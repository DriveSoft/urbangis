{"version":3,"sources":["components_hl/MenuGlobal.js","components/FormFilter.js","components/FormAccident.js","components/SidebarTabs.js","components/Sidebar.js","components/ButtonMap_.js","components/MapTileLayers.js","components/Map.js","components/images/markers/marker-red.png","components/images/markers/marker-shadow.png","components/LoginModalForm.js","components/RegisterModalForm.js","App.js","useAuthToken.js","reportWebVitals.js","i18nextConf.js","index.js"],"names":["MenuGlobal","currentCity","appname","onClickShowMenu","setLoginModalShow","authToken","setAuthToken","useState","cities","setCities","useTranslation","t","i18n","changeLanguage","value","useEffect","fetchCities","a","fetch","process","res","json","data","console","log","Navbar","bg","expand","Container","Button","className","variant","id","onClick","Toggle","Collapse","Nav","Link","href","NavDropdown","title","Item","active","map","city","as","to","sysname","cityname","language","username","undefined","FormFilter","onSubmitFilter","minMaxDateData","dictManeuvers","dictTypeViolations","dictViolators","setDefaultsForDates","setValue","minDate","maxDate","useForm","reValidateMode","defaultValues","dateFromFilter","dateToFilter","descFilter","maneuverFilter","violationsTypeFilter","violatorsFilter","driverViolationFilter","motorcyclistViolationFilter","cyclistViolationFilter","pedestrianViolationFilter","kidsInjuredFilter","pubtrPassengersInjuredFilter","driversKilledFilter","motorcyclistsKilledFilter","cyclistsKilledFilter","pedestrianKilledFilter","kidsKilledFilter","pubtrPassengersKilledFilter","publicTransportInvolvedFilter","showOnlyMyAccidentsFilter","select","control","handleSubmit","reset","optionsManeuverFilter","Array","isArray","x","label","maneuvername","optionsTypeViolationsFilter","violationname","optionsViolatorsFilter","violatorname","Form","onSubmit","Row","Group","Col","controlId","Label","name","render","field","Control","type","style","minWidth","isClearable","isSearchable","options","isMulti","Card","body","Title","Check","checked","inline","e","FormAccident","newMarkerState","onSubmitAccident","onDeleteAccident","onCloseAccident","dataAccidentForm","showModalDelete","setShowModalDelete","dateTimeRef","useRef","visible","current","state","inputValue","selectedDate","position","lat","lng","formData","accidentId","properties","latAccidentForm","latitude","lngAccidentForm","longitude","descAccidentForm","description","datetime","dateTimeAccidentForm","moment","maneuver","maneuverAccidentForm","find","item","violations_type","parseInt","violationsTypeAccidentForm","filter","includes","violators","violatorsAccidentForm","driversInjuredAccidentForm","drivers_injured","motorcyclistsInjuredAccidentForm","motorcyclists_injured","cyclistsInjuredAccidentForm","cyclists_injured","pedInjuredAccidentForm","ped_injured","kidsInjuredAccidentForm","kids_injured","pubtrPassengersInjuredAccidentForm","pubtr_passengers_injured","driversKilledAccidentForm","drivers_killed","motorcyclistsKilledAccidentForm","motorcyclists_killed","cyclistsKilledAccidentForm","cyclists_killed","pedKilledAccidentForm","ped_killed","kidsKilledAccidentForm","kids_killed","pubtrPassengersKilledAccidentForm","pubtr_passengers_killed","publicTransportInvolvedAccidentForm","public_transport_involved","keepDefaultValues","getValues","errors","formState","dataRest","format","rules","required","step","size","isInvalid","Feedback","rows","ref","color","marginTop","min","max","display","Modal","show","onHide","Header","closeButton","Body","Footer","SidebarTabs","showAccidentTab","activeTabKey","setActiveTabKey","Tabs","activeKey","onSelect","k","Tab","eventKey","overflowY","overflowX","width","height","tabClassName","Sidebar","ButtonMap_","iconTrue","iconFalse","checkButtonState","L","easyButton","states","stateName","icon","button","backgroundColor","addTo","MapTileLayers","heatMapLayer","setView_nTimes_gps","circle_geolocation","mapBaseLayerName","LayersControl","BaseLayer","TileLayer","attribution","url","accessToken","tileSize","zoomOffset","maxZoom","subdomains","bingkey","redIcon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","geojsonMarkerOptions","radius","fillColor","weight","opacity","fillOpacity","currentCitySysname","Map","dataAccidents","dataHeatmapPoints","onDragEndNewMarker","checkButtonNewMarker","checkButtonHeatmap","checkButtonGPS","onClickMap","onMarkerClick","onClickNewMarker","onClickHeatmap","onClickGPS","filterMapCallback","onBaselayerchange","setNewMarkerState","isMobileDevice","showOkCancelMobileMarker","setCheckButtonGPS","showSidebar","currentCityInfo","setCurrentCityInfo","setMap","currentZoom","setCurrentZoom","buttonNewMarker","setButtonNewMarker","buttonHeatmap","setButtonHeatmap","buttonGPS","setButtonGPS","mapname_","document","cookie","split","row","startsWith","newMarkerRef","SetPanToMap","useMap","panTo","parseFloat","_onClickGPS","locate","enableHighAccuracy","watch","maximumAge","stopLocate","removeLayer","markerOnClick","geojson","target","toGeoJSON","pointToLayer","feature","latlng","circleMarker","on","onEachFeaturePoint","layer","NewMarker","eventHandlers","useMemo","dragend","marker","LatLng","getLatLng","coord","toFixed","Marker","draggable","getCenter","MapEvents","useMapEvents","baselayerchange","move","setLatLng","moveend","click","zoomend","_zoom","locationfound","accuracy","setView","hasLayer","setRadius","circle","locationerror","alert","message","HeatmapFunction","heatLayer","gradient","blur","addLayer","remove","fetchCity","DomUtil","addClass","_container","removeClass","window","setTimeout","invalidateSize","pan","MapContainer","cursor","whenCreated","center","zoom","zoomControl","scrollWheelZoom","GeoJSON","onEachFeature","Date","now","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","iconCreateFunction","cluster","digits","count","getChildCount","divIcon","html","ZoomControl","LoginModalForm","setRegisterModalShow","showWrongPassword","setShowWrongPassword","password","rememberme","credentials","method","headers","JSON","stringify","then","status","centered","localStorage","setItem","loginUser","FloatingLabel","placeholder","Text","RegisterModalForm","email","password2","first_name","last_name","setError","token","Object","entries","key","registerUser","App","props","getUsernameFromToken","access","arToken","length","parse","atob","tokenString","getItem","sessionStorage","userName","getToken","userToken","removeItem","useAuthToken","innerWidth","screenWidth","setScreenWidth","setIsMobileDevice","isMobileView","paramsRouter","useParams","csrftoken","cookieValue","cookies","i","trim","substring","decodeURIComponent","getCookie","loginModalShow","registerModalShow","setMapBaseLayerName","setDictManeuvers","setTypeViolations","setDictViolators","setDataAccidents","dataFilters","setDataFilters","setMinMaxDateData","setDataAccidentForm","isMobile","setShowSidebar","setShowAccidentTab","setCheckButtonNewMarker","setCheckButtonHeatmap","setShowOkCancelMobileMarker","handleWindowSizeChange","fetchManeuvers","fetchTypeViolations","fetchViolators","myHeaders","Headers","append","response","refreshAuthToken","refresh","checkAuthToken","test","navigator","userAgent","addEventListener","removeEventListener","fetchAccidents","interval","setInterval","clearInterval","cityName","datefilter_Min","datefilter_Max","features","slice","fetchUrl","bodyObject","statusText","detail","paddingRight","paddingLeft","valueFilter","dateFrom_Filter","dateTo_Filter","maneuver_Filter","description_Filter","violations_type_Filter","violators_Filter","drivers_injured_Filter","motorcyclists_injured_Filter","cyclists_injured_Filter","ped_injured_Filter","kids_injured_Filter","pubtr_passengers_injured_Filter","drivers_killed_Filter","motorcyclists_killed_Filter","cyclists_killed_Filter","ped_killed_Filter","kids_killed_Filter","pubtr_passengers_killed_Filter","public_transport_involved_Filter","toLowerCase","indexOf","String","driverInjuredFilter","motorcyclistInjuredFilter","cyclistInjuredFilter","pedestrianInjuredFilter","returnValue","push","refreshToken","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","use","LanguageDetector","initReactI18next","init","resources","en","translation","translationEN","translationBG","fallbackLng","interpolation","escapeValue","ReactDOM","basename","path","element","getElementById"],"mappings":"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","file":"static/js/main.dc4c537e.chunk.js","sourcesContent":["import { useState, useEffect } from 'react'\r\nimport Container from 'react-bootstrap/Container';\r\nimport Navbar from 'react-bootstrap/Navbar'\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport NavDropdown from 'react-bootstrap/NavDropdown';\r\nimport Button from 'react-bootstrap/Button';\r\nimport { Link } from \"react-router-dom\";\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nfunction MenuGlobal({currentCity, appname, onClickShowMenu, setLoginModalShow, authToken, setAuthToken}) {\r\n    const [cities, setCities] = useState([])  \r\n\t\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\r\n    useEffect(() => {\r\n        const fetchCities = async () => {\r\n          const res = await fetch(`${process.env.REACT_APP_API_URL}cities/`)\r\n          const data = await res.json()\r\n          setCities(data)\r\n          console.log(data)\r\n        }\r\n    \r\n        fetchCities()\r\n      }, [])  \r\n      \r\n      \r\n\r\n\tfunction changeLanguage(value) {\r\n\t\ti18n.changeLanguage(value)\r\n\t\t//localStorage.setItem('lng', value)\r\n\t}\r\n\r\n\r\n    return (\r\n\t\t<Navbar bg=\"light\" expand=\"lg\">\r\n\t\t\t<Container>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tclassName=\"start-0\"\r\n\t\t\t\t\tvariant=\"outline-primary\"\r\n\t\t\t\t\tid=\"menu-toggle\"\r\n\t\t\t\t\tonClick={onClickShowMenu}\r\n\t\t\t\t>\r\n\t\t\t\t\t{t('menu.menu')}\r\n\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t<Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n\t\t\t\t<Navbar.Collapse id=\"basic-navbar-nav\">\r\n\t\t\t\t\t<Nav className=\"ms-auto\">\r\n\t\t\t\t\t\t<Nav.Link href=\"/\">{t('menu.home')}</Nav.Link>\r\n\r\n\r\n\t\t\t\t\t\t<NavDropdown title={t('menu.appMaps.title')} id=\"basic-nav-dropdown\">\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/roadaccident/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"roadaccident\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t('menu.appMaps.roadaccident')}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/citytree/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"citytree\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t('menu.appMaps.citytree')}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/urbanobject/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"3\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"urbanobject\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t('menu.appMaps.urbanobject')}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown title={t('menu.city')} id=\"basic-nav-dropdown\">\r\n\t\t\t\t\t\t\t{cities.map((city) => (\r\n\t\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\t\tas={Link}\r\n\t\t\t\t\t\t\t\t\tkey={city.id}\r\n\t\t\t\t\t\t\t\t\tto={`/${city.sysname}`}\r\n\t\t\t\t\t\t\t\t\tactive={currentCity === city.sysname}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{city.cityname}\r\n\t\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\r\n\r\n\t\t\t\t\t\t<NavDropdown title=\"Lang\" id=\"basic-nav-dropdown\">\r\n\t\t\t\t\t\t\t<NavDropdown.Item\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={\"en\" === i18n.language || \"en-US\" === i18n.language || \"en-GB\" === i18n.language}\r\n\t\t\t\t\t\t\t\tvalue=\"en\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage('en')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEnglish\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={\"bg\" === i18n.language}\r\n\t\t\t\t\t\t\t\tvalue=\"bg\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage('bg')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tBulgarian\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\t\t\t\t\t\t\r\n\r\n\r\n\t\t\t\t\t\t{authToken ? (\t\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Nav.Link>\r\n\t\t\t\t\t\t\t\t\t{`${t('words.hello')}, ${authToken.username}`}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetAuthToken(undefined);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{t('menu.logout')}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => setLoginModalShow(true)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t('menu.signin')}\r\n\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t)}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t\t</Nav>\r\n\t\t\t\t</Navbar.Collapse>\r\n\t\t\t</Container>\r\n\t\t</Navbar>\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default MenuGlobal\r\n","import { useState, useEffect } from 'react'\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { Form, Button, Card, Row, Col, } from 'react-bootstrap';\r\nimport Select from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n//export const DictionariesContext = createContext({})\r\n\r\n\r\nfunction FormFilter( {onSubmitFilter, minMaxDateData, dictManeuvers, dictTypeViolations, dictViolators} ) {\r\n\r\n    const { t, i18n } = useTranslation()\r\n\r\n    // used to set default values for dates control, because when it renders first time, minMaxDateData is still empty, after that I just can't change def values, so do it manually \r\n    useEffect(() => {\r\n        setDefaultsForDates()\r\n    }, [minMaxDateData])\r\n\r\n\r\n    function setDefaultsForDates(){\r\n        setValue('dateFromFilter', minMaxDateData.minDate)\r\n        setValue('dateToFilter', minMaxDateData.maxDate)\r\n    }\r\n\r\n \r\n    const { control, handleSubmit, reset, setValue } = useForm({\r\n        reValidateMode: 'onChange',\r\n        defaultValues: {\r\n            dateFromFilter: '',\r\n            dateToFilter: '',\r\n            descFilter: '',\r\n            maneuverFilter: '',\r\n            violationsTypeFilter: '',\r\n            violatorsFilter: '',\r\n\r\n            driverViolationFilter:  false,\r\n            motorcyclistViolationFilter:  false,\r\n            cyclistViolationFilter:  false,\r\n            pedestrianViolationFilter:  false,\r\n            kidsInjuredFilter:  false,\r\n            pubtrPassengersInjuredFilter: false,\r\n            \r\n            driversKilledFilter: false,\r\n            motorcyclistsKilledFilter: false,\r\n            cyclistsKilledFilter: false,\r\n            pedestrianKilledFilter: false,\r\n            kidsKilledFilter: false,\r\n            pubtrPassengersKilledFilter: false,\r\n\r\n            publicTransportInvolvedFilter: false,\r\n            showOnlyMyAccidentsFilter: false,\r\n\r\n          select: {}\r\n        }\r\n      });    \r\n\r\n      \r\n\r\n\r\n      //let optionsManeuverFilter = []\r\n      //let arManeuvers = dictsContex?.dictManeuvers\r\n      //if (Array.isArray(arManeuvers)) {\r\n      //  optionsManeuverFilter = arManeuvers.map((x) => { return {value: x.id, label: x.maneuvername} })  \r\n      //}\r\n\r\n      //let optionsTypeViolationsFilter = []\r\n      //let arTypeViolations = dictsContex?.dictTypeViolations\r\n      //if (Array.isArray(arTypeViolations)) {\r\n      //    optionsTypeViolationsFilter = arTypeViolations.map((x) => { return {value: x.id, label: x.violationname} })  \r\n      //}     \r\n        \r\n      //let optionsViolatorsFilter = []\r\n      //let arViolators = dictsContex?.dictViolators\r\n      //if (Array.isArray(arViolators)) {\r\n      //    optionsViolatorsFilter = arViolators.map((x) => { return {value: x.id, label: x.violatorname} })  \r\n      //}         \r\n\r\n      \r\n    let optionsManeuverFilter = []\r\n    if (Array.isArray(dictManeuvers)) {\r\n        optionsManeuverFilter = dictManeuvers.map((x) => { return {value: x.id, label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`)} }) \r\n         \r\n    }\r\n\r\n    let optionsTypeViolationsFilter = []\r\n    if (Array.isArray(dictTypeViolations)) {\r\n        optionsTypeViolationsFilter = dictTypeViolations.map((x) => { return {value: x.id, label: t(`sidebar.filterTab.typeViolationsList.${x.violationname}`)} })  \r\n    }\r\n    \r\n    let optionsViolatorsFilter = []\r\n    if (Array.isArray(dictViolators)) {\r\n        optionsViolatorsFilter = dictViolators.map((x) => { return {value: x.id, label: t(`sidebar.filterTab.violatorsList.${x.violatorname}`)} })  \r\n    }    \r\n\r\n      \r\n     \r\n    \r\n    \r\n    function onResetButton(e) {\r\n        reset()\r\n        setDefaultsForDates()\r\n        onSubmitFilter({})\r\n    }     \r\n    \r\n\r\n\r\n    return (\r\n        <div>\r\n            <Form className=\"m-1\" onSubmit={handleSubmit(onSubmitFilter)}> \r\n\r\n                <Row >\r\n                    <Form.Group as={Col} controlId=\"formDateFromFilter\">\r\n                        <Form.Label>{t('sidebar.filterTab.from')}</Form.Label>\r\n                        <Controller\r\n                            name=\"dateFromFilter\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"date\" {...field} />}\r\n                        />\r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formDateToFilter\">\r\n                        <Form.Label>{t('sidebar.filterTab.to')}</Form.Label>\r\n                        <Controller\r\n                            name=\"dateToFilter\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"date\" {...field} />}\r\n                        />\r\n                    </Form.Group>\r\n                </Row>\r\n\r\n\r\n\r\n                <Row className=\"mt-3\">\r\n                    <Form.Group as={Col} controlId=\"formManeuverFilter\" style={{minWidth: '250px'}}>\r\n                        <Form.Label>{t('sidebar.filterTab.vehicleManeuver')}</Form.Label>\r\n                        <Controller\r\n                            name=\"maneuverFilter\"\r\n                            control={control}\r\n                            render={({ field }) => <Select {...field} isClearable isSearchable={false} options={optionsManeuverFilter} />}\r\n                        />\r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formDescFilter\">\r\n                        <Form.Label>{t('sidebar.filterTab.description')}</Form.Label>\r\n                        <Controller\r\n                            name=\"descFilter\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"text\" {...field} />}\r\n                        />\r\n                    </Form.Group>                    \r\n                </Row>                \r\n\r\n\r\n\r\n                <Form.Group controlId=\"formViolationsTypeFilter\" className=\"mt-3\">\r\n                    <Form.Label>{t('sidebar.filterTab.violationsType')}</Form.Label>\r\n                    <Controller\r\n                        name=\"violationsTypeFilter\"\r\n                        control={control}\r\n                        render={({ field }) => <Select {...field} isMulti isSearchable={false} options={optionsTypeViolationsFilter} />}\r\n                    />\r\n                </Form.Group>\r\n\r\n\r\n                <Form.Group controlId=\"formviolatorsFilter\" className=\"mt-3\">\r\n                    <Form.Label>{t('sidebar.filterTab.violators')}</Form.Label>\r\n                    <Controller\r\n                        name=\"violatorsFilter\"\r\n                        control={control}\r\n                        render={({ field }) => <Select {...field} isMulti isSearchable={false} options={optionsViolatorsFilter} />}\r\n                    />\r\n                </Form.Group>      \r\n\r\n\r\n\r\n                <Card body className=\"mt-3\">\r\n                    <Card.Title><h6>{t('sidebar.filterTab.injured')}</h6></Card.Title>\r\n                    \r\n                        <Controller\r\n                            name=\"driverInjuredFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.driver')} type=\"checkbox\" id=\"idDriverInjuredFilter\"/>\r\n                            }\r\n                        />        \r\n\r\n                        <Controller\r\n                            name=\"motorcyclistInjuredFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.motorcyclist')} type=\"checkbox\" id=\"idMotorcyclistInjuredFilter\"/>\r\n                            }\r\n                        />                                         \r\n\r\n                        <Controller\r\n                            name=\"cyclistInjuredFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.cyclist')} type=\"checkbox\" id=\"idCyclistInjuredFilter\"/>\r\n                            }\r\n                        /> \r\n\r\n                        <Controller\r\n                            name=\"pedestrianInjuredFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.pedestrian')} type=\"checkbox\" id=\"idPedestrianInjuredFilter\"/>\r\n                            }\r\n                        /> \r\n\r\n                        <Controller\r\n                            name=\"kidsInjuredFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.kid')} type=\"checkbox\" id=\"idKidsInjuredFilter\"/>\r\n                            }\r\n                        /> \r\n     \r\n                        <Controller\r\n                            name=\"pubtrPassengersInjuredFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.pubtrPassenger')} type=\"checkbox\" id=\"idPubtrPassengersInjuredFilter\"/>\r\n                            }\r\n                        />                         \r\n                </Card>          \r\n\r\n\r\n\r\n                <Card body className=\"mt-3\">\r\n                    <Card.Title><h6>{t('sidebar.filterTab.killed')}</h6></Card.Title>\r\n                    \r\n                        <Controller\r\n                            name=\"driversKilledFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.driver')} type=\"checkbox\" id=\"idDriversKilledFilter\"/>\r\n                            }\r\n                        />        \r\n\r\n                        <Controller\r\n                            name=\"motorcyclistsKilledFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.motorcyclist')} type=\"checkbox\" id=\"idMotorcyclistsKilledFilter\"/>\r\n                            }\r\n                        />                                         \r\n\r\n                        <Controller\r\n                            name=\"cyclistsKilledFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.cyclist')} type=\"checkbox\" id=\"idCyclistsKilledFilter\"/>\r\n                            }\r\n                        /> \r\n\r\n                        <Controller\r\n                            name=\"pedestrianKilledFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.pedestrian')} type=\"checkbox\" id=\"idPedestrianKilledFilter\"/>\r\n                            }\r\n                        /> \r\n\r\n                        <Controller\r\n                            name=\"kidsKilledFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.kid')} type=\"checkbox\" id=\"idKidsKilledFilter\"/>\r\n                            }\r\n                        /> \r\n     \r\n                        <Controller\r\n                            name=\"pubtrPassengersKilledFilter\"\r\n                            control={control}\r\n                            render={({ field }) => \r\n                                <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.pubtrPassenger')} type=\"checkbox\" id=\"idPubtrPassengersKilledFilter\"/>\r\n                            }\r\n                        />                         \r\n                </Card> \r\n\r\n\r\n                <Form.Group controlId=\"formPublicTransportInvolvedFilter\" className=\"mt-3 ms-1\">\r\n                    <Controller\r\n                                name=\"publicTransportInvolvedFilter\"\r\n                                control={control}\r\n                                render={({ field }) => \r\n                                    <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.publicTransportInvolved')} type=\"checkbox\" id=\"idPublicTransportInvolvedFilter\"/>\r\n                                }\r\n                    /> \r\n                </Form.Group>\r\n\r\n                <Form.Group controlId=\"formShowOnlyMyAccidentsFilter\" className=\"mt-3 ms-1\">\r\n                    <Controller\r\n                                name=\"showOnlyMyAccidentsFilter\"\r\n                                control={control}\r\n                                render={({ field }) => \r\n                                    <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.filterTab.showOnlyMyAccidents')} type=\"checkbox\" id=\"idShowOnlyMyAccidentsFilter\"/>\r\n                                }\r\n                    /> \r\n                </Form.Group>\r\n\r\n\r\n                <div className=\"mt-4 me-2 float-end\">\r\n                    <Button variant=\"light\" onClick={onResetButton}>{t('sidebar.filterTab.clear')}</Button>{' '}\r\n                    <Button type=\"submit\" variant=\"primary\" style={{ minWidth: '150px' }}>{t('sidebar.filterTab.search')}</Button>{' '}\r\n                </div>\r\n\r\n            </Form> \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default FormFilter\r\n","import { useState, useEffect, useRef } from 'react'\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { Form, Button, Card, Row, Col, Modal} from 'react-bootstrap'\r\nimport Select from \"react-select\";\r\nimport \"@fortawesome/fontawesome-free/css/all.min.css\"\r\n\r\nimport Datetime from 'react-datetime'\r\nimport \"react-datetime/css/react-datetime.css\"\r\n\r\nimport moment from 'moment'\r\nimport { useTranslation } from 'react-i18next'\r\n\r\n\r\nfunction FormAccident( {newMarkerState, onSubmitAccident, onDeleteAccident, onCloseAccident, dictManeuvers, dictTypeViolations, dataAccidentForm, dictViolators, currentCity} ) {\r\n    \r\n    const [showModalDelete, setShowModalDelete] = useState(false);\r\n    const dateTimeRef = useRef(null)\r\n    const { t } = useTranslation()\r\n\r\n    //const handleShowModalDeleteClose = () => setShowModalDelete(false);\r\n\r\n\r\n    useEffect(() => {\r\n        if (newMarkerState.visible) {\r\n            reset()\r\n                    \r\n            // perhaps a bug of component, value is not reset, so reset it manually\r\n            dateTimeRef.current.state.inputValue = ''\r\n            dateTimeRef.current.state.selectedDate = undefined\r\n                        \r\n            setValue('latAccidentForm', newMarkerState.position.lat) \r\n            setValue('lngAccidentForm', newMarkerState.position.lng)             \r\n        }\r\n    }, [newMarkerState])\r\n\r\n\r\n    useEffect(() => {\r\n        let formData = {}\r\n\r\n        formData.accidentId = dataAccidentForm?.properties?.id\r\n        formData.latAccidentForm = dataAccidentForm?.properties?.latitude\r\n        formData.lngAccidentForm = dataAccidentForm?.properties?.longitude\r\n        formData.descAccidentForm = dataAccidentForm?.properties?.description\r\n        \r\n        if (dataAccidentForm?.properties?.datetime) {\r\n            formData.dateTimeAccidentForm = moment(dataAccidentForm?.properties?.datetime)\r\n        }\r\n        \r\n        let maneuver = dataAccidentForm?.properties?.maneuver\r\n        if (maneuver) {\r\n            formData.maneuverAccidentForm = optionsManeuverFilter.find((item) => item.value === maneuver)           \r\n        }\r\n\r\n        let violations_type = dataAccidentForm?.properties?.violations_type\r\n        if (violations_type) {\r\n            violations_type = violations_type.map(item => parseInt(item))            \r\n            formData.violationsTypeAccidentForm = optionsTypeViolationsFilter.filter(item => violations_type.includes(item.value))          \r\n        }        \r\n        \r\n        let violators = dataAccidentForm?.properties?.violators\r\n        if (violators) {\r\n            violators = violators.map(item => parseInt(item))            \r\n            formData.violatorsAccidentForm = optionsViolatorsFilter.filter(item => violators.includes(item.value))          \r\n        }          \r\n\r\n        \r\n        formData.driversInjuredAccidentForm = dataAccidentForm?.properties?.drivers_injured\r\n        formData.motorcyclistsInjuredAccidentForm = dataAccidentForm?.properties?.motorcyclists_injured\r\n        formData.cyclistsInjuredAccidentForm = dataAccidentForm?.properties?.cyclists_injured\r\n        formData.pedInjuredAccidentForm = dataAccidentForm?.properties?.ped_injured\r\n        formData.kidsInjuredAccidentForm = dataAccidentForm?.properties?.kids_injured\r\n        formData.pubtrPassengersInjuredAccidentForm = dataAccidentForm?.properties?.pubtr_passengers_injured\r\n        \r\n        formData.driversKilledAccidentForm = dataAccidentForm?.properties?.drivers_killed\r\n        formData.motorcyclistsKilledAccidentForm = dataAccidentForm?.properties?.motorcyclists_killed\r\n        formData.cyclistsKilledAccidentForm = dataAccidentForm?.properties?.cyclists_killed\r\n        formData.pedKilledAccidentForm = dataAccidentForm?.properties?.ped_killed\r\n        formData.kidsKilledAccidentForm = dataAccidentForm?.properties?.kids_killed\r\n        formData.pubtrPassengersKilledAccidentForm = dataAccidentForm?.properties?.pubtr_passengers_killed\r\n\r\n        formData.publicTransportInvolvedAccidentForm = dataAccidentForm?.properties?.public_transport_involved\r\n\r\n\r\n\r\n        //formData.violationsTypeAccidentForm = [{value: 1, label: '  '}, {value: 3, label: ''}]\r\n\r\n\r\n        //setValue(\"violationsTypeAccidentForm\",[{value: 1, label: '  '}, {value: 3, label: ''}]);\r\n\r\n        //formData.violationsTypeAccidentForm = \r\n        \r\n        //console.log('optionsTypeViolationsFilter', optionsTypeViolationsFilter)\r\n        //console.log('violations_type', violations_type)\r\n        \r\n\r\n\r\n        //console.log('dictManeuvers', dictManeuvers)\r\n        //setValue(\"maneuverAccidentForm\", {value: 2, label: '  '}, { shouldValidate: true });\r\n        //setValue(\"maneuverAccidentForm\",[{value: 'optionA', label:'Option A'}]);\r\n\r\n  \r\n        reset(formData, {keepDefaultValues: true} )\r\n    }, [dataAccidentForm])    \r\n        \r\n\r\n\r\n\r\n\r\n    let optionsManeuverFilter = []\r\n    if (Array.isArray(dictManeuvers)) {\r\n        optionsManeuverFilter = dictManeuvers.map((x) => { return {value: x.id, label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`)} })  \r\n    }\r\n  \r\n    let optionsTypeViolationsFilter = []\r\n    if (Array.isArray(dictTypeViolations)) {\r\n        optionsTypeViolationsFilter = dictTypeViolations.map((x) => { return {value: x.id, label: t(`sidebar.filterTab.typeViolationsList.${x.violationname}`)} })  \r\n    }\r\n      \r\n    let optionsViolatorsFilter = []\r\n    if (Array.isArray(dictViolators)) {\r\n        optionsViolatorsFilter = dictViolators.map((x) => { return {value: x.id, label: t(`sidebar.filterTab.violatorsList.${x.violatorname}`)} })  \r\n    }      \r\n\r\n\r\n    \r\n\r\n    const { control, handleSubmit, reset, setValue, getValues, formState: { errors }  } = useForm({\r\n        //reValidateMode: 'onChange',\r\n        defaultValues: {\r\n            latAccidentForm: '',\r\n            lngAccidentForm: '',\r\n            descAccidentForm: '',\r\n            dateTimeAccidentForm: '',\r\n            maneuverAccidentForm: null, \r\n            violationsTypeAccidentForm: [],\r\n            violatorsAccidentForm: [],\r\n\r\n            driversInjuredAccidentForm: 0,\r\n            motorcyclistsInjuredAccidentForm: 0,\r\n            cyclistsInjuredAccidentForm: 0,\r\n            pedInjuredAccidentForm: 0,\r\n            kidsInjuredAccidentForm: 0,\r\n            pubtrPassengersInjuredAccidentForm: 0,\r\n            \r\n            driversKilledAccidentForm: 0,\r\n            motorcyclistsKilledAccidentForm: 0,\r\n            cyclistsKilledAccidentForm: 0, \r\n            pedKilledAccidentForm: 0, \r\n            kidsKilledAccidentForm: 0,\r\n            pubtrPassengersKilledAccidentForm: 0,\r\n            \r\n            publicTransportInvolvedAccidentForm: false,\r\n              \r\n            accidentId: ''\r\n        }\r\n    }); \r\n\r\n\r\n\r\n    function prepareOnSubmitAccident (data) {\r\n        let dataRest = {}\r\n\r\n        \r\n        dataRest.id = parseInt(getValues(\"accidentId\")) || null\r\n        //dataRest.city = currentCity\r\n        dataRest.latitude = getValues(\"latAccidentForm\")\r\n        dataRest.longitude = getValues(\"lngAccidentForm\")\r\n        dataRest.datetime = getValues(\"dateTimeAccidentForm\").format('YYYY-MM-DDTHH:mm')\r\n        \r\n        dataRest.maneuver = getValues(\"maneuverAccidentForm\")?.value   \r\n        if (dataRest.maneuver === undefined) { dataRest.maneuver = null }\r\n        \r\n        dataRest.description = getValues(\"descAccidentForm\")        \r\n        dataRest.violations_type = getValues(\"violationsTypeAccidentForm\").map((item) => item.value)\r\n        dataRest.violators = getValues(\"violatorsAccidentForm\").map((item) => item.value)\r\n        \r\n        dataRest.drivers_injured = parseInt(getValues(\"driversInjuredAccidentForm\")) || 0\r\n        dataRest.motorcyclists_injured = parseInt(getValues(\"motorcyclistsInjuredAccidentForm\")) || 0\r\n        dataRest.cyclists_injured = parseInt(getValues(\"cyclistsInjuredAccidentForm\")) || 0\r\n        dataRest.ped_injured = parseInt(getValues(\"pedInjuredAccidentForm\")) || 0\r\n        dataRest.kids_injured = parseInt(getValues(\"kidsInjuredAccidentForm\")) || 0\r\n        dataRest.pubtr_passengers_injured = parseInt(getValues(\"pubtrPassengersInjuredAccidentForm\")) || 0\r\n        \r\n        dataRest.drivers_killed = parseInt(getValues(\"driversKilledAccidentForm\")) || 0\r\n        dataRest.motorcyclists_killed = parseInt(getValues(\"motorcyclistsKilledAccidentForm\")) || 0\r\n        dataRest.cyclists_killed = parseInt(getValues(\"cyclistsKilledAccidentForm\")) || 0\r\n        dataRest.ped_killed = parseInt(getValues(\"pedKilledAccidentForm\")) || 0\r\n        dataRest.kids_killed = parseInt(getValues(\"kidsKilledAccidentForm\")) || 0\r\n        dataRest.pubtr_passengers_killed = parseInt(getValues(\"pubtrPassengersKilledAccidentForm\")) || 0\r\n        \r\n        dataRest.public_transport_involved = getValues(\"publicTransportInvolvedAccidentForm\")\r\n\r\n        onSubmitAccident(dataRest)    \r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Form className=\"m-1\" onSubmit={handleSubmit(prepareOnSubmitAccident)}>\r\n\r\n                <Row>\r\n                    <Form.Group as={Col} controlId=\"formDateFromFilter\">\r\n                        <Form.Label>{t('sidebar.accidentTab.latLng')} <a href=\"#\"><i className=\"fas fa-edit align-middle\"></i></a></Form.Label>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formLatAccident\">\r\n                        <Controller\r\n                            name=\"latAccidentForm\"\r\n                            control={control}\r\n                            rules={{ required: true }}\r\n                            render={({ field }) => <Form.Control type=\"number\" step=\"any\" size=\"sm\" isInvalid={!!errors.latAccidentForm} {...field} />}\r\n                        />\r\n\r\n                        <Form.Control.Feedback type=\"invalid\">\r\n                            {t('words.requiredField')}\r\n                        </Form.Control.Feedback>                          \r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formLngAccident\">\r\n                        <Controller\r\n                            name=\"lngAccidentForm\"\r\n                            control={control}\r\n                            rules={{ required: true }}\r\n                            render={({ field }) => <Form.Control type=\"number\" step=\"any\" size=\"sm\" isInvalid={!!errors.lngAccidentForm} {...field} />}\r\n                        />\r\n                        <Form.Control.Feedback type=\"invalid\">\r\n                            {t('words.requiredField')}\r\n                        </Form.Control.Feedback>                        \r\n                    </Form.Group>                    \r\n                </Row>\r\n\r\n\r\n                <Form.Group controlId=\"formDescriptionAccident\" className=\"mt-3\">\r\n                    <Form.Label>{t('sidebar.accidentTab.description')}</Form.Label>\r\n                    <Controller\r\n                        name=\"descAccidentForm\"\r\n                        control={control}\r\n                        render={({ field }) => <Form.Control type=\"text\" as=\"textarea\" rows={3}  {...field} />}\r\n                    />\r\n                </Form.Group>\r\n\r\n\r\n                <Row className=\"mt-3\">\r\n                    <Form.Group as={Col} controlId=\"formDateTimeAccident\" style={{minWidth: '250px'}}>\r\n                        <Form.Label>{t('sidebar.accidentTab.datetime')}</Form.Label>\r\n                        <Controller\r\n                            name=\"dateTimeAccidentForm\"\r\n                            control={control}\r\n                            rules={{ required: true }}\r\n                            \r\n                            render={({ field }) => <Datetime {...field} ref={dateTimeRef} />}\r\n                        />\r\n                        { errors.dateTimeAccidentForm ? \r\n                            <p style={{color: \"red\"}}><small>Required field</small></p> \r\n                            : ''                            \r\n                        }   \r\n                      \r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formManeuverAccident\">\r\n                        <Form.Label>{t('sidebar.accidentTab.vehicleManeuver')}</Form.Label>\r\n                        <Controller\r\n                            name=\"maneuverAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Select {...field} isClearable isSearchable={false} options={optionsManeuverFilter} />}\r\n                        />\r\n                    </Form.Group>                    \r\n                </Row> \r\n\r\n\r\n\r\n                <Form.Group controlId=\"formViolationsTypeAccident\" className=\"mt-3\">\r\n                    <Form.Label>{t('sidebar.accidentTab.violationsType')}</Form.Label>\r\n                    <Controller\r\n                        name=\"violationsTypeAccidentForm\"\r\n                        control={control}\r\n                        render={({ field }) => <Select {...field} isMulti isSearchable={false} options={optionsTypeViolationsFilter} />}\r\n                    />\r\n                </Form.Group>\r\n\r\n\r\n                <Form.Group controlId=\"formViolatorsAccident\" className=\"mt-3\">\r\n                    <Form.Label>{t('sidebar.accidentTab.violators')}</Form.Label>\r\n                    <Controller\r\n                        name=\"violatorsAccidentForm\"\r\n                        control={control}\r\n                        render={({ field }) => <Select {...field} isMulti isSearchable={false} options={optionsViolatorsFilter} />}\r\n                    />\r\n                </Form.Group>                \r\n\r\n\r\n\r\n\r\n                <Row className=\"mt-3\">\r\n                    <Form.Group as={Col} controlId=\"formInjuredLabelAccident\"> \r\n                        <Form.Label style={{marginTop: \"32px\"}}>{t('sidebar.accidentTab.injured')}</Form.Label>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formDriversInjuredAccident\" className=\"ps-1 pe-0\">\r\n                        <Form.Label><i className=\"fas fa-car fa-lg\" title={t('sidebar.accidentTab.driverAndPassengers')}></i></Form.Label>\r\n                        <Controller\r\n                            name=\"driversInjuredAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group>    \r\n\r\n                    <Form.Group as={Col} controlId=\"formMotorcyclistsInjuredAccident\" className=\"ps-1 pe-0\">\r\n                        <Form.Label><i className=\"fas fa-motorcycle fa-lg\" title={t('sidebar.accidentTab.motorcyclist')}></i></Form.Label>\r\n                        <Controller\r\n                            name=\"motorcyclistsInjuredAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formCyclistsInjuredAccident\" className=\"ps-1 pe-0\">\r\n                        <Form.Label><i className=\"fas fa-bicycle fa-lg\" title={t('sidebar.accidentTab.cyclist')}></i></Form.Label>\r\n                        <Controller\r\n                            name=\"cyclistsInjuredAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formPedInjuredAccident\" className=\"ps-1 pe-0\">\r\n                        <Form.Label><i className=\"fas fa-walking fa-lg\" title={t('sidebar.accidentTab.pedestrian')}></i></Form.Label>\r\n                        <Controller\r\n                            name=\"pedInjuredAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formKidsInjuredAccident\" className=\"ps-1 pe-0\">\r\n                        <Form.Label><i className=\"fas fa-baby fa-lg\" title={t('sidebar.accidentTab.kid')}></i></Form.Label>\r\n                        <Controller\r\n                            name=\"kidsInjuredAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formPubtrPassengersInjuredAccident\" className=\"ps-1 pe-0\">\r\n                        <Form.Label><i className=\"fas fa-bus-alt fa-lg\" title={t('sidebar.accidentTab.publicTransPassenger')}></i></Form.Label>\r\n                        <Controller\r\n                            name=\"pubtrPassengersInjuredAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group>                                                                                                                     \r\n                </Row> \r\n\r\n\r\n\r\n                <Row className=\"mt-0\">\r\n                    <Form.Group as={Col} controlId=\"formKilledLabelAccident\"> \r\n                        <Form.Label>{t('sidebar.accidentTab.killed')}</Form.Label>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formDriversKilledAccident\" className=\"ps-1 pe-0\">\r\n                        <Controller\r\n                            name=\"driversKilledAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group>    \r\n\r\n                    <Form.Group as={Col} controlId=\"formMotorcyclistsKilledAccident\" className=\"ps-1 pe-0\">\r\n                        <Controller\r\n                            name=\"motorcyclistsKilledAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formCyclistsKilledAccident\" className=\"ps-1 pe-0\">\r\n                        <Controller\r\n                            name=\"cyclistsKilledAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formPedKilledAccident\" className=\"ps-1 pe-0\">\r\n                        <Controller\r\n                            name=\"pedKilledAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formKidsKilledAccident\" className=\"ps-1 pe-0\">\r\n                        <Controller\r\n                            name=\"kidsKilledAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group> \r\n\r\n                    <Form.Group as={Col} controlId=\"formPubtrPassengersKilledAccident\" className=\"ps-1 pe-0\">\r\n                        <Controller\r\n                            name=\"pubtrPassengersKilledAccidentForm\"\r\n                            control={control}\r\n                            render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" max=\"99\" {...field} />}\r\n                        />\r\n                    </Form.Group>                                                                                                                     \r\n                </Row>                 \r\n\r\n\r\n                <Form.Group controlId=\"formPublicTransportInvolvedAccident\" className=\"mt-3 ms-1\">\r\n                    <Controller\r\n                                name=\"publicTransportInvolvedAccidentForm\"\r\n                                control={control}\r\n                                render={({ field }) => \r\n                                    <Form.Check {...field} checked={field['value'] ?? false} inline label={t('sidebar.accidentTab.publicTransInvolved')} type=\"checkbox\" id=\"idPublicTransportInvolvedAccident\"/>\r\n                                }\r\n                    /> \r\n                </Form.Group>\r\n\r\n\r\n                <Form.Group controlId=\"formIdAccident\" className=\"mt-3\">\r\n                    <Controller\r\n                        name=\"accidentId\"\r\n                        control={control}\r\n                        render={({ field }) => <Form.Control type=\"number\" size=\"sm\" min=\"0\" style={{display: 'none'}} {...field} />}\r\n                    />\r\n                </Form.Group>\r\n\r\n\r\n\r\n                <div className=\"mt-4 me-2 float-end\">\r\n                    <Button onClick={() => setShowModalDelete(true)} variant=\"light\">{t('sidebar.accidentTab.delete')}</Button>{' '}\r\n                    <Button onClick={onCloseAccident} variant=\"secondary\">{t('sidebar.accidentTab.close')}</Button>{' '}\r\n                    <Button type=\"submit\" variant=\"primary\" style={{ minWidth: '110px' }}>{t('sidebar.accidentTab.save')}</Button>\r\n                </div>\r\n\r\n\r\n            </Form>            \r\n            \r\n\r\n\r\n            \r\n\r\n            <Modal show={showModalDelete} onHide={() => setShowModalDelete(false)}>\r\n                <Modal.Header closeButton>\r\n                <Modal.Title>{t('words.deleting')}</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>{t('words.confirmDeleting')}</Modal.Body>\r\n                <Modal.Footer>\r\n                <Button variant=\"light\" onClick={() => {setShowModalDelete(false); onDeleteAccident(getValues(\"accidentId\"))} }>\r\n                    {t('words.delete')}\r\n                </Button>\r\n                <Button variant=\"secondary\" onClick={() => setShowModalDelete(false)}>\r\n                    {t('words.cancel')}\r\n                </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n\r\n\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default FormAccident\r\n","import { useState } from 'react'\r\nimport Tabs from 'react-bootstrap/Tabs'\r\nimport Tab from 'react-bootstrap/Tab'\r\nimport FormFilter from './FormFilter'\r\nimport FormAccident from './FormAccident'\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nconst SidebarTabs = ({\r\n\t\t\t\t\t\tonSubmitFilter, \r\n\r\n\t\t\t\t\t\tonSubmitAccident, \r\n\t\t\t\t\t\tonDeleteAccident, \r\n\t\t\t\t\t\tonCloseAccident,\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\tminMaxDateData, \r\n\t\t\t\t\t\tdataAccidentForm,\r\n\r\n\t\t\t\t\t\tshowAccidentTab, \r\n\t\t\t\t\t\tactiveTabKey, \r\n\t\t\t\t\t\tsetActiveTabKey, \r\n\t\t\t\t\t\tnewMarkerState, \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdictManeuvers, \r\n\t\t\t\t\t\tdictTypeViolations, \r\n\t\t\t\t\t\tdictViolators,\r\n\t\t\t\t\t\tcurrentCity\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t}) => {\r\n    const [key, setKey] = useState('filter')    \r\n    \r\n\tconst { t } = useTranslation()\r\n\r\n    return (\r\n        <Tabs\r\n        \tid=\"controlled-tab-example\"\r\n          \tactiveKey={activeTabKey}\r\n\t\t\tonSelect={(k) => setActiveTabKey(k)}\r\n          \t//onSelect={(k) => setKey(k)}\r\n          \tclassName=\"mb-3\"\r\n\t\t>\r\n\r\n        \t<Tab eventKey=\"filter\" title={t('sidebar.filterTab.title')}>\r\n\t\t\t\t<div style={{overflowY: 'auto', overflowX: 'hidden', width: '100%', height: 'calc(100vh - 130px)'}}>\r\n\t\t\t\t\t<FormFilter \r\n\t\t\t\t\t\tonSubmitFilter={onSubmitFilter} \r\n\t\t\t\t\t\tminMaxDateData={minMaxDateData} \r\n\t\t\t\t\t\tdictManeuvers={dictManeuvers} \r\n\t\t\t\t\t\tdictTypeViolations={dictTypeViolations} \r\n\t\t\t\t\t\tdictViolators={dictViolators} \r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n          \t</Tab>\r\n\r\n          \t<Tab eventKey=\"accident\" title={t('sidebar.accidentTab.title')} tabClassName={!showAccidentTab ? 'd-none' : ''}>\r\n\t\t\t  \t<div style={{overflowY: 'auto', overflowX: 'hidden', width: '100%', height: 'calc(100vh - 130px)'}}>\r\n\t\t\t\t\t<FormAccident \r\n\t\t\t\t\t\tonSubmitAccident={onSubmitAccident}\r\n\t\t\t\t\t\tonDeleteAccident={onDeleteAccident}\r\n\t\t\t\t\t\tonCloseAccident={onCloseAccident}\r\n\t\t\t\t\t\tnewMarkerState={newMarkerState}\r\n\t\t\t\t\t\tdictManeuvers={dictManeuvers}\r\n\t\t\t\t\t\tdictTypeViolations={dictTypeViolations}\r\n\t\t\t\t\t\tdictViolators={dictViolators} \r\n\t\t\t\t\t\tdataAccidentForm={dataAccidentForm}\r\n\t\t\t\t\t\tcurrentCity={currentCity}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n          \t</Tab>\r\n          \r\n\r\n\r\n        </Tabs>\r\n      );\r\n}\r\n\r\nexport default SidebarTabs\r\n","import { useState } from 'react'\r\nimport SidebarTabs from './SidebarTabs';\r\n\r\nconst Sidebar = ({\r\n                    onSubmitFilter, \r\n                    \r\n                    onSubmitAccident, \r\n                    onDeleteAccident, \r\n                    onCloseAccident,\r\n                    \r\n                    minMaxDateData, \r\n                    dataAccidentForm,\r\n\r\n                    showAccidentTab, \r\n                    activeTabKey, \r\n                    setActiveTabKey, \r\n                    newMarkerState, \r\n                    dictManeuvers, \r\n                    dictTypeViolations, \r\n                    dictViolators,\r\n                    currentCity\r\n                }) => {\r\n\r\n    \r\n\r\n    return (\r\n        <div className=\"bg-light border-right\" id=\"sidebar-wrapper\">\r\n            <div className=\"list-group list-group-flush\" style={{marginTop: '15px'}}>\r\n\r\n                <SidebarTabs \r\n                    onSubmitFilter={onSubmitFilter} \r\n                    \r\n                    onSubmitAccident={onSubmitAccident}\r\n                    onDeleteAccident={onDeleteAccident}\r\n                    onCloseAccident={onCloseAccident}\r\n\r\n                    minMaxDateData={minMaxDateData} \r\n                    dataAccidentForm={dataAccidentForm}\r\n                    \r\n                    showAccidentTab={showAccidentTab} \r\n                    activeTabKey={activeTabKey}\r\n                    setActiveTabKey={setActiveTabKey}\r\n                    newMarkerState={newMarkerState}\r\n\r\n                    dictManeuvers={dictManeuvers} \r\n                    dictTypeViolations={dictTypeViolations} \r\n                    dictViolators={dictViolators} \r\n                    currentCity={currentCity}\r\n                />\r\n\r\n            </div>            \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Sidebar\r\n","import L from 'leaflet';\r\nimport easyButton from 'leaflet-easybutton'\r\nimport \"leaflet-easybutton/src/easy-button.css\"\r\nimport \"@fortawesome/fontawesome-free/css/all.min.css\" \r\n \r\nfunction ButtonMap_ (map, iconTrue, iconFalse, onClick, checkButtonState) {\r\n    //const map = useMap()\r\n    \r\n            const buttonMap = L.easyButton({\r\n                position: 'topright',\r\n                states:[\r\n                    {\r\n                        stateName: 'off',\r\n                        icon: `<i class=\"${iconTrue}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('on');\r\n                            control.button.style.backgroundColor = 'red';\r\n                            onClick(true)\r\n                        }\r\n                    },\r\n        \r\n                    {\r\n                        stateName: 'on',\r\n                        icon: `<i class=\"${iconFalse}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('off');\r\n                            control.button.style.backgroundColor = 'white';\r\n                            onClick(false)\r\n                        }\r\n                    }]\r\n            }).addTo( map );\r\n\r\n\r\n\r\n            //if (checkButtonState) {\r\n            //    buttonMap.state('on');\r\n            //    buttonMap.button.style.backgroundColor = 'red';\r\n            //} else {\r\n            //    buttonMap.state('off');\r\n            //    buttonMap.button.style.backgroundColor = 'white';            \r\n            //}\r\n            \r\n            \r\n    \r\n    return buttonMap\r\n\r\n}\r\n\r\nexport default ButtonMap_\r\n","import React from \"react\"\r\nimport { LayersControl, TileLayer } from \"react-leaflet\"\r\nimport {BingLayer} from 'react-leaflet-bing-v2/src/index'\r\n\r\nfunction MapTileLayers({ mapBaseLayerName }) {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Default\"}\r\n\t\t\t\tname=\"Default\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/streets-v11\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Dark\"}\r\n\t\t\t\tname=\"Dark\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/dark-v10\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Google\"}\r\n\t\t\t\tname=\"Google\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat1\"}\r\n\t\t\t\tname=\"Sat1\"\r\n\t\t\t>\r\n                <BingLayer  bingkey={'AniAD3xsGTaSbK1pa0_UkWS1CldG0nGI7r55MlVZqHhyKil9rD9dFK8536u8hTj1'} type=\"Aerial\"/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n            \r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat2\"}\r\n\t\t\t\tname=\"Sat2\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat3\"}\r\n\t\t\t\tname=\"Sat3\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Tiles &copy; Esri'\r\n\t\t\t\t\turl=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\r\n                    maxZoom={19}                    \r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat4\"}\r\n\t\t\t\tname=\"Sat4\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/satellite-v9\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tmaxZoom={21}\r\n                    zoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default MapTileLayers;\r\n","import { useState, useEffect, useRef, useMemo } from 'react'\r\nimport { MapContainer, LayersControl, TileLayer, ZoomControl, useMapEvents, GeoJSON, useMap, Marker, Popup } from 'react-leaflet'\r\nimport L from 'leaflet'\r\nimport \"leaflet.heat\"\r\n\r\n//import ButtonMap from './ButtonMap'\r\nimport ButtonMap_ from './ButtonMap_'\r\nimport MapTileLayers from './MapTileLayers'\r\n\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport redIconFile from './images/markers/marker-red.png';\r\nimport redIconShadowFile from './images/markers/marker-shadow.png';\r\n\r\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\r\nimport 'react-leaflet-markercluster/dist/styles.min.css'; // sass\r\n//require('leaflet/dist/leaflet.css'); // inside .js file\r\n//require('react-leaflet-markercluster/dist/styles.min.css'); // inside .js file\r\n\r\n\r\n// fix disapeared marker from map\r\n\r\n//import icon from 'leaflet/dist/images/marker-icon.png';\r\n//import iconShadow from 'leaflet/dist/images/marker-shadow.png';\r\n//let DefaultIcon = L.icon({\r\n//    iconAnchor: [12, 40],\r\n//    iconUrl: icon,\r\n//    shadowUrl: iconShadow\r\n//});\r\n//L.Marker.prototype.options.icon = DefaultIcon;\r\n\r\n\r\n\r\n\r\n\r\nlet redIcon = L.icon({ \r\n    iconUrl: redIconFile,\r\n    shadowUrl: redIconShadowFile,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41]\r\n  });\r\n\r\n\r\nlet geojsonMarkerOptions = {\r\n    //renderer: myRenderer,\r\n    radius: 6, //6\r\n    fillColor: \"#402000\",//\"#ff7800\",\r\n    color: \"#000\",\r\n    weight: 0, //2        weight > 0\r\n    opacity: 0.5,//0.7\r\n    fillOpacity: 0.6//0.2\r\n};\r\n\r\n//let buttonNewMarker = null\r\n//let buttonHeatmap = null\r\n//let buttonGPS = null\r\n\r\nlet currentCitySysname = ''\r\n\r\nlet heatMapLayer\r\nlet markersLayer\r\n\r\nlet setView_nTimes_gps\r\nlet circle_geolocation\r\n\r\n\r\nfunction Map ({\r\n                mapBaseLayerName, \r\n                dataAccidents, \r\n                dataHeatmapPoints, \r\n                currentCity, \r\n                newMarkerState, \r\n                onDragEndNewMarker, \r\n                checkButtonNewMarker, \r\n                checkButtonHeatmap, \r\n                checkButtonGPS, \r\n                onClickMap, \r\n                onMarkerClick, \r\n                onClickNewMarker, \r\n                onClickHeatmap, \r\n                onClickGPS, \r\n                filterMapCallback, \r\n                onBaselayerchange, \r\n                setNewMarkerState, \r\n                isMobileDevice, \r\n                showOkCancelMobileMarker, \r\n                //setMapCurrentLatLng, \r\n                setCheckButtonGPS, \r\n                showSidebar}) {\r\n\r\n    const [currentCityInfo, setCurrentCityInfo] = useState({latitude: \"0\", longitude: \"0\"})\r\n    const [map, setMap] = useState(null);  \r\n    const [currentZoom, setCurrentZoom] = useState(null)  \r\n \r\n\r\n    const [buttonNewMarker, setButtonNewMarker] = useState(null);\r\n    const [buttonHeatmap, setButtonHeatmap] = useState(null);\r\n    const [buttonGPS, setButtonGPS] = useState(null);\r\n\r\n\r\n    let mapname = 'Default'\r\n    let mapname_ = document.cookie\r\n    .split('; ')\r\n    .find(row => row.startsWith('mapname='))\r\n\r\n    if (mapname_) {\r\n        mapname = mapname_.split('=')[1]    \r\n    }\r\n\r\n\r\n    let newMarkerRef = useRef(null)   \r\n \r\n\r\n    // create buttons\r\n    useEffect(() => {        \r\n        if (map) {            \r\n            setButtonNewMarker( ButtonMap_(map, 'fas fa-map-marker-alt fa-lg', 'fas fa-map-marker-alt fa-lg', onClickNewMarker, checkButtonNewMarker) )\r\n            setButtonHeatmap( ButtonMap_(map, 'fas fa-eye fa-lg', 'fas fa-eye-slash fa-lg', onClickHeatmap, checkButtonHeatmap) )\r\n            setButtonGPS( ButtonMap_(map, 'fas fa-satellite-dish fa-lg', 'fas fa-satellite-dish fa-lg', _onClickGPS, checkButtonGPS) )\r\n            \r\n            //setMapCurrentLatLng({lat: map.getCenter().lat, lng: map.getCenter().lng})\r\n            \r\n            \r\n        }\r\n\r\n        return () => { \r\n            buttonNewMarker && buttonNewMarker.remove()\r\n            buttonHeatmap && buttonHeatmap.remove()\r\n            buttonGPS && buttonGPS.remove()\r\n        }  \r\n\r\n\r\n      }, [map])  //<MapContainer whenCreated={setMap} ...\r\n\r\n\r\n    // load data for the city\r\n    useEffect(() => {\r\n\r\n        const fetchCity = async () => {\r\n          const res = await fetch(`${process.env.REACT_APP_API_URL}cities/${currentCity}`)\r\n          const data = await res.json()\r\n          setCurrentCityInfo(data)\r\n        }\r\n        fetchCity()        \r\n   \r\n      }, [currentCity])  //[currentCity]\r\n   \r\n\r\n\r\n      // apply states for buttons\r\n      useEffect(() => {        \r\n        if (buttonNewMarker) {\r\n            if (checkButtonNewMarker) {\r\n                buttonNewMarker.state('on');\r\n                buttonNewMarker.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonNewMarker.state('off');\r\n                buttonNewMarker.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [checkButtonNewMarker])\r\n      useEffect(() => {        \r\n        if (buttonHeatmap) {\r\n            if (checkButtonHeatmap) {\r\n                buttonHeatmap.state('on');\r\n                buttonHeatmap.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonHeatmap.state('off');\r\n                buttonHeatmap.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [checkButtonHeatmap])\r\n      useEffect(() => {        \r\n        if (buttonGPS) {\r\n            if (checkButtonGPS) {\r\n                buttonGPS.state('on');\r\n                buttonGPS.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonGPS.state('off');\r\n                buttonGPS.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [checkButtonGPS])      \r\n\r\n\r\n\r\n    useEffect(()=>{\r\n\r\n\r\n        if (map && !isMobileDevice) {\r\n            if (checkButtonNewMarker) {\r\n                L.DomUtil.addClass(map._container,'crosshair-cursor-enabled');\r\n            } else {\r\n                L.DomUtil.removeClass(map._container,'crosshair-cursor-enabled');\r\n            }    \r\n        }\r\n    }, [checkButtonNewMarker])\r\n      \r\n\r\n\r\n    useEffect(()=>{\r\n        if (map) {\r\n            window.setTimeout(function(){map.invalidateSize({pan: false});}, 600)\r\n        }        \r\n    }, [showSidebar])\r\n\r\n\r\n    function SetPanToMap() {        \r\n        const map = useMap()\r\n        // change map position when current city has been changed\r\n        if (currentCitySysname !== currentCityInfo[\"sysname\"]) {\r\n            map.panTo( [parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])] )\r\n        }\r\n        currentCitySysname = currentCityInfo[\"sysname\"]\r\n\r\n        return null\r\n    }    \r\n\r\n\r\n    function _onClickGPS(state) {\r\n        if (map) {\r\n            if (state){\r\n                setView_nTimes_gps = 4;\r\n                map.locate({maxZoom: 20, enableHighAccuracy: true, watch:true, maximumAge: 20000});\r\n            } else {\r\n                map.stopLocate();\r\n                map.removeLayer(circle_geolocation);\r\n                setView_nTimes_gps = 4;\r\n            }\r\n\r\n        }\r\n        onClickGPS(state)\r\n    }\r\n\r\n\r\n    function markerOnClick(e)\r\n    {\r\n        let marker = e.target;\r\n        let geojson = marker.toGeoJSON();\r\n        onMarkerClick(geojson)\r\n        //console.log(geojson)\r\n        \r\n        \r\n    }\r\n\r\n    function pointToLayer(feature, latlng) {\r\n        //return L.circleMarker(latlng, geojsonMarkerOptions).bindPopup(\"MESSAGE\")\r\n        if (!checkButtonHeatmap) {\r\n            return L.circleMarker(latlng, geojsonMarkerOptions).on('click', markerOnClick)        \r\n        }\r\n        \r\n    }\r\n\r\n\r\n    function onEachFeaturePoint(feature, layer) {\r\n        //console.log('feature: ', feature);\r\n        //console.log('layer: ', layer);\r\n        layer.on({\r\n          'click': function (e) {\r\n             console.log('e: ', e);\r\n             console.log('click');\r\n           }\r\n        })\r\n    }    \r\n\r\n\r\n\r\n\r\n\r\n    function NewMarker({newMarkerState}) {          \r\n        const visible = newMarkerState.visible\r\n\r\n        const map = useMap()\r\n\r\n        const eventHandlers = useMemo(\r\n            () => ({\r\n                dragend() {\r\n                    const marker = newMarkerRef.current\r\n                    if (!isMobileDevice && marker != null) {\r\n                        //onDragEndNewMarker(marker.getLatLng())                        \r\n                        const LatLng = marker.getLatLng()\r\n                        let coord = { lat: 0, lng: 0 };\r\n                        coord.lat = LatLng.lat.toFixed(5);\r\n                        coord.lng = LatLng.lng.toFixed(5);\r\n                \r\n                        setNewMarkerState({ visible: true, position: coord });                        \r\n                    }\r\n                },\r\n            }),\r\n            [],\r\n        )\r\n\r\n\r\n\r\n\r\n\r\n        return (<>\r\n                    {visible && <> \r\n                        {(!isMobileDevice) \r\n                        ?\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={true}\r\n                                position={newMarkerState.position}\r\n                                ref={newMarkerRef}\r\n                                eventHandlers={eventHandlers}                    \r\n                            />                    \r\n                        :\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={false}\r\n                                //position={map.getCenter()}\r\n                                position={newMarkerState.position.lat==0 ? map.getCenter() : newMarkerState.position }\r\n                                ref={newMarkerRef}                 \r\n                            />\r\n                        } \r\n                </>}\r\n                                         \r\n        </>)\r\n    }\r\n    \r\n\r\n\r\n    function MapEvents() {        \r\n        const map = useMapEvents({\r\n            //baselayerchange(e) {\r\n            //    document.cookie = 'mapname='+e.name\r\n            //    //setMapname(e.name)\r\n            //    mapname = e.name\r\n            //}, \r\n            baselayerchange: onBaselayerchange,\r\n\r\n            move(e) {               \r\n                \r\n                if (showOkCancelMobileMarker) {\r\n\r\n                    const marker = newMarkerRef.current\r\n                    marker.setLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n                                    \r\n                    //let coord = { lat: 0, lng: 0 }\r\n                    //coord.lat = e.target.getCenter().lat.toFixed(5)\r\n                    //coord.lng = e.target.getCenter().lng.toFixed(5)\r\n                }    \r\n            },\r\n\r\n            moveend(e) {\r\n                if (showOkCancelMobileMarker) {\r\n                    \r\n                    const marker = newMarkerRef.current\r\n                    const LatLng = marker.getLatLng()\r\n                    let coord = { lat: 0, lng: 0 };\r\n                    coord.lat = LatLng.lat.toFixed(5);\r\n                    coord.lng = LatLng.lng.toFixed(5);                   \r\n                    setNewMarkerState({visible: true, position: coord})                        \r\n                }\r\n                //setMapCurrentLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n\r\n\r\n            },\r\n            \r\n            click(e) {\r\n                onClickMap(e)\r\n            }, \r\n\r\n            zoomend(e){                \r\n                setCurrentZoom(e.target._zoom)\r\n            },\r\n\r\n            locationfound(e){\r\n                let radius = e.accuracy / 2;\r\n\r\n                if (setView_nTimes_gps > 0) {\r\n                    map.setView(e.latlng, 20);\r\n                    setView_nTimes_gps = setView_nTimes_gps - 1;\r\n                }\r\n    \r\n                if (map.hasLayer(circle_geolocation)) {\r\n                    circle_geolocation.setLatLng(e.latlng);\r\n                    circle_geolocation.setRadius(radius);\r\n                } else {\r\n                    circle_geolocation = L.circle(e.latlng, radius).addTo(map);\r\n                }                \r\n            },\r\n\r\n            locationerror(e){\r\n                setCheckButtonGPS(false)\r\n                alert(e.message)\r\n            }\r\n        })\r\n      \r\n        return null\r\n      }\r\n\r\n\r\n\r\n\r\n\r\n      function HeatmapFunction(){\r\n        const map = useMap()\r\n        //useEffect(() => {\r\n          //const points = addressPoints\r\n          //? addressPoints.map((p) => {\r\n          //  return [p[0], p[1], p[2]]; // lat lng intensity\r\n          //  })\r\n          //: [];\r\n     \r\n            const points = [\r\n                [43.207650, 27.958490, 1.0]\r\n            ]\r\n\r\n\r\n\r\n            if (heatMapLayer) { \r\n                map.removeLayer(heatMapLayer)\r\n            }\r\n\r\n            if (checkButtonHeatmap) {                \r\n                if (dataHeatmapPoints) {\r\n                    heatMapLayer = L.heatLayer(dataHeatmapPoints, {\r\n                        gradient: {0.4: '#1E90FF', 0.8: 'white', 1: 'red'},                        \r\n                        //minOpacity: 0.1,\r\n                        max: 1.5,\r\n                        radius: 14,\r\n                        blur: 10,\r\n                        maxZoom: 6\r\n\r\n                    })//.addTo(map);\r\n                    map.addLayer(heatMapLayer)                \r\n                }\r\n            }\r\n\r\n\r\n            //heatMap.addLatLng([43.207650, 27.998590])\r\n            //heatMap.setLatLngs([])\r\n\r\n            //L.heatLayer(points).redraw()\r\n            //L.heatLayer(points).addLatLng([43.207650, 27.998590])\r\n\r\n        //}, [dataHeatmapPoints]);\r\n\r\n        return null\r\n     }\r\n\r\n\r\n\r\n\r\n\r\n    const createClusterCustomIcon  = function (cluster) {\r\n        // get the number of items in the cluster\r\n        let count = cluster.getChildCount();\r\n\r\n        // figure out how many digits long the number is\r\n        //var digits = (count + '').length;\r\n        let digits;\r\n        if (count == 2) { digits = '1'; }\r\n        if (count >= 3 && count <=5) { digits = '2'; }\r\n        if (count >= 6 && count <=9) { digits = '3'; }\r\n        if (count >= 10 && count <=14) { digits = '4'; }\r\n        if (count > 14) { digits = '5'; }\r\n\r\n        return L.divIcon({\r\n          html: count,\r\n          className: 'cluster digits-' + digits,\r\n          iconSize: null\r\n        });\r\n      }\r\n\r\n\r\n\r\n\r\n    return (\r\n        <>        \r\n        {/* The map rendered before useEffect called, so first we need to load currentCityInfo before to show the map */}\r\n        { currentCityInfo[\"longitude\"] !== \"0\" && currentCityInfo[\"latitude\"]!==\"0\" ? ( \r\n\r\n            <MapContainer style={{cursor: \"crosshair\"}} whenCreated={setMap} center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} zoom={13} zoomControl={false} scrollWheelZoom={true} style={{ height: 'calc(100vh - 60px)', width: '100%' }} >                \r\n                <LayersControl position=\"topleft\">                    \r\n                    <MapTileLayers mapBaseLayerName={mapBaseLayerName} />                 \r\n                </LayersControl>    \r\n\r\n            \r\n                {/* To change center of the map when current city will change */}\r\n                {/*<SetViewMap center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} />*/} \r\n                <SetPanToMap />\r\n\r\n\r\n                {currentZoom < 15 ? (\r\n                    <GeoJSON key={Date.now()} data={dataAccidents} pointToLayer={pointToLayer} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>  \r\n                ) : (\r\n                    <MarkerClusterGroup\r\n                    spiderfyOnMaxZoom={true}\r\n                    showCoverageOnHover={false}\r\n                    zoomToBoundsOnClick={true}\r\n                    maxClusterRadius={15}\r\n                    iconCreateFunction={createClusterCustomIcon}>                \r\n                        <GeoJSON key={Date.now()} data={dataAccidents} pointToLayer={pointToLayer} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>                \r\n                    </MarkerClusterGroup>\r\n                )}\r\n\r\n\r\n                <NewMarker newMarkerState={newMarkerState} onDragEndNewMarker={onDragEndNewMarker}/>\r\n                \r\n                <MapEvents />\r\n                \r\n                {!isMobileDevice && <ZoomControl position='bottomright'/>}\r\n                \r\n   \r\n                {/* <ButtonsControl /> */}\r\n\r\n                <HeatmapFunction />\r\n                \r\n\r\n                \r\n            </MapContainer>\r\n        ) : (\r\n            <p>Loading...</p>\r\n        )}    \r\n            \r\n        </>\r\n        \r\n    )\r\n}\r\n\r\nexport default Map\r\n\r\n\r\n//https://egghead.io/lessons/react-create-a-new-map-using-react-leaflet\r\n\r\n//https://codesandbox.io/s/63wqz?file=/src/LeafletControlGeocoder.jsx\r\n//https://www.npmjs.com/package/leaflet-control-geocoder\r\n\r\n//https://codesandbox.io/s/how-to-add-a-legend-to-the-map-using-react-leaflet-useleaflet-hook-75jnp?file=/src/index.js\r\n\r\n//https://newbedev.com/home-button-leaflet-map\r\n\r\n//  React-Leaflet\r\n//https://stackoverflow.com/questions/69697017/use-leaflet-map-object-outside-useeffect-in-react","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACJ0lEQVR4Ae3ShY6bQRADYIeZ3v+9yszMDZPlkSWtslPuiS6+C+8n/zNp4p/froi8Jq/Jxk+TkwmHX//Wz8lG3jNjTeaguabD6HAVbphMwIIzqtd+rzKYhsgUNNcqo3fEBlyyOWmwhbbS4b8SaLBu7SGlpL9gklw3YpYR6J5Bm0zAguspZjvqSVQxqvxsPSJJKYIFKh5A2VIDyMgYfYB9hvcmI0VPTxVZS81ER7qiBoFqBAa9MKOKLzzv2BE3EOnlmDTrNRXryToGOGR65nhvSphjMP6b6WJ6xMYYxSW7l1Pp6CSzbLFPgAN3NGLKPRn3c59qxzapCTPUFNVKh0vUe24azMkW+uRm/B8UU3O3Eiw4nOrrafOSF5gS7PqHUotBQQ6f11p22HDOi+66i2LIHcWJOZrTP+rkhOl7n8YcTzCQIuIvyZPQrvs5Br0OdTsyB+YYrwKokXvsgOIXZzbeQ0DMnhHIqGOdBMEl9qKYAo3pBbbDNkijUSgjv/PrMFhwRwS2YbbMzqg+SzdukoxbeiSEVlgyK6yFmjSYtDxhTXRv1OsgsCb2jflu8hLMyC0P7Qg54NE1qc/MF5PqeAHWSfDL3zxN9dsQ+YD3zEeRS4GeYgFm5I7HNiJPfP4V7/CKeUvwsxpqhkwFzMgjj33Vwe+EnuIxngn8FvNTSCkwmJG+rQm8J/MId/EQL3nZwe2EmSNm9ufkFq9xHzcJPscnLGMRomBKqdzOY2EH+IPOLMEAAAAASUVORK5CYII=\"","import { useState, useEffect } from 'react'\r\nimport { Form, Button, FloatingLabel, Modal } from \"react-bootstrap\";\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nconst LoginModalForm = ({ show, onHide, setLoginModalShow, setRegisterModalShow, setAuthToken }) => {\r\n\r\n    const [showWrongPassword, setShowWrongPassword] = useState(false)\r\n\tconst { t } = useTranslation()\r\n\r\n    useEffect(() => {\r\n        reset()\r\n        setShowWrongPassword(false)\r\n    }, [show])\r\n\r\n\r\n    const { control, handleSubmit, reset, formState: { errors }  } = useForm({\r\n        //reValidateMode: 'onChange',\r\n        defaultValues: {\r\n            username: '',\r\n            password: '',\r\n\t\t\trememberme: false\r\n        }\r\n    }); \r\n\r\n\r\n\r\n\r\n    async function loginUser(credentials) {\r\n\t\t//console.log(credentials)\r\n        return fetch(`${process.env.REACT_APP_API_URL}token/`, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\t\t})\r\n\t\t\t.then((data) => {\r\n                if (data.status === 200) {\r\n                    data.json().then((data) => {\r\n\t\t\t\t\t\t//data.rememberme = credentials.rememberme\r\n\t\t\t\t\t\tsetAuthToken(data)\r\n                        //console.log(data);\r\n                        setShowWrongPassword(false)\r\n                        setLoginModalShow(false)\r\n\t\t\t\t\t});\r\n                } else if (data.status === 401) {\r\n                    setShowWrongPassword(true)\r\n                }\r\n\t\t\t\t\r\n\t\t\t});\r\n    }\r\n\r\n\r\n\r\n\r\n    const OnSubmitForm = (data) => {\r\n        setShowWrongPassword(false)\r\n        localStorage.setItem('rememberme', data.rememberme);\r\n\t\tloginUser(data)        \r\n    }    \r\n\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\tshow={show}\r\n\t\t\tonHide={onHide}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t('loginForm.title')}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formLogin\">\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingInput\"\r\n\t\t\t\t\t\t\tlabel={t('loginForm.username')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('loginForm.username')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t('loginForm.password')}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('loginForm.password')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formBasicCheckbox\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"rememberme\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Check type=\"checkbox\" label={t('loginForm.rememberMe')} {...field}/>\r\n\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\t\t\t\t\t\t\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t{showWrongPassword && (\r\n\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t{t('loginForm.wrongUsernamePassword')}\r\n\t\t\t\t\t\t</Form.Text>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t('loginForm.login')}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{t('loginForm.dontHaveAccount')} <a href=\"#\" onClick={()=> { setLoginModalShow(false); setRegisterModalShow(true) } }>{t('loginForm.signUp')}</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default LoginModalForm;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Form, Button, FloatingLabel, Modal, Col, Row } from \"react-bootstrap\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nconst RegisterModalForm = ({\r\n\tshow,\r\n\tonHide,\r\n\tsetRegisterModalShow,\r\n\tsetLoginModalShow,\r\n\tsetAuthToken,\r\n}) => {\r\n\t\r\n\tconst { t } = useTranslation()\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\t\r\n\t}, [show]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n        setError,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\temail: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tpassword2: \"\",\r\n\t\t\tfirst_name: \"\",\r\n\t\t\tlast_name: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\tconst OnSubmitForm = (data) => {\r\n\t\tregisterUser(data);\r\n\t};\r\n\r\n\tasync function registerUser(credentials) {\r\n\r\n\t\treturn fetch(\"http://localhost:8000/api/users/\", {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\r\n\t\t}).then((data) => {            \r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\t\r\n                    console.log('ok', data)\t\t\t\t\r\n                    setRegisterModalShow(false);\r\n                    setAuthToken(data.token) // after register make login\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t} else if (data.status >= 400) {\r\n\t\t\t\tdata.json().then((data) => {\r\n\t\t\t\t\tconsole.log(data)\r\n                \r\n                    for (const [key, value] of Object.entries(data)) {                \r\n                        setError(key, {\r\n                            type: \"manual\",\r\n                            message: value,\r\n                        }); \r\n                    }                   \r\n\t\t\t\t});                \r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\tshow={show}\r\n\t\t\tonHide={onHide}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t('registerForm.title')}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formRegister\">\r\n\t\t\t\t\t\t\r\n                \r\n                        {errors?.username?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{errors.username.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                        \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingUsername\"\r\n\t\t\t\t\t\t\tlabel={t('registerForm.username')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.username')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n                        \r\n                        {errors?.email?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{errors.email.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                          \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingEmail\"\r\n\t\t\t\t\t\t\tlabel={t('registerForm.email')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"email\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.email')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.email}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\r\n                        {errors?.password?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{errors.password.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}  \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t('registerForm.password')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.password')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword2\"\r\n\t\t\t\t\t\t\tlabel={t('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password2\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password2}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"first_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.firstNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.first_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"last_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.lastNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.last_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t('registerForm.register')}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{t('registerForm.alreadyHaveAccount')}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetRegisterModalShow(false);\r\n\t\t\t\t\t\t\t\t\tsetLoginModalShow(true);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t('registerForm.login')}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RegisterModalForm;\r\n","import \"./App.css\";\nimport { useParams } from \"react-router-dom\";\nimport { useState, useEffect, useRef } from \"react\";\n\nimport MenuGlobal from \"./components_hl/MenuGlobal\";\nimport Sidebar from \"./components/Sidebar\";\nimport Map from \"./components/Map\";\nimport LoginModalForm from \"./components/LoginModalForm\";\nimport RegisterModalForm from \"./components/RegisterModalForm\";\nimport Button from \"react-bootstrap/Button\";\n\nimport useAuthToken from \"./useAuthToken\";\nimport { useTranslation } from 'react-i18next'\n\n\n\nfunction App(props) {\n\n\tconst { authToken, setAuthToken } = useAuthToken();\n\n\tconst [screenWidth, setScreenWidth] = useState(window.innerWidth);\n\tconst [isMobileDevice, setIsMobileDevice] = useState(false)\n\tconst isMobileView = screenWidth <= 768;\n\t\n\n\tconst paramsRouter = useParams();\n\tconst csrftoken = getCookie(\"csrftoken\");\n\n\tconst [loginModalShow, setLoginModalShow] = useState(false);\n    const [registerModalShow, setRegisterModalShow] = useState(false);\n\n\tconst [mapBaseLayerName, setMapBaseLayerName] = useState(\"Default\");\n\t//const [mapCurrentLatLng, setMapCurrentLatLng] = useState({lat: 0, lng: 0})\n\t\n\n\tconst [dictManeuvers, setDictManeuvers] = useState({});\n\tconst [dictTypeViolations, setTypeViolations] = useState({});\n\tconst [dictViolators, setDictViolators] = useState({});\n\n\tconst [dataAccidents, setDataAccidents] = useState([]);\n\tconst [dataFilters, setDataFilters] = useState({});\n\tconst [minMaxDateData, setMinMaxDateData] = useState({\n\t\tminDate: \"\",\n\t\tmaxDate: \"\",\n\t});\n\tconst [dataAccidentForm, setDataAccidentForm] = useState({});\n\n\tconst [newMarkerState, setNewMarkerState] = useState({\n\t\tvisible: false,\n\t\tposition: {},\n\t\tisMobile: false\n\t});\n\n\tconst [showSidebar, setShowSidebar] = useState(!isMobileView);\n\tconst [showAccidentTab, setShowAccidentTab] = useState(false);\n\tconst [activeTabKey, setActiveTabKey] = useState(\"filter\");\n\n\tconst [checkButtonNewMarker, setCheckButtonNewMarker] = useState(false);\n\tconst [checkButtonHeatmap, setCheckButtonHeatmap] = useState(false);\n\tconst [checkButtonGPS, setCheckButtonGPS] = useState(false);\n\n\tconst [showOkCancelMobileMarker, setShowOkCancelMobileMarker] = useState(false)\n\n\t//const accidentId = parseInt(paramsRouter.accidentId, 10);\n\n\tconst { t } = useTranslation()\n\n\tlet dataHeatmapPoints = [];\n\n\n\n\tuseEffect(() => {\n\t\t//setUserAuthToken(getAuthToken())\n\n\t\tconst fetchManeuvers = async () => {\n\t\t\t//const url = `http://127.0.0.1:8000/api/dictionary/roadaccident/maneuvers`;\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}dictionary/roadaccident/maneuvers`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tsetDictManeuvers(data);\n\t\t};\n\n\t\tconst fetchTypeViolations = async () => {\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}dictionary/roadaccident/typeviolations`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tsetTypeViolations(data);\n\t\t};\n\n\t\tconst fetchViolators = async () => {\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}dictionary/roadaccident/violators`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tsetDictViolators(data);\n\t\t};\n\n\t\tfetchManeuvers();\n\t\tfetchTypeViolations();\n\t\tfetchViolators();\n\n\t\tlet mapname_ = document.cookie\n\t\t\t.split(\"; \")\n\t\t\t.find((row) => row.startsWith(\"mapname=\"));\n\n\t\tif (mapname_) {\n\t\t\tsetMapBaseLayerName(mapname_.split(\"=\")[1]);\n\t\t}\n\n\t\tif (authToken) {\n            checkAuthToken()\n        }\n\n        \n\t\tsetIsMobileDevice( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) )\t\t\n\t\t//setIsMobileDevice( true )\t\t\n\t\t\n\t\twindow.addEventListener('resize', handleWindowSizeChange);\n        return () => {\n            window.removeEventListener('resize', handleWindowSizeChange);\t\t\t\n        }\t\t\n\t\t\n\t}, []); /* useEffect triggers when route has been changed too */\n\n\n\tuseEffect(() => {\n\t\tfetchAccidents();\n\t}, [paramsRouter]); /* useEffect triggers when route has been changed too */\n\n    useEffect(() => {\n        let periodUpdate = 240000 //4 min\n        let interval = setInterval(() => {\n            if (authToken) {\n                refreshAuthToken(authToken.refresh)    \n            }\n        }, periodUpdate)\n\n        return ()=> clearInterval(interval)\n    }, [authToken])\n\n\n\n    function handleWindowSizeChange() {\n        setScreenWidth(window.innerWidth);\n    }\n\n\n\tconst fetchAccidents = async () => {\n\t\tconst url = `${process.env.REACT_APP_API_URL}roadaccident/${paramsRouter.cityName}/accidents/`;\n\t\tconst res = await fetch(url);\n\t\tconst data = await res.json();\n\n\t\t// find min and max dates\n\t\tlet datefilter_Min = \"2100-01-01\";\n\t\tlet datefilter_Max = \"1970-01-01\";\n\t\tfor (let item of data.features) {\n\t\t\tconsole.log(item);\n\t\t\tif (item.properties.datetime > datefilter_Max) {\n\t\t\t\tdatefilter_Max = item.properties.datetime;\n\t\t\t}\n\t\t\tif (item.properties.datetime < datefilter_Min) {\n\t\t\t\tdatefilter_Min = item.properties.datetime;\n\t\t\t}\n\t\t}\n\t\tsetMinMaxDateData({\n\t\t\tminDate: datefilter_Min.slice(0, 10),\n\t\t\tmaxDate: datefilter_Max.slice(0, 10),\n\t\t});\n\t\tsetDataAccidents(data);\n\t};\n\n\n\n\n\n\n\n\n\n\tconst onClickMap = (e) => {\n\t\tif (checkButtonNewMarker && !isMobileDevice) {\n\t\t\tsetCheckButtonNewMarker(false)\n\n\t\t\tlet coord = { lat: 0, lng: 0 }\n\t\t\tcoord.lat = e.latlng.lat.toFixed(5)\n\t\t\tcoord.lng = e.latlng.lng.toFixed(5)\n\n\t\t\tsetNewMarkerState({ visible: true, position: coord })\n\n\t\t\tsetShowAccidentTab(true)\n\t\t\tsetActiveTabKey(\"accident\")\n\t\t}\n\t};\n\n\tconst onDragEndNewMarker = (LatLng) => {\n\t\t//let coord = { lat: 0, lng: 0 };\n\t\t//coord.lat = LatLng.lat.toFixed(5);\n\t\t//coord.lng = LatLng.lng.toFixed(5);\n\n\t\t//setNewMarkerState({ visible: true, position: coord });\n\t};\n\n\tconst onMarkerClick = (data) => {\n\t\t//console.log(\"makrer\", data);\n\t\tsetShowAccidentTab(true);\n\t\tsetActiveTabKey(\"accident\");\n\t\tsetDataAccidentForm(data);\n\t\tsetShowSidebar(true)\n\t};\n\n\tconst onClickNewMarker = (state) => {\n\t\tsetCheckButtonNewMarker(state);\n\n\t\tif (isMobileDevice && state) {\t\t\t\n\t\t\tsetNewMarkerState({ visible: true, position: {lat: 0, lng: 0} })\n\t\t\tsetShowOkCancelMobileMarker(true)\t\t\t\n\t\t}\n\t};\n\n\tconst onClickHeatmap = (state) => {\n\t\tconsole.log(\"onClickHeatmap\", state);\n\n\t\tif (state) {\n\t\t\tsetMapBaseLayerName(\"Dark\");\n\t\t} else {\n\t\t\tsetMapBaseLayerName(\"Default\");\n\t\t}\n\t\tsetCheckButtonHeatmap(state);\n\t};\n\n\tconst onClickGPS = (state) => {\n\t\t//console.log(\"onClickGPS\", state);\n\t\tsetCheckButtonGPS(state);\n\t};\n\n\tconst onSubmitFilter = (filter) => {\n\t\tdataHeatmapPoints = [];\n\t\tsetDataFilters(filter);\n\n\t\tif (isMobileView) {\n\t\t\tsetShowSidebar(false)\n\t\t}\n\t};\n\n\tconst onSubmitAccident = (data) => {\n\t\tconsole.log(\"onSubmitAccident\", data);\n\t\tlet method;\n\t\tlet url;\n\t\tif (data.id) {\n\t\t\turl = `${process.env.REACT_APP_API_URL}roadaccident/${paramsRouter.cityName}/accidents/${data.id}/`;\n\t\t\tmethod = \"PUT\";\n\t\t} else {\n\t\t\turl = `${process.env.REACT_APP_API_URL}roadaccident/${paramsRouter.cityName}/accidents/`;\n\t\t\tmethod = \"POST\";\n\t\t}\n\n\t\tfetchUrl(url, method, data);\n\t\t\n\t\tif (isMobileView) {\n\t\t\tsetShowSidebar(false)\n\t\t}\n\t};\n\n\tconst onDeleteAccident = (id) => {\n\t\tfetchUrl(\n\t\t\t`${process.env.REACT_APP_API_URL}roadaccident/${paramsRouter.cityName}/accidents/${id}/`,\n\t\t\t\"DELETE\"\n\t\t);\n\t};\n\n\tconst onCloseAccident = () => {\n\t\tsetNewMarkerState({ visible: false, position: {} });\n\t\tsetActiveTabKey(\"filter\");\n\t\tsetShowAccidentTab(false);\n\t};\n\n\tconst onBaselayerchange = (e) => {\n\t\t//console.log('onBaselayerchange', e.name)\n\t\tdocument.cookie = \"mapname=\" + e.name;\n\n\t\t//setMapBaseLayerName(e.name)\n\n\t\t//setMapname(e.name)\n\t\t//mapname = e.name\n\t};\n\n\tconst filterMapCallback = (feature, layer) => {\n\t\tlet dateFrom_Filter = true;\n\t\tlet dateTo_Filter = true;\n\n\t\tlet maneuver_Filter = true;\n\t\tlet description_Filter = true;\n\t\tlet violations_type_Filter = true;\n\t\tlet violators_Filter = true;\n\n\t\tlet drivers_injured_Filter = true;\n\t\tlet motorcyclists_injured_Filter = true;\n\t\tlet cyclists_injured_Filter = true;\n\t\tlet ped_injured_Filter = true;\n\t\tlet kids_injured_Filter = true;\n\t\tlet pubtr_passengers_injured_Filter = true;\n\n\t\tlet drivers_killed_Filter = true;\n\t\tlet motorcyclists_killed_Filter = true;\n\t\tlet cyclists_killed_Filter = true;\n\t\tlet ped_killed_Filter = true;\n\t\tlet kids_killed_Filter = true;\n\t\tlet pubtr_passengers_killed_Filter = true;\n\n\t\tlet public_transport_involved_Filter = true;\n\t\tlet showOnlyMyAccidents_Filter = true;\n\n\t\tlet valueFilter;\n\n\t\tvalueFilter = dataFilters?.dateFromFilter;\n\t\tif (valueFilter) {\n\t\t\tdateFrom_Filter =\n\t\t\t\tfeature.properties.datetime.split(\"T\")[0] >= valueFilter;\n\t\t}\n\t\tvalueFilter = dataFilters?.dateToFilter;\n\t\tif (valueFilter) {\n\t\t\tdateTo_Filter =\n\t\t\t\tfeature.properties.datetime.split(\"T\")[0] <= valueFilter;\n\t\t}\n\n\t\tvalueFilter = dataFilters?.maneuverFilter?.value;\n\t\tif (valueFilter) {\n\t\t\tmaneuver_Filter = valueFilter === feature.properties.maneuver;\n\t\t}\n\n\t\tvalueFilter = dataFilters?.descFilter;\n\t\tif (valueFilter) {\n\t\t\tif (\n\t\t\t\tfeature.properties.description\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.indexOf(valueFilter.toLowerCase()) === -1\n\t\t\t) {\n\t\t\t\tdescription_Filter = false;\n\t\t\t}\n\t\t}\n\n\t\tvalueFilter = dataFilters?.violationsTypeFilter;\n\t\tif (Array.isArray(valueFilter)) {\n\t\t\tlet intersection = valueFilter.filter((x) =>\n\t\t\t\tfeature.properties.violations_type.includes(String(x.value))\n\t\t\t);\n\t\t\tviolations_type_Filter = intersection.length > 0;\n\t\t}\n\n\t\tvalueFilter = dataFilters?.violatorsFilter;\n\t\tif (Array.isArray(valueFilter)) {\n\t\t\tlet intersection = valueFilter.filter((x) =>\n\t\t\t\tfeature.properties.violators.includes(String(x.value))\n\t\t\t);\n\t\t\tviolators_Filter = intersection.length > 0;\n\t\t}\n\n\t\tvalueFilter = dataFilters?.driverInjuredFilter;\n\t\tif (valueFilter) {\n\t\t\tdrivers_injured_Filter = feature.properties.drivers_injured > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.motorcyclistInjuredFilter;\n\t\tif (valueFilter) {\n\t\t\tmotorcyclists_injured_Filter =\n\t\t\t\tfeature.properties.motorcyclists_injured > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.cyclistInjuredFilter;\n\t\tif (valueFilter) {\n\t\t\tcyclists_injured_Filter = feature.properties.cyclists_injured > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.pedestrianInjuredFilter;\n\t\tif (valueFilter) {\n\t\t\tped_injured_Filter = feature.properties.ped_injured > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.kidsInjuredFilter;\n\t\tif (valueFilter) {\n\t\t\tkids_injured_Filter = feature.properties.kids_injured > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.pubtrPassengersInjuredFilter;\n\t\tif (valueFilter) {\n\t\t\tpubtr_passengers_injured_Filter =\n\t\t\t\tfeature.properties.pubtr_passengers_injured > 0;\n\t\t}\n\n\t\tvalueFilter = dataFilters?.driversKilledFilter;\n\t\tif (valueFilter) {\n\t\t\tdrivers_killed_Filter = feature.properties.drivers_killed > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.motorcyclistsKilledFilter;\n\t\tif (valueFilter) {\n\t\t\tmotorcyclists_killed_Filter =\n\t\t\t\tfeature.properties.motorcyclists_killed > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.cyclistsKilledFilter;\n\t\tif (valueFilter) {\n\t\t\tcyclists_killed_Filter = feature.properties.cyclists_killed > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.pedestrianKilledFilter;\n\t\tif (valueFilter) {\n\t\t\tped_killed_Filter = feature.properties.ped_killed > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.kidsKilledFilter;\n\t\tif (valueFilter) {\n\t\t\tkids_killed_Filter = feature.properties.kids_killed > 0;\n\t\t}\n\t\tvalueFilter = dataFilters?.pubtrPassengersKilledFilter;\n\t\tif (valueFilter) {\n\t\t\tpubtr_passengers_killed_Filter =\n\t\t\t\tfeature.properties.pubtr_passengers_killed > 0;\n\t\t}\n\n\t\tvalueFilter = dataFilters?.publicTransportInvolvedFilter;\n\t\tif (valueFilter) {\n\t\t\tpublic_transport_involved_Filter =\n\t\t\t\tfeature.properties.public_transport_involved > 0;\n\t\t}\n\t\t//valueFilter = dataFilters?.showOnlyMyAccidentsFilter\n\n\t\tlet returnValue =\n\t\t\tdateFrom_Filter &&\n\t\t\tdateTo_Filter &&\n\t\t\tmaneuver_Filter &&\n\t\t\tdescription_Filter &&\n\t\t\tviolations_type_Filter &&\n\t\t\tviolators_Filter &&\n\t\t\tdrivers_injured_Filter &&\n\t\t\tmotorcyclists_injured_Filter &&\n\t\t\tcyclists_injured_Filter &&\n\t\t\tped_injured_Filter &&\n\t\t\tkids_injured_Filter &&\n\t\t\tpubtr_passengers_injured_Filter &&\n\t\t\tdrivers_killed_Filter &&\n\t\t\tmotorcyclists_killed_Filter &&\n\t\t\tcyclists_killed_Filter &&\n\t\t\tped_killed_Filter &&\n\t\t\tkids_killed_Filter &&\n\t\t\tpubtr_passengers_killed_Filter &&\n\t\t\tpublic_transport_involved_Filter &&\n\t\t\tshowOnlyMyAccidents_Filter;\n\n\t\tif (returnValue) {\n\t\t\tdataHeatmapPoints.push([\n\t\t\t\tfeature.properties.latitude,\n\t\t\t\tfeature.properties.longitude,\n\t\t\t\t0.1,\n\t\t\t]);\n\t\t}\n\n\t\treturn returnValue;\n\t};\n\n\tfunction fetchUrl(url, method, bodyObject) {\n\t\tlet myHeaders = new Headers();\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");\n\t\tmyHeaders.append(\"X-CSRFToken\", csrftoken);\n\t\tif (authToken?.access) {\n\t\t\tmyHeaders.append(\"Authorization\", \"Bearer \" + authToken.access);\n\t\t}\n\n\t\tfetch(url, {\n\t\t\tmethod: method,\n\t\t\theaders: myHeaders,\n\t\t\tbody: JSON.stringify(bodyObject),\n\t\t}).then(function (response) {\n\t\t\tif (response.status >= 400) {\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\talert(\n\t\t\t\t\t\tresponse.statusText +\n\t\t\t\t\t\t\t\" (\" +\n\t\t\t\t\t\t\tresponse.status +\n\t\t\t\t\t\t\t\")\\n\\n\" +\n\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//closeTabAccident();\n\t\t\t\t//if (IS_MOBILE) {\n\t\t\t\t//    CloseSidebar()\n\t\t\t\t//}\n\n\t\t\t\t// select the new/edited accident marker\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\tfetchAccidents();\n\t\t\t\t\tsetNewMarkerState({ visible: false, position: {} });\n\t\t\t\t\tsetActiveTabKey(\"filter\");\n\t\t\t\t\tsetShowAccidentTab(false);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\n\n\n\n\n\n\treturn (\n\t\t<div className=\"main-wrapper\">\n\t\t\t<div id=\"app\">\n\n\t\t\t\t<div\n\t\t\t\t\tclassName={`d-flex ${showSidebar ? \"showed\" : \"hided\"}`}\n\t\t\t\t\tid=\"wrapper\"\n\t\t\t\t>\n\t\t\t\t\t{/* <DictionariesContext.Provider value={{dictManeuvers, dictTypeViolations, dictViolators}}> */}\n\t\t\t\t\t<Sidebar\n\t\t\t\t\t\tonSubmitFilter={onSubmitFilter}\n\t\t\t\t\t\tonSubmitAccident={onSubmitAccident}\n\t\t\t\t\t\tonDeleteAccident={onDeleteAccident}\n\t\t\t\t\t\tonCloseAccident={onCloseAccident}\n\t\t\t\t\t\tminMaxDateData={minMaxDateData}\n\t\t\t\t\t\tdataAccidentForm={dataAccidentForm}\n\t\t\t\t\t\tshowAccidentTab={showAccidentTab}\n\t\t\t\t\t\tactiveTabKey={activeTabKey}\n\t\t\t\t\t\tsetActiveTabKey={setActiveTabKey}\n\t\t\t\t\t\tnewMarkerState={newMarkerState}\n\t\t\t\t\t\tdictManeuvers={dictManeuvers}\n\t\t\t\t\t\tdictTypeViolations={dictTypeViolations}\n\t\t\t\t\t\tdictViolators={dictViolators}\n\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t/>\n\t\t\t\t\t{/*</DictionariesContext.Provider> */}\n\n\t\t\t\t\t<div id=\"page-content-wrapper\">\n\t\t\t\t\t\t<MenuGlobal\n\t\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\tonClickShowMenu={() => setShowSidebar(!showSidebar)}\n\t\t\t\t\t\t\tauthToken={authToken}\n\t\t\t\t\t\t\tsetLoginModalShow={setLoginModalShow}\n\t\t\t\t\t\t\tsetAuthToken={setAuthToken}\n\t\t\t\t\t\t\tappname=\"roadaccident\"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"container-fluid\"\n\t\t\t\t\t\t\tstyle={{ paddingRight: \"0px\", paddingLeft: \"0px\" }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Map\n\t\t\t\t\t\t\t\tmapBaseLayerName={mapBaseLayerName}\n\t\t\t\t\t\t\t\tdataAccidents={dataAccidents}\n\t\t\t\t\t\t\t\tdataHeatmapPoints={dataHeatmapPoints}\n\t\t\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\tcheckButtonNewMarker={checkButtonNewMarker}\n\t\t\t\t\t\t\t\tcheckButtonHeatmap={checkButtonHeatmap}\n\t\t\t\t\t\t\t\tcheckButtonGPS={checkButtonGPS}\n\t\t\t\t\t\t\t\tonClickNewMarker={onClickNewMarker}\n\t\t\t\t\t\t\t\tonClickHeatmap={onClickHeatmap}\n\t\t\t\t\t\t\t\tonClickGPS={onClickGPS}\n\t\t\t\t\t\t\t\tonClickMap={onClickMap}\n\t\t\t\t\t\t\t\tonMarkerClick={onMarkerClick}\n\t\t\t\t\t\t\t\tnewMarkerState={newMarkerState}\n\t\t\t\t\t\t\t\tonDragEndNewMarker={onDragEndNewMarker}\n\t\t\t\t\t\t\t\tfilterMapCallback={filterMapCallback}\n\t\t\t\t\t\t\t\tonBaselayerchange={onBaselayerchange}\n\t\t\t\t\t\t\t\tsetNewMarkerState={setNewMarkerState}\n\t\t\t\t\t\t\t\tisMobileDevice={isMobileDevice}\n\t\t\t\t\t\t\t\tshowOkCancelMobileMarker={showOkCancelMobileMarker}\n\t\t\t\t\t\t\t\t//setMapCurrentLatLng={setMapCurrentLatLng}\n\t\t\t\t\t\t\t\tsetCheckButtonGPS={setCheckButtonGPS}\n\t\t\t\t\t\t\t\tshowSidebar={showSidebar}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t{showOkCancelMobileMarker && <> \n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tvariant=\"success\"\n\t\t\t\t\t\t\t\t\tid=\"doneEditMarkerMobile\"\n\t\t\t\t\t\t\t\t\tonClick={()=>{\n\t\t\t\t\t\t\t\t\t\tsetCheckButtonNewMarker(false);\n\t\t\t\t\t\t\t\t\t\tsetShowOkCancelMobileMarker(false)\n\t\t\t\t\t\t\t\t\t\tsetShowAccidentTab(true)\n\t\t\t\t\t\t\t\t\t\tsetActiveTabKey(\"accident\")\n\t\t\t\t\t\t\t\t\t\tsetShowSidebar(true)\n\n\t\t\t\t\t\t\t\t\t\t//setNewMarkerState({visible: true, position: mapCurrentLatLng})\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t('words.done')}\n\t\t\t\t\t\t\t\t</Button>{\" \"}\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\tid=\"cancelMarkerMobile\"\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetNewMarkerState({ visible: false, position: { lat: 0, lng: 0 } })\n\t\t\t\t\t\t\t\t\t\tsetShowOkCancelMobileMarker(false)\n\t\t\t\t\t\t\t\t\t\tsetCheckButtonNewMarker(false)\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}}\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t&#x2715;\n\t\t\t\t\t\t\t\t</Button>{\" \"}\n\t\t\t\t\t\t\t</>}\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<LoginModalForm\n\t\t\t\tsetAuthToken={setAuthToken}\n\t\t\t\tshow={loginModalShow}\n\t\t\t\tsetLoginModalShow={setLoginModalShow}\n                setRegisterModalShow={setRegisterModalShow}\n\t\t\t\tonHide={() => setLoginModalShow(false)}\n\t\t\t/>\n\n\t\t\t<RegisterModalForm\n\t\t\t\tsetAuthToken={setAuthToken}\n\t\t\t\tshow={registerModalShow}\n\t\t\t\tsetRegisterModalShow={setRegisterModalShow}\n                setLoginModalShow={setLoginModalShow}\n\t\t\t\tonHide={() => setRegisterModalShow(false)}\n\t\t\t/>\n\t\t</div>\n\t);\n\n\tfunction getCookie(name) {\n\t\tvar cookieValue = null;\n\t\tif (document.cookie && document.cookie !== \"\") {\n\t\t\tvar cookies = document.cookie.split(\";\");\n\t\t\tfor (var i = 0; i < cookies.length; i++) {\n\t\t\t\tvar cookie = cookies[i].trim();\n\t\t\t\t// Does this cookie string begin with the name we want?\n\t\t\t\tif (cookie.substring(0, name.length + 1) === name + \"=\") {\n\t\t\t\t\tcookieValue = decodeURIComponent(\n\t\t\t\t\t\tcookie.substring(name.length + 1)\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn cookieValue;\n\t}\n\n\n\n\n\n    function refreshAuthToken(refreshToken){\n\t\tlet myHeaders = new Headers();\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");\n\t\tmyHeaders.append(\"X-CSRFToken\", csrftoken);\n\n        fetch(`${process.env.REACT_APP_API_URL}token/refresh/`, {\n            method: \"POST\",\n            headers: myHeaders,\n            body: JSON.stringify({ refresh: refreshToken }),\n\n        }).then(function (response) {\n            if (response.status == 200) {\n                response.json().then((data) => {    \n                    //setAuthToken({access: data.access, refresh: authToken.refresh})\n                    setAuthToken(data)\n                });\n            } else if (response.status >= 400) {\n                setAuthToken(null)    \n            }\n        });\n    }\n\n\n    function checkAuthToken() {\n\t\tlet body = { token: authToken.access }\n\t\tlet url = `${process.env.REACT_APP_API_URL}token/verify/`;\n\t\tlet myHeaders = new Headers();\n\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");\n\t\tmyHeaders.append(\"X-CSRFToken\", csrftoken);\n\n\t\tfetch(url, {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: myHeaders,\n\t\t\tbody: JSON.stringify(body),\n\n\t\t}).then(function (response) {\n\t\t\tif (response.status >= 400) {\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\tconsole.log(\">= 400\", data);\n\n                    refreshAuthToken(authToken.refresh)\n\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\tconsole.log(\"ok\", data);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t}\n\n\n\n\t//function setAuthToken(userToken) {\n\t//    localStorage.setItem('token', JSON.stringify(userToken));\n\t//    setUserAuthToken(JSON.stringify(userToken))\n\t//}\n\n\t//function getAuthToken () {\n\t//    const tokenString = localStorage.getItem('token')\n\t//    return JSON.parse(tokenString)\n\t//}\n}\n\nexport default App;\n\n// Code Splitting in React Using Lazy and Suspense | Code Splitting Made Easy\n// https://www.youtube.com/watch?v=69Oj8JTYXZU\n","import { useState } from 'react';\r\n\r\nexport default function useAuthToken() {\r\n    \r\n    const getUsernameFromToken = (json) =>{\r\n        let token = json?.access \r\n\r\n        if (token) {\r\n            const arToken = token.split('.')\r\n            if (arToken.length > 1) {\r\n                return JSON.parse(atob(arToken[1])).username\r\n            }\r\n        }\r\n    }\r\n    \r\n    const getToken = () => {\r\n        let tokenString\r\n        const rememberme = localStorage.getItem('rememberme')\r\n\r\n        if (rememberme==='true') {\r\n            tokenString = localStorage.getItem('token')\r\n        } else {\r\n            tokenString = sessionStorage.getItem('token')\r\n        }\r\n        \r\n\r\n        if (tokenString) {\r\n            let json = JSON.parse(tokenString)\r\n            const userName = getUsernameFromToken(json)\r\n            if (userName) {\r\n                json.username = userName\r\n            }            \r\n            return json\r\n        } else {\r\n            return null\r\n        }\r\n      };\r\n\r\n    const [authToken, setAuthToken] = useState(getToken());\r\n\r\n\r\n    const saveToken = userToken => {\r\n        if (userToken) {\r\n\r\n            const rememberme = localStorage.getItem('rememberme')\r\n\r\n            if (rememberme === 'true') {\r\n                localStorage.setItem('token', JSON.stringify(userToken));\r\n            } else {\r\n                sessionStorage.setItem('token', JSON.stringify(userToken));\r\n            }\r\n            \r\n            \r\n            const userName = getUsernameFromToken(userToken)\r\n            if (userName) {\r\n                userToken.username = userName\r\n            }            \r\n        } else {\r\n            localStorage.removeItem(\"token\")    \r\n            localStorage.removeItem(\"rememberme\") \r\n            sessionStorage.removeItem(\"token\")\r\n        }           \r\n        setAuthToken(userToken);\r\n    };    \r\n\r\n\r\n    return {\r\n        setAuthToken: saveToken,\r\n        authToken\r\n    }    \r\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import i18n from 'i18next';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\n\r\nimport translationEN from './locales/en/translation.json';\r\nimport translationBG from './locales/bg/translation.json';\r\nconst availableLanguages = ['en', 'bg'];\r\n\r\n\r\ni18n\r\n    .use(LanguageDetector)\r\n    .use(initReactI18next) // passes i18n down to react-i18next\r\n    .init({\r\n        // the translations\r\n        // (tip move them in a JSON file and import them,\r\n        // or even better, manage them via a UI: https://react.i18next.com/guides/multiple-translation-files#manage-your-translations-with-a-management-gui)\r\n        resources: {\r\n            en: {\r\n                translation: translationEN\r\n            },\r\n\r\n            bg: {\r\n                translation: translationBG\r\n            }      \r\n        },\r\n        //lng: \"bg\", // if you're using a language detector, do not define the lng option\r\n        //lng: localStorage.getItem('lng') || 'en',\r\n        fallbackLng: \"en\",\r\n\r\n        interpolation: {\r\n        escapeValue: false // react already safes from xss => https://www.i18next.com/translation-function/interpolation#unescape\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\nexport default i18n;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\nimport './index.css';\nimport './sidebar.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport './i18nextConf';\n\n// Importing the Bootstrap CSS\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  //<React.StrictMode>\n    <BrowserRouter basename=\"/roadaccident\">\n      <Routes>\n        <Route path=\"/\" element={<App />}>\n          <Route path=\":cityName\" element={<App />} >\n            <Route path=\":accidentId\" element={<App />} />\n          </Route>               \n        </Route>\n      </Routes>\n    </BrowserRouter>,\n  //</React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}