(this.webpackJsonproadaccident=this.webpackJsonproadaccident||[]).push([[0],{131:function(e,t,n){},132:function(e,t,n){},134:function(e,t,n){},166:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(22),c=n.n(a),i=n(71),o=n(11),l=(n(131),n(132),n(21)),s=n(9),d=n.n(s),u=n(16),j=n(3),b=(n(134),n(116)),m=n(105),p=n(48),O=n(52),v=n(51),f=n(1);var h=function(e){var t=e.currentCity,n=e.appname,a=e.onClickShowMenu,c=e.setLoginModalShow,o=e.authToken,l=e.setAuthToken,s=Object(r.useState)([]),h=Object(j.a)(s,2),x=h[0],y=h[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://127.0.0.1:8000/api/","cities/"));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,y(n),console.log(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(f.jsx)(m.a,{bg:"light",expand:"lg",children:Object(f.jsxs)(b.a,{children:[Object(f.jsx)(v.a,{className:"start-0",variant:"outline-primary",id:"menu-toggle",onClick:a,children:"Menu"})," ",Object(f.jsx)(m.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(f.jsx)(m.a.Collapse,{id:"basic-navbar-nav",children:Object(f.jsxs)(p.a,{className:"ms-auto",children:[Object(f.jsx)(p.a.Link,{href:"/",children:"\u041d\u0430\u0447\u0430\u043b\u043e"}),Object(f.jsxs)(O.a,{title:"\u041a\u0430\u0440\u0442\u0438",id:"basic-nav-dropdown",children:[Object(f.jsx)(O.a.Item,{href:"/roadaccident/".concat(t),active:"roadaccident"===n,children:"\u041f\u044a\u0442\u043d\u043e \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0448\u0441\u0442\u0432\u0438\u044f"},"1"),Object(f.jsx)(O.a.Item,{href:"/citytree/".concat(t),active:"citytree"===n,children:"\u0413\u0440\u0430\u0434\u0441\u043a\u0430 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b\u043d\u043e\u0441\u0442"},"2"),Object(f.jsx)(O.a.Item,{href:"/urbanobject/".concat(t),active:"urbanobject"===n,children:"\u0413\u0440\u0430\u0434\u0441\u043a\u0438 \u043e\u0431\u0435\u043a\u0442\u0438"},"3")]}),Object(f.jsx)(O.a,{title:"\u0413\u0440\u0430\u0434",id:"basic-nav-dropdown",children:x.map((function(e){return Object(f.jsx)(O.a.Item,{as:i.b,to:"/".concat(e.sysname),active:t===e.sysname,children:e.cityname},e.id)}))}),o?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.a.Link,{children:"Hello, ".concat(o.username)}),Object(f.jsx)(p.a.Link,{href:"#",onClick:function(){l(void 0)},children:"Logout"})]}):Object(f.jsx)(p.a.Link,{href:"#",onClick:function(){return c(!0)},children:"Signin"})]})})]})})},x=n(121),y=n(112),A=n(2),g=n(8),k=n(180),F=n(172),I=n(117),w=n(182),S=n(47);var C=function(e){var t=e.onSubmitFilter,n=e.minMaxDateData,a=e.dictManeuvers,c=e.dictTypeViolations,i=e.dictViolators;function o(){j("dateFromFilter",n.minDate),j("dateToFilter",n.maxDate)}Object(r.useEffect)((function(){o()}),[n]);var l=Object(g.b)({reValidateMode:"onChange",defaultValues:{dateFromFilter:"",dateToFilter:"",descFilter:"",maneuverFilter:"",violationsTypeFilter:"",violatorsFilter:"",driverViolationFilter:!1,motorcyclistViolationFilter:!1,cyclistViolationFilter:!1,pedestrianViolationFilter:!1,kidsInjuredFilter:!1,pubtrPassengersInjuredFilter:!1,driversKilledFilter:!1,motorcyclistsKilledFilter:!1,cyclistsKilledFilter:!1,pedestrianKilledFilter:!1,kidsKilledFilter:!1,pubtrPassengersKilledFilter:!1,publicTransportInvolvedFilter:!1,showOnlyMyAccidentsFilter:!1,select:{}}}),s=l.control,d=l.handleSubmit,u=l.reset,j=l.setValue,b=[];Array.isArray(a)&&(b=a.map((function(e){return{value:e.id,label:e.maneuvername}})));var m=[];Array.isArray(c)&&(m=c.map((function(e){return{value:e.id,label:e.violationname}})));var p=[];return Array.isArray(i)&&(p=i.map((function(e){return{value:e.id,label:e.violatorname}}))),Object(f.jsx)("div",{children:Object(f.jsxs)(k.a,{className:"m-1",onSubmit:d(t),children:[Object(f.jsxs)(F.a,{children:[Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formDateFromFilter",children:[Object(f.jsx)(k.a.Label,{children:"\u041e\u0442"}),Object(f.jsx)(g.a,{name:"dateFromFilter",control:s,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"date"},t))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formDateToFilter",children:[Object(f.jsx)(k.a.Label,{children:"\u0414\u043e"}),Object(f.jsx)(g.a,{name:"dateToFilter",control:s,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"date"},t))}})]})]}),Object(f.jsxs)(F.a,{className:"mt-3",children:[Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formManeuverFilter",style:{minWidth:"250px"},children:[Object(f.jsx)(k.a.Label,{children:"\u041c\u0430\u043d\u044c\u043e\u0432\u044a\u0440 \u043d\u0430 \u041c\u041f\u0421"}),Object(f.jsx)(g.a,{name:"maneuverFilter",control:s,render:function(e){var t=e.field;return Object(f.jsx)(S.a,Object(A.a)(Object(A.a)({},t),{},{isClearable:!0,isSearchable:!1,options:b}))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formDescFilter",children:[Object(f.jsx)(k.a.Label,{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(f.jsx)(g.a,{name:"descFilter",control:s,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text"},t))}})]})]}),Object(f.jsxs)(k.a.Group,{controlId:"formViolationsTypeFilter",className:"mt-3",children:[Object(f.jsx)(k.a.Label,{children:"\u0412\u0438\u0434 \u043d\u0430 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0435"}),Object(f.jsx)(g.a,{name:"violationsTypeFilter",control:s,render:function(e){var t=e.field;return Object(f.jsx)(S.a,Object(A.a)(Object(A.a)({},t),{},{isMulti:!0,isSearchable:!1,options:m}))}})]}),Object(f.jsxs)(k.a.Group,{controlId:"formviolatorsFilter",className:"mt-3",children:[Object(f.jsx)(k.a.Label,{children:"\u041d\u0430\u0440\u0443\u0448\u0438\u0442\u0435\u043b\u0438"}),Object(f.jsx)(g.a,{name:"violatorsFilter",control:s,render:function(e){var t=e.field;return Object(f.jsx)(S.a,Object(A.a)(Object(A.a)({},t),{},{isMulti:!0,isSearchable:!1,options:p}))}})]}),Object(f.jsxs)(w.a,{body:!0,className:"mt-3",children:[Object(f.jsx)(w.a.Title,{children:Object(f.jsx)("h6",{children:"\u041f\u043e\u0441\u0442\u0440\u0430\u0434\u0430\u043b\u0438"})}),Object(f.jsx)(g.a,{name:"driverInjuredFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0428\u043e\u0444\u044c\u043e\u0440",type:"checkbox",id:"idDriverInjuredFilter"}))}}),Object(f.jsx)(g.a,{name:"motorcyclistInjuredFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041c\u043e\u0442\u043e\u0446\u0438\u043a\u043b\u0438\u0441\u0442",type:"checkbox",id:"idMotorcyclistInjuredFilter"}))}}),Object(f.jsx)(g.a,{name:"cyclistInjuredFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0412\u0435\u043b\u043e\u0441\u0438\u043f\u0435\u0434\u0438\u0441\u0442",type:"checkbox",id:"idCyclistInjuredFilter"}))}}),Object(f.jsx)(g.a,{name:"pedestrianInjuredFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041f\u0435\u0448\u0435\u0445\u043e\u0434\u0435\u0446",type:"checkbox",id:"idPedestrianInjuredFilter"}))}}),Object(f.jsx)(g.a,{name:"kidsInjuredFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0414\u0435\u0442\u0435",type:"checkbox",id:"idKidsInjuredFilter"}))}}),Object(f.jsx)(g.a,{name:"pubtrPassengersInjuredFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041f\u044a\u0442\u043d\u0438\u043a \u043d\u0430 \u0413\u0422",type:"checkbox",id:"idPubtrPassengersInjuredFilter"}))}})]}),Object(f.jsxs)(w.a,{body:!0,className:"mt-3",children:[Object(f.jsx)(w.a.Title,{children:Object(f.jsx)("h6",{children:"\u0423\u0431\u0438\u0442\u0438"})}),Object(f.jsx)(g.a,{name:"driversKilledFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0428\u043e\u0444\u044c\u043e\u0440",type:"checkbox",id:"idDriversKilledFilter"}))}}),Object(f.jsx)(g.a,{name:"motorcyclistsKilledFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041c\u043e\u0442\u043e\u0446\u0438\u043a\u043b\u0438\u0441\u0442",type:"checkbox",id:"idMotorcyclistsKilledFilter"}))}}),Object(f.jsx)(g.a,{name:"cyclistsKilledFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0412\u0435\u043b\u043e\u0441\u0438\u043f\u0435\u0434\u0438\u0441\u0442",type:"checkbox",id:"idCyclistsKilledFilter"}))}}),Object(f.jsx)(g.a,{name:"pedestrianKilledFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041f\u0435\u0448\u0435\u0445\u043e\u0434\u0435\u0446",type:"checkbox",id:"idPedestrianKilledFilter"}))}}),Object(f.jsx)(g.a,{name:"kidsKilledFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0414\u0435\u0442\u0435",type:"checkbox",id:"idKidsKilledFilter"}))}}),Object(f.jsx)(g.a,{name:"pubtrPassengersKilledFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041f\u044a\u0442\u043d\u0438\u043a \u043d\u0430 \u0413\u0422",type:"checkbox",id:"idPubtrPassengersKilledFilter"}))}})]}),Object(f.jsx)(k.a.Group,{controlId:"formPublicTransportInvolvedFilter",className:"mt-3 ms-1",children:Object(f.jsx)(g.a,{name:"publicTransportInvolvedFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0413\u0422 \u0443\u0447\u0430\u0441\u0442\u0432\u0430 \u0432 \u041f\u0422\u041f",type:"checkbox",id:"idPublicTransportInvolvedFilter"}))}})}),Object(f.jsx)(k.a.Group,{controlId:"formShowOnlyMyAccidentsFilter",className:"mt-3 ms-1",children:Object(f.jsx)(g.a,{name:"showOnlyMyAccidentsFilter",control:s,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u041f\u043e\u043a\u0430\u0436\u0438 \u041f\u0422\u041f \u0434\u043e\u0431\u0430\u0432\u0435\u043d\u0438 \u043e\u0442 \u043c\u0435\u043d",type:"checkbox",id:"idShowOnlyMyAccidentsFilter"}))}})}),Object(f.jsxs)("div",{className:"mt-4 me-2 float-end",children:[Object(f.jsx)(v.a,{variant:"light",onClick:function(e){u(),o(),t({})},children:"\u0418\u0437\u0447\u0438\u0441\u0442\u0438"})," ",Object(f.jsx)(v.a,{type:"submit",variant:"primary",style:{minWidth:"150px"},children:"\u0422\u044a\u0440\u0441\u0438"})," "]})]})})},M=n(181),N=(n(115),n(120)),T=n.n(N),K=(n(157),n(110)),z=n.n(K);var L=function(e){var t=e.newMarkerState,n=e.onSubmitAccident,a=e.onDeleteAccident,c=e.onCloseAccident,i=e.dictManeuvers,o=e.dictTypeViolations,l=e.dataAccidentForm,s=e.dictViolators,d=(e.currentCity,Object(r.useState)(!1)),u=Object(j.a)(d,2),b=u[0],m=u[1],p=Object(r.useRef)(null);Object(r.useEffect)((function(){t.visible&&(N(),p.current.state.inputValue="",p.current.state.selectedDate=void 0,K("latAccidentForm",t.position.lat),K("lngAccidentForm",t.position.lng))}),[t]),Object(r.useEffect)((function(){var e,t,n,r,a,c,i,o,s,d,u,j,b,m,p,v,f,y,A,g,k,F,I={};(I.accidentId=null===l||void 0===l||null===(e=l.properties)||void 0===e?void 0:e.id,I.latAccidentForm=null===l||void 0===l||null===(t=l.properties)||void 0===t?void 0:t.latitude,I.lngAccidentForm=null===l||void 0===l||null===(n=l.properties)||void 0===n?void 0:n.longitude,I.descAccidentForm=null===l||void 0===l||null===(r=l.properties)||void 0===r?void 0:r.description,null===l||void 0===l||null===(a=l.properties)||void 0===a?void 0:a.datetime)&&(I.dateTimeAccidentForm=z()(null===l||void 0===l||null===(F=l.properties)||void 0===F?void 0:F.datetime));var w=null===l||void 0===l||null===(c=l.properties)||void 0===c?void 0:c.maneuver;w&&(I.maneuverAccidentForm=O.find((function(e){return e.value===w})));var S=null===l||void 0===l||null===(i=l.properties)||void 0===i?void 0:i.violations_type;S&&(S=S.map((function(e){return parseInt(e)})),I.violationsTypeAccidentForm=h.filter((function(e){return S.includes(e.value)})));var C=null===l||void 0===l||null===(o=l.properties)||void 0===o?void 0:o.violators;C&&(C=C.map((function(e){return parseInt(e)})),I.violatorsAccidentForm=x.filter((function(e){return C.includes(e.value)}))),I.driversInjuredAccidentForm=null===l||void 0===l||null===(s=l.properties)||void 0===s?void 0:s.drivers_injured,I.motorcyclistsInjuredAccidentForm=null===l||void 0===l||null===(d=l.properties)||void 0===d?void 0:d.motorcyclists_injured,I.cyclistsInjuredAccidentForm=null===l||void 0===l||null===(u=l.properties)||void 0===u?void 0:u.cyclists_injured,I.pedInjuredAccidentForm=null===l||void 0===l||null===(j=l.properties)||void 0===j?void 0:j.ped_injured,I.kidsInjuredAccidentForm=null===l||void 0===l||null===(b=l.properties)||void 0===b?void 0:b.kids_injured,I.pubtrPassengersInjuredAccidentForm=null===l||void 0===l||null===(m=l.properties)||void 0===m?void 0:m.pubtr_passengers_injured,I.driversKilledAccidentForm=null===l||void 0===l||null===(p=l.properties)||void 0===p?void 0:p.drivers_killed,I.motorcyclistsKilledAccidentForm=null===l||void 0===l||null===(v=l.properties)||void 0===v?void 0:v.motorcyclists_killed,I.cyclistsKilledAccidentForm=null===l||void 0===l||null===(f=l.properties)||void 0===f?void 0:f.cyclists_killed,I.pedKilledAccidentForm=null===l||void 0===l||null===(y=l.properties)||void 0===y?void 0:y.ped_killed,I.kidsKilledAccidentForm=null===l||void 0===l||null===(A=l.properties)||void 0===A?void 0:A.kids_killed,I.pubtrPassengersKilledAccidentForm=null===l||void 0===l||null===(g=l.properties)||void 0===g?void 0:g.pubtr_passengers_killed,I.publicTransportInvolvedAccidentForm=null===l||void 0===l||null===(k=l.properties)||void 0===k?void 0:k.public_transport_involved,N(I,{keepDefaultValues:!0})}),[l]);var O=[];Array.isArray(i)&&(O=i.map((function(e){return{value:e.id,label:e.maneuvername}})));var h=[];Array.isArray(o)&&(h=o.map((function(e){return{value:e.id,label:e.violationname}})));var x=[];Array.isArray(s)&&(x=s.map((function(e){return{value:e.id,label:e.violatorname}})));var y=Object(g.b)({defaultValues:{latAccidentForm:"",lngAccidentForm:"",descAccidentForm:"",dateTimeAccidentForm:"",maneuverAccidentForm:null,violationsTypeAccidentForm:[],violatorsAccidentForm:[],driversInjuredAccidentForm:0,motorcyclistsInjuredAccidentForm:0,cyclistsInjuredAccidentForm:0,pedInjuredAccidentForm:0,kidsInjuredAccidentForm:0,pubtrPassengersInjuredAccidentForm:0,driversKilledAccidentForm:0,motorcyclistsKilledAccidentForm:0,cyclistsKilledAccidentForm:0,pedKilledAccidentForm:0,kidsKilledAccidentForm:0,pubtrPassengersKilledAccidentForm:0,publicTransportInvolvedAccidentForm:!1,accidentId:""}}),w=y.control,C=y.handleSubmit,N=y.reset,K=y.setValue,L=y.getValues,G=y.formState.errors;return Object(f.jsxs)("div",{children:[Object(f.jsxs)(k.a,{className:"m-1",onSubmit:C((function(e){var t,r={};r.id=parseInt(L("accidentId"))||null,r.latitude=L("latAccidentForm"),r.longitude=L("lngAccidentForm"),r.datetime=L("dateTimeAccidentForm").format("YYYY-MM-DDTHH:mm"),r.maneuver=null===(t=L("maneuverAccidentForm"))||void 0===t?void 0:t.value,void 0===r.maneuver&&(r.maneuver=null),r.description=L("descAccidentForm"),r.violations_type=L("violationsTypeAccidentForm").map((function(e){return e.value})),r.violators=L("violatorsAccidentForm").map((function(e){return e.value})),r.drivers_injured=parseInt(L("driversInjuredAccidentForm"))||0,r.motorcyclists_injured=parseInt(L("motorcyclistsInjuredAccidentForm"))||0,r.cyclists_injured=parseInt(L("cyclistsInjuredAccidentForm"))||0,r.ped_injured=parseInt(L("pedInjuredAccidentForm"))||0,r.kids_injured=parseInt(L("kidsInjuredAccidentForm"))||0,r.pubtr_passengers_injured=parseInt(L("pubtrPassengersInjuredAccidentForm"))||0,r.drivers_killed=parseInt(L("driversKilledAccidentForm"))||0,r.motorcyclists_killed=parseInt(L("motorcyclistsKilledAccidentForm"))||0,r.cyclists_killed=parseInt(L("cyclistsKilledAccidentForm"))||0,r.ped_killed=parseInt(L("pedKilledAccidentForm"))||0,r.kids_killed=parseInt(L("kidsKilledAccidentForm"))||0,r.pubtr_passengers_killed=parseInt(L("pubtrPassengersKilledAccidentForm"))||0,r.public_transport_involved=L("publicTransportInvolvedAccidentForm"),n(r)})),children:[Object(f.jsxs)(F.a,{children:[Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formDateFromFilter",children:Object(f.jsxs)(k.a.Label,{children:["Lat/Lng ",Object(f.jsx)("a",{href:"#",children:Object(f.jsx)("i",{className:"fas fa-edit align-middle"})})]})}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formLatAccident",children:[Object(f.jsx)(g.a,{name:"latAccidentForm",control:w,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",step:"any",size:"sm",isInvalid:!!G.latAccidentForm},t))}}),Object(f.jsx)(k.a.Control.Feedback,{type:"invalid",children:"Required field"})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formLngAccident",children:[Object(f.jsx)(g.a,{name:"lngAccidentForm",control:w,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",step:"any",size:"sm",isInvalid:!!G.lngAccidentForm},t))}}),Object(f.jsx)(k.a.Control.Feedback,{type:"invalid",children:"Required field"})]})]}),Object(f.jsxs)(k.a.Group,{controlId:"formDescriptionAccident",className:"mt-3",children:[Object(f.jsx)(k.a.Label,{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(f.jsx)(g.a,{name:"descAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text",as:"textarea",rows:3},t))}})]}),Object(f.jsxs)(F.a,{className:"mt-3",children:[Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formDateTimeAccident",style:{minWidth:"250px"},children:[Object(f.jsx)(k.a.Label,{children:"\u0414\u0430\u0442\u0430 \u0438 \u0447\u0430\u0441"}),Object(f.jsx)(g.a,{name:"dateTimeAccidentForm",control:w,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(T.a,Object(A.a)(Object(A.a)({},t),{},{ref:p}))}}),G.dateTimeAccidentForm?Object(f.jsx)("p",{style:{color:"red"},children:Object(f.jsx)("small",{children:"Required field"})}):""]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formManeuverAccident",children:[Object(f.jsx)(k.a.Label,{children:"\u041c\u0430\u043d\u044c\u043e\u0432\u044a\u0440 \u043d\u0430 \u041c\u041f\u0421"}),Object(f.jsx)(g.a,{name:"maneuverAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(S.a,Object(A.a)(Object(A.a)({},t),{},{isClearable:!0,isSearchable:!1,options:O}))}})]})]}),Object(f.jsxs)(k.a.Group,{controlId:"formViolationsTypeAccident",className:"mt-3",children:[Object(f.jsx)(k.a.Label,{children:"\u0412\u0438\u0434 \u043d\u0430 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0435"}),Object(f.jsx)(g.a,{name:"violationsTypeAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(S.a,Object(A.a)(Object(A.a)({},t),{},{isMulti:!0,isSearchable:!1,options:h}))}})]}),Object(f.jsxs)(k.a.Group,{controlId:"formViolatorsAccident",className:"mt-3",children:[Object(f.jsx)(k.a.Label,{children:"\u041d\u0430\u0440\u0443\u0448\u0438\u0442\u0435\u043b\u0438"}),Object(f.jsx)(g.a,{name:"violatorsAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(S.a,Object(A.a)(Object(A.a)({},t),{},{isMulti:!0,isSearchable:!1,options:x}))}})]}),Object(f.jsxs)(F.a,{className:"mt-3",children:[Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formInjuredLabelAccident",children:Object(f.jsx)(k.a.Label,{style:{marginTop:"32px"},children:"\u041f\u043e\u0441\u0442\u0440:"})}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formDriversInjuredAccident",className:"ps-1 pe-0",children:[Object(f.jsx)(k.a.Label,{children:Object(f.jsx)("i",{className:"fas fa-car fa-lg",title:"\u0428\u043e\u0444\u044c\u043e\u0440 \u0438 \u043f\u044a\u0442\u043d\u0438\u0446\u0438"})}),Object(f.jsx)(g.a,{name:"driversInjuredAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formMotorcyclistsInjuredAccident",className:"ps-1 pe-0",children:[Object(f.jsx)(k.a.Label,{children:Object(f.jsx)("i",{className:"fas fa-motorcycle fa-lg",title:"\u041c\u043e\u0442\u043e\u0446\u0438\u043a\u043b\u0438\u0441\u0442"})}),Object(f.jsx)(g.a,{name:"motorcyclistsInjuredAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formCyclistsInjuredAccident",className:"ps-1 pe-0",children:[Object(f.jsx)(k.a.Label,{children:Object(f.jsx)("i",{className:"fas fa-bicycle fa-lg",title:"\u0412\u0435\u043b\u043e\u0441\u0438\u043f\u0435\u0434\u0438\u0441\u0442"})}),Object(f.jsx)(g.a,{name:"cyclistsInjuredAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formPedInjuredAccident",className:"ps-1 pe-0",children:[Object(f.jsx)(k.a.Label,{children:Object(f.jsx)("i",{className:"fas fa-walking fa-lg",title:"\u041f\u0435\u0448\u0435\u0445\u043e\u0434\u0435\u0446"})}),Object(f.jsx)(g.a,{name:"pedInjuredAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formKidsInjuredAccident",className:"ps-1 pe-0",children:[Object(f.jsx)(k.a.Label,{children:Object(f.jsx)("i",{className:"fas fa-baby fa-lg",title:"\u0414\u0435\u0442\u0435"})}),Object(f.jsx)(g.a,{name:"kidsInjuredAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})]}),Object(f.jsxs)(k.a.Group,{as:I.a,controlId:"formPubtrPassengersInjuredAccident",className:"ps-1 pe-0",children:[Object(f.jsx)(k.a.Label,{children:Object(f.jsx)("i",{className:"fas fa-bus-alt fa-lg",title:"\u041f\u044a\u0442\u043d\u0438\u043a \u043d\u0430 \u0433\u0440\u0430\u0434\u0441\u043a\u0438 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442"})}),Object(f.jsx)(g.a,{name:"pubtrPassengersInjuredAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})]})]}),Object(f.jsxs)(F.a,{className:"mt-0",children:[Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formKilledLabelAccident",children:Object(f.jsx)(k.a.Label,{children:"\u0423\u0431\u0438\u0442\u0438:"})}),Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formDriversKilledAccident",className:"ps-1 pe-0",children:Object(f.jsx)(g.a,{name:"driversKilledAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})}),Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formMotorcyclistsKilledAccident",className:"ps-1 pe-0",children:Object(f.jsx)(g.a,{name:"motorcyclistsKilledAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})}),Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formCyclistsKilledAccident",className:"ps-1 pe-0",children:Object(f.jsx)(g.a,{name:"cyclistsKilledAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})}),Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formPedKilledAccident",className:"ps-1 pe-0",children:Object(f.jsx)(g.a,{name:"pedKilledAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})}),Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formKidsKilledAccident",className:"ps-1 pe-0",children:Object(f.jsx)(g.a,{name:"kidsKilledAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})}),Object(f.jsx)(k.a.Group,{as:I.a,controlId:"formPubtrPassengersKilledAccident",className:"ps-1 pe-0",children:Object(f.jsx)(g.a,{name:"pubtrPassengersKilledAccidentForm",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",max:"99"},t))}})})]}),Object(f.jsx)(k.a.Group,{controlId:"formPublicTransportInvolvedAccident",className:"mt-3 ms-1",children:Object(f.jsx)(g.a,{name:"publicTransportInvolvedAccidentForm",control:w,render:function(e){var t,n=e.field;return Object(f.jsx)(k.a.Check,Object(A.a)(Object(A.a)({},n),{},{checked:null!==(t=n.value)&&void 0!==t&&t,inline:!0,label:"\u0413\u0422 \u0443\u0447\u0430\u0441\u0442\u0432\u0430 \u0432 \u041f\u0422\u041f",type:"checkbox",id:"idPublicTransportInvolvedAccident"}))}})}),Object(f.jsx)(k.a.Group,{controlId:"formIdAccident",className:"mt-3",children:Object(f.jsx)(g.a,{name:"accidentId",control:w,render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"number",size:"sm",min:"0",style:{display:"none"}},t))}})}),Object(f.jsxs)("div",{className:"mt-4 me-2 float-end",children:[Object(f.jsx)(v.a,{onClick:function(){return m(!0)},variant:"light",children:"\u0418\u0437\u0442\u0440\u0438\u0439"})," ",Object(f.jsx)(v.a,{onClick:c,variant:"secondary",children:"\u0418\u0437\u0445\u043e\u0434"})," ",Object(f.jsx)(v.a,{type:"submit",variant:"primary",style:{minWidth:"110px"},children:"\u0417\u0430\u043f\u0430\u0437\u0438"})]})]}),Object(f.jsxs)(M.a,{show:b,onHide:function(){return m(!1)},children:[Object(f.jsx)(M.a.Header,{closeButton:!0,children:Object(f.jsx)(M.a.Title,{children:"\u0418\u0437\u0442\u0440\u0438\u0432\u0430\u043d\u0435"})}),Object(f.jsx)(M.a.Body,{children:"\u041d\u0430\u0438\u0441\u0442\u0438\u043d\u0430 \u043b\u0438 \u0438\u0441\u043a\u0430\u0442\u0435 \u0434\u0430 \u0438\u0437\u0442\u0440\u0438\u0435\u0442\u0435 \u0442\u043e\u0437\u0438 \u0438\u043d\u0446\u0438\u0434\u0435\u043d\u0442?"}),Object(f.jsxs)(M.a.Footer,{children:[Object(f.jsx)(v.a,{variant:"light",onClick:function(){m(!1),a(L("accidentId"))},children:"\u0418\u0437\u0442\u0440\u0438\u0439"}),Object(f.jsx)(v.a,{variant:"secondary",onClick:function(){return m(!1)},children:"\u041e\u0442\u043c\u0435\u043d\u0438"})]})]})]})},G=function(e){var t=e.onSubmitFilter,n=e.onSubmitAccident,a=e.onDeleteAccident,c=e.onCloseAccident,i=e.minMaxDateData,o=e.dataAccidentForm,l=e.showAccidentTab,s=e.activeTabKey,d=e.setActiveTabKey,u=e.newMarkerState,b=e.dictManeuvers,m=e.dictTypeViolations,p=e.dictViolators,O=e.currentCity,v=Object(r.useState)("filter"),h=Object(j.a)(v,2);h[0],h[1];return Object(f.jsxs)(x.a,{id:"controlled-tab-example",activeKey:s,onSelect:function(e){return d(e)},className:"mb-3",children:[Object(f.jsx)(y.a,{eventKey:"filter",title:"\u0422\u044a\u0440\u0441\u0435\u043d\u0435",children:Object(f.jsx)("div",{style:{overflowY:"auto",overflowX:"hidden",width:"100%",height:"calc(100vh - 130px)"},children:Object(f.jsx)(C,{onSubmitFilter:t,minMaxDateData:i,dictManeuvers:b,dictTypeViolations:m,dictViolators:p})})}),Object(f.jsx)(y.a,{eventKey:"accident",title:"\u041f\u0422\u041f",tabClassName:l?"":"d-none",children:Object(f.jsx)("div",{style:{overflowY:"auto",overflowX:"hidden",width:"100%",height:"calc(100vh - 130px)"},children:Object(f.jsx)(L,{onSubmitAccident:n,onDeleteAccident:a,onCloseAccident:c,newMarkerState:u,dictManeuvers:b,dictTypeViolations:m,dictViolators:p,dataAccidentForm:o,currentCity:O})})})]})},D=function(e){var t=e.onSubmitFilter,n=e.onSubmitAccident,r=e.onDeleteAccident,a=e.onCloseAccident,c=e.minMaxDateData,i=e.dataAccidentForm,o=e.showAccidentTab,l=e.activeTabKey,s=e.setActiveTabKey,d=e.newMarkerState,u=e.dictManeuvers,j=e.dictTypeViolations,b=e.dictViolators,m=e.currentCity;return Object(f.jsx)("div",{className:"bg-light border-right",id:"sidebar-wrapper",children:Object(f.jsx)("div",{className:"list-group list-group-flush",style:{marginTop:"15px"},children:Object(f.jsx)(G,{onSubmitFilter:t,onSubmitAccident:n,onDeleteAccident:r,onCloseAccident:a,minMaxDateData:c,dataAccidentForm:i,showAccidentTab:o,activeTabKey:l,setActiveTabKey:s,newMarkerState:d,dictManeuvers:u,dictTypeViolations:j,dictViolators:b,currentCity:m})})})},P=n(10),B=n(175),E=n(176),H=n(177),V=n(173),R=n(178),U=n(179),W=n(14),Y=n.n(W);n(158),n(159),n(160);var q=function(e,t,n,r,a){return Y.a.easyButton({position:"topright",states:[{stateName:"off",icon:'<i class="'.concat(t,'"></i>'),onClick:function(e){e.state("on"),e.button.style.backgroundColor="red",r(!0)}},{stateName:"on",icon:'<i class="'.concat(n,'"></i>'),onClick:function(e){e.state("off"),e.button.style.backgroundColor="white",r(!1)}}]}).addTo(e)},J=n(174),Z=n(123);var Q,X,_,$=function(e){var t=e.mapBaseLayerName;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(V.a.BaseLayer,{checked:"Default"===t,name:"Default",children:Object(f.jsx)(J.a,{attribution:'Map data \xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> <a href="https://www.mapbox.com/">Mapbox</a>',url:"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",accessToken:"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ",id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1})}),Object(f.jsx)(V.a.BaseLayer,{checked:"Dark"===t,name:"Dark",children:Object(f.jsx)(J.a,{attribution:'Map data \xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> <a href="https://www.mapbox.com/">Mapbox</a>',url:"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",accessToken:"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ",id:"mapbox/dark-v10",tileSize:512,zoomOffset:-1})}),Object(f.jsx)(V.a.BaseLayer,{checked:"Google"===t,name:"Google",children:Object(f.jsx)(J.a,{attribution:"Google",url:"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]})}),Object(f.jsx)(V.a.BaseLayer,{checked:"Sat1"===t,name:"Sat1",children:Object(f.jsx)(Z.a,{bingkey:"AniAD3xsGTaSbK1pa0_UkWS1CldG0nGI7r55MlVZqHhyKil9rD9dFK8536u8hTj1",type:"Aerial"})}),Object(f.jsx)(V.a.BaseLayer,{checked:"Sat2"===t,name:"Sat2",children:Object(f.jsx)(J.a,{attribution:"Google",url:"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]})}),Object(f.jsx)(V.a.BaseLayer,{checked:"Sat3"===t,name:"Sat3",children:Object(f.jsx)(J.a,{attribution:"Tiles \xa9 Esri",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",maxZoom:19})}),Object(f.jsx)(V.a.BaseLayer,{checked:"Sat4"===t,name:"Sat4",children:Object(f.jsx)(J.a,{attribution:'Map data \xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> <a href="https://www.mapbox.com/">Mapbox</a>',url:"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",accessToken:"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ",id:"mapbox/satellite-v9",tileSize:512,maxZoom:21,zoomOffset:-1})})]})},ee=(n(162),n(122)),te=n.n(ee),ne=(n(164),Y.a.icon({iconUrl:"data:image/png;base64,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",shadowUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACJ0lEQVR4Ae3ShY6bQRADYIeZ3v+9yszMDZPlkSWtslPuiS6+C+8n/zNp4p/froi8Jq/Jxk+TkwmHX//Wz8lG3jNjTeaguabD6HAVbphMwIIzqtd+rzKYhsgUNNcqo3fEBlyyOWmwhbbS4b8SaLBu7SGlpL9gklw3YpYR6J5Bm0zAguspZjvqSVQxqvxsPSJJKYIFKh5A2VIDyMgYfYB9hvcmI0VPTxVZS81ER7qiBoFqBAa9MKOKLzzv2BE3EOnlmDTrNRXryToGOGR65nhvSphjMP6b6WJ6xMYYxSW7l1Pp6CSzbLFPgAN3NGLKPRn3c59qxzapCTPUFNVKh0vUe24azMkW+uRm/B8UU3O3Eiw4nOrrafOSF5gS7PqHUotBQQ6f11p22HDOi+66i2LIHcWJOZrTP+rkhOl7n8YcTzCQIuIvyZPQrvs5Br0OdTsyB+YYrwKokXvsgOIXZzbeQ0DMnhHIqGOdBMEl9qKYAo3pBbbDNkijUSgjv/PrMFhwRwS2YbbMzqg+SzdukoxbeiSEVlgyK6yFmjSYtDxhTXRv1OsgsCb2jflu8hLMyC0P7Qg54NE1qc/MF5PqeAHWSfDL3zxN9dsQ+YD3zEeRS4GeYgFm5I7HNiJPfP4V7/CKeUvwsxpqhkwFzMgjj33Vwe+EnuIxngn8FvNTSCkwmJG+rQm8J/MId/EQL3nZwe2EmSNm9ufkFq9xHzcJPscnLGMRomBKqdzOY2EH+IPOLMEAAAAASUVORK5CYII=",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})),re={radius:6,fillColor:"#402000",color:"#000",weight:0,opacity:.5,fillOpacity:.6},ae="";var ce=function(e){var t,n=e.mapBaseLayerName,a=e.dataAccidents,c=e.dataHeatmapPoints,i=e.currentCity,o=e.newMarkerState,l=e.onDragEndNewMarker,s=e.checkButtonNewMarker,b=e.checkButtonHeatmap,m=e.checkButtonGPS,p=e.onClickMap,O=e.onMarkerClick,v=e.onClickNewMarker,h=e.onClickHeatmap,x=e.onClickGPS,y=e.filterMapCallback,A=e.onBaselayerchange,g=e.setNewMarkerState,k=e.isMobileDevice,F=e.showOkCancelMobileMarker,I=e.setMapCurrentLatLng,w=e.setCheckButtonGPS,S=e.showSidebar,C=Object(r.useState)({latitude:"0",longitude:"0"}),M=Object(j.a)(C,2),N=M[0],T=M[1],K=Object(r.useState)(null),z=Object(j.a)(K,2),L=z[0],G=z[1],D=Object(r.useState)(null),W=Object(j.a)(D,2),J=W[0],Z=W[1],ee=Object(r.useState)(null),ce=Object(j.a)(ee,2),ie=ce[0],oe=ce[1],le=Object(r.useState)(null),se=Object(j.a)(le,2),de=se[0],ue=se[1],je=Object(r.useState)(null),be=Object(j.a)(je,2),me=be[0],pe=be[1],Oe=document.cookie.split("; ").find((function(e){return e.startsWith("mapname=")}));Oe&&Oe.split("=")[1];var ve=Object(r.useRef)(null);function fe(){var e=Object(B.a)();return ae!==N.sysname&&e.panTo([parseFloat(N.latitude),parseFloat(N.longitude)]),ae=N.sysname,null}function he(e){L&&(e?(X=4,L.locate({maxZoom:20,enableHighAccuracy:!0,watch:!0,maximumAge:2e4})):(L.stopLocate(),L.removeLayer(_),X=4)),x(e)}function xe(e){var t=e.target.toGeoJSON();O(t)}function ye(e,t){if(!b)return Y.a.circleMarker(t,re).on("click",xe)}function Ae(e,t){t.on({click:function(e){console.log("e: ",e),console.log("click")}})}function ge(e){var t=e.newMarkerState,n=t.visible,a=Object(B.a)(),c=Object(r.useMemo)((function(){return{dragend:function(){var e=ve.current;if(!k&&null!=e){var t=e.getLatLng(),n={lat:0,lng:0};n.lat=t.lat.toFixed(5),n.lng=t.lng.toFixed(5),g({visible:!0,position:n})}}}}),[]);return Object(f.jsx)(f.Fragment,{children:n&&Object(f.jsx)(f.Fragment,{children:k?Object(f.jsx)(E.a,{icon:ne,draggable:!1,position:0==t.position.lat?a.getCenter():t.position,ref:ve},"newMarker"):Object(f.jsx)(E.a,{icon:ne,draggable:!0,position:t.position,ref:ve,eventHandlers:c},"newMarker")})})}function ke(){var e=Object(B.b)({baselayerchange:A,move:function(e){F&&ve.current.setLatLng({lat:e.target.getCenter().lat,lng:e.target.getCenter().lng})},moveend:function(e){if(F){var t=ve.current.getLatLng(),n={lat:0,lng:0};n.lat=t.lat.toFixed(5),n.lng=t.lng.toFixed(5),g({visible:!0,position:n})}I({lat:e.target.getCenter().lat,lng:e.target.getCenter().lng})},click:function(e){p(e)},zoomend:function(e){Z(e.target._zoom)},locationfound:function(t){var n=t.accuracy/2;X>0&&(e.setView(t.latlng,20),X-=1),e.hasLayer(_)?(_.setLatLng(t.latlng),_.setRadius(n)):_=Y.a.circle(t.latlng,n).addTo(e)},locationerror:function(e){w(!1),alert(e.message)}});return null}function Fe(){var e=Object(B.a)();return Q&&e.removeLayer(Q),b&&c&&(Q=Y.a.heatLayer(c,{gradient:{.4:"#1E90FF",.8:"white",1:"red"},max:1.5,radius:14,blur:10,maxZoom:6}),e.addLayer(Q)),null}return Object(r.useEffect)((function(){return L&&(oe(q(L,"fas fa-map-marker-alt fa-lg","fas fa-map-marker-alt fa-lg",v,s)),ue(q(L,"fas fa-eye fa-lg","fas fa-eye-slash fa-lg",h,b)),pe(q(L,"fas fa-satellite-dish fa-lg","fas fa-satellite-dish fa-lg",he,m)),I({lat:L.getCenter().lat,lng:L.getCenter().lng})),function(){ie&&ie.remove(),de&&de.remove(),me&&me.remove()}}),[L]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://127.0.0.1:8000/api/","cities/").concat(i));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,T(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[i]),Object(r.useEffect)((function(){ie&&(s?(ie.state("on"),ie.button.style.backgroundColor="red"):(ie.state("off"),ie.button.style.backgroundColor="white"))}),[s]),Object(r.useEffect)((function(){de&&(b?(de.state("on"),de.button.style.backgroundColor="red"):(de.state("off"),de.button.style.backgroundColor="white"))}),[b]),Object(r.useEffect)((function(){me&&(m?(me.state("on"),me.button.style.backgroundColor="red"):(me.state("off"),me.button.style.backgroundColor="white"))}),[m]),Object(r.useEffect)((function(){L&&!k&&(s?Y.a.DomUtil.addClass(L._container,"crosshair-cursor-enabled"):Y.a.DomUtil.removeClass(L._container,"crosshair-cursor-enabled"))}),[s]),Object(r.useEffect)((function(){L&&window.setTimeout((function(){L.invalidateSize({pan:!1})}),600)}),[S]),Object(f.jsx)(f.Fragment,{children:"0"!==N.longitude&&"0"!==N.latitude?Object(f.jsxs)(H.a,(t={style:{cursor:"crosshair"},whenCreated:G,center:[parseFloat(N.latitude),parseFloat(N.longitude)],zoom:13,zoomControl:!1,scrollWheelZoom:!0},Object(P.a)(t,"style",{height:"calc(100vh - 60px)",width:"100%"}),Object(P.a)(t,"children",[Object(f.jsx)(V.a,{position:"topleft",children:Object(f.jsx)($,{mapBaseLayerName:n})}),Object(f.jsx)(fe,{}),J<15?Object(f.jsx)(R.a,{data:a,pointToLayer:ye,filter:y,onEachFeature:Ae},Date.now()):Object(f.jsx)(te.a,{spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,maxClusterRadius:15,iconCreateFunction:function(e){var t,n=e.getChildCount();return 2==n&&(t="1"),n>=3&&n<=5&&(t="2"),n>=6&&n<=9&&(t="3"),n>=10&&n<=14&&(t="4"),n>14&&(t="5"),Y.a.divIcon({html:n,className:"cluster digits-"+t,iconSize:null})},children:Object(f.jsx)(R.a,{data:a,pointToLayer:ye,filter:y,onEachFeature:Ae},Date.now())}),Object(f.jsx)(ge,{newMarkerState:o,onDragEndNewMarker:l}),Object(f.jsx)(ke,{}),!k&&Object(f.jsx)(U.a,{position:"bottomright"}),Object(f.jsx)(Fe,{})]),t)):Object(f.jsx)("p",{children:"Loading..."})})},ie=n(118),oe=function(e){var t=e.show,n=e.onHide,a=e.setLoginModalShow,c=e.setRegisterModalShow,i=e.setAuthToken,o=Object(r.useState)(!1),l=Object(j.a)(o,2),s=l[0],b=l[1];Object(r.useEffect)((function(){h(),b(!1)}),[t]);var m=Object(g.b)({defaultValues:{username:"",password:""}}),p=m.control,O=m.handleSubmit,h=m.reset,x=m.formState.errors;function y(){return(y=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat("http://127.0.0.1:8000/api/","token/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){200===e.status?e.json().then((function(e){i(e),console.log(e.access),b(!1),a(!1)})):401===e.status&&b(!0)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.jsxs)(M.a,{show:t,onHide:n,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(f.jsx)(M.a.Header,{closeButton:!0,children:Object(f.jsx)(M.a.Title,{id:"contained-modal-title-vcenter",children:"SIGN IN"})}),Object(f.jsx)(M.a.Body,{children:Object(f.jsxs)(k.a,{onSubmit:O((function(e){b(!1),function(e){y.apply(this,arguments)}(e)})),children:[Object(f.jsxs)(k.a.Group,{className:"mb-3",controlId:"formLogin",children:[Object(f.jsx)(ie.a,{controlId:"floatingInput",label:"Username",className:"mb-3",children:Object(f.jsx)(g.a,{name:"username",control:p,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text",placeholder:"Username",isInvalid:!!x.username},t))}})}),Object(f.jsx)(ie.a,{controlId:"floatingPassword",label:"Password",children:Object(f.jsx)(g.a,{name:"password",control:p,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"password",placeholder:"Password",isInvalid:!!x.password},t))}})})]}),Object(f.jsx)(k.a.Group,{className:"mb-3",controlId:"formBasicCheckbox",children:Object(f.jsx)(k.a.Check,{type:"checkbox",label:"Remember me"})}),s&&Object(f.jsx)(k.a.Text,{className:"text-danger",children:"Wrong username or password."}),Object(f.jsx)(v.a,{className:"mb-3",variant:"primary",type:"submit",style:{display:"block",width:"100%"},children:"LOGIN"}),Object(f.jsx)(k.a.Text,{className:"text-muted mb-0",children:Object(f.jsxs)("p",{className:"text-center",children:["Don't have account? ",Object(f.jsx)("a",{href:"#",onClick:function(){a(!1),c(!0)},children:"Sign up"})]})})]})})]})},le=function(e){var t,n,a,c=e.show,i=e.onHide,o=e.setRegisterModalShow,l=e.setLoginModalShow,s=e.setAuthToken;Object(r.useEffect)((function(){O()}),[c]);var b=Object(g.b)({defaultValues:{username:"",email:"",password:"",password2:"",first_name:"",last_name:""}}),m=b.control,p=b.handleSubmit,O=b.reset,h=b.setError,x=b.formState.errors;function y(){return(y=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("http://localhost:8000/api/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){200===e.status?e.json().then((function(e){console.log("ok",e),o(!1),s(e.token)})):e.status>=400&&e.json().then((function(e){console.log(e);for(var t=0,n=Object.entries(e);t<n.length;t++){var r=Object(j.a)(n[t],2),a=r[0],c=r[1];h(a,{type:"manual",message:c})}}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.jsxs)(M.a,{show:c,onHide:i,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(f.jsx)(M.a.Header,{closeButton:!0,children:Object(f.jsx)(M.a.Title,{id:"contained-modal-title-vcenter",children:"SIGN UP"})}),Object(f.jsx)(M.a.Body,{children:Object(f.jsxs)(k.a,{onSubmit:p((function(e){!function(e){y.apply(this,arguments)}(e)})),children:[Object(f.jsxs)(k.a.Group,{className:"mb-3",controlId:"formRegister",children:[(null===x||void 0===x||null===(t=x.username)||void 0===t?void 0:t.message)&&Object(f.jsx)(k.a.Text,{className:"text-danger",children:x.username.message.map((function(e){return Object(f.jsx)("p",{className:"mb-0",children:e},e)}))}),Object(f.jsx)(ie.a,{controlId:"floatingUsername",label:"Username",className:"mb-3",children:Object(f.jsx)(g.a,{name:"username",control:m,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text",placeholder:"Username",isInvalid:!!x.username},t))}})}),(null===x||void 0===x||null===(n=x.email)||void 0===n?void 0:n.message)&&Object(f.jsx)(k.a.Text,{className:"text-danger",children:x.email.message.map((function(e){return Object(f.jsx)("p",{className:"mb-0",children:e},e)}))}),Object(f.jsx)(ie.a,{controlId:"floatingEmail",label:"Email",className:"mb-3",children:Object(f.jsx)(g.a,{name:"email",control:m,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text",placeholder:"Email",isInvalid:!!x.email},t))}})}),(null===x||void 0===x||null===(a=x.password)||void 0===a?void 0:a.message)&&Object(f.jsx)(k.a.Text,{className:"text-danger",children:x.password.message.map((function(e){return Object(f.jsx)("p",{className:"mb-0",children:e},e)}))}),Object(f.jsx)(ie.a,{controlId:"floatingPassword",label:"Password",className:"mb-3",children:Object(f.jsx)(g.a,{name:"password",control:m,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"password",placeholder:"Password",isInvalid:!!x.password},t))}})}),Object(f.jsx)(ie.a,{controlId:"floatingPassword2",label:"Confirm password",className:"mb-3",children:Object(f.jsx)(g.a,{name:"password2",control:m,rules:{required:!0},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"password",placeholder:"Password",isInvalid:!!x.password2},t))}})}),Object(f.jsxs)(F.a,{children:[Object(f.jsx)(I.a,{children:Object(f.jsx)(g.a,{name:"first_name",control:m,rules:{required:!1},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text",size:"sm",placeholder:"Firstname (optional)",isInvalid:!!x.first_name},t))}})}),Object(f.jsx)(I.a,{children:Object(f.jsx)(g.a,{name:"last_name",control:m,rules:{required:!1},render:function(e){var t=e.field;return Object(f.jsx)(k.a.Control,Object(A.a)({type:"text",size:"sm",placeholder:"Lastname (optional)",isInvalid:!!x.last_name},t))}})})]})]}),Object(f.jsx)(v.a,{className:"mb-3",variant:"primary",type:"submit",style:{display:"block",width:"100%"},children:"REGISTER"}),Object(f.jsx)(k.a.Text,{className:"text-muted mb-0",children:Object(f.jsxs)("p",{className:"text-center",children:["Already have an account?"," ",Object(f.jsx)("a",{href:"#",onClick:function(){o(!1),l(!0)},children:"Login"})]})})]})})]})};var se=function(e){var t=function(){var e=function(e){var t=null===e||void 0===e?void 0:e.access;if(t){var n=t.split(".");if(n.length>1)return JSON.parse(atob(n[1])).username}},t=Object(r.useState)(function(){var t=localStorage.getItem("token"),n=JSON.parse(t),r=e(n);return r&&(n.username=r),n}()),n=Object(j.a)(t,2),a=n[0],c=n[1];return{setAuthToken:function(t){if(t){localStorage.setItem("token",JSON.stringify(t));var n=e(t);n&&(t.username=n)}else localStorage.removeItem("token");c(t)},authToken:a}}(),n=t.authToken,a=t.setAuthToken,c=Object(r.useState)(window.innerWidth),i=Object(j.a)(c,2),s=i[0],b=i[1],m=Object(r.useState)(!1),p=Object(j.a)(m,2),O=p[0],x=p[1],y=s<=768,A=Object(o.g)(),g=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),r=0;r<n.length;r++){var a=n[r].trim();if(a.substring(0,e.length+1)===e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t}("csrftoken"),k=Object(r.useState)(!1),F=Object(j.a)(k,2),I=F[0],w=F[1],S=Object(r.useState)(!1),C=Object(j.a)(S,2),M=C[0],N=C[1],T=Object(r.useState)("Default"),K=Object(j.a)(T,2),z=K[0],L=K[1],G=Object(r.useState)({lat:0,lng:0}),P=Object(j.a)(G,2),B=(P[0],P[1]),E=Object(r.useState)({}),H=Object(j.a)(E,2),V=H[0],R=H[1],U=Object(r.useState)({}),W=Object(j.a)(U,2),Y=W[0],q=W[1],J=Object(r.useState)({}),Z=Object(j.a)(J,2),Q=Z[0],X=Z[1],_=Object(r.useState)([]),$=Object(j.a)(_,2),ee=$[0],te=$[1],ne=Object(r.useState)({}),re=Object(j.a)(ne,2),ae=re[0],ie=re[1],se=Object(r.useState)({minDate:"",maxDate:""}),de=Object(j.a)(se,2),ue=de[0],je=de[1],be=Object(r.useState)({}),me=Object(j.a)(be,2),pe=me[0],Oe=me[1],ve=Object(r.useState)({visible:!1,position:{},isMobile:!1}),fe=Object(j.a)(ve,2),he=fe[0],xe=fe[1],ye=Object(r.useState)(!y),Ae=Object(j.a)(ye,2),ge=Ae[0],ke=Ae[1],Fe=Object(r.useState)(!1),Ie=Object(j.a)(Fe,2),we=Ie[0],Se=Ie[1],Ce=Object(r.useState)("filter"),Me=Object(j.a)(Ce,2),Ne=Me[0],Te=Me[1],Ke=Object(r.useState)(!1),ze=Object(j.a)(Ke,2),Le=ze[0],Ge=ze[1],De=Object(r.useState)(!1),Pe=Object(j.a)(De,2),Be=Pe[0],Ee=Pe[1],He=Object(r.useState)(!1),Ve=Object(j.a)(He,2),Re=Ve[0],Ue=Ve[1],We=Object(r.useState)(!1),Ye=Object(j.a)(We,2),qe=Ye[0],Je=Ye[1],Ze=(parseInt(A.accidentId,10),[]);function Qe(){b(window.innerWidth)}Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("http://127.0.0.1:8000/api/","dictionary/roadaccident/maneuvers"),e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,R(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("http://127.0.0.1:8000/api/","dictionary/roadaccident/typeviolations"),e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,q(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("http://127.0.0.1:8000/api/","dictionary/roadaccident/violators"),e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,X(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),t(),r();var a=document.cookie.split("; ").find((function(e){return e.startsWith("mapname=")}));return a&&L(a.split("=")[1]),n&&function(){var e={token:n.access},t="".concat("http://127.0.0.1:8000/api/","token/verify/"),r=new Headers;r.append("Content-type","application/json"),r.append("X-CSRFToken",g),fetch(t,{method:"POST",headers:r,body:JSON.stringify(e)}).then((function(e){e.status>=400?e.json().then((function(e){console.log(">= 400",e),$e(n.refresh)})):e.json().then((function(e){console.log("ok",e)}))}))}(),x(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)),window.addEventListener("resize",Qe),function(){window.removeEventListener("resize",Qe)}}),[]);var Xe=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a,c,i,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("http://127.0.0.1:8000/api/","roadaccident/").concat(A.cityName,"/accidents/"),e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,a="2100-01-01",c="1970-01-01",i=Object(l.a)(r.features);try{for(i.s();!(o=i.n()).done;)s=o.value,console.log(s),s.properties.datetime>c&&(c=s.properties.datetime),s.properties.datetime<a&&(a=s.properties.datetime)}catch(d){i.e(d)}finally{i.f()}je({minDate:a.slice(0,10),maxDate:c.slice(0,10)}),te(r);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function _e(e,t,r){var a=new Headers;a.append("Content-type","application/json"),a.append("X-CSRFToken",g),(null===n||void 0===n?void 0:n.access)&&a.append("Authorization","Bearer "+n.access),fetch(e,{method:t,headers:a,body:JSON.stringify(r)}).then((function(e){e.status>=400?e.json().then((function(t){alert(e.statusText+" ("+e.status+")\n\n"+t.detail)})):e.json().then((function(e){console.log(e),Xe(),xe({visible:!1,position:{}}),Te("filter"),Se(!1)}))}))}return Object(r.useEffect)((function(){var e=setInterval((function(){n&&$e(n.refresh)}),24e4);return function(){return clearInterval(e)}}),[n]),Object(r.useEffect)((function(){Xe()}),[A]),Object(f.jsxs)("div",{className:"main-wrapper",children:[Object(f.jsx)("div",{id:"app",children:Object(f.jsxs)("div",{className:"d-flex ".concat(ge?"showed":"hided"),id:"wrapper",children:[Object(f.jsx)(D,{onSubmitFilter:function(e){Ze=[],ie(e),y&&ke(!1)},onSubmitAccident:function(e){var t,n;console.log("onSubmitAccident",e),e.id?(n="".concat("http://127.0.0.1:8000/api/","roadaccident/").concat(A.cityName,"/accidents/").concat(e.id,"/"),t="PUT"):(n="".concat("http://127.0.0.1:8000/api/","roadaccident/").concat(A.cityName,"/accidents/"),t="POST"),_e(n,t,e),y&&ke(!1)},onDeleteAccident:function(e){_e("".concat("http://127.0.0.1:8000/api/","roadaccident/").concat(A.cityName,"/accidents/").concat(e,"/"),"DELETE")},onCloseAccident:function(){xe({visible:!1,position:{}}),Te("filter"),Se(!1)},minMaxDateData:ue,dataAccidentForm:pe,showAccidentTab:we,activeTabKey:Ne,setActiveTabKey:Te,newMarkerState:he,dictManeuvers:V,dictTypeViolations:Y,dictViolators:Q,currentCity:A.cityName}),Object(f.jsxs)("div",{id:"page-content-wrapper",children:[Object(f.jsx)(h,{currentCity:A.cityName,onClickShowMenu:function(){return ke(!ge)},authToken:n,setLoginModalShow:w,setAuthToken:a,appname:"roadaccident"}),Object(f.jsxs)("div",{className:"container-fluid",style:{paddingRight:"0px",paddingLeft:"0px"},children:[Object(f.jsx)(ce,{mapBaseLayerName:z,dataAccidents:ee,dataHeatmapPoints:Ze,currentCity:A.cityName,checkButtonNewMarker:Le,checkButtonHeatmap:Be,checkButtonGPS:Re,onClickNewMarker:function(e){Ge(e),O&&e&&(xe({visible:!0,position:{lat:0,lng:0}}),Je(!0))},onClickHeatmap:function(e){console.log("onClickHeatmap",e),L(e?"Dark":"Default"),Ee(e)},onClickGPS:function(e){Ue(e)},onClickMap:function(e){if(Le&&!O){Ge(!1);var t={lat:0,lng:0};t.lat=e.latlng.lat.toFixed(5),t.lng=e.latlng.lng.toFixed(5),xe({visible:!0,position:t}),Se(!0),Te("accident")}},onMarkerClick:function(e){console.log("makrer",e),Se(!0),Te("accident"),Oe(e),ke(!0)},newMarkerState:he,onDragEndNewMarker:function(e){},filterMapCallback:function(e,t){var n,r,a=!0,c=!0,i=!0,o=!0,l=!0,s=!0,d=!0,u=!0,j=!0,b=!0,m=!0,p=!0,O=!0,v=!0,f=!0,h=!0,x=!0,y=!0,A=!0;((r=null===ae||void 0===ae?void 0:ae.dateFromFilter)&&(a=e.properties.datetime.split("T")[0]>=r),(r=null===ae||void 0===ae?void 0:ae.dateToFilter)&&(c=e.properties.datetime.split("T")[0]<=r),(r=null===ae||void 0===ae||null===(n=ae.maneuverFilter)||void 0===n?void 0:n.value)&&(i=r===e.properties.maneuver),(r=null===ae||void 0===ae?void 0:ae.descFilter)&&-1===e.properties.description.toLowerCase().indexOf(r.toLowerCase())&&(o=!1),r=null===ae||void 0===ae?void 0:ae.violationsTypeFilter,Array.isArray(r))&&(l=r.filter((function(t){return e.properties.violations_type.includes(String(t.value))})).length>0);(r=null===ae||void 0===ae?void 0:ae.violatorsFilter,Array.isArray(r))&&(s=r.filter((function(t){return e.properties.violators.includes(String(t.value))})).length>0);(r=null===ae||void 0===ae?void 0:ae.driverInjuredFilter)&&(d=e.properties.drivers_injured>0),(r=null===ae||void 0===ae?void 0:ae.motorcyclistInjuredFilter)&&(u=e.properties.motorcyclists_injured>0),(r=null===ae||void 0===ae?void 0:ae.cyclistInjuredFilter)&&(j=e.properties.cyclists_injured>0),(r=null===ae||void 0===ae?void 0:ae.pedestrianInjuredFilter)&&(b=e.properties.ped_injured>0),(r=null===ae||void 0===ae?void 0:ae.kidsInjuredFilter)&&(m=e.properties.kids_injured>0),(r=null===ae||void 0===ae?void 0:ae.pubtrPassengersInjuredFilter)&&(p=e.properties.pubtr_passengers_injured>0),(r=null===ae||void 0===ae?void 0:ae.driversKilledFilter)&&(O=e.properties.drivers_killed>0),(r=null===ae||void 0===ae?void 0:ae.motorcyclistsKilledFilter)&&(v=e.properties.motorcyclists_killed>0),(r=null===ae||void 0===ae?void 0:ae.cyclistsKilledFilter)&&(f=e.properties.cyclists_killed>0),(r=null===ae||void 0===ae?void 0:ae.pedestrianKilledFilter)&&(h=e.properties.ped_killed>0),(r=null===ae||void 0===ae?void 0:ae.kidsKilledFilter)&&(x=e.properties.kids_killed>0),(r=null===ae||void 0===ae?void 0:ae.pubtrPassengersKilledFilter)&&(y=e.properties.pubtr_passengers_killed>0),(r=null===ae||void 0===ae?void 0:ae.publicTransportInvolvedFilter)&&(A=e.properties.public_transport_involved>0);var g=a&&c&&i&&o&&l&&s&&d&&u&&j&&b&&m&&p&&O&&v&&f&&h&&x&&y&&A&&!0;return g&&Ze.push([e.properties.latitude,e.properties.longitude,.1]),g},onBaselayerchange:function(e){document.cookie="mapname="+e.name},setNewMarkerState:xe,isMobileDevice:O,showOkCancelMobileMarker:qe,setMapCurrentLatLng:B,setCheckButtonGPS:Ue,showSidebar:ge}),qe&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v.a,{variant:"success",id:"doneEditMarkerMobile",onClick:function(){Ge(!1),Je(!1),Se(!0),Te("accident"),ke(!0)},children:"\u0413\u043e\u0442\u043e\u0432\u043e"})," ",Object(f.jsx)(v.a,{variant:"secondary",id:"cancelMarkerMobile",onClick:function(){xe({visible:!1,position:{lat:0,lng:0}}),Je(!1),Ge(!1)},children:"\u2715"})," "]})]})]})]})}),Object(f.jsx)(oe,{setAuthToken:a,show:I,setLoginModalShow:w,setRegisterModalShow:N,onHide:function(){return w(!1)}}),Object(f.jsx)(le,{setAuthToken:a,show:M,setRegisterModalShow:N,setLoginModalShow:w,onHide:function(){return N(!1)}})]});function $e(e){var t=new Headers;t.append("Content-type","application/json"),t.append("X-CSRFToken",g),fetch("".concat("http://127.0.0.1:8000/api/","token/refresh/"),{method:"POST",headers:t,body:JSON.stringify({refresh:e})}).then((function(e){200==e.status?e.json().then((function(e){a(e)})):e.status>=400&&a(null)}))}},de=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,183)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};n(165);c.a.render(Object(f.jsx)(i.a,{basename:"/roadaccident",children:Object(f.jsx)(o.c,{children:Object(f.jsx)(o.a,{path:"/",element:Object(f.jsx)(se,{}),children:Object(f.jsx)(o.a,{path:":cityName",element:Object(f.jsx)(se,{}),children:Object(f.jsx)(o.a,{path:":accidentId",element:Object(f.jsx)(se,{})})})})})}),document.getElementById("root")),de()}},[[166,1,2]]]);
//# sourceMappingURL=main.2705195d.chunk.js.map