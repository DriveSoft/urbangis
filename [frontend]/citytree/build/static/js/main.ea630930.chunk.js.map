{"version":3,"sources":["actions/index.js","components_hl/MenuGlobal.tsx","components_hl/ButtonMap.js","components_hl/MapTileLayers.tsx","components_hl/Map.tsx","components/images/markers/marker-red.png","components/images/markers/marker-shadow.png","components/MainWrapper.tsx","components/Sidebar.tsx","components/ButtonOkCancelMobileMarker.tsx","components/FormFilter.tsx","components/TableList.tsx","components/ImageS3Upload/ImageS3Upload.tsx","components/InspectionsList.tsx","components/ImageS3Upload/delete2.svg","components/ImageS3Upload/index.tsx","components/images/no-photo.png","components/UploadPhotos.tsx","components/FormTree.tsx","components/FormInspection.tsx","components/ImageSlider.tsx","components/TreePreviewModal.tsx","constants/const.ts","utils/misc.ts","constants/urlsAPI.ts","auth/useAuthToken.tsx","components/LoginModalForm.tsx","components/RegisterModalForm.tsx","utils/filterDataMap.ts","utils/fetchAllDictionariesData.ts","i18nextConf.js","auth/permissions.ts","App.tsx","reportWebVitals.js","reducers/userInterface.tsx","reducers/dataApp.tsx","reducers/index.ts","index.js"],"names":["actNewTreeCreation","value","type","payload","actShowSidebar","actShowTreeTab","actShowInspTab","actActiveTabKey","actLoginModalShow","actRegisterModalShow","actMapBaseLayerName","actMapMarkerState","actShowOkCancelMobileMarker","actCheckButtonNewMarker","actCheckButtonGPS","actDataPermissions","actDataTrees","MenuGlobal","currentCity","appname","authToken","setAuthToken","dispatch","useDispatch","rxShowSidebar","useSelector","state","uiReducer","showSidebar","useState","expanded","setExpanded","cities","setCities","useTranslation","t","i18n","changeLanguage","useEffect","fetchCities","a","fetch","process","res","json","data","console","log","Navbar","bg","expand","collapseOnSelect","Container","Button","className","variant","id","onClick","Toggle","Collapse","Nav","Link","href","NavDropdown","title","Item","active","map","city","as","to","sysname","cityname","language","user","name","ButtonMap_","iconTrue","iconFalse","L","easyButton","position","states","stateName","icon","control","button","style","backgroundColor","addTo","MapTileLayers","heatMapLayer","setView_nTimes_gps","circle_geolocation","mapBaseLayerName","LayersControl","BaseLayer","checked","TileLayer","attribution","url","accessToken","maxZoom","tileSize","zoomOffset","subdomains","bingkey","redIcon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","currentCitySysname","Map","mainData","dataHeatmapPoints","onDragEndNewMarker","onClickMap","onZoomEnd","onClickCreateNewMarker","onEachLayer","pointToLayerCallback","filterMapCallback","rxMapBaseLayerName","rxIsMobileDevice","isMobileDevice","rxMapMarkerState","mapMarkerState","rxShowOkCancelMobileMarker","showOkCancelMobileMarker","rxCheckButtonNewMarker","checkButtonNewMarker","rxCheckButtonHeatmap","checkButtonHeatmap","rxCheckButtonGPS","checkButtonGPS","currentCityInfo","setCurrentCityInfo","setMap","currentZoom","setCurrentZoom","buttonNewMarker","setButtonNewMarker","buttonHeatmap","setButtonHeatmap","buttonGPS","setButtonGPS","mapname_","document","cookie","split","find","row","startsWith","newMarkerRef","useRef","onClickNewMarker","onClickHeatmap","onClickGPS","remove","fetchCity","DomUtil","addClass","_container","removeClass","window","setTimeout","invalidateSize","pan","visible","lat","lng","SetPanToMap","useMap","panTo","parseFloat","locate","enableHighAccuracy","watch","maximumAge","stopLocate","hasLayer","removeLayer","NewMarker","eventHandlers","useMemo","dragend","current","marker","LatLng","getLatLng","coord","toFixed","time","Promise","resolve","then","Marker","draggable","getCenter","ref","MapEvents","useMapEvents","baselayerchange","e","move","setLatLng","target","moveend","click","zoomend","_zoom","locationfound","radius","accuracy","setView","latlng","setRadius","circle","locationerror","alert","message","MarkersZoomAdjustment","zoom","getZoom","eachLayer","layer","onEachFeaturePoint","feature","myTag","HeatmapFunction","heatLayer","gradient","max","blur","addLayer","MapContainer","whenCreated","center","zoomControl","scrollWheelZoom","height","width","GeoJSON","pointToLayer","filter","onEachFeature","dateTimeGenerated","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","iconCreateFunction","cluster","digits","count","getChildCount","divIcon","html","toString","undefined","ZoomControl","MainWrapper","children","cityName","Sidebar","marginTop","ButtonOkCancelMobileMarker","FormFilter","onSubmitFilter","rxDictSpecieses","dataReducer","dictSpecieses","rxDictStatuses","dictStatuses","rxDictCareTypes","dictCareTypes","rxDictRemarks","dictRemarks","rxDictPlaceTypes","dictPlaceTypes","rxDictIrrigationMethods","dictIrrigationMethods","rxDictGroupSpecs","dictGroupSpec","useForm","reValidateMode","defaultValues","speciesFilter","statusFilter","careTypeFilter","remarkFilter","placeTypeFilter","irrigationMethodFilter","datePlantedFromFilter","datePlantedToFilter","dateAddedFromFilter","dateAddedToFilter","commentFilter","heightFromFilter","trunkGirthFromFilter","crownDiameterFromFilter","heightToFilter","trunkGirthToFilter","crownDiameterToFilter","showMyTreesFilter","handleSubmit","reset","optionsSpeciesesFilter","Array","isArray","unknownTreeItem","itemGroup","label","groupname","options","spec","groupspec","localname","speciesname","typespec","unshift","optionsStatusesFilter","x","statusname","optionsCareTypesFilter","carename","optionsRemarksFilter","remarkname","optionsPlaceTypesFilter","placename","optionsIrrigationMethodsFilter","irrigationname","customStyles","option","styles","paddingLeft","Option","props","color","Form","onSubmit","Group","controlId","Label","render","field","placeholder","isMulti","isSearchable","getOptionLabel","components","maxMenuHeight","Row","Col","minWidth","isClearable","Control","maxWidth","size","min","Check","inline","TableList","stateComponent","columns","sortField","sortAsc","OnClickButtons","sortState","setSortState","dataTable","setDataTable","columnsHeader","item","index","cursor","sortable","float","textAlign","headerName","fontSize","DataTable","sortedData","sort","b","length","DataRow","indexRow","colSpan","getUniqKey","String","col","dateTimeOption","Date","toLocaleDateString","toLocaleTimeString","dateTime","buttons","buttonRow","forEach","text","iconFA","idButton","buttonText","iconFASize","push","Table","striped","bordered","hover","InspectionsList","inspectionsData","setInspectionsData","rxDataLastEditetTreeId","dataLastEditedTreeId","fetchInpections","idTree","element","photo1","photo2","photo3","typeData","treeId","rowData","onClickButtonEditInsp","onClickButtonPhotosInsp","defaultResizingOptions","enabled","autoResize","maxHeight","compressFormat","quality","rotation","ImageS3Upload","forwardRef","signingUrl","autoUpload","emptyPhoto","serverPhoto","onChange","buttonCaption","resizer","onFinish","onProgress","onError","onSignedUrl","useImperativeHandle","uploadFile","inputFileEl","files","status","resizing","startUpload","none","setStatus","imagePhoto","setImagePhoto","compressedPhoto","setCompressedPhoto","buttonCaptionState","setButtonCaptionState","showSpinner","setShowSpinner","s3DataState","setS3DataState","notLoad","setNotLoad","fields","key","slice","resizeFile","file","Resizer","imageFileResizer","uri","onChangeFile","event","URL","createObjectURL","image","Blob","resized","error","fetchUrlSign","objectName","myHeaders","Headers","append","bodyObject","method","headers","body","JSON","stringify","parse","updateProgress","ev","lengthComputable","percentComplete","Math","round","loaded","total","s3Data","xhr","XMLHttpRequest","open","timeout","upload","onprogress","postData","FormData","onreadystatechange","readyState","onload","onerror","send","filename","replace","signedUrl","file_exists","rndStr","makeRandomStr","Image","src","fluid","rounded","deleteImage","top","right","Spinner","animation","role","accept","display","result","characters","charactersLength","i","charAt","floor","random","UploadPhotos","controlFromUseForm","signingS3Url","onCallbackDone","photo1Ref","photo2Ref","photo3Ref","uploadedPhoto1","setUploadedPhoto1","uploadedPhoto2","setUploadedPhoto2","uploadedPhoto3","setUploadedPhoto3","resizerOptions","uploadPhotos","p1","p2","p3","onFinishPhoto1","onFinishPhoto2","onFinishPhoto3","xs","noPhotoImage","FormTree","onSubmitTree","onDeleteTree","onCloseTree","onNewInsp","onClickInspEdit","onClickInspPhotos","onClickEditCoords","dataTreeForm","rxNewTreeCreation","newTreeCreation","showModalDelete","setShowModalDelete","uploadPhotosRef","setValue","optionsIrrigationMethodsData","formData","latitude","longitude","species","species_id","isFound","optionsSpeciesesData","category","speciescomment","comment","placetype","optionsPlaceTypesData","irrigationmethod","dateplanted","googlestreeturl","keepDefaultValues","optionsStatusesData","optionsCareTypesData","optionsRemarksData","crowndiameter","trunkgirth","remarks","recommendations","useradded","getValues","errors","formState","trigger","preventDefault","prepareOnSubmitTree","inspection","parseInt","isSelected","isFocused","isDisabled","rules","required","step","isInvalid","Feedback","rows","pattern","Modal","show","onHide","Header","closeButton","Title","Body","Footer","FormInspection","onSubmitInsp","onDeleteInsp","onCloseInsp","dataInspForm","isValid","tree","includes","prepareOnSubmitInsp","photoServer","ImageSlider","setVisible","images","dialogClassName","Carousel","interval","photo","RowTable","isValueIsLink","dateTimeToDate","dateTimeStr","arDateTime","toISOString","TreePreviewModal","setTreePreview","onButtonEditTreeClick","handleClose","photos","isPrevNextControlsEnable","numberOfPhotos","lastinsp_photo1","lastinsp_photo2","lastinsp_photo3","itemPhoto","photoIndex","photoKeyName","hasOwnProperty","alt","controls","lastinsp_status","lastinsp_height","lastinsp_trunkgirth","lastinsp_crowndiameter","lastinsp_remarks","lastinsp_recommendations","inspData","csrftoken","cookieValue","cookies","trim","substring","decodeURIComponent","getCookie","fetchUrl2","tokenAccess","getHTTPHeader","fetchResult","ok","fetchException","statusText","detail","this","URL_LOGIN","URL_REFRESH_TOKEN","URL_VERIFY_TOKEN","URL_GET_PERMISSIONS","URL_GENERATE_S3_URLKEY","URL_GET_DICT_SPECIESES","URL_GET_DICT_CARETYPES","URL_GET_DICT_REMARKS","URL_GET_DICT_PLACETYPES","URL_GET_DICT_IRRIGATIONMETHODS","URL_GET_DICT_GROUPSPECS","URL_GET_DICT_TYPESPECS","URL_GET_DICT_STATUSES","urlTreesByCity","urlTreeByCityAndID","checkAuthToken","access","isTokenValid","refreshTokens","refresh","urlCheckingToken","token","refreshToken","getNewAccessRefreshAuthToken","accessRefreshToken","urlRefreshingToken","response","LoginModalForm","rxLoginModalShow","loginModalShow","showWrongPassword","setShowWrongPassword","username","password","rememberme","credentials","centered","localStorage","setItem","loginUser","FloatingLabel","Text","RegisterModalForm","rxRegisterModalShow","registerModalShow","email","password2","first_name","last_name","setError","Object","entries","registerUser","isFoundArrayInValue","array","isFoundArrayInArray","arraySearch","arrayTree","fetchAllDictionariesData","all","fetchData","speciesesResponse","caretypesResponse","remarksResponse","placetypesResponse","irrigationmethodsResponse","groupspecsResponse","typespecsResponse","specieses","caretypes","placetypes","irrigationmethods","groupspecs","typespecs","apiURL","use","LanguageDetector","initReactI18next","init","resources","en","translation","translationEN","translationBG","fallbackLng","interpolation","escapeValue","initPermissions","is_superuser","view_tree","granted","deniedMessage","i18next","add_tree","change_tree","can_change_not_own_tree_record","can_delete_not_own_tree_record","delete_tree","view_inspection","add_inspection","change_inspection","can_change_not_own_insp_record","can_delete_not_own_insp_record","delete_inspection","careactivity","view_careactivity","has_perm","permObject","model","permName","getCurrentUserPermissions","initPermissionsRes","currentPermissions","citytree","arrayPerms","perm","geojsonMarkerOptions_citytree","fillColor","weight","opacity","fillOpacity","App","paramsRouter","useParams","rxDataPermissions","dataPermissions","rxDataTrees","dataTrees","rxDataFilters","dataFilters","rxActiveTabKey","activeTabKey","rxShowTreeTab","showTreeTab","rxShowInspTab","showInspTab","currentZoomMap","setCurrentZoomMap","tokenString","getItem","sessionStorage","getUserInfoFromToken","getToken","arToken","atob","user_id","userToken","removeItem","useAuthToken","innerWidth","screenWidth","setScreenWidth","isMobileView","setDataTreeForm","setDataInspForm","imageSlider","setImageSlider","treePreview","fetchAllDictionariesDataWrapper","userAuthentication","test","navigator","userAgent","addEventListener","handleWindowSizeChange","removeEventListener","actDictCareTypes","actDictRemarks","actDictPlaceTypes","actDictIrrigationMethods","actDictGroupSpecs","actDictTypeSpecs","catch","fetchTreesAndStatuses","now","markerOnClick","geojson","toGeoJSON","properties","showTreePreview","setInterval","keys","permResult","clearInterval","fetchTreeData","editTree","updateInspectionListsWithSpecificTreeId","ZoomToRadius","r","Tabs","activeKey","onSelect","k","Tab","eventKey","tabClassName","paddingRight","hexcolor","on","valueFilter","objectSearchResult","plantedDateFrom","plantedDateTo","addedDateFrom","addedDateTo","heightFrom","heightTo","trunkGirthFrom","trunkGirthTo","crownDiameterFrom","crownDiameterTo","showOnlyMyTrees","datetimeadded","toLowerCase","indexOf","el","filterDataMap","dot","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initialState","isMobile","action","dictTypeSpec","allReducers","combineReducers","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","StrictMode","basename","path","getElementById"],"mappings":"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","file":"static/js/main.ea630930.chunk.js","sourcesContent":["// userInterface actions ================================================\r\nexport const actNewTreeCreation= (value) => {\r\n    return {\r\n        type: 'NEWTREECREATION',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowSidebar = (value) => {\r\n    return {\r\n        type: 'SHOWSIDEBAR',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowTreeTab = (value) => {\r\n    return {\r\n        type: 'SHOWTREETAB',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowInspTab = (value) => {\r\n    return {\r\n        type: 'SHOWINSPTAB',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actActiveTabKey = (value) => {\r\n    return {\r\n        type: 'ACTIVETABKEY',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actLoginModalShow = (value) => {\r\n    return {\r\n        type: 'LOGINMODALSHOW',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actRegisterModalShow = (value) => {\r\n    return {\r\n        type: 'REGISTERMODALSHOW',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const actMapBaseLayerName = (value) => {\r\n    return {\r\n        type: 'MAPBASELAYERNAME',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actMapMarkerState = (value) => {\r\n    return {\r\n        type: 'MAPMARKERSTATE',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowOkCancelMobileMarker = (value) => {\r\n    return {\r\n        type: 'SHOWOKCANCELMOBILEMARKER',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actCheckButtonNewMarker = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONNEWMARKER',\r\n        payload: value\r\n    }\r\n}\r\nexport const actCheckButtonHeatmap = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONHEATMAP',\r\n        payload: value\r\n    }\r\n}\r\nexport const actCheckButtonGPS = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONGPS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actIsMobileDevice = (value) => {\r\n    return {\r\n        type: 'ISMOBILEDEVICE',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// date actions ================================================\r\nexport const actDataPermissions= (value) => {\r\n    return {\r\n        type: 'DATAPERMISSIONS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDataTrees= (value) => {\r\n    return {\r\n        type: 'DATATREES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDataLastEditedTreeId= (value) => {\r\n    return {\r\n        type: 'DATALASTEDITEDTREEID',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictStatuses = (value) => {\r\n    return {\r\n        type: 'DICTSTATUSES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictSpecieses = (value) => {\r\n    return {\r\n        type: 'DICTSPECIESES',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\nexport const actDictCareTypes = (value) => {\r\n    return {\r\n        type: 'DICTCARETYPES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictRemarks = (value) => {\r\n    return {\r\n        type: 'DICTREMARKS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictPlaceTypes = (value) => {\r\n    return {\r\n        type: 'DICTPLACETYPES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictIrrigationMethods = (value) => {\r\n    return {\r\n        type: 'DICTIRRIGATIONMETHODS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictGroupSpecs = (value) => {\r\n    return {\r\n        type: 'DICTGROUPSPECS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictTypeSpecs = (value) => {\r\n    return {\r\n        type: 'DICTTYPESPECS',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const actDataFilters = (value) => {\r\n    return {\r\n        type: 'DATAFILTERS',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n","import { useState, useEffect } from 'react'\r\nimport Container from 'react-bootstrap/Container';\r\nimport Navbar from 'react-bootstrap/Navbar'\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport NavDropdown from 'react-bootstrap/NavDropdown';\r\nimport Button from 'react-bootstrap/Button';\r\nimport { Link } from \"react-router-dom\";\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { actLoginModalShow, actShowSidebar } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\ninterface IStateCities {\r\n\tcities: {\r\n\t\tid: number\r\n\t\tsysname: string;\r\n\t\tcityname: string;\r\n\t\tlatitude: number;\r\n\t\tlongitude: number;\r\n\t\tpopulation: number;\r\n\t}[]\r\n}\r\n\r\ninterface MenuGlobalProps {\r\n\tcurrentCity: string;\r\n\tappname: string;\r\n\tauthToken: any;\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n  }\r\n\r\n\r\n\r\nfunction MenuGlobal({\r\n\tcurrentCity,\r\n\tappname,\r\n\tauthToken,\r\n\tsetAuthToken,\r\n}: MenuGlobalProps) {\r\n\tconst dispatch = useDispatch();\r\n\tconst rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar)\r\n\tconst [expanded, setExpanded] = useState(false);\r\n\tconst [cities, setCities] = useState<IStateCities['cities']>([]);\r\n\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tconst fetchCities = async () => {\r\n\t\t\tconst res = await fetch(`${process.env.REACT_APP_API_URL}cities/`);\r\n\t\t\tconst data = await res.json();\r\n\t\t\tsetCities(data);\r\n\t\t\tconsole.log(data);\r\n\t\t};\r\n\r\n\t\tfetchCities();\r\n\t}, []);\r\n\r\n\tfunction changeLanguage(value: string) {\r\n\t\ti18n.changeLanguage(value);\r\n\t\t//localStorage.setItem('lng', value)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Navbar bg=\"light\" expand=\"lg\" expanded={expanded} collapseOnSelect >\r\n\t\t\t<Container>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tclassName=\"start-0\"\r\n\t\t\t\t\tvariant=\"outline-primary\"\r\n\t\t\t\t\tid=\"menu-toggle\"\r\n\t\t\t\t\t//onClick={onClickShowMenu}\r\n\t\t\t\t\tonClick={() => dispatch(actShowSidebar(!rxShowSidebar))}\r\n\t\t\t\t>\r\n\t\t\t\t\t{t<string>(\"menu.menu\")}\r\n\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t<Navbar.Toggle aria-controls=\"basic-navbar-nav\" onClick={() => setExpanded(!expanded)} />\r\n\t\t\t\t<Navbar.Collapse id=\"basic-navbar-nav\">\r\n\t\t\t\t\t<Nav className=\"ms-auto\">\r\n\t\t\t\t\t\t<Nav.Link href=\"/\">{t<string>(\"menu.home\")}</Nav.Link>\r\n\r\n\t\t\t\t\t\t<NavDropdown\r\n\t\t\t\t\t\t\ttitle={t<string>(\"menu.appMaps.title\")}\r\n\t\t\t\t\t\t\tid=\"basic-nav-dropdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/roadaccident/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"roadaccident\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.roadaccident\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/citytree/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"citytree\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.citytree\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/urbanobject/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"3\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"urbanobject\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.urbanobject\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown\r\n\t\t\t\t\t\t\ttitle={t<string>(\"menu.city\")}\r\n\t\t\t\t\t\t\tid=\"basic-nav-dropdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{cities.map((city) => (\r\n\t\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\t\tas={Link}\r\n\t\t\t\t\t\t\t\t\tkey={city.id}\r\n\t\t\t\t\t\t\t\t\tto={`/${city.sysname}`}\r\n\t\t\t\t\t\t\t\t\tactive={currentCity === city.sysname}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{city.cityname}\r\n\t\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown title=\"Lang\" id=\"basic-nav-dropdown\">\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\"en\" === i18n.language ||\r\n\t\t\t\t\t\t\t\t\t\"en-US\" === i18n.language ||\r\n\t\t\t\t\t\t\t\t\t\"en-GB\" === i18n.language\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvalue=\"en\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage(\"en\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEnglish\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={\"bg\" === i18n.language}\r\n\t\t\t\t\t\t\t\tvalue=\"bg\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage(\"bg\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tBulgarian\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t{authToken ? (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Nav.Link>\r\n\t\t\t\t\t\t\t\t\t{`${t(\"words.hello\")}, ${\r\n\t\t\t\t\t\t\t\t\t\tauthToken?.user?.name\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\r\n\t\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetAuthToken(null);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{t<string>(\"menu.logout\")}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t//onClick={() => setLoginModalShow(true)}\r\n\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(true))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.signin\")}\r\n\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Nav>\r\n\t\t\t\t</Navbar.Collapse>\r\n\t\t\t</Container>\r\n\t\t</Navbar>\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default MenuGlobal\r\n","// don't work with TypeScript, error: TypeError: leaflet__WEBPACK_IMPORTED_MODULE_0___default.a.easyButton is not a function\r\nimport L from 'leaflet';\r\nimport easyButton from 'leaflet-easybutton'\r\nimport \"leaflet-easybutton/src/easy-button.css\"\r\nimport \"@fortawesome/fontawesome-free/css/all.min.css\" \r\n \r\n\r\nfunction ButtonMap_ (map, iconTrue, iconFalse, onClick) {\r\n    //const map = useMap()\r\n    \r\n            const buttonMap = L.easyButton({\r\n                position: 'topright',\r\n                states:[\r\n                    {\r\n                        title: '',\r\n                        stateName: 'off',\r\n                        icon: `<i class=\"${iconTrue}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('on');\r\n                            //@ts-ignore\r\n                            control.button.style.backgroundColor = 'red';\r\n                            onClick(true)\r\n                        }\r\n                    },\r\n        \r\n                    {\r\n                        title: '',\r\n                        stateName: 'on',\r\n                        icon: `<i class=\"${iconFalse}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('off');\r\n                            //@ts-ignore\r\n                            control.button.style.backgroundColor = 'white';\r\n                            onClick(false)\r\n                        }\r\n                    }]\r\n            }).addTo( map );\r\n\r\n\r\n\r\n            //if (checkButtonState) {\r\n            //    buttonMap.state('on');\r\n            //    buttonMap.button.style.backgroundColor = 'red';\r\n            //} else {\r\n            //    buttonMap.state('off');\r\n            //    buttonMap.button.style.backgroundColor = 'white';            \r\n            //}\r\n            \r\n            \r\n    \r\n    return buttonMap\r\n\r\n}\r\n\r\nexport default ButtonMap_\r\n","import React from \"react\"\r\nimport { LayersControl, TileLayer } from \"react-leaflet\"\r\n//@ts-ignore\r\nimport {BingLayer} from 'react-leaflet-bing-v2/src/index'\r\n\r\n\r\ninterface MapTileLayersProps {\r\n\tmapBaseLayerName: string;\r\n}\r\n\r\nfunction MapTileLayers({ mapBaseLayerName }: MapTileLayersProps) {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Default\"}\r\n\t\t\t\tname=\"Default\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/streets-v11\"\r\n\t\t\t\t\tmaxZoom={21}\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Dark\"}\r\n\t\t\t\tname=\"Dark\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/dark-v10\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Google\"}\r\n\t\t\t\tname=\"Google\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat1\"}\r\n\t\t\t\tname=\"Sat1\"\r\n\t\t\t>\r\n                <BingLayer  bingkey={'AniAD3xsGTaSbK1pa0_UkWS1CldG0nGI7r55MlVZqHhyKil9rD9dFK8536u8hTj1'} type=\"Aerial\"/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n            \r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat2\"}\r\n\t\t\t\tname=\"Sat2\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat3\"}\r\n\t\t\t\tname=\"Sat3\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Tiles &copy; Esri'\r\n\t\t\t\t\turl=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\r\n                    maxZoom={19}                    \r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat4\"}\r\n\t\t\t\tname=\"Sat4\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/satellite-v9\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tmaxZoom={21}\r\n                    zoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default MapTileLayers;\r\n","import { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { MapContainer, LayersControl, TileLayer, ZoomControl, useMapEvents, GeoJSON, useMap, Marker, Popup } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport \"leaflet.heat\";\r\nimport \"./Map.css\";\r\n\r\n//import ButtonMap from './ButtonMap'\r\nimport ButtonMap_ from './ButtonMap';\r\nimport MapTileLayers from '../components_hl/MapTileLayers';\r\n\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport redIconFile from '../components/images/markers/marker-red.png';\r\nimport redIconShadowFile from '../components/images/markers/marker-shadow.png';\r\n\r\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\r\nimport 'react-leaflet-markercluster/dist/styles.min.css'; // sass\r\n//require('leaflet/dist/leaflet.css'); // inside .js file\r\n//require('react-leaflet-markercluster/dist/styles.min.css'); // inside .js file\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport {\r\n\tactCheckButtonGPS,\r\n\tactCheckButtonHeatmap,\r\n\tactCheckButtonNewMarker,\r\n\tactMapBaseLayerName,\r\n\tactMapMarkerState,\r\n\tactShowOkCancelMobileMarker\r\n    //actShowAccidentTab,\r\n    //actActiveTabKey\r\n} from \"../actions\";\r\nimport { RootState } from '../reducers/index';\r\nimport { ScriptElementKindModifier } from 'typescript';\r\n\r\n// fix disapeared marker from map\r\n\r\n//import icon from 'leaflet/dist/images/marker-icon.png';\r\n//import iconShadow from 'leaflet/dist/images/marker-shadow.png';\r\n//let DefaultIcon = L.icon({\r\n//    iconAnchor: [12, 40],\r\n//    iconUrl: icon,\r\n//    shadowUrl: iconShadow\r\n//});\r\n//L.Marker.prototype.options.icon = DefaultIcon;\r\n\r\n\r\n\r\n\r\n\r\nlet redIcon = L.icon({ \r\n    iconUrl: redIconFile,\r\n    shadowUrl: redIconShadowFile,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41]\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//let buttonNewMarker = null\r\n//let buttonHeatmap = null\r\n//let buttonGPS = null\r\n\r\nlet currentCitySysname = ''\r\n\r\nlet heatMapLayer: any;\r\nlet markersLayer\r\n\r\nlet setView_nTimes_gps: number;\r\nlet circle_geolocation: L.Circle<any>;\r\n\r\n\r\n\r\n\r\n\r\ninterface IStateCurrentCity {\r\n    id: number\r\n\tsysname: string;\r\n\tcityname: string;\r\n\tlatitude: string;\r\n\tlongitude: string;\r\n\tpopulation: number;\t\r\n    zoom: number;\r\n}\r\n\r\ninterface MapProps {\r\n    mainData: any;\r\n    appname: string;\r\n    dataHeatmapPoints: number[][]; // [[lat, lng, value],[lat, lng, value]...]\r\n    currentCity: string;\r\n    onDragEndNewMarker: (LatLng: {lat: number; lng: number}) => void;\r\n    onClickMap: (e: any) => void;\r\n    onClickCreateNewMarker?: (state: boolean) => boolean | void;\r\n    onZoomEnd?: (e: any) => void;\r\n    onEachLayer?: (layer: L.Layer, zoom: number) => void;\r\n    //onMarkerClick: (data: any) => void;\r\n    pointToLayerCallback: (feature: any, latlng: L.LatLng) => any;\r\n    filterMapCallback: (feature: any) => boolean;\r\n}\r\n\r\nfunction Map ({\r\n                mainData,  \r\n                appname,          \r\n                dataHeatmapPoints, \r\n                currentCity,                 \r\n                onDragEndNewMarker, \r\n                onClickMap, \r\n                onClickCreateNewMarker,\r\n                onZoomEnd,  \r\n                onEachLayer,                            \r\n                //onMarkerClick,                 \r\n                pointToLayerCallback,\r\n                filterMapCallback               \r\n            }: MapProps) {\r\n               \r\n\r\n    const dispatch = useDispatch()\r\n    //const defaultZoom = 13;\r\n    //const rxDataAccidents = useSelector((state: RootState) => state.dataReducer.dataAccidents)\r\n    \r\n    const rxMapBaseLayerName = useSelector((state: RootState) => state.uiReducer.mapBaseLayerName);\r\n    const rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\r\n    const rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\r\n    const rxMapMarkerState = useSelector((state: RootState) => state.uiReducer.mapMarkerState);\r\n    const rxShowOkCancelMobileMarker = useSelector((state: RootState) => state.uiReducer.showOkCancelMobileMarker);\r\n    \r\n    const rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\r\n    const rxCheckButtonHeatmap = useSelector((state: RootState) => state.uiReducer.checkButtonHeatmap);\r\n    const rxCheckButtonGPS = useSelector((state: RootState) => state.uiReducer.checkButtonGPS);\r\n\r\n    //const [currentCityInfo, setCurrentCityInfo] = useState({latitude: \"0\", longitude: \"0\"})\r\n    const [currentCityInfo, setCurrentCityInfo] = useState<IStateCurrentCity | null>(null);\r\n    const [map, setMap] = useState<any>(null);  \r\n    \r\n    const [currentZoom, setCurrentZoom] = useState(13); \r\n\r\n    const [buttonNewMarker, setButtonNewMarker] = useState<any>(null);\r\n    const [buttonHeatmap, setButtonHeatmap] = useState<any>(null);\r\n    const [buttonGPS, setButtonGPS] = useState<any>(null);    \r\n\r\n    let mapname_ = document.cookie\r\n    .split('; ')\r\n    .find(row => row.startsWith('mapname='))\r\n\r\n    let mapname\r\n    if (mapname_) {\r\n        mapname = mapname_.split('=')[1]    \r\n    }\r\n\r\n\r\n    let newMarkerRef = useRef(null)   \r\n \r\n\r\n    // create buttons\r\n    useEffect(() => {        \r\n        if (map) {            \r\n            setButtonNewMarker( ButtonMap_(map, 'fas fa-map-marker-alt fa-lg', 'fas fa-map-marker-alt fa-lg', onClickNewMarker) )\r\n            setButtonHeatmap( ButtonMap_(map, 'fas fa-eye fa-lg', 'fas fa-eye-slash fa-lg', onClickHeatmap) )\r\n            setButtonGPS( ButtonMap_(map, 'fas fa-satellite-dish fa-lg', 'fas fa-satellite-dish fa-lg', onClickGPS) )\r\n            \r\n            //setMapCurrentLatLng({lat: map.getCenter().lat, lng: map.getCenter().lng})                        \r\n\r\n            let mapname_ = document.cookie\r\n\t\t\t.split(\"; \")\r\n\t\t\t.find((row) => row.startsWith(\"mapname=\"));\r\n\r\n\t\t    if (mapname_) {\r\n                dispatch(actMapBaseLayerName(mapname_.split(\"=\")[1]))\r\n\t\t    }            \r\n        }        \r\n\r\n        return () => { \r\n            buttonNewMarker && buttonNewMarker.remove()\r\n            buttonHeatmap && buttonHeatmap.remove()\r\n            buttonGPS && buttonGPS.remove()\r\n        }  \r\n\r\n\r\n      }, [map])  //<MapContainer whenCreated={setMap} ...\r\n\r\n\r\n    // load data for the city\r\n    useEffect(() => {\r\n\r\n        const fetchCity = async () => {\r\n            const res = await fetch(`${process.env.REACT_APP_API_URL}cities/${currentCity}`);\r\n            const data = await res.json();\r\n            setCurrentCityInfo(data);          \r\n        }\r\n\r\n        fetchCity();\r\n        console.log('currentCity');\r\n           \r\n    }, [currentCity])  //[currentCity]\r\n   \r\n\r\n    \r\n\r\n      // apply states for buttons\r\n      \r\n      useEffect(() => {        \r\n        if (buttonNewMarker) {\r\n            if (rxCheckButtonNewMarker) {\r\n                buttonNewMarker.state('on');\r\n                buttonNewMarker.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonNewMarker.state('off');\r\n                buttonNewMarker.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonNewMarker]);\r\n\r\n      useEffect(() => {        \r\n        if (buttonHeatmap) {\r\n            if (rxCheckButtonHeatmap) {\r\n                buttonHeatmap.state('on');\r\n                buttonHeatmap.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonHeatmap.state('off');\r\n                buttonHeatmap.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonHeatmap])\r\n      useEffect(() => {        \r\n        if (buttonGPS) {\r\n            if (rxCheckButtonGPS) {\r\n                buttonGPS.state('on');\r\n                buttonGPS.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonGPS.state('off');\r\n                buttonGPS.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonGPS])      \r\n\r\n\r\n    \r\n    useEffect(()=>{\r\n        if (map && !rxIsMobileDevice) {\r\n            if (rxCheckButtonNewMarker) {\r\n                L.DomUtil.addClass(map._container,'crosshair-cursor-enabled');\r\n            } else {\r\n                L.DomUtil.removeClass(map._container,'crosshair-cursor-enabled');\r\n            }    \r\n        }\r\n    }, [rxCheckButtonNewMarker]); \r\n      \r\n\r\n\r\n    useEffect(()=>{\r\n        if (map) {\r\n            window.setTimeout(function(){map.invalidateSize({pan: false});}, 600)\r\n        }        \r\n    }, [rxShowSidebar])\r\n\r\n\r\n\r\n    \r\n\r\n\tconst onClickNewMarker = (state: boolean) => {                \r\n        // if (onClickCreateNewMarker) {\r\n        //     const preventDefault = onClickCreateNewMarker(state);            \r\n        //     if (preventDefault === false) {            \r\n        //         return\r\n        //     }                \r\n        // }\r\n                        \r\n\t\tif (rxIsMobileDevice && state) {\t\t\t\t\t\t\r\n            dispatch(actMapMarkerState({ visible: true, position: {lat: 0, lng: 0} }));\r\n            dispatch(actShowOkCancelMobileMarker(true));\r\n\t\t}\r\n\r\n        dispatch(actCheckButtonNewMarker(state));\r\n\t};\r\n\r\n\tconst onClickHeatmap = (state: boolean) => {\t\t        \t\t\r\n        dispatch(actCheckButtonHeatmap(state));\r\n        if (state) {\r\n            dispatch(actMapBaseLayerName('Dark'));\r\n\t\t} else {\r\n            dispatch(actMapBaseLayerName('Default'));\r\n\t\t}\r\n        \r\n\t};\r\n\r\n\r\n    function SetPanToMap() {        \r\n        const map = useMap();\r\n        if (currentCityInfo) {\r\n            // change map position when current city has been changed        \r\n            if (currentCitySysname !== currentCityInfo[\"sysname\"]) {\r\n                map.panTo( [parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])] );\r\n            }\r\n            currentCitySysname = currentCityInfo[\"sysname\"];\r\n\r\n        }\r\n        return null;\r\n    }    \r\n\r\n\r\n    function onClickGPS(state: boolean) {\r\n        if (map) {\r\n            if (state){\r\n                setView_nTimes_gps = 4;\r\n                map.locate({maxZoom: 20, enableHighAccuracy: true, watch:true, maximumAge: 20000});\r\n            } else {\r\n                map.stopLocate();\r\n                if (circle_geolocation && map.hasLayer(circle_geolocation)) map.removeLayer(circle_geolocation);\r\n                setView_nTimes_gps = 4;\r\n            }\r\n\r\n        }\r\n        dispatch(actCheckButtonGPS(state));\r\n    }\r\n\r\n\r\n    function NewMarker({mapMarkerState}: any) {  \r\n        const visible = mapMarkerState.visible;\r\n        const map = useMap();\r\n\r\n        const eventHandlers = useMemo(\r\n            () => ({\r\n                dragend() {\r\n                    \r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current;\r\n                        if (!rxIsMobileDevice && marker != null) {                                                    \r\n                            const LatLng = marker.getLatLng();\r\n                            const coord = { lat: '0', lng: '0' };\r\n                            coord.lat = LatLng.lat.toFixed(5);\r\n                            coord.lng = LatLng.lng.toFixed(5);\r\n                            \r\n                            //const cordFloat = {lat: parseFloat(coord.lat), lng: parseFloat(coord.lng)}\r\n                            //onDragEndNewMarker(cordFloat);\r\n                            //setNewMarkerState({ visible: true, position: coord }); \r\n                            //console.log('123', { visible: true, position: coord });\r\n                            \r\n                            // I don't know why, but that prevent the error for citytree app, when user try to move the marker\r\n                            sleep(0).then(() => {\r\n                                //console.log('onDragEndNewMarker timer', { visible: true, position: coord });\r\n                                    dispatch(actMapMarkerState({ visible: true, position: coord })); \r\n                            });\r\n\r\n                                                                        \r\n                        }\r\n                    }\r\n                }\r\n            }),\r\n            [],\r\n        );\r\n        function sleep (time: number) {\r\n            return new Promise((resolve) => setTimeout(resolve, time));\r\n        }          \r\n\r\n         \r\n\r\n        return (<>\r\n                    {visible && <> \r\n                        {(!rxIsMobileDevice) \r\n                        ?\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={true}\r\n                                position={mapMarkerState.position}                                                                \r\n                                ref={newMarkerRef}\r\n                                eventHandlers={eventHandlers}                    \r\n                            />                    \r\n                        :\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={false}\r\n                                //position={map.getCenter()}\r\n                                position={mapMarkerState.position.lat==0 ? map.getCenter() : mapMarkerState.position }\r\n                                ref={newMarkerRef}                 \r\n                            />\r\n                        } \r\n                </>}\r\n                                         \r\n        </>)\r\n    }\r\n    \r\n\r\n\r\n    function MapEvents() {        \r\n        const map = useMapEvents({\r\n            baselayerchange(e) {\r\n                document.cookie = 'mapname='+e.name\r\n            }, \r\n            //baselayerchange: onBaselayerchange,\r\n\r\n            move(e) {               \r\n                \r\n                if (rxShowOkCancelMobileMarker) {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current\r\n                        marker.setLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n                                        \r\n                        //let coord = { lat: 0, lng: 0 }\r\n                        //coord.lat = e.target.getCenter().lat.toFixed(5)\r\n                        //coord.lng = e.target.getCenter().lng.toFixed(5)\r\n                    }\r\n                }    \r\n            },\r\n\r\n            moveend(e) {\r\n                if (rxShowOkCancelMobileMarker) {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current\r\n                        const LatLng = marker.getLatLng()\r\n                        let coord = { lat: '0', lng: '0' };\r\n                        coord.lat = LatLng.lat.toFixed(5);\r\n                        coord.lng = LatLng.lng.toFixed(5);                   \r\n                        //setNewMarkerState({visible: true, position: coord})                        \r\n                        dispatch(actMapMarkerState({visible: true, position: coord}))\r\n                    }\r\n                }\r\n                setView_nTimes_gps = 0;\r\n                //setMapCurrentLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n\r\n\r\n            },\r\n            \r\n            click(e) {\r\n                onClickMap(e)              \r\n            }, \r\n\r\n            zoomend(e){                                \r\n                if (onZoomEnd) onZoomEnd(e);\r\n\r\n                setCurrentZoom(e.target._zoom)                 \r\n                //dispatch(actCurrentMapZoom(e.target._zoom));               \r\n            },\r\n\r\n            locationfound(e){\r\n                let radius = e.accuracy / 2;\r\n\r\n                if (setView_nTimes_gps > 0) {\r\n                    map.setView(e.latlng, 20);\r\n                    setView_nTimes_gps = setView_nTimes_gps - 1;\r\n                }\r\n    \r\n                if (circle_geolocation && map.hasLayer(circle_geolocation)) {\r\n                    circle_geolocation.setLatLng(e.latlng);\r\n                    circle_geolocation.setRadius(radius);\r\n                } else {\r\n                    circle_geolocation = L.circle(e.latlng, radius).addTo(map);\r\n                }                \r\n            },\r\n\r\n            locationerror(e){\r\n                //setCheckButtonGPS(false)\r\n                dispatch(actCheckButtonGPS(false))\r\n                alert(e.message)\r\n            }\r\n        })\r\n      \r\n        return null\r\n      }\r\n\r\n\r\n\r\n    function MarkersZoomAdjustment(){    \r\n        const map = useMap(); \r\n        const zoom = map.getZoom();\r\n                 \r\n        if (onEachLayer) {\r\n            map.eachLayer(function (layer) {\r\n                onEachLayer(layer, zoom);           \r\n            });\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    function onEachFeaturePoint(feature: any, layer: L.Layer) {               \r\n        //@ts-ignore\r\n        layer.myTag = \"myGeoJSON\"\r\n        // layer.on({\r\n        //   'click': function (e) {\r\n        //      console.log('e: ', e);\r\n        //      console.log('click');\r\n        //    }\r\n        // })\r\n    }  \r\n\r\n    function HeatmapFunction(){\r\n        const map = useMap();\r\n\r\n            if (heatMapLayer) { \r\n                map.removeLayer(heatMapLayer)\r\n            }\r\n\r\n            if (rxCheckButtonHeatmap) {                      \r\n                if (dataHeatmapPoints) {\r\n                    // @ts-ignore\r\n                    heatMapLayer = L.heatLayer(dataHeatmapPoints, {\r\n                        gradient: {0.4: '#1E90FF', 0.8: 'white', 1: 'red'},                        \r\n                        //minOpacity: 0.1,\r\n                        max: 1.5,\r\n                        radius: 14,\r\n                        blur: 10,\r\n                        maxZoom: 6\r\n\r\n                    })//.addTo(map);\r\n                    map.addLayer(heatMapLayer)                \r\n                }\r\n            } \r\n\r\n        return null\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    const createClusterCustomIcon  = function (cluster: L.MarkerCluster) {\r\n        // get the number of items in the cluster\r\n        let count = cluster.getChildCount();\r\n\r\n        // figure out how many digits long the number is\r\n        //var digits = (count + '').length;\r\n        let digits;\r\n        if (count == 2) { digits = '1'; }\r\n        if (count >= 3 && count <=5) { digits = '2'; }\r\n        if (count >= 6 && count <=9) { digits = '3'; }\r\n        if (count >= 10 && count <=14) { digits = '4'; }\r\n        if (count > 14) { digits = '5'; }\r\n\r\n        return L.divIcon({\r\n          html: count.toString(),\r\n          className: 'cluster digits-' + digits,\r\n          iconSize: undefined\r\n        });\r\n      }\r\n\r\n\r\n\r\n\r\n    return (\r\n        <>        \r\n        {/* The map rendered before useEffect called, so first we need to load currentCityInfo before to show the map */}\r\n        { currentCityInfo && currentCityInfo[\"longitude\"] !== \"0\" && currentCityInfo[\"latitude\"]!==\"0\" ? ( \r\n\r\n            <MapContainer whenCreated={setMap} center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} zoom={currentCityInfo.zoom} zoomControl={false} scrollWheelZoom={true} style={{ height: 'calc(100vh - 60px)', width: '100%' }} >                \r\n                <LayersControl position=\"topleft\">                    \r\n                    <MapTileLayers mapBaseLayerName={rxMapBaseLayerName} />                 \r\n                </LayersControl>    \r\n\r\n            \r\n                {/* To change center of the map when current city will change */}\r\n                {/*<SetViewMap center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} />*/} \r\n                <SetPanToMap />\r\n\r\n\r\n\r\n                {appname === 'roadaccident' && <> \r\n                    {currentZoom && currentZoom < 15 ? (\r\n                        <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>  \r\n                    ) : (\r\n                        /* @ts-ignore */\r\n                        <MarkerClusterGroup\r\n                        spiderfyOnMaxZoom={true}\r\n                        showCoverageOnHover={false}\r\n                        zoomToBoundsOnClick={true}\r\n                        maxClusterRadius={15}\r\n                        iconCreateFunction={createClusterCustomIcon}>                \r\n                            <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>                \r\n                        </MarkerClusterGroup>\r\n                    )}\r\n                </>}\r\n\r\n\r\n                {appname === 'citytree' && <>                                                         \r\n                    <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>                                       \r\n                </>}\r\n\r\n                <NewMarker mapMarkerState={rxMapMarkerState} onDragEndNewMarker={onDragEndNewMarker}/>\r\n                \r\n                <MapEvents />\r\n                \r\n                {!rxIsMobileDevice && <ZoomControl position='bottomright'/>}\r\n                \r\n   \r\n                {/* <ButtonsControl /> */}\r\n\r\n                <HeatmapFunction />\r\n                \r\n                {onEachLayer && <MarkersZoomAdjustment />}\r\n                \r\n            </MapContainer>\r\n        ) : (\r\n            <p>Loading...</p>\r\n        )}    \r\n            \r\n        </>\r\n        \r\n    )\r\n}\r\n\r\nexport default Map\r\n\r\n\r\n//https://egghead.io/lessons/react-create-a-new-map-using-react-leaflet\r\n\r\n//https://codesandbox.io/s/63wqz?file=/src/LeafletControlGeocoder.jsx\r\n//https://www.npmjs.com/package/leaflet-control-geocoder\r\n\r\n//https://codesandbox.io/s/how-to-add-a-legend-to-the-map-using-react-leaflet-useleaflet-hook-75jnp?file=/src/index.js\r\n\r\n//https://newbedev.com/home-button-leaflet-map\r\n\r\n//пример без React-Leaflet\r\n//https://stackoverflow.com/questions/69697017/use-leaflet-map-object-outside-useeffect-in-react","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACJ0lEQVR4Ae3ShY6bQRADYIeZ3v+9yszMDZPlkSWtslPuiS6+C+8n/zNp4p/froi8Jq/Jxk+TkwmHX//Wz8lG3jNjTeaguabD6HAVbphMwIIzqtd+rzKYhsgUNNcqo3fEBlyyOWmwhbbS4b8SaLBu7SGlpL9gklw3YpYR6J5Bm0zAguspZjvqSVQxqvxsPSJJKYIFKh5A2VIDyMgYfYB9hvcmI0VPTxVZS81ER7qiBoFqBAa9MKOKLzzv2BE3EOnlmDTrNRXryToGOGR65nhvSphjMP6b6WJ6xMYYxSW7l1Pp6CSzbLFPgAN3NGLKPRn3c59qxzapCTPUFNVKh0vUe24azMkW+uRm/B8UU3O3Eiw4nOrrafOSF5gS7PqHUotBQQ6f11p22HDOi+66i2LIHcWJOZrTP+rkhOl7n8YcTzCQIuIvyZPQrvs5Br0OdTsyB+YYrwKokXvsgOIXZzbeQ0DMnhHIqGOdBMEl9qKYAo3pBbbDNkijUSgjv/PrMFhwRwS2YbbMzqg+SzdukoxbeiSEVlgyK6yFmjSYtDxhTXRv1OsgsCb2jflu8hLMyC0P7Qg54NE1qc/MF5PqeAHWSfDL3zxN9dsQ+YD3zEeRS4GeYgFm5I7HNiJPfP4V7/CKeUvwsxpqhkwFzMgjj33Vwe+EnuIxngn8FvNTSCkwmJG+rQm8J/MId/EQL3nZwe2EmSNm9ufkFq9xHzcJPscnLGMRomBKqdzOY2EH+IPOLMEAAAAASUVORK5CYII=\"","import { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\ninterface MainWrapperProps {\r\n    children: JSX.Element;\r\n    cityName: string | undefined;\r\n}\r\n\r\nconst MainWrapper = ({children, cityName}: MainWrapperProps) => {\r\n    const rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\r\n\r\n    return (\r\n        //@ts-ignore\r\n        <div className=\"main-wrapper\">            \r\n            {cityName ? (                \r\n                <div id=\"app\">\r\n                    <div className={`d-flex ${rxShowSidebar ? \"showed\" : \"hided\"}`} id=\"wrapper\">\r\n                        {children}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                    \"You must select a city.\"\r\n            )}     \t\t                           \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MainWrapper","interface SidebarProps {\r\n\tchildren: JSX.Element\t\r\n}\r\n\r\nconst Sidebar = ({children}: SidebarProps) => {\r\n\treturn (\r\n\t\t<div className=\"bg-light border-right\" id=\"sidebar-wrapper\">\r\n\t\t\t<div className=\"list-group list-group-flush\" style={{ marginTop: \"15px\" }}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Sidebar\r\n","import Button from \"react-bootstrap/Button\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {\r\n\tactMapMarkerState,\r\n\tactShowSidebar,\r\n\tactCheckButtonNewMarker,\r\n\tactShowOkCancelMobileMarker,\r\n\tactShowTreeTab,\r\n\tactActiveTabKey,\r\n    actNewTreeCreation\r\n} from \"../actions\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\n\r\nconst ButtonOkCancelMobileMarker = () => {\r\n\r\n    const dispatch = useDispatch();\r\n    const { t } = useTranslation();\r\n    const rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\r\n\r\n\r\n    return (\r\n    <>\r\n        <Button\r\n            variant=\"success\"\r\n            id=\"doneEditMarkerMobile\"\r\n            onClick={() => {\r\n                if (rxCheckButtonNewMarker) dispatch(actNewTreeCreation(true));\r\n                \r\n                dispatch(actCheckButtonNewMarker(false));\r\n                dispatch(actShowOkCancelMobileMarker(false));                \r\n                dispatch(actShowTreeTab(true));\r\n                dispatch(actActiveTabKey(\"tree\"));\r\n                dispatch(actShowSidebar(true));                \r\n            }}\r\n        >\r\n            {t<string>(\"words.done\")}\r\n        </Button>{\" \"}\r\n        \r\n        <Button\r\n            variant=\"secondary\"\r\n            id=\"cancelMarkerMobile\"\r\n            onClick={() => {\r\n                dispatch(\r\n                    actMapMarkerState({\r\n                        visible: false,\r\n                        position: {\r\n                            lat: 0,\r\n                            lng: 0,\r\n                        },\r\n                    })\r\n                );\r\n                dispatch(\r\n                    actShowOkCancelMobileMarker(\r\n                        false\r\n                    )\r\n                );\r\n                dispatch(\r\n                    actCheckButtonNewMarker(\r\n                        false\r\n                    )\r\n                );\r\n            }}\r\n        >\r\n            &#x2715;\r\n        </Button>{\" \"}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ButtonOkCancelMobileMarker","import { useForm, Controller  } from 'react-hook-form'\r\nimport { Form, Button, Row, Col, } from 'react-bootstrap';\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\ninterface FormFilterProps {\r\n\tonSubmitFilter: (filter: {}) => void;\r\n}\r\n\r\n\r\nconst FormFilter = ({onSubmitFilter}: FormFilterProps) => {\r\n    const rxDictSpecieses = useSelector((state: RootState) => state.dataReducer.dictSpecieses);\r\n    const rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);\r\n\tconst rxDictPlaceTypes = useSelector((state: RootState) => state.dataReducer.dictPlaceTypes);\r\n\tconst rxDictIrrigationMethods = useSelector((state: RootState) => state.dataReducer.dictIrrigationMethods);\r\n\tconst rxDictGroupSpecs = useSelector((state: RootState) => state.dataReducer.dictGroupSpec);\r\n\t\r\n\tconst { t } = useTranslation();\r\n\r\n\r\n\r\n\tconst { control, handleSubmit, reset } = useForm({\r\n\t\treValidateMode: \"onChange\",\r\n\t\tdefaultValues: {\r\n\t\t\tspeciesFilter: \"\",\r\n\t\t\tstatusFilter: \"\",\r\n\t\t\tcareTypeFilter: \"\",\r\n\t\t\tremarkFilter: \"\",\r\n\t\t\tplaceTypeFilter: \"\",\r\n\t\t\tirrigationMethodFilter: \"\",\r\n\t\t\tdatePlantedFromFilter: \"\",\r\n\t\t\tdatePlantedToFilter: \"\",\r\n\t\t\tdateAddedFromFilter: \"\",\r\n\t\t\tdateAddedToFilter: \"\",\r\n\t\t\tcommentFilter: \"\",\r\n\t\t\theightFromFilter: \"\",\r\n\t\t\ttrunkGirthFromFilter: \"\",\r\n\t\t\tcrownDiameterFromFilter: \"\",\r\n\t\t\theightToFilter: \"\",\r\n\t\t\ttrunkGirthToFilter: \"\",\r\n\t\t\tcrownDiameterToFilter: \"\",\t\t\t\r\n\t\t\tshowMyTreesFilter: \"\",\r\n\r\n\t\t\t//select: {},\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\t\r\n\t//let optionsSpeciesesFilter: {label: string; options: {value: number; label: string}[] | undefined}[] = [];\r\n\tlet optionsSpeciesesFilter: any = [];\r\n\tif (Array.isArray(rxDictSpecieses) && Array.isArray(rxDictGroupSpecs)) {\r\n\t\tlet unknownTreeItem = null;\r\n\r\n\t\toptionsSpeciesesFilter = rxDictGroupSpecs.map(itemGroup => {\r\n\t\t\treturn {\t\t\t\t\r\n\t\t\t\tlabel: itemGroup.groupname,\r\n\t\t\t\toptions: rxDictSpecieses.map(spec => {\r\n\t\t\t\t\tif (itemGroup.id === spec.groupspec) {\r\n\t\t\t\t\t\tif (spec.id !== 1) { // unknow tree item has id = 1\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname,\r\n\t\t\t\t\t\t\t\tspeciesname: spec.speciesname,\r\n\t\t\t\t\t\t\t\ttypespec: spec.typespec\r\n\t\t\t\t\t\t\t\t//color: '#FF8B00'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tunknownTreeItem = {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn null;\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}).filter(e => e) // removes all undefined items in result array\t\t\t \r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\tif (unknownTreeItem) {\r\n\t\t\toptionsSpeciesesFilter.unshift(unknownTreeItem);\r\n\t\t}\t\t\t\t\r\n\t}\r\n\r\n\r\n\tlet optionsStatusesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictStatuses)) {\r\n\t\toptionsStatusesFilter = rxDictStatuses.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.statusname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\t\r\n\tlet optionsCareTypesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictCareTypes)) {\r\n\t\toptionsCareTypesFilter = rxDictCareTypes.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.carename,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\r\n\tlet optionsRemarksFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictRemarks)) {\r\n\t\toptionsRemarksFilter = rxDictRemarks.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.remarkname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\t\r\n\tlet optionsPlaceTypesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictPlaceTypes)) {\r\n\t\toptionsPlaceTypesFilter = rxDictPlaceTypes.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.placename,\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\r\n\tlet optionsIrrigationMethodsFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictIrrigationMethods)) {\r\n\t\toptionsIrrigationMethodsFilter = rxDictIrrigationMethods.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.irrigationname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\r\n\r\n\t  const customStyles = {\r\n\t\t//@ts-ignore\r\n\t\toption: (styles, { data }) => {\r\n\t\t\t//const color = chroma(data.color);\r\n\t\t\treturn {\r\n\t\t\t  ...styles,\r\n\t\t\t  paddingLeft: 20,\r\n\t\t\t  backgroundColor: data.typespec === 2 ? '#EEFFEE' : undefined,\r\n\r\n\t\t\t};\r\n\t\t  },\r\n\t  } \r\n\r\n\r\n\r\n\t  const Option = (props: any) => {\r\n\t\tconst { label, speciesname } = props.data;\r\n\t\treturn (\r\n\t\t  <components.Option {...props}>\r\n\t\t\t<span>{label}</span> <span style={{ color: \"darkgray\" }}>{speciesname}</span>\r\n\t\t  </components.Option>\r\n\t\t);\r\n\t  };\t  \r\n\r\n\r\n\r\n\tfunction onResetButton() {\r\n\t\treset();\r\n\t\tonSubmitFilter({});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form className=\"m-1\" onSubmit={handleSubmit(onSubmitFilter)}>\r\n\t\t\t\t<Form.Group controlId=\"formSpeciesFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.species\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"speciesFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={true}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsSpeciesesFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tgetOptionLabel={(option) =>`${option.label} - ${option.speciesname}`}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formStatusFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.status\")}\r\n\t\t\t\t\t</Form.Label>\r\n\r\n\t\t\t\t\t{/*{!rxIsMobileDevice ? ( */}\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"statusFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\toptions={optionsStatusesFilter}\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t\t\t\tmaxMenuHeight={400}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/*):(\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<select {...register(\"statusFilter\")} \t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tstyle={{width: '100%', minHeight: '38px', borderRadius: '4px', borderColor: 'rgb(204, 204, 204)', backgroundColor: 'rgb(255, 255, 255)'}}\r\n\t\t\t\t\t\t\tmultiple={true}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option disabled selected>{t<string>(\"words.select\")}</option>\r\n\t\t\t\t\t\t\t{optionsStatusesFilter.map((item) => <option key={item.value} value={item.value}>{item.label}</option>)}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}*/}\t\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formCareTypeFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.careType\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"careTypeFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsCareTypesFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formRemarkFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.remark\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"remarkFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsRemarksFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formPlaceTypeFilter\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"230px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.placeType\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"placeTypeFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\toptions={optionsPlaceTypesFilter}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formIrrigationMethodFilter\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"230px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.irrigationMethod\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"irrigationMethodFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\r\n\t\t\t\t\t\t\t\t\t\t\"words.select\"\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\toptions={optionsIrrigationMethodsFilter}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDatePlantedFromFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.plantedFrom\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"datePlantedFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDatePlantedToFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.plantedTo\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"datePlantedToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDateAddedFromFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.dateAddedFrom\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateAddedFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDateAddedToFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.dateAddedTo\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateAddedToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group className=\"mt-3\" controlId=\"formCommentFilter\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.comment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"commentFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control type=\"text\" {...field} />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formFromParamsTreeFilter\" style={{maxWidth: \"50px\"}}>\r\n\t\t\t\t\t\t<Form.Label style={{ marginTop: \"32px\"}}>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.from\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formHeightFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.height\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"heightFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formTrunkGirthFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.trunkGirth\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkGirthFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"999\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formCrownDiameterFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.crownDiameter\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crownDiameterFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-0\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formToParamsTreeFilter\" style={{maxWidth: \"50px\"}}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.to\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formHeightToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"heightToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formTrunkGirthToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkGirthToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"999\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formCrownDiameterToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crownDiameterToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formShowMyTreesFilter\"\r\n\t\t\t\t\tclassName=\"mt-3 ms-1\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"showMyTreesFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tchecked={field[\"value\"] ?? false}\r\n\t\t\t\t\t\t\t\tinline\r\n\t\t\t\t\t\t\t\tlabel={t<string>(\r\n\t\t\t\t\t\t\t\t\t\"sidebar.filterTab.showMyTrees\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tid=\"idShowMyTreesFilter\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\t\t\t\t\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button variant=\"light\" onClick={onResetButton}>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.clear\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"150px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.search\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default FormFilter\r\n\r\n\r\n\r\n","import Table from \"react-bootstrap/Table\";\r\nimport {useState, useEffect} from 'react';\r\n\r\nexport interface ColumnsStructureTableList {\r\n\tfield: string;\r\n\theaderName: string;\r\n\twidth?: string;\r\n\tsortable?: boolean;\r\n\tdateTimeOption?: 'onlyDate' | 'onlyTime' | 'dateTime'; // for Date fields you can choose format\t\r\n}\r\n\r\nexport interface DataStructureTableList {\r\n\tid: number;\t\r\n\t[key: string]: any | {iconFA?: string; iconFASize?: string; text?: string; idButton: string}[]; // array of buttons, where key is field name of a column\r\n}\r\n\r\ninterface TableListProps {\t\r\n\tcolumns: ColumnsStructureTableList[];\r\n\tdata: DataStructureTableList[] | undefined;\r\n\tsortField?: string;\r\n\tsortAsc?: boolean;\t\r\n\tsize?: string; // sm\r\n\tvariant?: string; // dark\r\n  \tOnClickButtons?: (rowData: any, idButton: string) => void;\r\n}\r\n\r\nfunction TableList({columns, data, sortField, sortAsc=true, size, variant, OnClickButtons}: TableListProps) {\r\n\r\n\tconst [sortState, setSortState] = useState({sortField: sortField, sortAsc: sortAsc});\r\n\tconst [dataTable, setDataTable] = useState(data);\r\n\t\r\n\tuseEffect(()=>{\r\n\t\tsetDataTable(data);\r\n\t}, [data]);\r\n\r\n\r\n\tconst columnsHeader = columns.map((item, index) => ( \r\n\t\t<th \r\n\t\t\tstyle={{ width: item.width ? item.width: \"\", cursor: item.sortable ? \"pointer\" : \"default\" }} \r\n\t\t\tkey={index} \r\n\t\t\tonClick={() => {\r\n\t\t\t\tif (item.sortable) {\r\n\t\t\t\t\tsetSortState({sortField: item.field, sortAsc: sortState.sortField === item.field ? !sortState.sortAsc : true}); // inverse sortAsc, only when sortField has not changed, otherwise sortAsc=true \r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t\r\n\t\t\t{ // for current sorted column draws icon\r\n\t\t\tsortState?.sortField === item.field ? \r\n\t\t\t<>\r\n\t\t\t\t<div style={{float: \"left\", textAlign: \"left\"}}>{item.headerName}</div>\r\n\t\t\t\t<div style={{float: \"right\", textAlign: \"right\"}}>\r\n\t\t\t\t\t<span style={{fontSize: \"8pt\", color: \"gray\"}}> {sortState.sortAsc ? '▼' : '▲'}</span>\r\n\t\t\t\t</div>\t\t\t\r\n\t\t\t</>: item.headerName\r\n\t\t\t}\r\n\t\t</th>\r\n\t));\r\n\r\n\r\n\r\n\tfunction DataTable() {\r\n\t\tfunction compare( a:{}, b:{} ) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tif ( a[sortState.sortField] < b[sortState.sortField] ){\r\n\t\t\t\tif (sortState.sortAsc) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 1;\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t//@ts-ignore\r\n\t\t\tif ( a[sortState.sortField] > b[sortState.sortField] ){\r\n\t\t\t\tif (sortState.sortAsc) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn -1;\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\t\r\n\t\t// sorting of data\r\n\t\tlet sortedData:any[] | undefined = [];\r\n\t\tif (sortState.sortField) {\t\t\r\n\t\t\t//setDataTable(dataTable?.sort(compare));\t\t\t\r\n\t\t\tsortedData = dataTable?.sort(compare);\t\t\t\r\n\t\t} else {\r\n\t\t\tsortedData = dataTable;\r\n\t\t}\r\n\r\n\t\t// fill out\r\n\t\tif (sortedData && sortedData.length > 0) {\r\n\t\t\treturn (\r\n\t\t\t\t<>\r\n\t\t\t\t{sortedData.map((row: any, index) => {\t\t\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<tr key={row.id}>\r\n\t\t\t\t\t\t\t<DataRow row={row} indexRow={index}/>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (<tr><td style={{textAlign: \"center\"}} colSpan={columns.length}>no data</td></tr>)\r\n\t}\t\r\n\r\n\r\n\tinterface DataRowProps {\r\n\t\trow: any;\r\n\t\tindexRow: number;\r\n\t}\t\r\n\r\n\tfunction DataRow({row, indexRow}: DataRowProps): any {\t\r\n\t\tconst getUniqKey = (row: any, index: number): string => (`${String(row.id)}.${String(index)}`);\r\n\t\t\t\t\r\n\t\tconst result = columns.map((col, index) => {\r\n\t\t\t\r\n\t\t\tif (typeof row[col.field] !== \"object\") { //if it's not object, then it's just value of field, else it's button\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tif (col?.dateTimeOption) {\t\t\t\t\r\n\t\t\t\t\tif (col.dateTimeOption === \"onlyDate\") {\r\n\t\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{new Date(row[col.field]).toLocaleDateString()}</td>)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (col.dateTimeOption === \"onlyTime\") {\r\n\t\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{new Date(row[col.field]).toLocaleTimeString()}</td>)\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\r\n\t\t\t\t\tif (col.dateTimeOption === \"dateTime\") {\r\n\t\t\t\t\t\tlet dateTime = new Date(row[col.field]).toLocaleDateString() + ' ' + new Date(row[col.field]).toLocaleTimeString();\r\n\t\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{dateTime}</td>)\r\n\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{row[col.field]}</td>)\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (col.field===\"#\") {\r\n\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{indexRow+1}</td>)\t\r\n\t\t\t\t}\r\n\t\t\t\treturn (<td key={getUniqKey(row, index)}>{row[col.field]}</td>)\r\n\t\t\t}\t\r\n\t\t\t\r\n\t\t\t// buttons\r\n\t\t\tconst buttons = row[col.field];\r\n\t\t\t\r\n\t\t\tif (Array.isArray(buttons)) {\r\n\t\t\t\tlet buttonRow:any[] = [];\r\n\t\t\t\tbuttons.forEach(button => {\r\n\t\t\t\t\tif ((button?.text || button?.iconFA)  && button?.idButton) {\r\n\t\t\t\t\t\tlet buttonText = [];\r\n\t\r\n\t\t\t\t\t\tif (button?.iconFA) {\r\n\t\t\t\t\t\t\tif (button?.iconFASize) {\r\n\t\t\t\t\t\t\t\tbuttonText.push(<i key={getUniqKey(row, index)+button.idButton} className={button.iconFA} style={{fontSize: button.iconFASize}}></i>);\t\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tbuttonText.push(<i key={getUniqKey(row, index)+button.idButton} className={button.iconFA}></i>);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif (button?.text) {\r\n\t\t\t\t\t\t\tbuttonText.push(<span key={getUniqKey(row, index)+button.idButton}>{button.text}</span>);\t\r\n\t\t\t\t\t\t}\t\t\t\t\r\n\t\r\n\t\t\t\t\t\tif (OnClickButtons) {\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tbuttonRow.push(<span key={getUniqKey(row, index)+button.idButton}><a href='#' onClick={()=>OnClickButtons(row, button.idButton)}>{buttonText}</a> </span>);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbuttonRow.push(<span key={getUniqKey(row, index)+button.idButton}>{buttonText}</span>);\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn (<td key={getUniqKey(row, index)}>{buttonRow}</td>);\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n  \treturn (\r\n\t\t<Table striped bordered hover size={size} variant={variant}>\r\n\t\t\t<thead>\r\n\t\t\t\t<tr>\t\t\t\t\r\n\t\t\t\t\t{columnsHeader}\t\t\t\r\n\t\t\t\t</tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody>\r\n\t\t\t\t<DataTable/>\r\n\t\t\t</tbody>\r\n\t\t</Table>\r\n  \t)\r\n}\r\n\r\nexport default TableList","import {useState, useEffect, forwardRef, useRef, useImperativeHandle} from 'react';\r\nimport { Form, Button, Spinner , Row, Col, Modal } from \"react-bootstrap\";\r\nimport Image from 'react-bootstrap/Image';\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport deleteImage from \"./delete2.svg\";\r\n\r\ninterface ImageS3UploadProps {\r\n    signingUrl: string;\r\n    autoUpload: boolean;\r\n    //startUploadState?: boolean;\r\n    value: string | undefined;\r\n    onChange: (val: string) => void;    \r\n    emptyPhoto?: string; \r\n    serverPhoto?: string | undefined | null; \r\n    buttonCaption?: string;\r\n\r\n    resizer?: {\r\n        enabled: boolean;\r\n        autoResize: boolean;\r\n        maxWidth: number;\r\n        maxHeight: number;\r\n        compressFormat: string;\r\n        quality: number;\r\n        rotation: number;\r\n    };\r\n\r\n    onFinish?: () => void;\r\n    onProgress?: (percent: number) => void;\r\n    onError?: (status: number, filename: string) => void;\r\n    onSignedUrl?: (data: any)  => void;\r\n}\r\n\r\ninterface RefObject {\r\n    uploadFile: () => boolean\r\n}\r\n\r\n\r\nenum stateComponent {\r\n    none,\r\n    resizing,\r\n    resized,\r\n    uploading,\r\n    uploaded,\r\n    error\r\n}\r\n\r\nconst defaultResizingOptions = {\r\n    enabled: false,\r\n    autoResize: true, // otherwise resizing will be preform before uploading\r\n    maxWidth: 1280,\r\n    maxHeight: 1280,\r\n    compressFormat: \"JPEG\",\r\n    quality: 70,\r\n    rotation: 0\r\n}\r\n\r\nconst ImageS3Upload = forwardRef<RefObject | undefined, ImageS3UploadProps>(({\r\n    signingUrl,\r\n    autoUpload,\r\n    //startUploadState,\r\n    emptyPhoto,\r\n    serverPhoto,\r\n    value,\r\n    onChange,\r\n    buttonCaption = 'Browse...',\r\n    resizer = defaultResizingOptions,\r\n    onFinish,\r\n    onProgress,\r\n    onError,\r\n    onSignedUrl\r\n}, ref) => {\r\n\r\n\r\n    // to be able to call method uploadFile\r\n    useImperativeHandle(ref, () => ({\r\n        uploadFile: () => {\r\n            //@ts-ignore\r\n            if (inputFileEl?.current?.files && inputFileEl.current.files.length===1) {                \r\n                if (status !== stateComponent.resizing) {\r\n                    //@ts-ignore\r\n                    startUpload(inputFileEl?.current?.files[0].name);\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            return false;             \r\n        }\r\n    }));\r\n\r\n\r\n    const inputFileEl = useRef(null);\r\n    \r\n    const [status, setStatus] = useState<stateComponent>(stateComponent.none);\r\n    const [imagePhoto, setImagePhoto] = useState<string | undefined>(undefined);\r\n    const [compressedPhoto, setCompressedPhoto] = useState<any>(undefined);\r\n    const [buttonCaptionState, setButtonCaptionState] = useState(buttonCaption);\r\n    //const [stateUploading, setStateUploading] = useState(false);\r\n    const [showSpinner, setShowSpinner] = useState<boolean>(false);    \r\n    const [s3DataState, setS3DataState] = useState<any>(undefined);\r\n    const [notLoad, setNotLoad] = useState(false); // to prevent loading photo from S3 when we have this photo in blob input element\r\n   \r\n\r\n    useEffect(()=>{\r\n        if (emptyPhoto) {\r\n            setImagePhoto(emptyPhoto);    \r\n        }  \r\n    }, []);\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n        console.log('s3DataState', s3DataState); \r\n        if (s3DataState?.data?.fields?.key) {\r\n            setNotLoad(true);\r\n            onChange(s3DataState.data.fields.key);\r\n        } \r\n    }, [s3DataState]);  \r\n\r\n    useEffect(()=>{                \r\n        \r\n        if (value) {\r\n            \r\n            if (serverPhoto == null) {\r\n                serverPhoto = '';    \r\n            }\r\n\r\n            if (serverPhoto.slice(-1) != '/' && value.slice(0, 1) != '/') { // if there is no symbol / between serverPhoto and value, just add it.\r\n                serverPhoto = serverPhoto + '/';\r\n            }\r\n\r\n            if (!notLoad) { // to prevent loading photo from S3 when we have this photo in blob input element\r\n                setButtonCaptionState(buttonCaption);\r\n                setShowSpinner(false);\r\n                if (inputFileEl?.current) {\r\n                    //@ts-ignore\r\n                    inputFileEl.current.value='';\r\n                }\r\n                                \r\n                setImagePhoto(`${serverPhoto}${value}`);\r\n                //console.log('serverPhotoValue', `${serverPhoto}${value}`); \r\n            }\r\n                    \r\n          \r\n        } else {\r\n            setImagePhoto(emptyPhoto);\r\n            setButtonCaptionState(buttonCaption);\r\n        }\r\n               \r\n        setNotLoad(false);\r\n        \r\n    }, [value]);   \r\n    \r\n    \r\n\r\n\r\n    //useEffect(() => {\r\n        //if (status === stateComponent.resizing) {\r\n        //    setButtonCaptionState(\"Resizing...\");\r\n        //} else {\r\n        //    setButtonCaptionState(buttonCaption);            \r\n        //}   \r\n    //}, [status])\r\n\r\n\r\n        \r\n{/*\r\n    useEffect(()=>{\r\n        if (startUploadState === true && stateUploading === false) {\r\n            setStateUploading(true);\r\n            //@ts-ignore\r\n            if (inputFileEl?.current?.files && inputFileEl.current.files.length===1) {\r\n                //@ts-ignore\r\n                startUpload(inputFileEl?.current?.files[0].name);\r\n            }    \r\n        }\r\n    }, [startUploadState]);\r\n*/}\r\n\r\n\r\n    const resizeFile = (file: any) =>\r\n\t\tnew Promise((resolve) => {\r\n\t\t\tResizer.imageFileResizer(\r\n\t\t\t\tfile,\r\n\t\t\t\tresizer.maxWidth,\r\n\t\t\t\tresizer.maxHeight,\r\n\t\t\t\tresizer.compressFormat,\r\n\t\t\t\tresizer.quality,\r\n\t\t\t\tresizer.rotation,\r\n\t\t\t\t(uri) => {\r\n\t\t\t\t\tresolve(uri);\r\n\t\t\t\t},\r\n\t\t\t\t\"blob\"\r\n\t\t\t);\r\n\t\t});\r\n\r\n\r\n    const onChangeFile = async (event: any) => {\r\n        \r\n        if (event.target.files && event.target.files.length > 0) {\r\n            const file = event.target.files[0];\r\n            //onChange(file.name);\r\n            //setFilename(file.name);\r\n            setImagePhoto(URL.createObjectURL(file)); \r\n            \r\n            if (resizer.enabled && resizer.autoResize) {\r\n                try {                \r\n                    setStatus(stateComponent.resizing);\r\n                    setButtonCaptionState(\"Resizing...\")\r\n                    const image = await resizeFile(file);\r\n\r\n                    if (image instanceof Blob) {\r\n                        setCompressedPhoto(image);\r\n                        setStatus(stateComponent.resized);\r\n                        setButtonCaptionState(\"Resized \");\r\n    \r\n                        if (autoUpload) {\r\n                            startUpload(file.name);     \r\n                        }\r\n                        //console.log('image.size', humanFileSize(image.size));\r\n                    } else {\r\n                        setButtonCaptionState(\"Error\");    \r\n                    } \r\n                    \r\n\r\n\r\n                } catch (err) {\r\n                    console.log(err);\r\n                    setStatus(stateComponent.error);\r\n                    setButtonCaptionState(\"Error\")\r\n                }\r\n            } else {\r\n                if (autoUpload) {\r\n                    startUpload(file.name);     \r\n                }                \r\n            }            \r\n\r\n        }                \r\n    };\r\n\r\n\r\n\r\n\r\n\tconst fetchUrlSign = async (objectName: string) => {\t\t\t\r\n\r\n\t\tlet myHeaders = new Headers();\r\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");  \r\n\r\n        const bodyObject = {objectName: objectName};\r\n        \r\n        let res = await fetch(signingUrl, {\r\n            method: 'POST',\r\n            headers: myHeaders,\r\n            body: JSON.stringify(bodyObject)\r\n        });\r\n\r\n\t\tconst json = await res.json();\r\n\r\n        return JSON.parse(json);\t\t\t\t\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n    const updateProgress = (ev: any) => {\r\n        if (ev.lengthComputable) {\r\n            let percentComplete = Math.round((ev.loaded / ev.total) * 100);\r\n            setButtonCaptionState(String(percentComplete)+'%');\r\n            if (onProgress) {\r\n                onProgress(percentComplete);\r\n            }\r\n            console.log('percentComplete', percentComplete);\r\n            //$('#'+idElement+'_browse_button').html(percentComplete+'%');\r\n        }\r\n    } \r\n\r\n    const uploadFile = (file: any, s3Data: any) => {\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", s3Data.url);\r\n        xhr.timeout = 30000;\r\n        xhr.upload.onprogress = updateProgress;\r\n\r\n        let postData = new FormData();\r\n\t\tfor (let key in s3Data.fields) {\t\t\t\r\n            if (key != 'file') { // in field \"file\" must be blob of file.\r\n                postData.append(key, s3Data.fields[key]);\r\n                //console.log('append', key, s3Data.fields[key]);\r\n            }                    \r\n\t\t}\r\n\t\tpostData.append(\"file\", file); // blob\r\n\r\n\t\txhr.onreadystatechange = () => {\r\n\t\t\tif (xhr.readyState === 4) {\r\n\t\t\t\t// done\r\n\t\t\t\tif (xhr.status === 200 || xhr.status === 204) {\r\n                    setShowSpinner(false);\r\n                    setButtonCaptionState('Done');\r\n                    if (onFinish) {\r\n                        onFinish();\r\n                    }\r\n\r\n                    \r\n\t\t\t\t\t//ok || 204 No Content\r\n                } else {\r\n\t\t\t\t\t//SetStateSaveButton('saveButton', true, 'Запази');\r\n\t\t\t\t\t//SetStateSaveButton('saveInspButton', true, 'Запази');\r\n\t\t\t\t\t//$('#'+idElement+'_loading').hide();\r\n\t\t\t\t\t//$('#'+idElement+'_browse_button').html('Browse...');\r\n\t\t\t\t\t\r\n                    if (onError) {\r\n                        setShowSpinner(false);\r\n                        setButtonCaptionState(`Error ${xhr.status}`);\r\n                        onError(xhr.status, file.name);\r\n                    }                    \r\n                    \r\n                    alert(\r\n\t\t\t\t\t\t\"Error during file upload (status: \" +\r\n\t\t\t\t\t\t\txhr.status +\r\n\t\t\t\t\t\t\t\"): \" +\r\n\t\t\t\t\t\t\tfile.name\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}  \r\n\t\t};\r\n\r\n\r\n\t\txhr.onload = () => {\r\n\t\t\t// transaction completes successfully.\r\n\t\t\tconsole.log(\"transaction completes successfully.\");\r\n            //if (s3DataState?.data?.fields?.key) {\r\n            //    onChange(s3DataState.data.fields.key);\r\n            //}             \r\n\t\t};  \r\n\r\n\r\n        xhr.onerror = () => {\r\n            //SetStateSaveButton('saveButton', true, 'Запази');\r\n            //SetStateSaveButton('saveInspButton', true, 'Запази');\r\n            //$('#'+idElement+'_loading').hide();\r\n            //$('#'+idElement+'_browse_button').html('Browse...');\r\n            alert('Error during file upload: ' + file.name);\r\n        };  \r\n          \r\n        \r\n        console.log('postData', postData);\r\n        xhr.send(postData);  \r\n\r\n    \r\n    //    {\"data\": {\"url\": \"https://urbangis.s3.amazonaws.com/\", \"fields\": {\"acl\": \"public-read\", \"Content-Type\": \"image/jpeg\", \"key\": \"media/citytree/images_tree/user_None/None\", \"x-amz-algorithm\": \"AWS4-HMAC-SHA256\", \"x-amz-credential\": \"***REMOVED***/20220524/eu-central-1/s3/aws4_request\", \"x-amz-date\": \"20220524T105522Z\", \"policy\": \"eyJleHBpcmF0aW9uIjogIjIwMjItMDUtMjRUMTE6NTU6MjJaIiwgImNvbmRpdGlvbnMiOiBbeyJhY2wiOiAicHVibGljLXJlYWQifSwgeyJDb250ZW50LVR5cGUiOiAiaW1hZ2UvanBlZyJ9LCB7ImJ1Y2tldCI6ICJ1cmJhbmdpcyJ9LCB7ImtleSI6ICJtZWRpYS9jaXR5dHJlZS9pbWFnZXNfdHJlZS91c2VyX05vbmUvTm9uZSJ9LCB7IngtYW16LWFsZ29yaXRobSI6ICJBV1M0LUhNQUMtU0hBMjU2In0sIHsieC1hbXotY3JlZGVudGlhbCI6ICJBS0lBMllTTzdGRTVKQllPWEU1Qy8yMDIyMDUyNC9ldS1jZW50cmFsLTEvczMvYXdzNF9yZXF1ZXN0In0sIHsieC1hbXotZGF0ZSI6ICIyMDIyMDUyNFQxMDU1MjJaIn1dfQ==\", \"x-amz-signature\": \"75a181348c86194678752f6c726582a833408925226259efc0ad6858060d56bb\", \"file\": null}}, \"url\": \"https://urbangis.s3.amazonaws.com/media/citytree/images_tree/user_None/None\", \"file_exists\": false}\r\n    }\r\n\r\n\r\n\r\n\r\n    const startUpload = async (filename: string) => {\r\n        filename = filename.replace(/\\s/g, ''); // remove spaces, because there is some problem with restAPI, which return url filename with %20 instead space, after that when we savind data again, %20 will be convert to %2520 (% = %25)\r\n\r\n        setShowSpinner(true);\r\n        setButtonCaptionState('Starting... ');\r\n        setS3DataState(undefined);\r\n        const signedUrl = await fetchUrlSign(filename);\r\n        setS3DataState(signedUrl);  \r\n        if (onSignedUrl) {\r\n            onSignedUrl(signedUrl);\r\n        }\r\n        \r\n        console.log('signedUrl', signedUrl);\r\n        \r\n\r\n        if (signedUrl.file_exists === false) {\r\n            //@ts-ignore\r\n            if (inputFileEl?.current?.files && inputFileEl.current.files.length===1) {\r\n                //@ts-ignore\r\n                const file = inputFileEl.current.files[0];\r\n\r\n                if (resizer.enabled) {\r\n                   \r\n                    if (resizer.autoResize) { // photo already resized and stored in compressedPhoto\r\n                        if (compressedPhoto) {\r\n                            //@ts-ignore\r\n                            uploadFile(compressedPhoto, signedUrl.data);\r\n                        }\r\n                    } else {\r\n                        try {                \r\n\r\n                            setStatus(stateComponent.resizing);\r\n                            setButtonCaptionState(\"Resizing...\")\r\n                            const image = await resizeFile(file);\r\n                            setStatus(stateComponent.resized);\r\n                            setButtonCaptionState(\"Resized\");\r\n                            //@ts-ignore\r\n                            uploadFile(image, signedUrl.data);                            \r\n                        } catch (err) {\r\n                            console.log(err);\r\n                            setStatus(stateComponent.error);\r\n                            setButtonCaptionState(\"Error\")\r\n                        }                        \r\n                    }\r\n\r\n                    \r\n                } else {\r\n                    //@ts-ignore\r\n                    uploadFile(file, signedUrl.data);\r\n                }                \r\n            }\r\n        } else {\r\n            let rndStr = makeRandomStr(5);\r\n            startUpload(rndStr + '_' + filename);            \r\n        }\r\n    \r\n    }\r\n\r\n\r\n\r\n\r\n    return (\r\n        <div style={{position: \"relative\"}}>\r\n            <Form.Group>\r\n                <Image src={imagePhoto} fluid={true} rounded key={imagePhoto} /> {/* key to prevent showing previous loaded photos */}\r\n                <a href=\"#\">\r\n                    {/*\r\n                    <i className=\"far fa-times-circle fa-lg\" \r\n                        style={{color: \"#BB0000\", position: \"absolute\", top: \"-3px\", right: \"8px\", textShadow: \"0 0 3px white\"}}\r\n                        onClick={() => { \r\n                            //onChange(\"*will_be_deleted*\"); \r\n                            //setFilename(\"*will_be_deleted*\");\r\n                            onChange(\"\"); \r\n                            setImagePhoto(emptyPhoto);\r\n                            if (inputFileEl?.current) {\r\n                                //@ts-ignore\r\n                                inputFileEl.current.value='';\r\n                            }                             \r\n                        }} \r\n                    />\r\n                    */}   \r\n\r\n                    <Image \r\n                        src={deleteImage} \r\n                        style={{width: \"46px\", height: \"46px\", position: \"absolute\", top: \"-9px\", right: \"-8px\"}} \r\n                        onClick={() => { \r\n                            onChange(\"\"); \r\n                            setImagePhoto(emptyPhoto);\r\n                            if (inputFileEl?.current) {\r\n                                //@ts-ignore\r\n                                inputFileEl.current.value='';\r\n                            }                             \r\n                        }}                     \r\n                    />\r\n\r\n                </a>\r\n                \r\n                <Button variant=\"outline-secondary\" style={{width: \"100%\"}} className=\"mt-3\"\r\n                    onClick={()=>{\r\n                        //onChange(\"Helloooo\")\r\n                        setShowSpinner(false);\r\n                        setButtonCaptionState(buttonCaption);\r\n                        //@ts-ignore                        \r\n                        inputFileEl.current.click();\r\n                    }}>\r\n                    {showSpinner && <Spinner\r\n                        as=\"span\"\r\n                        animation=\"border\"\r\n                        size=\"sm\"\r\n                        role=\"status\"\r\n                        aria-hidden=\"true\"\r\n                    />}                \r\n                    {buttonCaptionState}\r\n                </Button>{' '}\r\n                \r\n                \r\n                <input ref={inputFileEl} type=\"file\" accept=\"image/*\" style={{display: \"none\"}} \r\n                    onChange={onChangeFile}\r\n                    /*\r\n                    onChange={(e)=>{\r\n                        if (e.target.files && e.target.files.length > 0) {\r\n                            const file = e.target.files[0];\r\n                            //onChange(file.name);\r\n                            //setFilename(file.name);\r\n                            setImagePhoto(URL.createObjectURL(file)); \r\n                            if (autoUpload) {\r\n                                startUpload(file.name);     \r\n                            }\r\n                        }     \r\n                    }}\r\n                    */\r\n                />\r\n\r\n                \r\n                {/* \r\n                <input ref={inputTextEl} style={{width: \"100%\"}}\r\n                    //value={filename}\r\n                    //onChange={({ target: { value } }) => onChange(value)}\r\n                /> \r\n\r\n\r\n                \r\n\r\n              \r\n\r\n                    \r\n                <img src=\"{% static 'images/no-photo.png' %}\" class=\"img-fluid rounded\" id=\"id_insp_img_photo1\">\r\n                            <a href=\"#\"><i class=\"far fa-times-circle fa-2x iconDeletePhoto\" onclick=\"document.getElementById('id_insp_photo1_new_name').value='*will_be_deleted*'; $('#id_insp_img_photo1').attr('src', '{% static 'images/no-photo.png' %}');\"></i></a>\r\n\r\n                */}\r\n            </Form.Group>        \r\n        </div>\r\n  )\r\n\r\n})\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction makeRandomStr(length: number) {\r\n    let result           = '';\r\n    const characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    const charactersLength = characters.length;\r\n    for ( var i = 0; i < length; i++ ) {\r\n      result += characters.charAt(Math.floor(Math.random() *\r\n charactersLength));\r\n   }\r\n   return result;\r\n}\r\n\r\n\r\n\r\n\r\nfunction humanFileSize(size: number) {\r\n    const i = Math.floor( Math.log(size) / Math.log(1024) );\r\n    const sSize = ( size / Math.pow(1024, i) ).toFixed(2);\r\n    return `${sSize} ${['B', 'kB', 'MB', 'GB', 'TB'][i]}`;\r\n    //return ( size / Math.pow(1024, i) ).toFixed(2) * 1 + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n    \r\n};\r\n\r\nexport default ImageS3Upload","import { useEffect, useState } from 'react';\r\nimport TableList, {DataStructureTableList} from './TableList';\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\ninterface InspectionsListProps {\r\n    idTree: number | undefined;  \r\n    onClickButtonEditInsp: (inspData: any) => void;\r\n    onClickButtonPhotosInsp: (inspData: any) => void;\r\n}\r\n\r\nconst InspectionsList = (props: InspectionsListProps) => {\r\n\r\n    const [inspectionsData, setInspectionsData] = useState<DataStructureTableList[] | undefined>(undefined);\r\n    const rxDataLastEditetTreeId = useSelector((state: RootState) => state.dataReducer.dataLastEditedTreeId);\r\n\r\n    const fetchInpections = async () => {\r\n        //@ts-ignore\r\n        let url = `${process.env.REACT_APP_API_URL}citytree/cityfoo/trees/${props.idTree}/inspections/`;\r\n        let res = await fetch(url);\r\n        let data = await res.json(); \r\n        \r\n        // adding buttons\r\n        data = data.map((element: any) => {\r\n            element.buttons = [];\r\n            element.buttons.push({iconFA: 'fas fa-edit', iconFASize: '15pt', idButton: 'edit'});\r\n            \r\n            if (element?.photo1 || element?.photo2 || element?.photo3) {\r\n                element.buttons.push({iconFA: 'fa fa-camera', iconFASize: '15pt', idButton: 'photo'});                       \r\n                \r\n            }\r\n            element.typeData = 'Inspection';\r\n            return element;\r\n                \r\n        });\r\n        \r\n        //console.log('inspections', data);\r\n        setInspectionsData(data);       \r\n    };\r\n\r\n    useEffect(() => {\r\n        if (props.idTree) {\r\n            fetchInpections();\r\n        }\r\n    }, [props.idTree]);\r\n\r\n    useEffect(() => {\r\n        //console.log('rxDataLastEditetTreeId', props.idTree, rxDataLastEditetTreeId);\r\n        if (props.idTree && (props.idTree === rxDataLastEditetTreeId.treeId)) { // if data about inspection was updated, which belongs to this instance of tree, then update the component\r\n            fetchInpections();\r\n            console.log('rxDataLastEditetTreeId');\r\n        }\r\n    }, [rxDataLastEditetTreeId]);\r\n\r\n\r\n    const OnClickInspButtons = (rowData: any, idButton: string) => {            \r\n        if (idButton==='edit') props.onClickButtonEditInsp(rowData);        \r\n        if (idButton==='photo') props.onClickButtonPhotosInsp(rowData);                 \r\n    }\r\n\r\n  return (\r\n    <TableList \r\n        data={inspectionsData} \r\n        OnClickButtons={OnClickInspButtons} \r\n        sortField={\"datetime\"} \r\n        sortAsc={false} \r\n        size={\"sm\"}        \r\n        columns={\r\n            [\r\n                {\r\n                    field: \"#\",\r\n                    headerName: \"\",\r\n                },                            \r\n                {\r\n                    field: \"datetime\",\r\n                    headerName: \"Дата\",\r\n                    width: \"40%\",\r\n                    sortable: true,\r\n                    dateTimeOption: \"onlyDate\",\r\n                },\r\n                {\r\n                    field: \"typeData\",\r\n                    headerName: \"Тип\",\r\n                    width: \"35%\"\r\n                },    \r\n                {\r\n                    field: \"buttons\",\r\n                    headerName: \"Actions\",\r\n                    width: \"25%\"\r\n                },             \r\n            ]\r\n        }\r\n    />\r\n  )\r\n}\r\n\r\n\r\nexport default InspectionsList; ","export default __webpack_public_path__ + \"static/media/delete2.5b09b7b5.svg\";","import ImageS3Upload from './ImageS3Upload';\r\n\r\nexport default ImageS3Upload;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkMzMzRGRjBCRDQ0RTExRUI4M0FBOEVDOTExMzA0Q0NEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkMzMzRGRjBDRDQ0RTExRUI4M0FBOEVDOTExMzA0Q0NEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzMzNEZGMDlENDRFMTFFQjgzQUE4RUM5MTEzMDRDQ0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzMzNEZGMEFENDRFMTFFQjgzQUE4RUM5MTEzMDRDQ0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4+BmGWAAAYBklEQVR42uxd2VcUxxce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\"","import { Form, Button, Card, Row, Col, Modal} from 'react-bootstrap';\r\nimport {useState, useEffect, forwardRef, useRef, useImperativeHandle} from 'react'\r\nimport { Controller } from \"react-hook-form\";\r\nimport ImageS3Upload from \"./ImageS3Upload\";\r\nimport noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface UploadPhotosProps {\r\n    controlFromUseForm: any;\r\n    signingS3Url: string;\r\n    serverPhoto?: string | undefined | null;\r\n    onCallbackDone: () => void;\r\n} \r\n\r\ninterface RefObject {\r\n    uploadPhotos: () => void\r\n}\r\n\r\nconst UploadPhotos = forwardRef<RefObject | undefined, UploadPhotosProps>(({\r\n    controlFromUseForm,\r\n    signingS3Url,\r\n    serverPhoto,\r\n    onCallbackDone\r\n}, ref) => {\r\n\r\n\tconst photo1Ref = useRef(); // to be able to call method uploadFile\r\n\tconst photo2Ref = useRef();\r\n\tconst photo3Ref = useRef();   \r\n    \r\n\tconst [uploadedPhoto1, setUploadedPhoto1] = useState(false);\r\n\tconst [uploadedPhoto2, setUploadedPhoto2] = useState(false);\r\n\tconst [uploadedPhoto3, setUploadedPhoto3] = useState(false);   \r\n\r\n\tuseEffect(() => {\r\n\t\tif (uploadedPhoto1 && uploadedPhoto2 && uploadedPhoto3) {\t\t\t\r\n\t\t\tsetUploadedPhoto1(false);\r\n\t\t\tsetUploadedPhoto2(false);\r\n\t\t\tsetUploadedPhoto3(false);\r\n\t\t\t\t\t\t\r\n\t\t\tonCallbackDone();\r\n\t\t}\r\n\t}, [uploadedPhoto1, uploadedPhoto2, uploadedPhoto3]);\r\n\r\n\r\n\r\n    const autoUpload = false;\r\n\r\n    const resizerOptions = {\r\n        enabled: true,\r\n        autoResize: true, // otherwise resizing will be preform before uploading\r\n        maxWidth: 1280,\r\n        maxHeight: 1280,\r\n        compressFormat: \"JPEG\",\r\n        quality: 70,\r\n        rotation: 0            \r\n    }\r\n\r\n\r\n    // to be able to call method uploadFile\r\n    useImperativeHandle(ref, () => ({\r\n        uploadPhotos: () => {\r\n\r\n            let p1 = false;\r\n            let p2 = false;\r\n            let p3 = false;\r\n            //@ts-ignore\r\n            if (photo1Ref?.current?.uploadFile) {\r\n                //@ts-ignore\r\n                p1=photo1Ref.current.uploadFile();\r\n            }\t\r\n    \r\n            //@ts-ignore\r\n            if (photo2Ref?.current?.uploadFile) {\r\n                //@ts-ignore\r\n                p2=photo2Ref.current.uploadFile();\r\n            }\r\n            \r\n            //@ts-ignore\r\n            if (photo3Ref?.current?.uploadFile) {\r\n                //@ts-ignore\r\n                p3=photo3Ref.current.uploadFile();\r\n            }\t\t\r\n    \r\n    \r\n            console.log('p', p1, p2, p3);\r\n            if (!p1 && !p2 && !p3) { // there is no photo to upload, so just submit form\r\n                onCallbackDone();\r\n            } else {\r\n                //e.preventDefault();\r\n                setUploadedPhoto1(!p1);\r\n                setUploadedPhoto2(!p2);\r\n                setUploadedPhoto3(!p3);\r\n                //console.log('cons', {photo1: !p1, photo2: !p2, photo3: !p3, data: data})\r\n                //setPhotosUploaded({photo1: !p1, photo2: !p2, photo3: !p3, data: data});\r\n            }\t            \r\n\r\n        }\r\n    }));\r\n\r\n\r\n\r\n\tconst onFinishPhoto1 = () => {\r\n\t\tconsole.log('onFinishPhoto1');\r\n\t\tsetUploadedPhoto1(true);\r\n\t\t//setPhotosUploaded({...photosUploaded, photo1: true});\t\r\n\t}\r\n\tconst onFinishPhoto2 = () => {\r\n\t\tconsole.log('onFinishPhoto2');\r\n\t\tsetUploadedPhoto2(true);\r\n\t\r\n\t\t//setPhotosUploaded({photo1: photosUploaded.photo1, photo2: true, photo3: photosUploaded.photo3, data: photosUploaded.data});\r\n\t\t//setPhotosUploaded({...photosUploaded, photo2: true});\r\n\t}\r\n\tconst onFinishPhoto3 = () => {\r\n\t\tconsole.log('onFinishPhoto3');\r\n\t\t//setPhotosUploaded({...photosUploaded, photo3: true});\r\n\t\tsetUploadedPhoto3(true);\r\n\t}\r\n\r\n\r\n\r\n\r\n    return (\r\n\r\n\r\n        <Row className=\"mt-3\" xs={3}>\r\n            <Form.Group as={Col} controlId=\"formIdInsp1\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo1\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\r\n                            //startUploadState={photo1StateUpload.start}\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\t\r\n                            onFinish={onFinishPhoto1}\r\n                            resizer={resizerOptions}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                            {...field}\r\n                            ref={photo1Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Col} controlId=\"formIdInsp2\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo2\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\t\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\r\n                            onFinish={onFinishPhoto2}\r\n                            resizer={resizerOptions}\r\n                            {...field}\r\n                            ref={photo2Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Col} controlId=\"formIdInsp3\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo3\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\r\n                            onFinish={onFinishPhoto3}\r\n                            resizer={resizerOptions}\r\n                            {...field}\r\n                            ref={photo3Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\t\r\n        </Row>\r\n\r\n\r\n\r\n  )\r\n})\r\n\r\nexport default UploadPhotos","import { useState, useEffect, useRef } from 'react';\r\nimport { useForm, Controller  } from 'react-hook-form';\r\nimport { Form, Button, Row, Col, Modal} from 'react-bootstrap';\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../reducers/index'\r\nimport { TreeItem } from \"../interfaces\";\r\nimport InspectionsList from './InspectionsList';\r\nimport UploadPhotos from \"./UploadPhotos\"\r\n//import noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface FormTreeProps {\r\n\tonSubmitTree: (data: {}) => void;\r\n\t//onDeleteTree: (id: number) => void;\r\n    onDeleteTree: (data: TreeItem | null) => void;\r\n\tonCloseTree: () => void;\r\n    \r\n    onNewInsp:(idTree: number) => void;\r\n    onClickInspEdit: (data: {}) => void;\r\n    onClickInspPhotos: (data: {}) => void;\r\n    onClickEditCoords: (coord: {lat: string; lng: string}) => void;\r\n        \t\r\n    dataTreeForm: TreeItem | null;\r\n    city: string;\r\n    signingS3Url: string;\r\n}\r\n\r\n\r\nconst FormTree = ({\r\n\tonSubmitTree,\r\n\tonDeleteTree,\r\n\tonCloseTree,\r\n    onNewInsp,\r\n    onClickInspEdit,\r\n    onClickInspPhotos,\r\n    onClickEditCoords,\r\n\tdataTreeForm,\r\n    city,\r\n    signingS3Url\r\n}: FormTreeProps) => {\r\n\r\n    const rxMapMarkerState = useSelector((state: RootState) => state.uiReducer.mapMarkerState);\r\n    const rxNewTreeCreation = useSelector((state: RootState) => state.uiReducer.newTreeCreation);\r\n    const [showModalDelete, setShowModalDelete] = useState(false);\r\n\r\n    const rxDictSpecieses = useSelector((state: RootState) => state.dataReducer.dictSpecieses);\r\n    const rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);\r\n\tconst rxDictPlaceTypes = useSelector((state: RootState) => state.dataReducer.dictPlaceTypes);\r\n\tconst rxDictIrrigationMethods = useSelector((state: RootState) => state.dataReducer.dictIrrigationMethods);\r\n    const rxDictGroupSpecs = useSelector((state: RootState) => state.dataReducer.dictGroupSpec);\r\n\r\n\r\n    const uploadPhotosRef = useRef();\r\n\r\n\r\n    // interface IInspections {\r\n\t// \tid: number;\r\n\t// \t[key: string]: any | {iconFA?: string; iconFASize?: string; text?: string; idButton: string};\r\n\t// };\r\n\r\n    //const [inspections, setInspections] = useState<IInspections[] | undefined>(undefined);\r\n\r\n    const { t } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n        reset();\r\n        //@ts-ignore\r\n        setValue(\"irrigationmethod\", optionsIrrigationMethodsData[0]);                 \r\n        setValue(\"latitude\", rxMapMarkerState.position.lat);\r\n        setValue(\"longitude\", rxMapMarkerState.position.lng);                  \r\n\t}, [rxNewTreeCreation]);  \r\n    \r\n\tuseEffect(() => {\r\n\t\tif (rxMapMarkerState.visible) {\r\n\t\t\tsetValue(\"latitude\", rxMapMarkerState.position.lat);\r\n\t\t\tsetValue(\"longitude\", rxMapMarkerState.position.lng);                       \r\n\t\t}\r\n\t}, [rxMapMarkerState]);    \r\n\r\n\r\n\r\n\r\n    // when provide data to show it\r\n\tuseEffect(() => {\r\n\t\tlet formData: any = {};\r\n\r\n        formData.id = dataTreeForm?.id;\r\n        formData.latitude = dataTreeForm?.latitude;\r\n        formData.longitude = dataTreeForm?.longitude;\r\n        \r\n\t\tlet species = dataTreeForm?.species_id;\r\n\t\tif (species) {\r\n\t\t\tlet isFound = false; // to stop loop\r\n            optionsSpeciesesData.forEach((category:any) => { // loop for categories (The most common, The medium common and so on...)\r\n                if (category?.options && Array.isArray(category.options)) { // in every categories trying to find id of species \r\n                    \r\n                    if (!isFound) {\r\n                        formData.species = category.options.find(                \t\t\t\r\n                            (item: any) => {\r\n                                isFound = item.value === species; \r\n                                return isFound;\t}\r\n                        );             \r\n                    }       \r\n                } else {  \r\n                    // if there are species at the same level with categories, like Unknown specify.                 \r\n                    if (category?.value && category.value === species) {                        \r\n                        formData.species = category;\r\n                        isFound = true;                        \r\n                    }\r\n\r\n                }      \r\n            });\r\n            \r\n\t\t} \r\n\r\n        \r\n        \r\n        \r\n        \r\n        formData.speciescomment = dataTreeForm?.speciescomment;\r\n        formData.comment = dataTreeForm?.comment;\r\n\r\n        \r\n\t\tlet placetype = dataTreeForm?.placetype;\r\n\t\tif (placetype) {\r\n\t\t\tconsole.log('optionsPlaceTypesData', optionsPlaceTypesData)\r\n\t\t\tformData.placetype = optionsPlaceTypesData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === placetype\t\r\n\t\t\t);\r\n\t\t}    \r\n        \r\n\t\tlet irrigationmethod = dataTreeForm?.irrigationmethod;\r\n\t\tif (irrigationmethod) {\r\n\t\t\t//console.log('optionsPlaceTypesData', optionsPlaceTypesData)\r\n\t\t\tformData.irrigationmethod = optionsIrrigationMethodsData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === irrigationmethod\t\r\n\t\t\t);\r\n\t\t}          \r\n        \r\n\r\n\t\tif (dataTreeForm?.dateplanted) {\r\n            console.log('dataTreeForm?.properties?.dateplanted', dataTreeForm?.dateplanted);\r\n\t\t\tformData.dateplanted = dataTreeForm.dateplanted;\r\n\t\t}\r\n\r\n        formData.googlestreeturl = dataTreeForm?.googlestreeturl;\r\n\r\n\r\n        reset(formData, { keepDefaultValues: true });\r\n\r\n\t}, [dataTreeForm]);\r\n\r\n\r\n\t//let optionsSpeciesesFilter: {label: string; options: {value: number; label: string}[] | undefined}[] = [];\r\n\tlet optionsSpeciesesData: any = [];\r\n\tif (Array.isArray(rxDictSpecieses) && Array.isArray(rxDictGroupSpecs)) {\r\n\t\tlet unknownTreeItem = null;\r\n\r\n\t\toptionsSpeciesesData = rxDictGroupSpecs.map(itemGroup => {\r\n\t\t\treturn {\t\t\t\t\r\n\t\t\t\tlabel: itemGroup.groupname,\r\n\t\t\t\toptions: rxDictSpecieses.map(spec => {\r\n\t\t\t\t\tif (itemGroup.id === spec.groupspec) {\r\n\t\t\t\t\t\tif (spec.id !== 1) { // unknow tree item has id = 1\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname,\r\n\t\t\t\t\t\t\t\tspeciesname: spec.speciesname,\r\n\t\t\t\t\t\t\t\ttypespec: spec.typespec\r\n\t\t\t\t\t\t\t\t//color: '#FF8B00'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tunknownTreeItem = {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn null;\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}).filter(e => e) // removes all undefined items in result array\t\t\t \r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\tif (unknownTreeItem) {\r\n\t\t\toptionsSpeciesesData.unshift(unknownTreeItem);\r\n\t\t}\t\t\t\t\r\n\t}    \r\n\r\n\r\n    let optionsStatusesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictStatuses)) {\r\n        optionsStatusesData = rxDictStatuses.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.statusname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsCareTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictCareTypes)) {\r\n        optionsCareTypesData = rxDictCareTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.carename,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsRemarksData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictRemarks)) {\r\n        optionsRemarksData = rxDictRemarks.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.remarkname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsPlaceTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictPlaceTypes)) {\r\n        //console.log('rxDictPlaceTypes', rxDictPlaceTypes)\r\n        optionsPlaceTypesData = rxDictPlaceTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.placename,\r\n            };\r\n        });\r\n    }\r\n\r\n    let optionsIrrigationMethodsData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictIrrigationMethods)) {\r\n        optionsIrrigationMethodsData = rxDictIrrigationMethods.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.irrigationname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tsetValue,\r\n\t\tgetValues,\r\n\t\tformState: { errors },\r\n        trigger\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\t\t\t\r\n            id: \"\",\r\n            latitude: \"\",\r\n            longitude: \"\",\r\n            species: \"\",\r\n            speciescomment: \"\",\r\n            comment: \"\",\r\n            placetype: \"\",\r\n            irrigationmethod: \"\",            \r\n            dateplanted: \"\",\r\n            googlestreeturl: \"\",\r\n            \r\n            height: \"\",\r\n            crowndiameter: \"\",\r\n            trunkgirth: \"\",\r\n            status: \"\",\r\n            remarks: \"\",\r\n            recommendations: \"\",\r\n            photo1: \"\",\r\n            photo2: \"\",\r\n            photo3: \"\",\r\n            useradded: 0\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\r\n\tasync function onSubmitBefore(e: any) {\r\n\t\te.preventDefault();\t\t\t\t\r\n\t\t\r\n        const result = await trigger(); // programmaticaly run validation\r\n        if (result) {\r\n            //@ts-ignore\r\n            uploadPhotosRef.current.uploadPhotos(); // component uploadPhotos has a callback to start a submit of the form, when uploading has been finished.\r\n        }\r\n\r\n\r\n\r\n        /*\r\n        //setPhoto1StateUpload({...photo1StateUpload, start: true})\r\n\r\n\t\tlet p1 = false;\r\n\t\tlet p2 = false;\r\n\t\tlet p3 = false;\r\n\t\t//@ts-ignore\r\n\t\tif (photo1Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp1=photo1Ref.current.uploadFile();\r\n\t\t}\t\r\n\r\n\t\t//@ts-ignore\r\n\t\tif (photo2Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp2=photo2Ref.current.uploadFile();\r\n\t\t}\r\n\t\t\r\n\t\t//@ts-ignore\r\n\t\tif (photo3Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp3=photo3Ref.current.uploadFile();\r\n\t\t}\t\t\r\n\r\n\r\n\t\tconsole.log('p', p1, p2, p3);\r\n\t\tif (!p1 && !p2 && !p3) { // there is no photo to upload, so just submit form\r\n\t\t\t//handleSubmit(prepareOnSubmitInsp)()\r\n\t\t} else {\r\n\t\t\te.preventDefault();\r\n\t\t\tsetUploadedPhoto1(!p1);\r\n\t\t\tsetUploadedPhoto2(!p2);\r\n\t\t\tsetUploadedPhoto3(!p3);\r\n\t\t\t//console.log('cons', {photo1: !p1, photo2: !p2, photo3: !p3, data: data})\r\n\t\t\t//setPhotosUploaded({photo1: !p1, photo2: !p2, photo3: !p3, data: data});\r\n\t\t}\t\t\r\n\t\t\r\n\t\t//handleSubmit(prepareOnSubmitInsp)()\r\n        */\r\n\t}\r\n\r\n\tconst onCallbackDone = () => {\r\n\t\tconsole.log('DONE');\r\n\t\thandleSubmit(prepareOnSubmitTree)();\t\r\n\t}    \r\n\r\n\r\n\r\n\tfunction prepareOnSubmitTree(data: {\r\n        id: any;\r\n        latitude: string;\r\n        longitude: string;\r\n        species: any;\r\n        speciescomment: string;\r\n        comment: string;\r\n        placetype: any;\r\n        irrigationmethod: any;\r\n        dateplanted: any;\r\n        googlestreeturl: string | null;\r\n\r\n        inspection?: any;\r\n        height: any;\r\n        crowndiameter: any;\r\n        trunkgirth: any;\r\n        status: any;\r\n        remarks: any;\r\n        recommendations: any;\r\n        photo1: string | null; \r\n        photo2: string | null;\r\n        photo3: string | null;\r\n\r\n        useradded: any;\r\n    }) {\r\n\t\t//let dataResult: any = {};\r\n        //console.log('data', data);\r\n\r\n\r\n        if (!data.dateplanted) {\r\n            data.dateplanted = null;    \r\n        }\r\n\r\n        if (rxNewTreeCreation === true) {\r\n            // new record                \r\n            data.species = data.species.value;\r\n            data.placetype = data.placetype.value;\r\n            data.irrigationmethod = data?.irrigationmethod?.value;            \r\n\r\n            // make inspection\r\n            if (data?.height && data?.crowndiameter && data?.trunkgirth && data?.status) {\r\n                data.inspection = {\r\n                    height: parseInt(data.height),\r\n                    crowndiameter: parseFloat(data.crowndiameter),\r\n                    trunkgirth: parseInt(data.trunkgirth),\r\n                    status: data.status.value,  \r\n                    \r\n                    photo1: data.photo1,          \r\n                    photo2: data.photo2, \r\n                    photo3: data.photo3, \r\n                };\r\n\r\n                if (data?.remarks && Array.isArray(data.remarks)) {\r\n                    data.inspection.remarks = [];\r\n                    data.remarks.forEach(element => {\r\n                        data.inspection.remarks.push(element.value);     \r\n                    });                                           \r\n                }\r\n                \r\n                if (data?.recommendations && Array.isArray(data.recommendations)) {\r\n                    data.inspection.recommendations = [];\r\n                    data.recommendations.forEach(element => {\r\n                        data.inspection.recommendations.push(element.value);     \r\n                    });                                           \r\n                }                             \r\n            }   \r\n\r\n            delete data.id;\r\n            delete data.height;\r\n            delete data.crowndiameter;\r\n            delete data.trunkgirth;\r\n            delete data.status; \r\n            delete data.remarks;\r\n            delete data.recommendations; \r\n\r\n            console.log('onSubmitTree', data);\r\n            onSubmitTree(data);\r\n\r\n        } else {\r\n            // edit\r\n            data.species = data.species.value;\r\n            data.placetype = data.placetype.value;\r\n            data.irrigationmethod = data?.irrigationmethod?.value; \r\n            if (dataTreeForm) data.useradded = dataTreeForm.useradded;\r\n            \r\n            \r\n            console.log('dataedit', data);\r\n            onSubmitTree(data);\r\n        }\r\n\r\n        \r\n    }        \r\n\r\n\r\n    const customStyles = {\r\n\t\t//@ts-ignore\r\n\t\toption: (styles, { data, isSelected, isFocused, isDisabled  }) => {\r\n\t\t\t//const color = chroma(data.color);\r\n\t\t\treturn {\r\n\t\t\t  ...styles,\r\n\t\t\t  paddingLeft: 20,\r\n\t\t\t  //backgroundColor: data.typespec === 2 ? '#EEFFEE' : undefined,\r\n              backgroundColor: isDisabled\r\n              ? undefined\r\n              : isSelected\r\n              ? \"#606060\"\r\n              : isFocused\r\n              ? \"#EEEEEE\"\r\n              : data.typespec === 2 ? '#EEFFEE' : undefined,\r\n\t\t\t};\r\n\t\t  },\r\n\t  } \r\n\r\n\r\n\r\n\t  const Option = (props: any) => {\r\n\t\tconst { label, speciesname } = props.data;\r\n\t\treturn (\r\n\t\t  <components.Option {...props}>\r\n\t\t\t<span>{label}</span> <span style={{ color: \"darkgray\" }}>{speciesname}</span>\r\n\t\t  </components.Option>\r\n\t\t);\r\n\t  };\r\n\r\n\r\n    \r\n\r\n    function OnButtonTableClick (rowData: any, idButton: string) {    \r\n        if (idButton==='edit') {\r\n            //onClickInspEdit(rowData);\r\n        } else if (idButton==='photo') {\r\n            //onClickInspPhotos(rowData);\r\n        }        \r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form\r\n\t\t\t\tclassName=\"m-1\"\r\n\t\t\t\tonSubmit={handleSubmit(prepareOnSubmitTree)}\r\n\t\t\t>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formCoordEditButton\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.latLng\")}{\" \"}\r\n\t\t\t\t\t\t\t<a href=\"#\">\r\n\t\t\t\t\t\t\t\t<i className=\"fas fa-edit align-middle\" onClick={() => onClickEditCoords({lat:getValues(\"latitude\"), lng:getValues(\"longitude\")})}></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formLatTree\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"latitude\"\r\n                            rules={{ required: true }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tstep=\"any\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tisInvalid={!!errors.latitude}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t{t<string>(\"words.requiredField\")}\r\n\t\t\t\t\t\t</Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formLngTree\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"longitude\"\r\n                            rules={{ required: true }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tstep=\"any\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tisInvalid={!!errors.longitude}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t{t<string>(\"words.requiredField\")}\r\n\t\t\t\t\t\t</Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formSpecies\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.species\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"species\"\r\n                        rules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={true}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsSpeciesesData}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tgetOptionLabel={(option) =>`${option.label} - ${option.speciesname}`}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n                    <p className=\"requiredField\">{errors.species?.message}</p>\r\n\t\t\t\t</Form.Group>\r\n\r\n                \r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formSpeciesCommentTree\"\r\n\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.speciescomment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"speciescomment\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n                \r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formCommentTree\"\r\n\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.comment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"comment\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tas=\"textarea\"\r\n\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formPlaceTypeTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.placetype\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"placetype\"\r\n                            rules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n                                    options={optionsPlaceTypesData}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n                        <p className=\"requiredField\">{errors.placetype?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formIrrigationmethodTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.irrigationmethod\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"irrigationmethod\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n                                    options={optionsIrrigationMethodsData}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n                    <Form.Group as={Col} controlId=\"formDatePlantedTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.dateplanted\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateplanted\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formGoogleStreetUrlTree\" style={{ minWidth: \"230px\" }}>\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.googlestreeturl\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"googlestreeturl\"\r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Form.Control\r\n                                    type=\"text\"\r\n                                    {...field}\r\n                                />\r\n                            )}\r\n                        />\r\n                    </Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n                {rxNewTreeCreation ? \r\n                <>\r\n                    <Form.Group className=\"mt-4\" controlId=\"formFirstInspectionTree\">\r\n                        <Form.Label>\r\n                            <b>{t<string>(\"sidebar.treeTab.firstInspection\")}</b>\r\n                        </Form.Label>\r\n\r\n                    </Form.Group>   \r\n                    \r\n                    <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"formHeightTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.heightTree\")}\r\n                            </Form.Label>\r\n                            <Controller\r\n                                name=\"height\"\r\n                                rules={{ required: t<string>(\"words.requiredField\") }}                               \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"\r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n                            <p className=\"requiredField\">{errors.height?.message}</p>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formDiameterTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.diameterTree\")}\r\n                            </Form.Label>\r\n                            <Controller\r\n                                name=\"crowndiameter\"\r\n                                rules={{ required: t<string>(\"words.requiredField\"), max: 99, pattern: /^\\d+([.]\\d)?$/ }}                              \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"\r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n\t\t\t\t\t\t{errors.crowndiameter?.message && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">{errors.crowndiameter?.message}</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"max\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Maximum value is 99</p>\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"pattern\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Allow only one decimal point</p>\r\n\t\t\t\t\t\t}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formGirthTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.girthTree\")}\r\n                            </Form.Label>\r\n                            <div style={{height: \"100%\"}}>\r\n                            <Controller\r\n                                name=\"trunkgirth\"\r\n                                rules={{ required: t<string>(\"words.requiredField\") }}                                \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"    \r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n                            <p className=\"requiredField\">{errors.trunkgirth?.message}</p>\r\n                            </div>\r\n                        </Form.Group>                        \r\n\t\t\t\t    </Row>  \r\n\r\n\r\n\r\n\r\n\r\n\r\n                    <Form.Group controlId=\"formStatusTree\" className=\"mt-3\">\r\n                        <Form.Label className=\"required\">\r\n                            {t<string>(\"sidebar.treeTab.status\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"status\"\r\n                            rules={{ required: t<string>(\"words.requiredField\") }} \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsStatusesData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n                        <p className=\"requiredField\">{errors.status?.message}</p>\r\n\t\t\t\t    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formRemarksTree\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.remarks\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"remarks\"                            \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    isMulti\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsRemarksData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n\t\t\t\t    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formCareTypesTree\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.careTypes\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"recommendations\"                            \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    isMulti\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsCareTypesData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n\t\t\t\t    </Form.Group>    \r\n\r\n\r\n                    <UploadPhotos \r\n                        controlFromUseForm={control}\r\n                        signingS3Url={signingS3Url}\r\n                        onCallbackDone={onCallbackDone}\t\r\n                        ref={uploadPhotosRef}\r\n\t\t\t\t    />\r\n                </>\r\n\r\n                \r\n                : <>\r\n                    <Form.Group controlId=\"formInspActTable\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.inspActionsTable\")}\r\n                        </Form.Label>\r\n                        \r\n                        <InspectionsList \r\n                            idTree={dataTreeForm?.id}\r\n                            //data={inspections} \r\n                            //OnClickButtons={OnButtonTableClick}\r\n                            onClickButtonEditInsp={onClickInspEdit}\r\n                            onClickButtonPhotosInsp={onClickInspPhotos}\r\n                        />\r\n\r\n                    </Form.Group>\r\n\r\n\r\n                    <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"formNewInspButton\">\r\n                            <Button\r\n                                style={{width: \"100%\"}}\r\n                                onClick={() => dataTreeForm?.id && onNewInsp(dataTreeForm.id)}\r\n                                variant=\"light\"\r\n                            >\r\n                                {t<string>(\"sidebar.treeTab.newInspButton\")}\r\n                            </Button>{\" \"}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formNewActButton\">\r\n                            <Button\r\n                                style={{width: \"100%\"}}\r\n                                //onClick={}\r\n                                variant=\"light\"\r\n                            >\r\n                                {t<string>(\"sidebar.treeTab.newActButton\")}\r\n                            </Button>{\" \"}\r\n                        </Form.Group>\r\n                    </Row>\r\n                </>}\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"id\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(true)}\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.delete\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button \r\n                        onClick={onCloseTree} \r\n                        variant=\"secondary\"\r\n                    >\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.close\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button                        \r\n\t\t\t\t\t\ttype=\"submit\"\r\n                        onClick={ rxNewTreeCreation ? onSubmitBefore : undefined }\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"110px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.save\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showModalDelete}\r\n\t\t\t\tonHide={() => setShowModalDelete(false)}\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t<Modal.Title>{t<string>(\"words.deleting\")}</Modal.Title>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Body>{t<string>(\"sidebar.treeTab.confirmDeleting\")}</Modal.Body>\r\n\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowModalDelete(false);\r\n\t\t\t\t\t\t\t//onDeleteTree(parseInt(getValues(\"id\").toString()));\r\n                            onDeleteTree(dataTreeForm);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.delete\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(false)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.cancel\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n\r\n}\r\n\r\n\r\nexport default FormTree","import { useState, useEffect, useRef } from \"react\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { Form, Button, Row, Col, Modal } from \"react-bootstrap\";\r\nimport Select from \"react-select\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\nimport { InspItem } from \"../interfaces\";\r\nimport UploadPhotos from \"./UploadPhotos\"\r\n//import ImageS3Upload from \"./ImageS3Upload\";\r\n//import noPhotoImage from \"./images/no-photo.png\";\r\n\r\n\r\n\r\n\r\ninterface FormInspProps {\r\n\tonSubmitInsp: (data: {}) => void;\r\n\tonDeleteInsp: (data: InspItem | null) => void;\r\n\tonCloseInsp: () => void;\r\n\tdataInspForm: InspItem | null;\r\n\tcity: string;\r\n\tsigningS3Url: string;\r\n}\r\n\r\n\r\nconst FormInspection = ({\r\n\tonSubmitInsp,\r\n\tonDeleteInsp,\r\n\tonCloseInsp,\r\n\tdataInspForm,\r\n\tcity,\r\n\tsigningS3Url\r\n}: FormInspProps) => {\r\n\r\n    \t\r\n\tconst [showModalDelete, setShowModalDelete] = useState(false);\r\n\r\n\tconst rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);    \r\n    const { t } = useTranslation();\r\n\r\n\r\n\tconst uploadPhotosRef = useRef();\r\n\r\n\tconst {\t\t\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tsetValue,\r\n\t\tgetValues,\r\n\t\tformState: { errors, isValid },\r\n\t\ttrigger \r\n\t} = useForm({ \r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\t\t\t\r\n            id: \"\",  \r\n            treeId: \"\",          \r\n            height: \"\",\r\n            crowndiameter: \"\",\r\n            trunkgirth: \"\",\r\n            status: \"\",\r\n            remarks: [],\r\n            recommendations: [],\r\n\t\t\tphoto1: \"\",\r\n\t\t\tphoto2: \"\",\r\n\t\t\tphoto3: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n\t\tlet formData: any = {};\r\n\r\n        formData.id = dataInspForm?.id;  \r\n        formData.treeId = dataInspForm?.tree; \r\n        formData.height = dataInspForm?.height; \r\n        formData.crowndiameter = dataInspForm?.crowndiameter; \r\n        formData.trunkgirth = dataInspForm?.trunkgirth; \r\n        \r\n\t\tlet status = dataInspForm?.status;\r\n\t\tif (status) {\r\n\t\t\tformData.status = optionsStatusesData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === status\t\r\n\t\t\t);\r\n\t\t}   \r\n  \r\n        \r\n\t\tlet remarks = dataInspForm?.remarks;\r\n\t\tif (remarks) {\r\n\t\t\t//let remarksValues = remarks.map((item) => item);\r\n\t\t\tformData.remarks = optionsRemarksData.filter(\r\n\t\t\t\t//@ts-ignore\r\n                (item) => remarks.includes(item.value)\r\n\t\t\t);\r\n\t\t}  \r\n        \r\n\t\tlet recommendations = dataInspForm?.recommendations;\r\n\t\tif (recommendations) {\r\n\t\t\t//let remarksValues = remarks.map((item) => item);\r\n\t\t\tformData.recommendations = optionsCareTypesData.filter(\r\n\t\t\t\t//@ts-ignore\r\n                (item) => recommendations.includes(item.value)\r\n\t\t\t);\r\n\t\t}        \r\n\r\n\r\n\t\tif (dataInspForm?.photo1) {\r\n\t\t\tformData.photo1 = dataInspForm.photo1;\r\n\t\t} else {\r\n\t\t\tformData.photo1 = '';\r\n\t\t}\r\n\t\tif (dataInspForm?.photo2) {\r\n\t\t\tformData.photo2 = dataInspForm.photo2;\r\n\t\t} else {\r\n\t\t\tformData.photo2 = '';\r\n\t\t}\r\n\t\tif (dataInspForm?.photo3) {\r\n\t\t\tformData.photo3 = dataInspForm.photo3;\r\n\t\t} else {\r\n\t\t\tformData.photo3 = '';\r\n\t\t}\t\t\r\n\t\t\r\n        \r\n        reset(formData, { keepDefaultValues: true });\r\n\t\tconsole.log('dataInspForm');\r\n\r\n    }, [dataInspForm]);\r\n\r\n\r\n    let optionsStatusesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictStatuses)) {\r\n        optionsStatusesData = rxDictStatuses.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.statusname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsCareTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictCareTypes)) {\r\n        optionsCareTypesData = rxDictCareTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.carename,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsRemarksData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictRemarks)) {\r\n        optionsRemarksData = rxDictRemarks.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.remarkname,\r\n            };\r\n        });\r\n    }    \r\n\r\n\r\n\r\n\r\n\tasync function onSubmitBefore(e: any) {\r\n\t\te.preventDefault();\t\t\t\t\r\n\t\tconst result = await trigger(); // programmaticaly run validation\r\n\t\tif (result) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tuploadPhotosRef.current.uploadPhotos(); // component uploadPhotos has a callback to start a submit of the form, when uploading has been finished.\r\n\t\t}\r\n\t}\r\n\r\n\tfunction prepareOnSubmitInsp(data: {\r\n        id: any;  \r\n        treeId: any;      \r\n        height: any;\r\n        crowndiameter: any;\r\n        trunkgirth: any;\r\n        status: any;\r\n        remarks: any;\r\n        recommendations: any;\r\n        //photo1: any;\r\n        //photo2: any;\r\n        //photo3: any;\r\n    }) {\r\n\r\n\t\tconsole.log('submit', data);\r\n\r\n        data.height = parseInt(data.height);\r\n        data.crowndiameter = parseFloat(data.crowndiameter);\r\n        data.trunkgirth = parseInt(data.trunkgirth);\r\n        data.status = data.status.value;\r\n\r\n        if (data?.remarks && Array.isArray(data.remarks)) {\r\n            let remarks: number[] = [];\r\n            data.remarks.forEach((element:{value: number; label: string}) => {\r\n                remarks.push(element.value);     \r\n            }); \r\n            data.remarks = remarks;                                          \r\n        }\r\n\r\n        if (data?.recommendations && Array.isArray(data.recommendations)) {\r\n            let recommendations: number[] = [];\r\n            data.recommendations.forEach((element:{value: number; label: string}) => {\r\n                recommendations.push(element.value);     \r\n            }); \r\n            data.recommendations = recommendations;                                          \r\n        }  \t\t\r\n\r\n\t\tonSubmitInsp({...data, user: dataInspForm?.user});\r\n\r\n    };\r\n\r\n\r\n\tconst onUploadError = (e: any) => {\r\n\t\tconsole.log('onUploadError', e);\r\n\t}\r\n\r\n\r\n\tconst onCallbackDone = () => {\r\n\t\tconsole.log('DONE');\r\n\t\thandleSubmit(prepareOnSubmitInsp)();\t\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form className=\"m-1\" onSubmit={handleSubmit(prepareOnSubmitInsp)}>\t\t\t\t\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formHeightTreeInsp\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.heightTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"height\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t)}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<p className=\"requiredField\">{errors.height?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDiameterTreeInsp\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.diameterTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crowndiameter\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\"), max: 99, pattern: /^\\d+([.]\\d)?$/ }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.crowndiameter?.message && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">{errors.crowndiameter?.message}</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"max\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Maximum value is 99</p>\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"pattern\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Allow only one decimal point</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formGirthTreeInsp\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.girthTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkgirth\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<p className=\"requiredField\">{errors.trunkgirth?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formStatusTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.status\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"status\"\r\n\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsStatusesData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<p className=\"requiredField\">{errors.status?.message}</p>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formRemarksTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.remarks\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"remarks\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsRemarksData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formCareTypesTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.careTypes\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"recommendations\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsCareTypesData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdInsp\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"id\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\t\t\t\t\r\n\r\n\r\n\t\t\t\t<UploadPhotos \r\n\t\t\t\t\tcontrolFromUseForm={control}\r\n\t\t\t\t\tsigningS3Url={signingS3Url}\r\n\t\t\t\t\tserverPhoto={dataInspForm?.photoServer}\r\n\t\t\t\t\tonCallbackDone={onCallbackDone}\t\r\n\t\t\t\t\tref={uploadPhotosRef}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdTreeInsp\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"treeId\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>      \r\n\r\n\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(true)}\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t> \r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.delete\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button \r\n                        onClick={onCloseInsp} \t\t\t\t\t\r\n                        variant=\"secondary\"\r\n                    >\r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.close\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button                        \r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tonClick={onSubmitBefore}\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"110px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.save\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\r\n\r\n\r\n\r\n\t\t\t</Form>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showModalDelete}\r\n\t\t\t\tonHide={() => setShowModalDelete(false)}\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t<Modal.Title>{t<string>(\"words.deleting\")}</Modal.Title>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Body>{t<string>(\"sidebar.inspTab.confirmDeleting\")}</Modal.Body>\r\n\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowModalDelete(false);\r\n\t\t\t\t\t\t\t//onDeleteInsp(parseInt(getValues(\"id\").toString()));\r\n                            onDeleteInsp(dataInspForm);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.delete\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(false)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.cancel\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FormInspection;\r\n","import Carousel from \"react-bootstrap/Carousel\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport \"./ImageSlider.css\";\r\n\r\n\r\ninterface ImageSliderProps {\r\n    visible: boolean;\r\n    setVisible: any;\r\n    images: string[];\r\n} \r\n\r\nfunction ImageSlider({\r\n    visible,\r\n    setVisible,\r\n    images\r\n}: ImageSliderProps) {\r\n  return (\r\n    \r\n    \r\n    <Modal\r\n        show={visible}\r\n        onHide={() => setVisible({visible: false, images:[]})}\r\n        //size=\"lg\"\r\n        //@ts-ignore\r\n        dialogClassName=\"modal-90w\"       \r\n        aria-labelledby=\"example-custom-modal-styling-title\"\r\n    >\r\n        <Modal.Body>\r\n            <Carousel interval={null}>\r\n                {                \r\n                    images.map((photo) => \r\n                        <Carousel.Item key={photo} >\r\n                            <img\r\n                                className=\"d-block w-100\"\r\n                                src={photo}                                               \r\n                            />\r\n                        </Carousel.Item>                    \r\n                    )                \r\n                }                \r\n            </Carousel>\r\n        </Modal.Body>\r\n    </Modal>\r\n\r\n  )\r\n}\r\n\r\nexport default ImageSlider","import { Form, Button, Row, Col, } from 'react-bootstrap';\r\nimport Table from 'react-bootstrap/Table';\r\nimport Carousel from \"react-bootstrap/Carousel\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport InspectionsList from './InspectionsList';\r\nimport { useTranslation } from 'react-i18next';\r\nimport \"./TreePreviewModal.css\";\r\nimport noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface TreePreviewModalProps {\r\n    visible: boolean;\r\n    data: any;\r\n    setTreePreview: any; \r\n    onButtonEditTreeClick: (idTree: number) => void;\r\n    onClickInspEdit: (data: {}) => void;\r\n    onClickButtonEditInsp: (inspData: any) => void;\r\n    onClickButtonPhotosInsp: (inspData: any) => void;    \r\n} \r\n\r\nfunction TreePreviewModal({\r\n    visible,\r\n    data,\r\n    setTreePreview,\r\n    onButtonEditTreeClick,\r\n    onClickButtonEditInsp,\r\n    onClickButtonPhotosInsp\r\n}: TreePreviewModalProps) {\r\n\r\n    const { t } = useTranslation();    \r\n    const handleClose = () => setTreePreview({visible: false, data: {photos:[]}});    \r\n    const handleEditTree = () => {\r\n        setTreePreview({visible: false, data: {photos:[]}}); \r\n        onButtonEditTreeClick(data.id)   \r\n    }\r\n\r\n    const onClickButtonEditInspBefore = (inspData: any) => {\r\n        setTreePreview({visible: false, data: {photos:[]}});\r\n        onClickButtonEditInsp(inspData);\r\n    }\r\n\r\n    const isPrevNextControlsEnable = () => {\r\n        return numberOfPhotos() > 1;\r\n    }\r\n\r\n    function numberOfPhotos() {\r\n        let result = 0;\r\n        if (data?.lastinsp_photo1 && data.lastinsp_photo1) result++;\r\n        if (data?.lastinsp_photo2 && data.lastinsp_photo2) result++;\r\n        if (data?.lastinsp_photo3 && data.lastinsp_photo3) result++;\r\n        \r\n        return result;        \r\n    }\r\n\r\n\r\n\r\n    function itemPhoto(photoIndex: string){\r\n        const photoKeyName = 'lastinsp_photo'+photoIndex;\r\n        \r\n        return (            \r\n            (data.hasOwnProperty(photoKeyName) && data[photoKeyName]) && (\r\n                <Carousel.Item key={data[photoKeyName]} className=\"carouselItem\">\r\n                    <img\r\n                        className=\"d-block w-100 imgItem\" alt={\"photo\"+photoIndex}\r\n                        src={data.photoServer+data[photoKeyName]}                                               \r\n                    />\r\n                </Carousel.Item> \r\n            )\r\n        )         \r\n    }\r\n\r\n    function imgPhotoItem() {        \r\n       \r\n        if (numberOfPhotos() > 0) {\r\n            return (\r\n                <Carousel interval={null} controls={isPrevNextControlsEnable()}>\r\n                    \r\n                    {itemPhoto('1')}\r\n                    {itemPhoto('2')}\r\n                    {itemPhoto('3')}\r\n                    \r\n                </Carousel>                \r\n            )\r\n        } else {\r\n            return (\r\n                <Carousel interval={null} controls={isPrevNextControlsEnable()}>\r\n                    <Carousel.Item className=\"carouselItem\">\r\n                        <img className=\"d-block w-100 imgItem\" alt=\"\" src={noPhotoImage} />\r\n                    </Carousel.Item>   \r\n                </Carousel>   \r\n            )\r\n        }\r\n    }\r\n\r\n\r\n    return (    \r\n    \r\n        <Modal\r\n            show={visible}\r\n            onHide={handleClose}\r\n            //size=\"lg\"\r\n            //@ts-ignore\r\n            dialogClassName=\"modal-90w\"       \r\n            aria-labelledby=\"example-custom-modal-styling-title\"\r\n        >\r\n\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>{data.localname} - {data.species} </Modal.Title>\r\n            </Modal.Header>\r\n\r\n            <Modal.Body>\r\n                <Row className=\"mt-1\">\r\n                    <Form.Group\r\n                            as={Col}\r\n                            controlId=\"formTreePreviewLeftSide\"\r\n                            style={{ minWidth: \"300px\" }}\r\n                    >\r\n                        \r\n                            {imgPhotoItem()}\r\n                        \r\n                     \r\n                    </Form.Group>\r\n\r\n                    <Form.Group\r\n                            as={Col}\r\n                            controlId=\"formTreePreviewRightSide\"\r\n                            //style={{ minWidth: \"230px\" }}\r\n                    >\r\n                        <Table striped>\r\n                            <tbody>\r\n                                <RowTable title={t<string>(\"TreePreviewModal.status\")} value={data.lastinsp_status} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.parameters\")} value={`${t<string>(\"TreePreviewModal.heightTree\")}: ${data.lastinsp_height} \\u00A0\\u00A0 ${t<string>(\"TreePreviewModal.girthTree\")}: ${data.lastinsp_trunkgirth} \\u00A0\\u00A0 ${t<string>(\"TreePreviewModal.diameterTree\")}: ${data.lastinsp_crowndiameter}`} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.dateplanted\")} value={dateTimeToDate(data.dateplanted)} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.googlestreeturl\")} value={data.googlestreeturl} isValueIsLink/>\r\n                                <RowTable title={t<string>(\"TreePreviewModal.remarks\")} value={data.lastinsp_remarks} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.careTypes\")} value={data.lastinsp_recommendations} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.comment\")} value={data.comment} />                                \r\n                            </tbody>\r\n                        </Table>\r\n\r\n\r\n                        <p className=\"mt-5\" id=\"captionInspectsActions\">Прегледи и Дейности</p>\r\n\r\n                        <InspectionsList \r\n                            idTree={data?.id}                             \r\n                            onClickButtonEditInsp={onClickButtonEditInspBefore}\r\n                            onClickButtonPhotosInsp={onClickButtonPhotosInsp}                          \r\n                        />\r\n\r\n                    </Form.Group>                \r\n                </Row>\r\n            </Modal.Body>\r\n\r\n            <Modal.Footer>\r\n                <Button variant=\"light\" onClick={handleEditTree}>\r\n                    {t<string>(\"TreePreviewModal.edit\")}\r\n                </Button>\r\n                <Button variant=\"primary\" style={{ minWidth: \"160px\" }} onClick={handleClose}>\r\n                    {t<string>(\"TreePreviewModal.close\")}\r\n                </Button>\r\n            </Modal.Footer>\r\n\r\n        </Modal>\r\n\r\n    )\r\n}\r\n\r\n\r\ninterface RowTableProps {\r\n    title: string;\r\n    value: string | null;\r\n    isValueIsLink?: boolean;   \r\n} \r\n\r\nconst RowTable = ({title, value, isValueIsLink}: RowTableProps) => {\r\n    if (value) {\r\n        return (\r\n            <tr>\r\n                <td>{title}</td>\r\n                { isValueIsLink ? \r\n                    <td><a href={value} target=\"_blank\">Link</a></td>\r\n                : <td>{value}</td>\r\n                }\r\n          </tr>                \r\n        );\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n\r\nfunction dateTimeToDate(dateTimeStr: string) {\r\n    if (dateTimeStr) {\r\n        const dateTime = new Date(dateTimeStr);\r\n        if (dateTime) {\r\n            const arDateTime = dateTime.toISOString().split(\"T\");\r\n            if (arDateTime.length === 2) {\r\n                return arDateTime[0];\r\n            } \r\n            return dateTimeStr;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\n\r\nexport default TreePreviewModal","import { getCookie } from \"../utils/misc\";\r\n\r\nexport const csrftoken = getCookie(\"csrftoken\");","import { csrftoken } from '../constants/const'\r\n\r\nexport async function fetchUrl2(url: string, method: string, bodyObject?: any, tokenAccess?: string) {\r\n    const myHeaders = getHTTPHeader(csrftoken, tokenAccess);\r\n\r\n    const fetchResult = await fetch(url, {\r\n        method: method,\r\n        headers: myHeaders,\r\n        body: JSON.stringify(bodyObject),\r\n    });\r\n\r\n    const result = await fetchResult.json();\r\n    if (fetchResult.ok) {\r\n        return result;\r\n    }\r\n\r\n    //@ts-ignore\r\n    throw new fetchException(fetchResult.status, fetchResult.statusText, result.detail);    \r\n};\t\r\n\r\nfunction fetchException(status: number, message: string, detail: string) {\r\n    //@ts-ignore\r\n    this.message = message;\r\n    //@ts-ignore\r\n    this.status = status;\r\n    //@ts-ignore\r\n    this.detail = detail;    \r\n}\t\r\n\r\nfunction getHTTPHeader(csrftoken: string | null, accessToken: string | undefined){\r\n    const myHeaders = new Headers();\r\n    myHeaders.append(\"Content-type\", \"application/json\");\r\n    \r\n    if (csrftoken) {\r\n        myHeaders.append(\"X-CSRFToken\", csrftoken);\r\n        console.log('csrftoken', csrftoken);\r\n    }\t\r\n    if (accessToken) {\r\n        myHeaders.append(\"Authorization\", \"Bearer \" + accessToken);\r\n    }\r\n    return myHeaders;\r\n}\r\n\r\n\r\n\r\nexport function getCookie(name: string) {\r\n    var cookieValue = null;\r\n    if (document.cookie && document.cookie !== \"\") {\r\n        var cookies = document.cookie.split(\";\");\r\n        for (var i = 0; i < cookies.length; i++) {\r\n            var cookie = cookies[i].trim();\r\n            // Does this cookie string begin with the name we want?\r\n            if (cookie.substring(0, name.length + 1) === name + \"=\") {\r\n                cookieValue = decodeURIComponent(\r\n                    cookie.substring(name.length + 1)\r\n                );\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return cookieValue;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// function fetchUrl(url: string, method: string, bodyObject?: any, tokenAccess?: string, callBackSucceed?: (data: any) => void) {\r\n//     const myHeaders = getHTTPHeader(csrftoken, tokenAccess);\r\n\r\n//     fetch(url, {\r\n//         method: method,\r\n//         headers: myHeaders,\r\n//         body: JSON.stringify(bodyObject),\r\n//     }).then(function (response) {\r\n//         if (response.status >= 400) {\r\n//             console.log('fetchUrl', response.status, response.statusText);\r\n\r\n            \r\n//             response.json().then((data) => {\r\n//                 //@ts-ignore\r\n//                 throw new fetchException(response.status, response.statusText, data.detail);\r\n//             \t// alert(\r\n//             \t// \tresponse.statusText +\r\n//             \t// \t\t\" (\" +\r\n//             \t// \t\tresponse.status +\r\n//             \t// \t\t\")\\n\\n\" +\r\n//             \t// \t\tdata.detail\r\n//             \t// );\r\n//             });\r\n//         } else {\r\n            \r\n//             if (callBackSucceed) {\r\n\r\n//                 response.json().then((data) => {\r\n//                     callBackSucceed(data);\r\n//                 })\r\n                \r\n//             }\r\n//         }\r\n//     });\r\n// };","export const URL_LOGIN = `${process.env.REACT_APP_API_URL}token/`;\r\nexport const URL_REFRESH_TOKEN = `${process.env.REACT_APP_API_URL}token/refresh/`;\r\nexport const URL_VERIFY_TOKEN = `${process.env.REACT_APP_API_URL}token/verify/`;\r\n\r\nexport const URL_GET_PERMISSIONS = `${process.env.REACT_APP_API_URL}currentusers/permissions/citytree`;\r\n\r\nexport const URL_GENERATE_S3_URLKEY = `${process.env.REACT_APP_API_URL}citytree/s3/generate_signed_url/`\r\n\r\nexport const URL_GET_DICT_SPECIESES = `${process.env.REACT_APP_API_URL}citytree/dictionary/specieses/`;\r\nexport const URL_GET_DICT_CARETYPES = `${process.env.REACT_APP_API_URL}citytree/dictionary/caretypes/`;\r\nexport const URL_GET_DICT_REMARKS = `${process.env.REACT_APP_API_URL}citytree/dictionary/remarks/`;\r\nexport const URL_GET_DICT_PLACETYPES = `${process.env.REACT_APP_API_URL}citytree/dictionary/placetypes/`;\r\nexport const URL_GET_DICT_IRRIGATIONMETHODS = `${process.env.REACT_APP_API_URL}citytree/dictionary/irrigationmethods/`;\r\nexport const URL_GET_DICT_GROUPSPECS = `${process.env.REACT_APP_API_URL}citytree/dictionary/groupspecs/`;\r\nexport const URL_GET_DICT_TYPESPECS = `${process.env.REACT_APP_API_URL}citytree/dictionary/typespecs/`;\r\nexport const URL_GET_DICT_STATUSES = `${process.env.REACT_APP_API_URL}citytree/dictionary/statuses`;\r\n\r\nexport const urlTreesByCity = (cityName: string) => `${process.env.REACT_APP_API_URL}citytree/${cityName}/trees/`;\r\nexport const urlTreeByCityAndID = (cityName: string, id: number) => `${process.env.REACT_APP_API_URL}citytree/${cityName}/trees/${id}/`;\r\n\r\n\r\n\r\n","import { useState } from 'react';\r\nimport { getCookie, fetchUrl2 } from \"../utils/misc\"\r\nimport { URL_VERIFY_TOKEN, URL_REFRESH_TOKEN } from '../constants/urlsAPI';\r\n\r\ninterface userTokenJson {\r\n    access: string; \r\n    refresh: string; \r\n    user: {\r\n        id: number; \r\n        name: string;\r\n    }    \r\n}\r\n\r\n\r\nexport const useAuthToken = () => {\r\n        \r\n    const [authToken, setAuthToken] = useState(getToken());\r\n\r\n    function getToken() {        \r\n        let tokenString;\r\n        const rememberme = localStorage.getItem('rememberme');\r\n\r\n        if (rememberme==='true') {\r\n            tokenString = localStorage.getItem('token');\r\n        } else {\r\n            tokenString = sessionStorage.getItem('token');\r\n        }\r\n        \r\n        if (tokenString) {            \r\n            const json = JSON.parse(tokenString);\r\n            const user = getUserInfoFromToken(json);\r\n            if (user) {\r\n                json.user = user;\r\n            }      \r\n\r\n            return json;        \r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    const saveToken = (userToken: userTokenJson | null) => {\r\n        console.log('saveToken', userToken);\r\n        if (userToken) {\r\n            const rememberme = localStorage.getItem('rememberme');\r\n\r\n            if (rememberme === 'true') {\r\n                localStorage.setItem('token', JSON.stringify(userToken));\r\n            } else {\r\n                sessionStorage.setItem('token', JSON.stringify(userToken));\r\n            }\r\n                        \r\n            const user = getUserInfoFromToken(userToken);\r\n            if (user) {                \r\n                if (userToken?.user) {\r\n                    userToken.user = {...userToken.user, id: user.id, name: user.name}\r\n                } else {\r\n                    userToken.user = user;    \r\n                }\r\n                \r\n            }            \r\n        } else {\r\n            localStorage.removeItem(\"token\");\r\n            localStorage.removeItem(\"rememberme\"); \r\n            sessionStorage.removeItem(\"token\");\r\n        }           \r\n        console.log('saveToken', userToken);\r\n        setAuthToken(userToken);\r\n    };    \r\n\r\n    function getUserInfoFromToken(json: userTokenJson): {id: number; name: string} | undefined {\r\n        let token = json?.access; \r\n\r\n        if (token) {\r\n            const arToken = token.split('.');\r\n            if (arToken.length > 1) {\r\n                console.log('getUserInfoFromToken', JSON.parse(atob(arToken[1])));\r\n                return {                    \r\n                    \"name\": JSON.parse(atob(arToken[1])).username,\r\n                    \"id\": JSON.parse(atob(arToken[1])).user_id\r\n                }    \r\n            }\r\n        }\r\n    }    \r\n\r\n\r\n    return [authToken, saveToken];  \r\n}\r\n\r\n\r\nexport async function userAuthentication(authToken: any, setAuthToken: any) {\r\n    if (authToken) {\r\n        const isTokenValid = await checkAuthToken(URL_VERIFY_TOKEN, authToken.access);\r\n        console.log('isTokenValid', isTokenValid);\r\n        \r\n        if (isTokenValid) return true;\r\n        \r\n        if (!isTokenValid) {\r\n            return await refreshTokens(setAuthToken, authToken.refresh);\t\t\t\t\t\t\t\r\n        }\t\t\t\t\t\t\t\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function checkAuthToken(urlCheckingToken: string, accessToken: string) {    \r\n    try {\r\n        await fetchUrl2(urlCheckingToken, 'POST', { token: accessToken }, accessToken); // if success, return just empty object {}\r\n        return true;\r\n    } catch (err) {\r\n        console.log('checkAuthToken', err);\r\n        return false;        \r\n    }\t\t\t\r\n};\t\r\n\r\nexport async function refreshTokens(setAuthToken: any, refreshToken: string) {\r\n    const accessRefreshToken = await getNewAccessRefreshAuthToken(URL_REFRESH_TOKEN, refreshToken);        \r\n    setAuthToken(accessRefreshToken);\r\n    if (accessRefreshToken) return true;\r\n    return false;\t\t\t\t\r\n}\r\n\r\n\r\n\r\nexport async function getNewAccessRefreshAuthToken(urlRefreshingToken: string, refreshToken: string){\r\n    try {\r\n        const response = await fetchUrl2(urlRefreshingToken, 'POST', { refresh: refreshToken });\r\n        return response;\r\n    } catch (err) {\r\n        console.log('getNewAccessRefreshAuthToken', err);\r\n        return null;        \r\n    }\r\n    \r\n    \r\n    \r\n    // const csrftoken = getCookie(\"csrftoken\");\r\n    // let myHeaders = new Headers();\r\n    // myHeaders.append(\"Content-type\", \"application/json\");\r\n    // if (csrftoken) {\r\n    //     myHeaders.append(\"X-CSRFToken\", csrftoken);\r\n    // }\t\r\n\r\n    // const response = await fetch(urlRefreshingToken, {\r\n    //     method: \"POST\",\r\n    //     headers: myHeaders,\r\n    //     body: JSON.stringify({ refresh: refreshToken }),\r\n    // });\r\n    \r\n    // if (response.status >= 400) {\r\n    //     return null;\r\n    // } else {\r\n    //     const responseJson = await response.json();\r\n    //     return responseJson;\t\r\n    // }\t\t\r\n};","import { useState, useEffect } from 'react'\r\nimport { Form, Button, FloatingLabel, Modal } from \"react-bootstrap\";\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { actLoginModalShow, actRegisterModalShow } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\nimport { URL_LOGIN } from '../constants/urlsAPI';\r\n\r\n\r\n\r\ninterface Credentials {\r\n\tusername: string; \r\n\tpassword: string; \r\n\trememberme: boolean;\r\n} \r\n\r\n\r\ninterface LoginModalFormProps {\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n}\r\n\r\n\r\nconst LoginModalForm = ({setAuthToken} : LoginModalFormProps) => {\r\n\tconst dispatch = useDispatch();\r\n\tconst rxLoginModalShow = useSelector((state: RootState) => state.uiReducer.loginModalShow)\r\n\r\n\tconst [showWrongPassword, setShowWrongPassword] = useState(false);\r\n\tconst { t } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\r\n\t\tsetShowWrongPassword(false);\r\n\t}, [rxLoginModalShow]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\trememberme: false,\r\n\t\t},\r\n\t});\r\n\r\n\tasync function loginUser(credentials: Credentials) {\r\n\t\tconsole.log(credentials)\r\n\t\treturn fetch(URL_LOGIN, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\t\t}).then((data) => {\r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\t\t\r\n\t\t\t\t\t//data.rememberme = credentials.rememberme\r\n\t\t\t\t\tconsole.log('setAuthToken', data);\r\n\t\t\t\t\tsetAuthToken(data);\r\n\t\t\t\t\t//console.log(data);\r\n\t\t\t\t\tsetShowWrongPassword(false);\r\n\r\n\t\t\t\t\t//setLoginModalShow(false)\r\n\t\t\t\t\tdispatch(actLoginModalShow(false));\r\n\t\t\t\t});\r\n\t\t\t} else if (data.status === 401) {\r\n\t\t\t\tsetShowWrongPassword(true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst OnSubmitForm = (data: Credentials) => {\r\n\t\tsetShowWrongPassword(false);\r\n\t\tlocalStorage.setItem(\"rememberme\", data.rememberme.toString());\r\n\t\tloginUser(data);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\t//show={show}\r\n\t\t\tshow={rxLoginModalShow}\r\n\t\t\t//onHide={onHide}\r\n\t\t\tonHide={() => dispatch(actLoginModalShow(false))}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t<string>(\"loginForm.title\")}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formLogin\">\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingInput\"\r\n\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.username\")}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t(\"loginForm.username\")}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.password\")}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t(\"loginForm.password\")}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formBasicCheckbox\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"rememberme\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t/* @ts-ignore */\r\n\t\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.rememberMe\")}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t{showWrongPassword && (\r\n\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t{t<string>(\"loginForm.wrongUsernamePassword\")}\r\n\t\t\t\t\t\t</Form.Text>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"loginForm.login\")}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{/* {t('loginForm.dontHaveAccount')} <a href=\"#\" onClick={()=> { setLoginModalShow(false); setRegisterModalShow(true) } }>{t('loginForm.signUp')}</a> */}\r\n\t\t\t\t\t\t\t{t<string>(\"loginForm.dontHaveAccount\")}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(false));\r\n\t\t\t\t\t\t\t\t\tdispatch(actRegisterModalShow(true));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"loginForm.signUp\")}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default LoginModalForm;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Form, Button, FloatingLabel, Modal, Col, Row } from \"react-bootstrap\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { actLoginModalShow, actRegisterModalShow } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\n\r\ninterface RegisterModalFormProps {\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n}\r\n\r\n\r\ninterface RegisterData {\r\n\tusername: string;\r\n\temail: string;\r\n\tpassword: string;\r\n\tpassword2: string;\r\n\tfirst_name: string;\r\n\tlast_name: string;\r\n} \r\n\r\n\r\n\r\n\r\nconst RegisterModalForm = ({setAuthToken}: RegisterModalFormProps) => {\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst rxRegisterModalShow = useSelector((state: RootState) => state.uiReducer.registerModalShow)\t\r\n\t\r\n\tconst { t } = useTranslation()\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\t\r\n\t}, [rxRegisterModalShow]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n        setError,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\temail: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tpassword2: \"\",\r\n\t\t\tfirst_name: \"\",\r\n\t\t\tlast_name: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\tconst OnSubmitForm = (data: RegisterData) => {\r\n\t\tregisterUser(data);\r\n\t};\r\n\r\n\tasync function registerUser(credentials: RegisterData) {\t\t\r\n\t\treturn fetch(`${process.env.REACT_APP_API_URL}users/`, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\r\n\t\t}).then((data) => {            \r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\t\r\n                    console.log('ok', data)\t\t\t\t\r\n                    //setRegisterModalShow(false);\r\n\t\t\t\t\tdispatch(actRegisterModalShow(false))\r\n                    setAuthToken(data.token) // after register make login\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t} else if (data.status >= 400) {\r\n\t\t\t\tdata.json().then((data) => {\r\n\t\t\t\t\tconsole.log(data)\r\n                \r\n                    for (const [key, value] of Object.entries(data)) {                \r\n                        //@ts-ignore\r\n\t\t\t\t\t\tsetError(key, {\r\n                            type: \"manual\",\r\n                            message: value,\r\n                        }); \r\n                    }                   \r\n\t\t\t\t});                \r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\t//show={show}\r\n\t\t\tshow={rxRegisterModalShow}\r\n\t\t\t//onHide={onHide}\r\n\t\t\tonHide={() => dispatch(actRegisterModalShow(false))}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t<string>('registerForm.title')}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formRegister\">\r\n\t\t\t\t\t\t\r\n                \r\n                        {errors?.username?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore*/}\r\n\t\t\t\t\t\t\t\t{errors.username.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                        \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingUsername\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.username')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.username')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n                        \r\n                        {errors?.email?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore  message is array, but declared as string */}\r\n\t\t\t\t\t\t\t\t{errors.email.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                          \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingEmail\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.email')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"email\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.email')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.email}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\r\n                        {errors?.password?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore*/}\r\n\t\t\t\t\t\t\t\t{errors.password.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}  \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.password')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.password')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword2\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password2\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password2}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"first_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.firstNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.first_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"last_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.lastNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.last_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>('registerForm.register')}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{t<string>('registerForm.alreadyHaveAccount')}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(actRegisterModalShow(false))\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(true))\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>('registerForm.login')}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RegisterModalForm;\r\n","export const filterDataMap = (feature: any, dataFilters: any, authToken: any): boolean => {\r\n\t\t\r\n    const objectSearchResult = {\r\n        species: true,\r\n        status: true,\r\n        recommendations: true,\r\n        remarks: true,\r\n        placetype: true,\r\n        irrigationmethod: true,\r\n\r\n        plantedDateFrom: true,\r\n        plantedDateTo: true,\r\n        addedDateFrom: true,\r\n        addedDateTo: true,\r\n        comment: true,\r\n\r\n        heightFrom: true,\r\n        heightTo: true,\r\n        trunkGirthFrom: true,\r\n        trunkGirthTo: true,\r\n        crownDiameterFrom: true,\r\n        crownDiameterTo: true,\r\n\r\n        showOnlyMyTrees: true\t\t\t\r\n    }\r\n\r\n    let valueFilter;\r\n\r\n            \r\n    valueFilter = dataFilters?.speciesFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.species = isFoundArrayInValue(valueFilter, feature.properties.species);\t\t\t\r\n    }\r\n\r\n    valueFilter = dataFilters?.statusFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.status = isFoundArrayInValue(valueFilter, feature.properties.lastinsp_status);\t\t\t\r\n    }\r\n\r\n\r\n    valueFilter = dataFilters?.careTypeFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.recommendations = isFoundArrayInArray(valueFilter, feature.properties.recommendations);\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.remarkFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.remarks = isFoundArrayInArray(valueFilter, feature.properties.remarks);\r\n    }\t\t\r\n\r\n\r\n\r\n    valueFilter = dataFilters?.placeTypeFilter?.value;\r\n    if (valueFilter) {\r\n        objectSearchResult.placetype = valueFilter === feature.properties.placetype;\r\n    }\r\n\r\n    valueFilter = dataFilters?.irrigationMethodFilter?.value;\r\n    if (valueFilter) {\r\n        objectSearchResult.irrigationmethod = valueFilter === feature.properties.irrigationmethod;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.datePlantedFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.plantedDateFrom =\r\n            feature.properties.dateplanted >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.datePlantedToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.plantedDateTo =\r\n            feature.properties.dateplanted <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.dateAddedFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.addedDateFrom =\r\n            feature.properties.datetimeadded >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.dateAddedToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.addedDateTo =\r\n            feature.properties.datetimeadded <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.commentFilter;\r\n    if (valueFilter) {\r\n        if (\r\n            feature.properties.comment\r\n                .toLowerCase()\r\n                .indexOf(valueFilter.toLowerCase()) === -1\r\n        ) {\r\n            objectSearchResult.comment = false;\r\n        }\r\n    }\t\t\r\n\r\n\r\n    \r\n    valueFilter = dataFilters?.heightFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.heightFrom = feature.properties.lastinsp_height >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.heightToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.heightTo = feature.properties.lastinsp_height <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.trunkGirthFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.trunkGirthFrom = feature.properties.lastinsp_trunkgirth >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.trunkGirthToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.trunkGirthTo = feature.properties.lastinsp_trunkgirth <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.crownDiameterFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.crownDiameterFrom = feature.properties.lastinsp_crowndiameter >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.crownDiameterToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.crownDiameterTo = feature.properties.lastinsp_crowndiameter <= valueFilter;\r\n    }\t\t\r\n\r\n\r\n\r\n    valueFilter = dataFilters?.showMyTreesFilter;\r\n    if (valueFilter && authToken?.user) {\r\n        objectSearchResult.showOnlyMyTrees = authToken.user.id === feature.properties.useradded;\t\r\n    }\r\n\r\n\r\n    let result = true;\r\n    for (const el in objectSearchResult) {\r\n        //@ts-ignore\r\n        if (objectSearchResult[el] === false) {\r\n            result = false;\r\n            break;\r\n        }\t\t\t\r\n    }\r\n                 \r\n    //rxDataTrees.dateTimeGenerated = Date.now(); // dateTimeGenerated is used like key parameter to update data on map, when it changed\r\n    return result;\r\n};\r\n\r\nfunction isFoundArrayInValue(array: {value: number}[], value: number) {\r\n    for (let el of array) {\r\n        if (el.value === value) {\r\n            return true;\t\t\t\t\r\n        }\t\t\t\t\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction isFoundArrayInArray(arraySearch: {value: number}[], arrayTree: string[]){\r\n    const intersection = arraySearch.filter((x) => {\r\n        return arrayTree.includes(String(x.value));\r\n    });\r\n    return intersection.length > 0;\r\n}\t","import { \r\n    URL_GET_DICT_SPECIESES, \r\n    URL_GET_DICT_CARETYPES,\r\n    URL_GET_DICT_REMARKS,\r\n    URL_GET_DICT_PLACETYPES,\r\n    URL_GET_DICT_IRRIGATIONMETHODS,\r\n    URL_GET_DICT_GROUPSPECS,\r\n    URL_GET_DICT_TYPESPECS \r\n} from '../constants/urlsAPI';\r\n\r\n\r\nexport const fetchAllDictionariesData = async() => {\t\t\r\n    \r\n\r\n    const [\r\n        speciesesResponse, \r\n        caretypesResponse, \r\n        remarksResponse, \r\n        placetypesResponse, \r\n        irrigationmethodsResponse, \r\n        groupspecsResponse, \r\n        typespecsResponse\r\n    ] = await Promise.all([\r\n        \r\n        fetchData(URL_GET_DICT_SPECIESES),\r\n        fetchData(URL_GET_DICT_CARETYPES),\r\n        fetchData(URL_GET_DICT_REMARKS),\r\n        fetchData(URL_GET_DICT_PLACETYPES),\r\n        fetchData(URL_GET_DICT_IRRIGATIONMETHODS),\r\n        fetchData(URL_GET_DICT_GROUPSPECS),\r\n        fetchData(URL_GET_DICT_TYPESPECS)\r\n    ]);\r\n\r\n\r\n    const specieses = await speciesesResponse;\r\n    const caretypes = await caretypesResponse;\r\n    const remarks = await remarksResponse;\r\n    const placetypes = await placetypesResponse;\r\n    const irrigationmethods = await irrigationmethodsResponse;\r\n    const groupspecs = await groupspecsResponse;\r\n    const typespecs = await typespecsResponse;\r\n\r\n    return [\r\n        specieses,\r\n        caretypes,\r\n        remarks,\r\n        placetypes,\r\n        irrigationmethods,\r\n        groupspecs,\r\n        typespecs    \r\n    ];\t\r\n}\r\n\r\nconst fetchData = async (apiURL: string) => {\t\t\t\r\n    const res = await fetch(apiURL);\r\n    const data = await res.json();\r\n    return data; \t\t\t\r\n} ","import i18n from 'i18next';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\n\r\nimport translationEN from './locales/en/translation.json';\r\nimport translationBG from './locales/bg/translation.json';\r\nconst availableLanguages = ['en', 'bg'];\r\n\r\n\r\ni18n\r\n    .use(LanguageDetector)\r\n    .use(initReactI18next) // passes i18n down to react-i18next\r\n    .init({\r\n        // the translations\r\n        // (tip move them in a JSON file and import them,\r\n        // or even better, manage them via a UI: https://react.i18next.com/guides/multiple-translation-files#manage-your-translations-with-a-management-gui)\r\n        resources: {\r\n            en: {\r\n                translation: translationEN\r\n            },\r\n\r\n            bg: {\r\n                translation: translationBG\r\n            }      \r\n        },\r\n        //lng: \"bg\", // if you're using a language detector, do not define the lng option\r\n        //lng: localStorage.getItem('lng') || 'en',\r\n        fallbackLng: \"en\",\r\n\r\n        interpolation: {\r\n        escapeValue: false // react already safes from xss => https://www.i18next.com/translation-function/interpolation#unescape\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\nexport default i18n;","import { fetchUrl2 } from \"../utils/misc\"\r\nimport { URL_GET_PERMISSIONS } from '../constants/urlsAPI';\r\nimport i18next from '../i18nextConf.js'\r\n\r\nexport const initPermissions = () => {\r\n    return {\r\n    is_superuser: false,\r\n    tree: {       \r\n        view_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.view_tree')\r\n        },\r\n        add_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.add_tree')\r\n        },\r\n        change_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.change_tree')\r\n        },\r\n        can_change_not_own_tree_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.can_change_not_own_tree_record')\r\n        },   \r\n        can_delete_not_own_tree_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.can_delete_not_own_tree_record')\r\n        },                         \r\n        delete_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.delete_tree')\r\n        },        \r\n    },\r\n\r\n    inspection: {\r\n        view_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.view_inspection')\r\n        },   \r\n        add_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.add_inspection')\r\n        },   \r\n        change_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.change_inspection')\r\n        },  \r\n        can_change_not_own_insp_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.can_change_not_own_insp_record')\r\n        },   \r\n        can_delete_not_own_insp_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.can_delete_not_own_insp_record')\r\n        },                              \r\n        delete_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.delete_inspection')\r\n        }                                \r\n    },\r\n\r\n    careactivity: {\r\n        view_careactivity: {\r\n            granted: false,\r\n            deniedMessage: \"\"\r\n        }             \r\n    },\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const has_perm = (permObject: any, model: string, permName: string, authToken: any) => {\r\n    \r\n    if (!authToken) {\r\n        alert('Authorization required');\r\n        return false;\r\n    }\r\n\r\n    if (permObject?.is_superuser === true) return true;\r\n    \r\n    console.log('has_perm value', permObject);    \r\n\r\n    if(permObject) {\r\n        if(permObject.hasOwnProperty(model) && permObject[model].hasOwnProperty(permName)) {\r\n            if (permObject[model][permName]?.granted === true) {\r\n                return true;\r\n            } else {\r\n                const deniedMessage = permObject[model][permName]?.deniedMessage;                \r\n                if (deniedMessage) alert(deniedMessage);   \r\n            }                \r\n        }\r\n        return false;\r\n    }\r\n    console.log('has_perm', 'permObject is not exists');\r\n    console.log('has_perm value', permObject);\r\n    return false;\r\n}\r\n\r\nexport async function getCurrentUserPermissions(authToken: any) {\r\n    try {\r\n\r\n        const fetchResult = await fetchUrl2(URL_GET_PERMISSIONS, \"GET\", undefined, authToken.access);\r\n        if (fetchResult && authToken?.user) {\t\t\t\t\t\t    \r\n            console.log('getCurrentUserPermissions', fetchResult);\r\n            \r\n            const initPermissionsRes = initPermissions();\r\n            const currentPermissions = {...initPermissionsRes};\r\n            currentPermissions.is_superuser = fetchResult.is_superuser;\t\t\t\t\t\t\t\t\t\r\n\r\n            if (fetchResult?.citytree) {\r\n                for (const model in fetchResult['citytree']) {\t\t\t\t\t\t\r\n                    const arrayPerms = fetchResult['citytree'][model];\t\t\t\t\t\r\n                    if (Array.isArray(arrayPerms)) {\t\t\t\t\t\t\t\r\n                        arrayPerms.forEach((perm) => {                            \r\n                            //@ts-ignore\r\n                            currentPermissions[model][perm] = {...currentPermissions[model][perm], granted: true};\r\n                        })\t\t\t\t\t\t\t\r\n                    }\r\n                }\r\n            }\r\n            console.log('currentPermissions', currentPermissions);\r\n            return currentPermissions; \r\n            //dispatch(actDataPermissions(currentPermissions));\r\n\r\n            \t\t\t\t\t\t\t\t\r\n        }        \r\n        console.log('URL_GET_PERMISSIONS', fetchResult);\r\n        return null;    \r\n\r\n    } catch(err) {\r\n        console.log('getCurrentUserPermissions', err);        \r\n    }\r\n}\t","import \"./App.css\";\nimport L from 'leaflet'\n\nimport { useParams } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\n\nimport MenuGlobal from \"./components_hl/MenuGlobal\";\nimport Map from \"./components_hl/Map\";\nimport MainWrapper from \"./components/MainWrapper\";\nimport Sidebar from \"./components/Sidebar\";\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\nimport ButtonOkCancelMobileMarker from \"./components/ButtonOkCancelMobileMarker\";\n\nimport FormFilter from './components/FormFilter';\nimport FormTree from './components/FormTree';\nimport FormInspection from './components/FormInspection';\nimport ImageSlider from './components/ImageSlider';\nimport TreePreviewModal from \"./components/TreePreviewModal\";\n\nimport { useAuthToken } from \"./auth/useAuthToken\";\nimport LoginModalForm from \"./components/LoginModalForm\";\nimport RegisterModalForm from \"./components/RegisterModalForm\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { RootState } from \"./reducers/index\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n\tactMapMarkerState,\n\tactNewTreeCreation,\n\tactShowOkCancelMobileMarker,\n\tactIsMobileDevice,\n\tactShowSidebar,\n\tactCheckButtonNewMarker,\n\tactShowTreeTab,\n\tactActiveTabKey,\n\tactDataLastEditedTreeId,\n\tactDictStatuses,\n\tactDictSpecieses,\n\tactDictCareTypes,\n\tactDictRemarks,\n\tactDictPlaceTypes,\n\tactDictIrrigationMethods,\n\tactDictGroupSpecs, \n\tactDictTypeSpecs,\n\tactDataTrees,\n\tactDataFilters,\n\tactShowInspTab,\n\tactDataPermissions\n} from \"./actions\";\nimport { TreeItem, InspItem } from \"./interfaces\";\n\nimport { filterDataMap } from \"./utils/filterDataMap\"\nimport { fetchUrl2 } from \"./utils/misc\"\nimport { fetchAllDictionariesData } from \"./utils/fetchAllDictionariesData\"\nimport { \n\tURL_GET_DICT_STATUSES, \n\tURL_GENERATE_S3_URLKEY, \n\turlTreesByCity, \n\turlTreeByCityAndID \n} from './constants/urlsAPI';\n\nimport { getCurrentUserPermissions, has_perm } from './auth/permissions'\nimport { userAuthentication, refreshTokens } from './auth/useAuthToken';\n\nlet geojsonMarkerOptions_citytree = {\n    //renderer: myRenderer,\n    radius: 5,\n    fillColor: \"#008000\",\n    color: \"#008000\",\n    weight: 0,\n    opacity: 1,\n    fillOpacity: 0.5\n\t};\n\n\n\n\nfunction App() {\n\tconst paramsRouter = useParams();\n\t//const csrftoken = getCookie(\"csrftoken\");\n\n\t// redux\n\tconst dispatch = useDispatch();\n\tconst rxDataPermissions = useSelector((state: RootState) => state.dataReducer.dataPermissions);\n\tconst rxDataTrees = useSelector((state: RootState) => state.dataReducer.dataTrees);\n\tconst rxShowOkCancelMobileMarker = useSelector((state: RootState) => state.uiReducer.showOkCancelMobileMarker);\n\tconst rxDataFilters = useSelector((state: RootState) => state.dataReducer.dataFilters);\n\tconst rxActiveTabKey = useSelector((state: RootState) => state.uiReducer.activeTabKey);\n\tconst rxShowTreeTab = useSelector((state: RootState) => state.uiReducer.showTreeTab);\n\tconst rxShowInspTab = useSelector((state: RootState) => state.uiReducer.showInspTab);\n\tconst rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\n\tconst rxCheckButtonHeatmap = useSelector((state: RootState) => state.uiReducer.checkButtonHeatmap);\n\n\tconst rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\n\tconst rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\n\n\tconst [currentZoomMap, setCurrentZoomMap] = useState(13);\n\n\t//const {authToken, setAuthToken} = useAuthToken();\n\tconst [authToken, setAuthToken] = useAuthToken();\n\tconst [screenWidth, setScreenWidth] = useState(window.innerWidth);\n\t//const [isMobileDevice, setIsMobileDevice] = useState(false)\n\tconst isMobileView = screenWidth <= 768; // show or hide sidebar at startup\n\n\n\tconst [dataTreeForm, setDataTreeForm] = useState<TreeItem | null>(null);\n\tconst [dataInspForm, setDataInspForm] = useState<InspItem | {tree: number} | null>(null);\n\tconst [imageSlider, setImageSlider] = useState<{visible: boolean; images: string[]}> ({visible: false, images: []});\n\tconst [treePreview, setTreePreview] = useState<{visible: boolean; data: {}; idTree: number | null}>({visible: false, data:{}, idTree: null});\n\tconst { t, i18n } = useTranslation();\n\n\tlet dataHeatmapPoints: number[][] = []; // [[lat, lng, value],[lat, lng, value]...]\t\n\n\n\tuseEffect(() => {\n\t\tfetchAllDictionariesDataWrapper();\t\t\n\t\tuserAuthentication(authToken, setAuthToken);\n\t\tdispatch(actIsMobileDevice(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)));\n\t\tdispatch(actShowSidebar(!isMobileView));\t\n\t\t\n\t\twindow.addEventListener('resize', handleWindowSizeChange);\n        return () => {\n            window.removeEventListener('resize', handleWindowSizeChange);\t\t\t\n        }\t\n\t\t\t\t\n\t}, []); /* useEffect triggers when route has been changed too */\n\n\tconst fetchAllDictionariesDataWrapper = () => {\n\t\tfetchAllDictionariesData().then(([specieses, caretypes, remarks, placetypes, irrigationmethods, groupspecs, typespecs]) => {\n\t\t\tdispatch(actDictSpecieses(specieses));\n\t\t\tdispatch(actDictCareTypes(caretypes));\n\t\t\tdispatch(actDictRemarks(remarks));\n\t\t\tdispatch(actDictPlaceTypes(placetypes));\n\t\t\tdispatch(actDictIrrigationMethods(irrigationmethods));\n\t\t\tdispatch(actDictGroupSpecs(groupspecs));\n\t\t\tdispatch(actDictTypeSpecs(typespecs));\n\t\t}).catch(error => {\t\t\t\n\t\t\tconsole.log('fetchAllDictionariesData error: ', error);\n\t\t});\t\n\t}\n\n    function handleWindowSizeChange() {\n        setScreenWidth(window.innerWidth);\n    }\n\n\tuseEffect(() => {\n\t\tfetchTreesAndStatuses();\n\t}, [paramsRouter]); /* useEffect triggers when route has been changed too */\n\n\tconst fetchTreesAndStatuses = async () => {\n\t\t//first of all, we must fetch dictionary with statuse, otherwise we can't draw points of trees in diferent color depends of them statuses.\n\t\tlet res = await fetch(URL_GET_DICT_STATUSES);\n\t\tlet data = await res.json();\n\t\tdispatch(actDictStatuses(data));\n\t\t\t\t\t\t\n\t\tif (paramsRouter.cityName) {\n\t\t\tconst URL = urlTreesByCity(paramsRouter.cityName);//`${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/`;\n\t\t\tres = await fetch(URL);\n\t\t\tdata = await res.json();\n\t\t\tdata.dateTimeGenerated = Date.now();\n\t\t\t\n\t\t\tdispatch(actDataTrees(data));\n\t\t}\n\t};\n\n\n    useEffect(() => {\n        let periodUpdate = 240000;//240000 //4 min\n        let interval = setInterval(() => {\n            if (authToken) {    \n\t\t\t\trefreshTokens(setAuthToken, authToken.refresh).then((res)=> console.log('refreshTokens', res));\n            }\n        }, periodUpdate);\n\n\t\n\t\t// update permissions if permissions object still empty, it can happens when website is loading with expired access token\n\t\tif (Object.keys(rxDataPermissions).length === 0 && authToken?.user?.id) {\n\t\t\tgetCurrentUserPermissions(authToken).then((permResult) => {\n\t\t\t\tif (permResult) {\n\t\t\t\t\tconsole.log('permResult useEffect authToken', permResult);\n\t\t\t\t\tdispatch(actDataPermissions(permResult));\n\t\t\t\t}\t\n\t\t\t});\t\t\t\n\t\t}\t\t\n\n        return () => clearInterval(interval)\n    }, [authToken]);\n\t\n\n    useEffect(() => {\n\t\tif (authToken?.user?.id) {\n\t\t\tgetCurrentUserPermissions(authToken).then((permResult) => {\t\t\t\t\n\t\t\t\tif (permResult) dispatch(actDataPermissions(permResult));\n\t\t\t});\t\t\t\n\t\t}\t\n    }, [authToken?.user?.id]);\n\n\n\n\tuseEffect(()=>{\n\n\t\tif (authToken?.user?.id) {\n\t\t\tgetCurrentUserPermissions(authToken).then((permResult) => {\t\t\t\t\n\t\t\t\tif (permResult) dispatch(actDataPermissions(permResult));\n\t\t\t});\t\t\t\n\t\t}\n\t\t\n\t\t// const permsToTranslate = {...rxDataPermissions};\n\t\t\n\t\t// Object.entries(permsToTranslate).forEach(([keyModel, valueModel]) => {\n\t\t// \tif (typeof valueModel === 'object') {\n\t\t// \t\t//@ts-ignore\n\t\t// \t\tObject.entries(valueModel).forEach(([keyPerm, valuePerm]) => {\n\t\t// \t\t\tconsole.log(t(`permsMessages.${keyModel}.${keyPerm}`));\n\t\t// \t\t});\n\t\t// \t}\t\t\t\n\t\t// });\t\t\t\t\n\t\t// //dispatch(actDataPermissions(permsToTranslate));\n\n\t}, [i18n.language])\n\n\n\tfunction markerOnClick(e: any) {\n\t\tlet marker: L.Marker = e.target;\n\t\tlet geojson = marker.toGeoJSON(); //: GeoJSON.FeatureCollection<any>\n\n\t\tif (geojson?.properties?.id) {\t\t\t\t\t\n\t\t\tshowTreePreview(geojson?.properties?.id);\n\t\t}   \n\t}\n\n\tconst showTreePreview = (idTree: number) => {\n\t\t//if (!has_perm(rxDataPermissions, 'tree', 'view_tree', authToken)) return; \n\n\t\tsetTreePreview({ visible: true, data: {}, idTree: idTree })\n\t\t//fetchTreeData(idTree).then((data) =>\n\t\t//\tsetTreePreview({ visible: true, data: data, idTree: null })\n\t\t//);\t\t\n\t};\n\n\t// when event comes from markerOnClick, it comes from L.Circle which is not React component, therefore there is something wrong, because in this event you can't see current values in States and Redux (to check permissions using rxDataPermissions), so I used redux event to broke that chain\n\tuseEffect(()=>{\t\t\n\t\tif (treePreview?.visible === true && treePreview?.idTree) {\n\t\t\tif (!has_perm(rxDataPermissions, 'tree', 'view_tree', authToken)) {\n\t\t\t\tsetTreePreview({ visible: false, data: {}, idTree: null })\n\t\t\t\treturn; \n\t\t\t}\t\n\n\t\t\tfetchTreeData(treePreview.idTree).then((data) =>\n\t\t\t\tsetTreePreview({ visible: true, data: data, idTree: null })\n\t\t\t);\t\t\t\n\t\t}\n\t}, [treePreview]);\n\n\t\n\n\tconst onButtonEditTreeClick = (idTree: number) => {\n\t\teditTree(idTree);\n\t}\n\n\tconst editTree = (idTree: number) => {\n\t\tfetchTreeData(idTree).then((data) => setDataTreeForm(data));\t\t\n\t\tdispatch(actShowTreeTab(true));\n\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\n\t}\n\t\n\tconst onSubmitTree = async (data: any) => {\t\t\n\t\tif (!has_perm(rxDataPermissions, 'tree', 'change_tree', authToken)) return;\n\t\t\t\n\t\t\n\t\t\t\t\n\t\tif (paramsRouter.cityName) {\n\t\t\tlet method;\n\t\t\tlet url;\n\t\t\tif (data.id) {\n\t\t\t\tconsole.log(data, authToken.user.id);\n\t\t\t\tif (data.useradded !== authToken.user.id && !has_perm(rxDataPermissions, 'tree', 'can_change_not_own_tree_record', authToken) ) return; \n\t\t\t\t//url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.id}/`;\n\t\t\t\turl = urlTreeByCityAndID(paramsRouter.cityName, data.id);\n\t\t\t\tmethod = \"PUT\";\n\t\t\t} else {\n\t\t\t\t//url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/`;\n\t\t\t\turl = urlTreesByCity(paramsRouter.cityName);\n\t\t\t\tmethod = \"POST\";\n\t\t\t}\n\n\t\t\t// const succeedCallBack = () => {\n\t\t\t// \tfetchTreesAndStatuses();\n\t\t\t// \tdispatch(actMapMarkerState({ visible: false, position: {} }));\n\t\t\t// \tdispatch(actNewTreeCreation(false));\n\t\t\t// \tdispatch(actActiveTabKey('filter'));\n\t\t\t// \tdispatch(actShowTreeTab(false));\n\n\t\t\t// \tif (isMobileView) {\n\t\t\t// \t\tdispatch(actShowSidebar(false))\n\t\t\t// \t}\t\t\t\n\t\t\t// }\t\t\n\t\t\t\n\t\t\ttry {\n\t\t\t\tawait fetchUrl2(url, method, data, authToken.access);\n\t\t\t\tfetchTreesAndStatuses();\n\t\t\t\tdispatch(actMapMarkerState({ visible: false, position: {} }));\n\t\t\t\tdispatch(actNewTreeCreation(false));\n\t\t\t\tdispatch(actActiveTabKey('filter'));\n\t\t\t\tdispatch(actShowTreeTab(false));\n\n\t\t\t\tif (isMobileView) { \n\t\t\t\t\tdispatch(actShowSidebar(false))\n\t\t\t\t}\t\t\t\t\n\t\t\t} catch(err) {\n\t\t\t\tconsole.log('onSubmitTree', err);\n\t\t\t\t//@ts-ignore\n\t\t\t\talert(err.detail);\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t};\n\n\n\n\t//const onDeleteTree = async (id: number) => {\n\tconst onDeleteTree = async (data: TreeItem | null) => {\n\t\tif (!has_perm(rxDataPermissions, 'tree', 'delete_tree', authToken)) return;\t\t\n\t\tif (!has_perm(rxDataPermissions, 'tree', 'can_delete_not_own_tree_record', authToken) && data?.useradded !== authToken.user.id) return;\n\t\t\n\t\tif (data?.id && paramsRouter.cityName) {\n\t\t\tawait fetchUrl2(urlTreeByCityAndID(paramsRouter.cityName, data.id), \"DELETE\", {}, authToken.access);\n\t\t\tdispatch(actActiveTabKey('filter'));\n\t\t\tdispatch(actShowTreeTab(false));\t\t\t\t\t\t\n\t\t\tfetchTreesAndStatuses();\t\t\t\n\t\t}\n\t};\n\n\n\tconst onCloseTree = () => {\t\n\t\tdispatch(actMapMarkerState({ visible: false, position: {} }));\n\t\tdispatch(actNewTreeCreation(false));\n\t\tdispatch(actActiveTabKey('filter'));\n\t\tdispatch(actShowTreeTab(false));\n\t};\n\n\tconst fetchTreeData = async (idTree: number) => {\t\t\t\n\t\tlet url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${idTree}/`;\n\t\tlet res = await fetch(url);\n\t\tlet data = await res.json();\n\t\tconsole.log(data)\n\t\treturn data;\n\t\t//setDataTreeForm(data);\t\t\n\t}\n\n\tconst onSubmitInsp = async (data: any) => {\n\n\t\tlet method;\n\t\tlet url;\n\t\tif (data.id) {\n\n\t\t\tif (!has_perm(rxDataPermissions, 'inspection', 'change_inspection', authToken)) return;\n\t\t\tif (data?.user !== authToken.user.id && !has_perm(rxDataPermissions, 'inspection', 'can_change_not_own_insp_record', authToken)) return;\t\t\t\n\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.treeId}/inspections/${data.id}/`;\n\t\t\tmethod = \"PUT\";\n\t\t} else {\t\t\t\t\t\t\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.treeId}/inspections/`;\n\t\t\tmethod = \"POST\";\n\t\t}\n\n\n\t\tconsole.log('insp', data, url);\n\t\tawait fetchUrl2(url, method, data, authToken.access);\n\t\tfetchTreeData(data.treeId).then(data => setDataTreeForm(data));\t\t\n\t\tfetchTreesAndStatuses();\n\t\tif (rxShowTreeTab === true) {\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\n\t\t} else {\n\t\t\tdispatch(actActiveTabKey('filter'));\t\n\t\t}\n\t\tdispatch(actShowInspTab(false));\n\t\t\n\t\tupdateInspectionListsWithSpecificTreeId(data.treeId);\t\t\n\t\t\t\n\t};\n\n\tconst onDeleteInsp = async (data: InspItem | null) => {\n\t\tif (!has_perm(rxDataPermissions, 'inspection', 'delete_inspection', authToken)) return;\t\t\n\t\tif (data?.user !== authToken.user.id && !has_perm(rxDataPermissions, 'inspection', 'can_delete_not_own_insp_record', authToken)) return;\t\t\n\n\t\tif (data?.id) {\n\t\t\tconsole.log('DELETE', data)\n\t\t\t//path('citytree/<str:city>/trees/<str:treeid>/inspections/<str:inspid>/', views.citytreeInspectionItem, name=\"citytree-restapi-inspection-item\"),\n\t\t\tawait fetchUrl2(\n\t\t\t\t`${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/0/inspections/${data.id}`, \n\t\t\t\t\"DELETE\", \n\t\t\t\t{}, \n\t\t\t\tauthToken.access);\n\n\t\t\t\tif (data) {\n\t\t\t\t\tfetchTreeData(data.tree).then(data => setDataTreeForm(data));\t;\t\t\t\t\n\t\t\t\t\tif (rxShowTreeTab === true) {\n\t\t\t\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatch(actActiveTabKey('filter'));\t\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\tdispatch(actShowInspTab(false));\t\t\t\t\t\t\n\t\t\t\t\tfetchTreesAndStatuses();\n\t\t\t\t\tupdateInspectionListsWithSpecificTreeId(data.tree);\n\t\t\t\t}\t\t\t\t\n\n\t\t}\t\n\t};\t\n\n\tfunction updateInspectionListsWithSpecificTreeId (id: number) {\n\t\tdispatch(actDataLastEditedTreeId({treeId: id})); \n\t}\t\n\n\tconst onCloseInsp = () => {\t\t\n\t\tdispatch(actShowInspTab(false));\n\t\tif (rxShowTreeTab === true) {\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\n\t\t} else {\n\t\t\tdispatch(actActiveTabKey('filter'));\t\n\t\t}\t\t\t\t\t\n\t};\t\n\n\tconst onNewInsp = (idTree: number) => {\n\t\tif (!has_perm(rxDataPermissions, 'inspection', 'add_inspection', authToken)) return; \n\n\t\tsetDataInspForm({tree: idTree});\n\t\tdispatch(actShowInspTab(true));\n\t\tdispatch(actActiveTabKey('insp'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\t\t\t\n\n\t}\n\n\tconst onClickInspEdit = (data: any) => {\n\t\tif (!has_perm(rxDataPermissions, 'inspection', 'view_inspection', authToken)) return; \n\n\t\t//setDataInspForm({...data}); //таким образом передается копия объекта, которая указывает на другой участок памяти, иначе useEffect не срабатывает у формы, а значит форма не перезаполняется, когда например чтото поменяли на форме, затем ее закрыли без сохранения и снова открыли, видим вместо актуальных данных, старые, которые не сохранялись\n\t\tsetDataInspForm(data);\n\t\tdispatch(actShowInspTab(true));\n\t\tdispatch(actActiveTabKey('insp'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\t\t\n\t}\t\n\n\tconst onClickInspPhotos = (data: any) => {\n\t\tconsole.log('onClickPhotos', data);\t\t\n\t\t\n\t\tconst images: string[] = [];\n\t\tif (data?.photo1) {\n\t\t\timages.push(`${data.photoServer}${data?.photo1}`);\n\t\t}\n\t\tif (data?.photo2) {\n\t\t\timages.push(`${data.photoServer}${data?.photo2}`);\n\t\t}\n\t\tif (data?.photo3) {\n\t\t\timages.push(`${data.photoServer}${data?.photo3}`);\n\t\t}\t\t\t\t\n\n\t\tif (images.length > 0) {\n\t\t\tsetImageSlider({visible: true, images: images});\n\t\t}\t\t\t\t\t\n\t}\t\t\n\n\tconst onClickEditCoords = (coord: {lat: string; lng: string}) => {\t\n\t\t\n\t\tif (rxIsMobileDevice) {\t\n\t\t\tdispatch(actShowSidebar(false));\t\t\t\t\t            \n            dispatch(actShowOkCancelMobileMarker(true));\n\t\t}\n\t\t\n\t\tdispatch(actMapMarkerState({ visible: true, position: coord }));\t\t\t\t\t\t\n\t}\n\t\t\n\n\n\tconst onClickMap = (e: any) => {\n\t\tif (rxCheckButtonNewMarker && !rxIsMobileDevice) {\n\t\t\tdispatch(actNewTreeCreation(true));\n\t\t\tdispatch(actCheckButtonNewMarker(false));\n\n\t\t\tlet coord = { lat: '0', lng: '0' };\n\t\t\tcoord.lat = e.latlng.lat.toFixed(5);\n\t\t\tcoord.lng = e.latlng.lng.toFixed(5);\n\t\t\t\n\t\t\tdispatch(actMapMarkerState({ visible: true, position: coord }));\n\t\t\tdispatch(actNewTreeCreation(true));\n\n\t\t\tdispatch(actShowTreeTab(true));\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\t\t\t\t\t\n\t\t\tdispatch(actShowSidebar(true));\t\n\t\t}\t\t\n\t}\n\n\tconst onClickCreateNewMarker = (state: boolean): boolean | void => {\t\t\t\t\t\t\n\t\t//console.log('test', test);\n\t\t//console.log('rxDataPermissions', rxDataPermissions);\n\t\t//if (!has_perm(rxDataPermissions, 'tree', 'add_tree', authToken)) return false;\t\t\t\t\t\t\t\n\t}\n\tuseEffect(()=>{\n\t\tif (rxCheckButtonNewMarker) {\n\t\t\tif (!has_perm(rxDataPermissions, 'tree', 'add_tree', authToken)) {\n\t\t\t\tdispatch(actCheckButtonNewMarker(false));\n\n\t\t\t\tif (rxIsMobileDevice) {\t\t\t\t\t\t\n\t\t\t\t\tdispatch(actMapMarkerState({ visible: false, position: {lat: 0, lng: 0} }));\n\t\t\t\t\tdispatch(actShowOkCancelMobileMarker(false));\n\t\t\t\t}\t\t\t\t\n\t\t\t}\t\t\t\t\t\t\n\t\t}\t\n\t}, [rxCheckButtonNewMarker]);\n\n\tconst onZoomEnd = (e: any) => {\n\t\tconsole.log('zoom', e.target._zoom);\n\t\tsetCurrentZoomMap(e.target._zoom);\n\t}\n\t\n\tconst onEachLayer = (layer: L.Layer, zoom: number) => {\n\t\t//@ts-ignore\n\t\tconst crowndiameter = layer?.feature?.properties?.lastinsp_crowndiameter;\n\t\tif (crowndiameter) {\n\t\t\t//@ts-ignore\n\t\t    layer.setRadius(ZoomToRadius(zoom, crowndiameter));                    \n\t\t\t\n\t\t} \t\t\n\t}\t\n\t\n\n\tconst onDragEndNewMarker = (LatLng: { lat: number; lng: number }) => {\n\t\tdispatch(actMapMarkerState({ visible: true, position: LatLng }));\n\t};\n\n\tconst filterMapCallback = (feature: any): boolean => {\n\t\tconst result = filterDataMap(feature, rxDataFilters, authToken);\n\n\t\tif (result) {\n\t\t\tlet crowndiameter = feature?.properties?.lastinsp_crowndiameter;\n\t\t\tif (!crowndiameter) crowndiameter = 1;\t\t\t\n\t\t\tconst dot = [feature.properties.latitude, feature.properties.longitude, crowndiameter / 20];\t\t\t\t\t\n\t\t\tdataHeatmapPoints.push(dot);\n\t\t}\n\n\t\treturn result;\n\t};\n\n\n\tconst onSubmitFilter = (filter: {}) => {\n\t\tconsole.log(filter);\n\t\tdataHeatmapPoints = [];\n\t\t\n\t\trxDataTrees.dateTimeGenerated = Date.now(); // dateTimeGenerated is used like key parameter to update data on map, when it changed. <GeoJSON key={mainData.dateTimeGenerated}...\n\t\tdispatch(actDataFilters(filter));\t\n\n\t\tif (isMobileView) {\n\t\t\tdispatch(actShowSidebar(false))\n\t\t}\n\t};\n\n\n\n\tfunction pointToLayerTrees(feature: any, latlng: L.LatLng): any {   \n\t\trxDataTrees.dateTimeGenerated = Date.now();\t\t\n\t\tif (!rxCheckButtonHeatmap) {\t\t\t\n\t\t\t// change color of point depends on them status\n\t\t\tif (feature.properties.lastinsp_status) {\n\t\t\t\tif (Array.isArray(rxDictStatuses)) {\n\t\t\t\t\trxDictStatuses.forEach(element => {\n\t\t\t\t\tif (element.id === feature.properties.lastinsp_status) {\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.fillColor = `#${element.hexcolor}`;\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.color = `#${element.hexcolor}`;\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.radius = ZoomToRadius(currentZoomMap, feature.properties.lastinsp_crowndiameter);\n\t\t\t\t\t}\t\n\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\t\t\t \n\t\t\treturn L.circle(latlng, geojsonMarkerOptions_citytree).on('click', markerOnClick);\t\t\t\n\t\t}\n\t\t\t\n\t\treturn null;\n\t}\n\n\tfunction ZoomToRadius (zoom: number, crowndiameter: number) {\n\t\t// + 21...13 -\n\t\tlet r = Math.floor(crowndiameter / 2);\n\t\tif (zoom < 19) r = r + (18-zoom)*5;\n\t\tif (r < 2) r=2;\n\t\treturn r; \t\t\n\t}\t\n\n \n\n\treturn (\t\t\t\t\n\t\t<MainWrapper cityName={paramsRouter.cityName}>\t\t\t\n\t\t\t<>\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t<Sidebar>\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\tid=\"controlled-tab-example\"\n\t\t\t\t\t\tactiveKey={rxActiveTabKey}\n\t\t\t\t\t\tonSelect={(k) => dispatch(actActiveTabKey(k))}\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tclassName=\"mb-3\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"filter\"\n\t\t\t\t\t\t\ttitle={t<string>(\"sidebar.filterTab.title\")}\t\t\t\t\t\t\t\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormFilter onSubmitFilter={onSubmitFilter}  \n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\n\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"tree\"\n\t\t\t\t\t\t\ttitle={t<string>(\n\t\t\t\t\t\t\t\t\"sidebar.treeTab.title\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\ttabClassName={\n\t\t\t\t\t\t\t\t!rxShowTreeTab ? \"d-none\" : \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormTree \n\t\t\t\t\t\t\t\t\tonSubmitTree={onSubmitTree}\n\t\t\t\t\t\t\t\t\tonDeleteTree={onDeleteTree}\n\t\t\t\t\t\t\t\t\tonCloseTree={onCloseTree} \n\t\t\t\t\t\t\t\t\tonNewInsp={onNewInsp}\n\t\t\t\t\t\t\t\t\tonClickInspEdit={onClickInspEdit}\n\t\t\t\t\t\t\t\t\tonClickInspPhotos={onClickInspPhotos}\n\t\t\t\t\t\t\t\t\tonClickEditCoords={onClickEditCoords}\n\t\t\t\t\t\t\t\t\tdataTreeForm={dataTreeForm}\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\t\tcity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t\tsigningS3Url={URL_GENERATE_S3_URLKEY}\n\t\t\t\t\t\t\t\t\t//currentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\n\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"insp\"\n\t\t\t\t\t\t\ttitle={t<string>(\n\t\t\t\t\t\t\t\t\"sidebar.inspTab.title\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\ttabClassName={\n\t\t\t\t\t\t\t\t!rxShowInspTab ? \"d-none\" : \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormInspection \n\t\t\t\t\t\t\t\t\tonSubmitInsp={onSubmitInsp}\n\t\t\t\t\t\t\t\t\tonDeleteInsp={onDeleteInsp}\n\t\t\t\t\t\t\t\t\tonCloseInsp={onCloseInsp} \n\t\t\t\t\t\t\t\t\tdataInspForm={dataInspForm}\n\t\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\t\tcity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t\tsigningS3Url={URL_GENERATE_S3_URLKEY}\n\t\t\t\t\t\t\t\t\t//currentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\t\t\t\t\t\t\t\t\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Sidebar>\n\n\t\t\t\t<div id=\"page-content-wrapper\">\n\t\t\t\t\t<MenuGlobal\n\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t//onClickShowMenu={ () => dispatch(actShowSidebar(!rxShowSidebar)) }\n\t\t\t\t\t\tauthToken={authToken}\n\t\t\t\t\t\tsetAuthToken={setAuthToken}\n\t\t\t\t\t\tappname=\"citytree\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"container-fluid\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tpaddingRight: \"0px\",\n\t\t\t\t\t\t\tpaddingLeft: \"0px\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Map\n\t\t\t\t\t\t\tmainData={rxDataTrees}\n\t\t\t\t\t\t\tappname=\"citytree\"\n\t\t\t\t\t\t\tdataHeatmapPoints={dataHeatmapPoints}\n\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\tonClickMap={onClickMap}\n\t\t\t\t\t\t\tonClickCreateNewMarker={onClickCreateNewMarker}\n\t\t\t\t\t\t\tonZoomEnd={onZoomEnd}\n\t\t\t\t\t\t\tonEachLayer={onEachLayer}\n\t\t\t\t\t\t\t//={onMarkerClick}\n\t\t\t\t\t\t\tonDragEndNewMarker={onDragEndNewMarker}\n\t\t\t\t\t\t\tpointToLayerCallback={pointToLayerTrees}\n\t\t\t\t\t\t\tfilterMapCallback={filterMapCallback}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n\t\t\t\t{rxShowOkCancelMobileMarker && (\n\t\t\t\t\t<ButtonOkCancelMobileMarker/>\n\t\t\t\t)}\n\n\t\t\t\t<ImageSlider \n\t\t\t\t\tvisible={imageSlider.visible} \n\t\t\t\t\tsetVisible={setImageSlider} \n\t\t\t\t\timages={imageSlider.images}\n\t\t\t\t/>\n\n\t\t\t\t<TreePreviewModal \n\t\t\t\t\tvisible={treePreview.visible} \n\t\t\t\t\tdata={treePreview.data}\n\t\t\t\t\tsetTreePreview={setTreePreview}\n\t\t\t\t\tonButtonEditTreeClick={onButtonEditTreeClick}\n\t\t\t\t\tonClickInspEdit={onClickInspEdit} \n\t\t\t\t\tonClickButtonEditInsp={onClickInspEdit}\n\t\t\t\t\tonClickButtonPhotosInsp={onClickInspPhotos}\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t/>\t\t\t\t\n\n\t\t\t\t<LoginModalForm setAuthToken={setAuthToken}/>\n\t\t\t\t<RegisterModalForm setAuthToken={setAuthToken}/> \t\t\t\n\t\t\t</>\n\t\t</MainWrapper>\n\n\t);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","const initialState = {\r\n    showSidebar: false,\r\n    showTreeTab: false,\r\n    showInspTab: false,\r\n    activeTabKey: 'filter',\r\n    loginModalShow: false,\r\n    registerModalShow: false,\r\n\r\n    mapBaseLayerName: 'Default',\r\n    mapMarkerState: {\r\n\t\tvisible: false,\r\n\t\tposition: {},\r\n\t\tisMobile: false\r\n\t},\r\n    newTreeCreation: false,\r\n    showOkCancelMobileMarker: false,\r\n    checkButtonNewMarker: false,\r\n    checkButtonHeatmap: false,\r\n    checkButtonGPS: false,\r\n\r\n    isMobileDevice: false\r\n}\r\n\r\nconst uiReducer = (state=initialState, action: {type: string; payload: any}) => {\r\n    switch (action.type) {\r\n        case 'SHOWSIDEBAR':\r\n            return {\r\n                ...state,\r\n                showSidebar: action.payload\r\n            }\r\n        case 'SHOWTREETAB':\r\n            return {\r\n                ...state,\r\n                showTreeTab: action.payload\r\n            }   \r\n        case 'SHOWINSPTAB':\r\n            return {\r\n                ...state,\r\n                showInspTab: action.payload\r\n            }                      \r\n        case 'ACTIVETABKEY':\r\n            return {\r\n                ...state,\r\n                activeTabKey: action.payload\r\n            }                                              \r\n        case 'LOGINMODALSHOW':\r\n            return {\r\n                ...state,\r\n                loginModalShow: action.payload\r\n            }\r\n\r\n        case 'REGISTERMODALSHOW':\r\n            return {\r\n                ...state,\r\n                registerModalShow: action.payload\r\n            }    \r\n        \r\n\r\n\r\n        case 'MAPBASELAYERNAME':\r\n            return {\r\n                ...state,\r\n                mapBaseLayerName: action.payload\r\n            } \r\n            \r\n        case 'MAPMARKERSTATE':\r\n            return {\r\n                ...state,\r\n                mapMarkerState: action.payload\r\n            } \r\n\r\n        case 'NEWTREECREATION':\r\n            return {\r\n                ...state,\r\n                newTreeCreation: action.payload\r\n            }             \r\n\r\n        case 'SHOWOKCANCELMOBILEMARKER':\r\n            return {\r\n                ...state,\r\n                showOkCancelMobileMarker: action.payload\r\n            }              \r\n        \r\n        case 'CHECKBUTTONNEWMARKER':\r\n            return {\r\n                ...state,\r\n                checkButtonNewMarker: action.payload\r\n            }\r\n        case 'CHECKBUTTONHEATMAP':\r\n            return {\r\n                ...state,\r\n                checkButtonHeatmap: action.payload\r\n            }            \r\n        case 'CHECKBUTTONGPS':\r\n            return {\r\n                ...state,\r\n                checkButtonGPS: action.payload\r\n            }            \r\n                        \r\n\r\n\r\n        case 'ISMOBILEDEVICE':\r\n            return {\r\n                ...state,\r\n                isMobileDevice: action.payload\r\n            }\r\n\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default uiReducer","const initialState = {\r\n    dataPermissions: {},\r\n    dataTrees: [],\r\n    dataFilters: {},\r\n    dictStatuses: [],\r\n    dictSpecieses: [],\r\n    dictCareTypes: [],\r\n    dictRemarks: [], \r\n    dictPlaceTypes: [],\r\n    dictIrrigationMethods: [], \r\n    dictGroupSpec: [],\r\n    dictTypeSpec: [],\r\n    dataLastEditedTreeId: {treeId: 0} \r\n}\r\n\r\nconst dataReducer = (state=initialState, action: {type: string; payload: any}) => {\r\n    switch (action.type) {\r\n        case 'DATAPERMISSIONS':\r\n            return {\r\n                ...state,\r\n                dataPermissions: action.payload\r\n            }\r\n        case 'DATATREES':\r\n            return {\r\n                ...state,\r\n                dataTrees: action.payload\r\n            }\r\n\r\n        case 'DATALASTEDITEDTREEID':\r\n            return {\r\n                ...state,\r\n                dataLastEditedTreeId: action.payload\r\n            }\r\n                        \r\n        case 'DICTSTATUSES':\r\n            return {\r\n                ...state,\r\n                dictStatuses: action.payload\r\n            }\r\n\r\n        case 'DICTSPECIESES':\r\n            return {\r\n                ...state,\r\n                dictSpecieses: action.payload\r\n            }      \r\n\r\n        case 'DICTCARETYPES':\r\n            return {\r\n                ...state,\r\n                dictCareTypes: action.payload\r\n            }  \r\n\r\n        case 'DICTREMARKS':\r\n            return {\r\n                ...state,\r\n                dictRemarks: action.payload\r\n            }  \r\n\r\n        case 'DICTPLACETYPES':\r\n            return {\r\n                ...state,\r\n                dictPlaceTypes: action.payload\r\n            }    \r\n            \r\n        case 'DICTIRRIGATIONMETHODS':\r\n            return {\r\n                ...state,\r\n                dictIrrigationMethods: action.payload\r\n            }   \r\n            \r\n        case 'DICTGROUPSPECS':\r\n            return {\r\n                ...state,\r\n                dictGroupSpec: action.payload\r\n            }             \r\n            \r\n        case 'DICTTYPESPECS':\r\n            return {\r\n                ...state,\r\n                dictTypeSpec: action.payload\r\n            }             \r\n\r\n        case 'DATAFILTERS':\r\n            return {\r\n                ...state,\r\n                dataFilters: action.payload\r\n            }\r\n\r\n\r\n        default:\r\n            return state            \r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport default dataReducer","import uiReducer from './userInterface'\r\nimport dataReducer from './dataApp'\r\nimport { combineReducers } from 'redux'\r\n\r\nexport const allReducers = combineReducers({\r\n    uiReducer,\r\n    dataReducer    \r\n});\r\n\r\n//export default allReducers\r\nexport type RootState = ReturnType<typeof allReducers>","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\nimport './sidebar.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport './i18nextConf';\nimport { createStore } from 'redux';\nimport { allReducers } from './reducers/index.ts';\nimport { Provider } from 'react-redux';\n\n// Importing the Bootstrap CSS\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst store = createStore(\n  allReducers,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n)\n\nReactDOM.render(\n  <Provider store={store}>\n  <React.StrictMode>\n    <BrowserRouter basename=\"/citytree\">\n      <Routes>\n        <Route path=\"/\" element={<App />}>\n          <Route path=\":cityName\" element={<App />} >\n            <Route path=\":treeId\" element={<App />} />\n          </Route>               \n        </Route>\n      </Routes>\n    </BrowserRouter>\n  </React.StrictMode>\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}