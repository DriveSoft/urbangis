{"version":3,"sources":["actions/index.js","components_hl/MenuGlobal.tsx","components_hl/ButtonMap.js","components_hl/MapTileLayers.tsx","components_hl/Map.tsx","components/images/markers/marker-red.png","components/images/markers/marker-shadow.png","components/MainWrapper.tsx","components/Sidebar.tsx","components/ButtonOkCancelMobileMarker.tsx","components/FormFilter.tsx","components/TableList.tsx","components/ImageS3Upload/ImageS3Upload.tsx","components/ImageS3Upload/delete2.svg","components/ImageS3Upload/index.tsx","components/images/no-photo.png","components/UploadPhotos.tsx","components/FormTree.tsx","components/FormInspection.tsx","components/ImageSlider.tsx","components/LoginModalForm.tsx","components/RegisterModalForm.tsx","App.tsx","useAuthToken.tsx","reportWebVitals.js","i18nextConf.js","reducers/userInterface.tsx","reducers/dataApp.tsx","reducers/index.ts","index.js"],"names":["actShowSidebar","value","type","payload","actShowTreeTab","actShowInspTab","actActiveTabKey","actLoginModalShow","actRegisterModalShow","actMapBaseLayerName","actNewMarkerState","actShowOkCancelMobileMarker","actCheckButtonNewMarker","actCheckButtonGPS","actDataTrees","MenuGlobal","currentCity","appname","authToken","setAuthToken","dispatch","useDispatch","rxShowSidebar","useSelector","state","uiReducer","showSidebar","useState","cities","setCities","useTranslation","t","i18n","changeLanguage","useEffect","fetchCities","a","fetch","process","res","json","data","console","log","Navbar","bg","expand","Container","Button","className","variant","id","onClick","Toggle","Collapse","Nav","Link","href","NavDropdown","title","Item","active","map","city","as","to","sysname","cityname","language","user","name","ButtonMap_","iconTrue","iconFalse","L","easyButton","position","states","stateName","icon","control","button","style","backgroundColor","addTo","MapTileLayers","heatMapLayer","setView_nTimes_gps","circle_geolocation","mapBaseLayerName","LayersControl","BaseLayer","checked","TileLayer","attribution","url","accessToken","maxZoom","tileSize","zoomOffset","subdomains","bingkey","redIcon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","currentCitySysname","Map","mainData","dataHeatmapPoints","onDragEndNewMarker","onClickMap","onZoomEnd","onEachLayer","pointToLayerCallback","filterMapCallback","rxMapBaseLayerName","rxIsMobileDevice","isMobileDevice","rxNewMarkerState","newMarkerState","rxShowOkCancelMobileMarker","showOkCancelMobileMarker","rxCheckButtonNewMarker","checkButtonNewMarker","rxCheckButtonHeatmap","checkButtonHeatmap","rxCheckButtonGPS","checkButtonGPS","currentCityInfo","setCurrentCityInfo","setMap","currentZoom","setCurrentZoom","buttonNewMarker","setButtonNewMarker","buttonHeatmap","setButtonHeatmap","buttonGPS","setButtonGPS","mapname_","document","cookie","split","find","row","startsWith","newMarkerRef","useRef","onClickNewMarker","onClickHeatmap","onClickGPS","remove","fetchCity","DomUtil","addClass","_container","removeClass","window","setTimeout","invalidateSize","pan","visible","lat","lng","SetPanToMap","useMap","panTo","parseFloat","locate","enableHighAccuracy","watch","maximumAge","stopLocate","removeLayer","onEachFeaturePoint","feature","layer","on","e","NewMarker","eventHandlers","useMemo","dragend","current","marker","LatLng","getLatLng","coord","toFixed","Marker","draggable","getCenter","ref","MapEvents","useMapEvents","baselayerchange","move","setLatLng","target","moveend","click","zoomend","_zoom","locationfound","radius","accuracy","setView","latlng","hasLayer","setRadius","circle","locationerror","alert","message","MarkersZoomAdjustment","zoom","getZoom","eachLayer","HeatmapFunction","heatLayer","gradient","max","blur","addLayer","MapContainer","whenCreated","center","zoomControl","scrollWheelZoom","height","width","GeoJSON","pointToLayer","filter","onEachFeature","dateTimeGenerated","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","iconCreateFunction","cluster","digits","count","getChildCount","divIcon","html","toString","undefined","ZoomControl","MainWrapper","children","cityName","Sidebar","marginTop","ButtonOkCancelMobileMarker","FormFilter","onSubmitFilter","rxDictSpecieses","dataReducer","dictSpecieses","rxDictStatuses","dictStatuses","rxDictCareTypes","dictCareTypes","rxDictRemarks","dictRemarks","rxDictPlaceTypes","dictPlaceTypes","rxDictIrrigationMethods","dictIrrigationMethods","rxDictGroupSpecs","dictGroupSpec","useForm","reValidateMode","defaultValues","speciesFilter","statusFilter","careTypeFilter","remarkFilter","placeTypeFilter","irrigationMethodFilter","datePlantedFromFilter","datePlantedToFilter","dateAddedFromFilter","dateAddedToFilter","commentFilter","heightFromFilter","trunkGirthFromFilter","crownDiameterFromFilter","heightToFilter","trunkGirthToFilter","crownDiameterToFilter","showMyTreesFilter","handleSubmit","register","reset","optionsSpeciesesFilter","setValue","Array","isArray","itemGroup","label","groupname","options","spec","groupspec","localname","speciesname","typespec","optionsStatusesFilter","x","statusname","optionsCareTypesFilter","carename","optionsRemarksFilter","remarkname","optionsPlaceTypesFilter","placename","optionsIrrigationMethodsFilter","irrigationname","customStyles","option","styles","paddingLeft","Option","props","color","Form","onSubmit","Group","controlId","Label","render","field","placeholder","isMulti","isSearchable","getOptionLabel","components","maxMenuHeight","Row","Col","minWidth","isClearable","Control","maxWidth","size","min","Check","inline","TableList","stateComponent","columns","sortField","sortAsc","OnClickButtons","sortState","setSortState","dataTable","setDataTable","columnsHeader","item","index","cursor","sortable","float","textAlign","headerName","fontSize","DataTable","sortedData","sort","b","length","DataRow","indexRow","colSpan","getUniqKey","String","col","dateTimeOption","Date","toLocaleDateString","toLocaleTimeString","dateTime","buttons","buttonRow","forEach","text","iconFA","idButton","buttonText","iconFASize","push","Table","striped","bordered","hover","defaultResizingOptions","enabled","autoResize","maxHeight","compressFormat","quality","rotation","ImageS3Upload","forwardRef","signingUrl","autoUpload","emptyPhoto","serverPhoto","onChange","buttonCaption","resizer","onFinish","onProgress","onError","onSignedUrl","useImperativeHandle","uploadFile","inputFileEl","files","status","resizing","startUpload","none","setStatus","imagePhoto","setImagePhoto","compressedPhoto","setCompressedPhoto","buttonCaptionState","setButtonCaptionState","showSpinner","setShowSpinner","s3DataState","setS3DataState","notLoad","setNotLoad","fields","key","slice","resizeFile","file","Promise","resolve","Resizer","imageFileResizer","uri","onChangeFile","event","URL","createObjectURL","image","Blob","resized","error","fetchUrlSign","objectName","myHeaders","Headers","append","bodyObject","method","headers","body","JSON","stringify","parse","updateProgress","ev","lengthComputable","percentComplete","Math","round","loaded","total","s3Data","xhr","XMLHttpRequest","open","timeout","upload","onprogress","postData","FormData","onreadystatechange","readyState","onload","onerror","send","filename","replace","signedUrl","file_exists","rndStr","makeRandomStr","Image","src","fluid","rounded","deleteImage","top","right","Spinner","animation","role","accept","display","result","characters","charactersLength","i","charAt","floor","random","UploadPhotos","controlFromUseForm","signingS3Url","onCallbackDone","photo1Ref","photo2Ref","photo3Ref","uploadedPhoto1","setUploadedPhoto1","uploadedPhoto2","setUploadedPhoto2","uploadedPhoto3","setUploadedPhoto3","resizerOptions","uploadPhotos","p1","p2","p3","onFinishPhoto1","onFinishPhoto2","onFinishPhoto3","xs","noPhotoImage","FormTree","onSubmitTree","onDeleteTree","onCloseTree","onNewInsp","onEditInsp","onClickInspPhotos","dataTreeForm","showModalDelete","setShowModalDelete","uploadPhotosRef","inspections","setInspections","optionsIrrigationMethodsData","formData","latitude","longitude","species","species_id","isFound","optionsSpeciesesData","element","speciescomment","comment","placetype","optionsPlaceTypesData","irrigationmethod","dateplanted","googlestreeturl","keepDefaultValues","fetchInpections","photo1","photo2","photo3","typeData","optionsStatusesData","optionsCareTypesData","optionsRemarksData","crowndiameter","trunkgirth","remarks","recommendations","getValues","errors","formState","trigger","preventDefault","prepareOnSubmitTree","inspection","parseInt","isSelected","isFocused","isDisabled","rules","required","step","isInvalid","Feedback","rows","pattern","rowData","Modal","show","onHide","Header","closeButton","Title","Body","Footer","FormInspection","onSubmitInsp","onDeleteInsp","onCloseInsp","dataInspForm","treeId","isValid","tree","includes","prepareOnSubmitInsp","photoServer","ImageSlider","setVisible","images","dialogClassName","Carousel","interval","photo","LoginModalForm","rxLoginModalShow","loginModalShow","showWrongPassword","setShowWrongPassword","username","password","rememberme","credentials","then","centered","localStorage","setItem","loginUser","FloatingLabel","Text","RegisterModalForm","rxRegisterModalShow","registerModalShow","email","password2","first_name","last_name","setError","token","Object","entries","registerUser","geojsonMarkerOptions_citytree","fillColor","weight","opacity","fillOpacity","App","paramsRouter","useParams","csrftoken","cookieValue","cookies","trim","substring","decodeURIComponent","getCookie","rxDataTrees","dataTrees","rxDataFilters","dataFilters","rxActiveTabKey","activeTabKey","rxShowTreeTab","showTreeTab","rxShowInspTab","showInspTab","currentZoomMap","setCurrentZoomMap","getUsernameFromToken","access","arToken","atob","user_id","tokenString","getItem","sessionStorage","getToken","userToken","removeItem","useAuthToken","innerWidth","screenWidth","setScreenWidth","isMobileView","setDataTreeForm","setDataInspForm","imageSlider","setImageSlider","handleWindowSizeChange","fetchSpecieses","fetchCareTypes","fetchRemarks","fetchPlaceTypes","fetchIrrigationMethods","fetchGroupSpecs","fetchTypeSpecs","response","refreshAuthToken","refresh","checkAuthToken","test","navigator","userAgent","addEventListener","removeEventListener","fetchTreesAndStatuses","setInterval","clearInterval","now","markerOnClick","fetchTreeData","idTree","geojson","toGeoJSON","properties","isFoundArrayInValue","array","isFoundArrayInArray","arraySearch","arrayTree","ZoomToRadius","r","Tabs","activeKey","onSelect","k","Tab","eventKey","tabClassName","fetchUrl","paddingRight","lastinsp_crowndiameter","lastinsp_status","hexcolor","valueFilter","objectSearchResult","plantedDateFrom","plantedDateTo","addedDateFrom","addedDateTo","heightFrom","heightTo","trunkGirthFrom","trunkGirthTo","crownDiameterFrom","crownDiameterTo","showOnlyMyTrees","datetimeadded","toLowerCase","indexOf","lastinsp_height","lastinsp_trunkgirth","useradded","el","callBackSucceed","get","statusText","detail","refreshToken","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","use","LanguageDetector","initReactI18next","init","resources","en","translation","translationEN","translationBG","fallbackLng","interpolation","escapeValue","initialState","isMobile","action","dictTypeSpec","allReducers","combineReducers","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","StrictMode","basename","path","getElementById"],"mappings":"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","file":"static/js/main.ae21a2b7.chunk.js","sourcesContent":["// userInterface actions ================================================\r\nexport const actShowSidebar = (value) => {\r\n    return {\r\n        type: 'SHOWSIDEBAR',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowTreeTab = (value) => {\r\n    return {\r\n        type: 'SHOWTREETAB',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowInspTab = (value) => {\r\n    return {\r\n        type: 'SHOWINSPTAB',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actActiveTabKey = (value) => {\r\n    return {\r\n        type: 'ACTIVETABKEY',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actLoginModalShow = (value) => {\r\n    return {\r\n        type: 'LOGINMODALSHOW',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actRegisterModalShow = (value) => {\r\n    return {\r\n        type: 'REGISTERMODALSHOW',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const actMapBaseLayerName = (value) => {\r\n    return {\r\n        type: 'MAPBASELAYERNAME',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actNewMarkerState = (value) => {\r\n    return {\r\n        type: 'NEWMARKERSTATE',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowOkCancelMobileMarker = (value) => {\r\n    return {\r\n        type: 'SHOWOKCANCELMOBILEMARKER',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actCheckButtonNewMarker = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONNEWMARKER',\r\n        payload: value\r\n    }\r\n}\r\nexport const actCheckButtonHeatmap = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONHEATMAP',\r\n        payload: value\r\n    }\r\n}\r\nexport const actCheckButtonGPS = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONGPS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actIsMobileDevice = (value) => {\r\n    return {\r\n        type: 'ISMOBILEDEVICE',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// date actions ================================================\r\nexport const actDataTrees= (value) => {\r\n    return {\r\n        type: 'DATATREES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictStatuses = (value) => {\r\n    return {\r\n        type: 'DICTSTATUSES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictSpecieses = (value) => {\r\n    return {\r\n        type: 'DICTSPECIESES',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\nexport const actDictCareTypes = (value) => {\r\n    return {\r\n        type: 'DICTCARETYPES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictRemarks = (value) => {\r\n    return {\r\n        type: 'DICTREMARKS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictPlaceTypes = (value) => {\r\n    return {\r\n        type: 'DICTPLACETYPES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictIrrigationMethods = (value) => {\r\n    return {\r\n        type: 'DICTIRRIGATIONMETHODS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictGroupSpecs = (value) => {\r\n    return {\r\n        type: 'DICTGROUPSPECS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictTypeSpecs = (value) => {\r\n    return {\r\n        type: 'DICTTYPESPECS',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const actDataFilters = (value) => {\r\n    return {\r\n        type: 'DATAFILTERS',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n","import { useState, useEffect } from 'react'\r\nimport Container from 'react-bootstrap/Container';\r\nimport Navbar from 'react-bootstrap/Navbar'\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport NavDropdown from 'react-bootstrap/NavDropdown';\r\nimport Button from 'react-bootstrap/Button';\r\nimport { Link } from \"react-router-dom\";\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { actLoginModalShow, actShowSidebar } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\ninterface IStateCities {\r\n\tcities: {\r\n\t\tid: number\r\n\t\tsysname: string;\r\n\t\tcityname: string;\r\n\t\tlatitude: number;\r\n\t\tlongitude: number;\r\n\t\tpopulation: number;\r\n\t}[]\r\n}\r\n\r\ninterface MenuGlobalProps {\r\n\tcurrentCity: string;\r\n\tappname: string;\r\n\tauthToken: any;\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n  }\r\n\r\n\r\n\r\nfunction MenuGlobal({\r\n\tcurrentCity,\r\n\tappname,\r\n\tauthToken,\r\n\tsetAuthToken,\r\n}: MenuGlobalProps) {\r\n\tconst dispatch = useDispatch();\r\n\tconst rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar)\r\n\tconst [cities, setCities] = useState<IStateCities['cities']>([]);\r\n\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tconst fetchCities = async () => {\r\n\t\t\tconst res = await fetch(`${process.env.REACT_APP_API_URL}cities/`);\r\n\t\t\tconst data = await res.json();\r\n\t\t\tsetCities(data);\r\n\t\t\tconsole.log(data);\r\n\t\t};\r\n\r\n\t\tfetchCities();\r\n\t}, []);\r\n\r\n\tfunction changeLanguage(value: string) {\r\n\t\ti18n.changeLanguage(value);\r\n\t\t//localStorage.setItem('lng', value)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Navbar bg=\"light\" expand=\"lg\">\r\n\t\t\t<Container>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tclassName=\"start-0\"\r\n\t\t\t\t\tvariant=\"outline-primary\"\r\n\t\t\t\t\tid=\"menu-toggle\"\r\n\t\t\t\t\t//onClick={onClickShowMenu}\r\n\t\t\t\t\tonClick={() => dispatch(actShowSidebar(!rxShowSidebar))}\r\n\t\t\t\t>\r\n\t\t\t\t\t{t<string>(\"menu.menu\")}\r\n\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t<Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n\t\t\t\t<Navbar.Collapse id=\"basic-navbar-nav\">\r\n\t\t\t\t\t<Nav className=\"ms-auto\">\r\n\t\t\t\t\t\t<Nav.Link href=\"/\">{t<string>(\"menu.home\")}</Nav.Link>\r\n\r\n\t\t\t\t\t\t<NavDropdown\r\n\t\t\t\t\t\t\ttitle={t<string>(\"menu.appMaps.title\")}\r\n\t\t\t\t\t\t\tid=\"basic-nav-dropdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/roadaccident/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"roadaccident\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.roadaccident\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/citytree/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"citytree\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.citytree\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/urbanobject/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"3\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"urbanobject\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.urbanobject\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown\r\n\t\t\t\t\t\t\ttitle={t<string>(\"menu.city\")}\r\n\t\t\t\t\t\t\tid=\"basic-nav-dropdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{cities.map((city) => (\r\n\t\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\t\tas={Link}\r\n\t\t\t\t\t\t\t\t\tkey={city.id}\r\n\t\t\t\t\t\t\t\t\tto={`/${city.sysname}`}\r\n\t\t\t\t\t\t\t\t\tactive={currentCity === city.sysname}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{city.cityname}\r\n\t\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown title=\"Lang\" id=\"basic-nav-dropdown\">\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\"en\" === i18n.language ||\r\n\t\t\t\t\t\t\t\t\t\"en-US\" === i18n.language ||\r\n\t\t\t\t\t\t\t\t\t\"en-GB\" === i18n.language\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvalue=\"en\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage(\"en\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEnglish\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={\"bg\" === i18n.language}\r\n\t\t\t\t\t\t\t\tvalue=\"bg\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage(\"bg\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tBulgarian\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t{authToken ? (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Nav.Link>\r\n\t\t\t\t\t\t\t\t\t{`${t(\"words.hello\")}, ${\r\n\t\t\t\t\t\t\t\t\t\tauthToken?.user?.name\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\r\n\t\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetAuthToken(null);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{t<string>(\"menu.logout\")}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t//onClick={() => setLoginModalShow(true)}\r\n\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(true))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.signin\")}\r\n\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Nav>\r\n\t\t\t\t</Navbar.Collapse>\r\n\t\t\t</Container>\r\n\t\t</Navbar>\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default MenuGlobal\r\n","// don't work with TypeScript, error: TypeError: leaflet__WEBPACK_IMPORTED_MODULE_0___default.a.easyButton is not a function\r\nimport L from 'leaflet';\r\nimport easyButton from 'leaflet-easybutton'\r\nimport \"leaflet-easybutton/src/easy-button.css\"\r\nimport \"@fortawesome/fontawesome-free/css/all.min.css\" \r\n \r\n\r\nfunction ButtonMap_ (map, iconTrue, iconFalse, onClick) {\r\n    //const map = useMap()\r\n    \r\n            const buttonMap = L.easyButton({\r\n                position: 'topright',\r\n                states:[\r\n                    {\r\n                        title: '',\r\n                        stateName: 'off',\r\n                        icon: `<i class=\"${iconTrue}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('on');\r\n                            //@ts-ignore\r\n                            control.button.style.backgroundColor = 'red';\r\n                            onClick(true)\r\n                        }\r\n                    },\r\n        \r\n                    {\r\n                        title: '',\r\n                        stateName: 'on',\r\n                        icon: `<i class=\"${iconFalse}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('off');\r\n                            //@ts-ignore\r\n                            control.button.style.backgroundColor = 'white';\r\n                            onClick(false)\r\n                        }\r\n                    }]\r\n            }).addTo( map );\r\n\r\n\r\n\r\n            //if (checkButtonState) {\r\n            //    buttonMap.state('on');\r\n            //    buttonMap.button.style.backgroundColor = 'red';\r\n            //} else {\r\n            //    buttonMap.state('off');\r\n            //    buttonMap.button.style.backgroundColor = 'white';            \r\n            //}\r\n            \r\n            \r\n    \r\n    return buttonMap\r\n\r\n}\r\n\r\nexport default ButtonMap_\r\n","import React from \"react\"\r\nimport { LayersControl, TileLayer } from \"react-leaflet\"\r\n//@ts-ignore\r\nimport {BingLayer} from 'react-leaflet-bing-v2/src/index'\r\n\r\n\r\ninterface MapTileLayersProps {\r\n\tmapBaseLayerName: string;\r\n}\r\n\r\nfunction MapTileLayers({ mapBaseLayerName }: MapTileLayersProps) {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Default\"}\r\n\t\t\t\tname=\"Default\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/streets-v11\"\r\n\t\t\t\t\tmaxZoom={21}\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Dark\"}\r\n\t\t\t\tname=\"Dark\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/dark-v10\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Google\"}\r\n\t\t\t\tname=\"Google\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat1\"}\r\n\t\t\t\tname=\"Sat1\"\r\n\t\t\t>\r\n                <BingLayer  bingkey={'AniAD3xsGTaSbK1pa0_UkWS1CldG0nGI7r55MlVZqHhyKil9rD9dFK8536u8hTj1'} type=\"Aerial\"/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n            \r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat2\"}\r\n\t\t\t\tname=\"Sat2\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat3\"}\r\n\t\t\t\tname=\"Sat3\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Tiles &copy; Esri'\r\n\t\t\t\t\turl=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\r\n                    maxZoom={19}                    \r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat4\"}\r\n\t\t\t\tname=\"Sat4\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/satellite-v9\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tmaxZoom={21}\r\n                    zoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default MapTileLayers;\r\n","import { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { MapContainer, LayersControl, TileLayer, ZoomControl, useMapEvents, GeoJSON, useMap, Marker, Popup } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport \"leaflet.heat\";\r\nimport \"./Map.css\";\r\n\r\n//import ButtonMap from './ButtonMap'\r\nimport ButtonMap_ from './ButtonMap';\r\nimport MapTileLayers from '../components_hl/MapTileLayers';\r\n\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport redIconFile from '../components/images/markers/marker-red.png';\r\nimport redIconShadowFile from '../components/images/markers/marker-shadow.png';\r\n\r\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\r\nimport 'react-leaflet-markercluster/dist/styles.min.css'; // sass\r\n//require('leaflet/dist/leaflet.css'); // inside .js file\r\n//require('react-leaflet-markercluster/dist/styles.min.css'); // inside .js file\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport {\r\n\tactCheckButtonGPS,\r\n\tactCheckButtonHeatmap,\r\n\tactCheckButtonNewMarker,\r\n\tactMapBaseLayerName,\r\n\tactNewMarkerState,\r\n\tactShowOkCancelMobileMarker\r\n    //actShowAccidentTab,\r\n    //actActiveTabKey\r\n} from \"../actions\";\r\nimport { RootState } from '../reducers/index';\r\n\r\n// fix disapeared marker from map\r\n\r\n//import icon from 'leaflet/dist/images/marker-icon.png';\r\n//import iconShadow from 'leaflet/dist/images/marker-shadow.png';\r\n//let DefaultIcon = L.icon({\r\n//    iconAnchor: [12, 40],\r\n//    iconUrl: icon,\r\n//    shadowUrl: iconShadow\r\n//});\r\n//L.Marker.prototype.options.icon = DefaultIcon;\r\n\r\n\r\n\r\n\r\n\r\nlet redIcon = L.icon({ \r\n    iconUrl: redIconFile,\r\n    shadowUrl: redIconShadowFile,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41]\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//let buttonNewMarker = null\r\n//let buttonHeatmap = null\r\n//let buttonGPS = null\r\n\r\nlet currentCitySysname = ''\r\n\r\nlet heatMapLayer: any;\r\nlet markersLayer\r\n\r\nlet setView_nTimes_gps: number;\r\nlet circle_geolocation: L.Circle<any>;\r\n\r\n\r\n\r\n\r\n\r\ninterface IStateCurrentCity {\r\n    id: number\r\n\tsysname: string;\r\n\tcityname: string;\r\n\tlatitude: string;\r\n\tlongitude: string;\r\n\tpopulation: number;\t\r\n    zoom: number;\r\n}\r\n\r\ninterface MapProps {\r\n    mainData: any;\r\n    appname: string;\r\n    dataHeatmapPoints: number[][]; // [[lat, lng, value],[lat, lng, value]...]\r\n    currentCity: string;\r\n    onDragEndNewMarker: (LatLng: {lon: number; lat: number}) => void;\r\n    onClickMap: (e: any) => void;\r\n    onZoomEnd?: (e: any) => void;\r\n    onEachLayer?: (layer: L.Layer, zoom: number) => void;\r\n    //onMarkerClick: (data: any) => void;\r\n    pointToLayerCallback: (feature: any, latlng: L.LatLng) => any;\r\n    filterMapCallback: (feature: any) => boolean;\r\n}\r\n\r\nfunction Map ({\r\n                mainData,  \r\n                appname,          \r\n                dataHeatmapPoints, \r\n                currentCity,                 \r\n                onDragEndNewMarker, \r\n                onClickMap, \r\n                onZoomEnd,  \r\n                onEachLayer,                            \r\n                //onMarkerClick,                 \r\n                pointToLayerCallback,\r\n                filterMapCallback               \r\n            }: MapProps) {\r\n               \r\n\r\n    const dispatch = useDispatch()\r\n    //const defaultZoom = 13;\r\n    //const rxDataAccidents = useSelector((state: RootState) => state.dataReducer.dataAccidents)\r\n    \r\n    const rxMapBaseLayerName = useSelector((state: RootState) => state.uiReducer.mapBaseLayerName);\r\n    const rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\r\n    const rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\r\n    const rxNewMarkerState = useSelector((state: RootState) => state.uiReducer.newMarkerState);\r\n    const rxShowOkCancelMobileMarker = useSelector((state: RootState) => state.uiReducer.showOkCancelMobileMarker);\r\n    \r\n    const rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\r\n    const rxCheckButtonHeatmap = useSelector((state: RootState) => state.uiReducer.checkButtonHeatmap);\r\n    const rxCheckButtonGPS = useSelector((state: RootState) => state.uiReducer.checkButtonGPS);\r\n\r\n    //const [currentCityInfo, setCurrentCityInfo] = useState({latitude: \"0\", longitude: \"0\"})\r\n    const [currentCityInfo, setCurrentCityInfo] = useState<IStateCurrentCity | null>(null);\r\n    const [map, setMap] = useState<any>(null);  \r\n    \r\n    const [currentZoom, setCurrentZoom] = useState(13); \r\n\r\n    const [buttonNewMarker, setButtonNewMarker] = useState<any>(null);\r\n    const [buttonHeatmap, setButtonHeatmap] = useState<any>(null);\r\n    const [buttonGPS, setButtonGPS] = useState<any>(null);\r\n\r\n    let mapname_ = document.cookie\r\n    .split('; ')\r\n    .find(row => row.startsWith('mapname='))\r\n\r\n    let mapname\r\n    if (mapname_) {\r\n        mapname = mapname_.split('=')[1]    \r\n    }\r\n\r\n\r\n    let newMarkerRef = useRef(null)   \r\n \r\n\r\n    // create buttons\r\n    useEffect(() => {        \r\n        if (map) {            \r\n            setButtonNewMarker( ButtonMap_(map, 'fas fa-map-marker-alt fa-lg', 'fas fa-map-marker-alt fa-lg', onClickNewMarker) )\r\n            setButtonHeatmap( ButtonMap_(map, 'fas fa-eye fa-lg', 'fas fa-eye-slash fa-lg', onClickHeatmap) )\r\n            setButtonGPS( ButtonMap_(map, 'fas fa-satellite-dish fa-lg', 'fas fa-satellite-dish fa-lg', onClickGPS) )\r\n            \r\n            //setMapCurrentLatLng({lat: map.getCenter().lat, lng: map.getCenter().lng})                        \r\n\r\n            let mapname_ = document.cookie\r\n\t\t\t.split(\"; \")\r\n\t\t\t.find((row) => row.startsWith(\"mapname=\"));\r\n\r\n\t\t    if (mapname_) {\r\n                dispatch(actMapBaseLayerName(mapname_.split(\"=\")[1]))\r\n\t\t    }            \r\n        }        \r\n\r\n        return () => { \r\n            buttonNewMarker && buttonNewMarker.remove()\r\n            buttonHeatmap && buttonHeatmap.remove()\r\n            buttonGPS && buttonGPS.remove()\r\n        }  \r\n\r\n\r\n      }, [map])  //<MapContainer whenCreated={setMap} ...\r\n\r\n\r\n    // load data for the city\r\n    useEffect(() => {\r\n\r\n        const fetchCity = async () => {\r\n            const res = await fetch(`${process.env.REACT_APP_API_URL}cities/${currentCity}`);\r\n            const data = await res.json();\r\n            setCurrentCityInfo(data);          \r\n        }\r\n\r\n        fetchCity();\r\n        console.log('currentCity');\r\n           \r\n    }, [currentCity])  //[currentCity]\r\n   \r\n\r\n    //useEffect(() => {\r\n    //    if (currentCityInfo && map) {\r\n    //        //map.setZoom(currentCityInfo.zoom);\r\n    //        if (onZoomEnd) onZoomEnd(currentCityInfo.zoom);          \r\n    //    }    \r\n    //\r\n    //}, [currentCityInfo]);   \r\n    \r\n    \r\n\r\n\r\n      // apply states for buttons\r\n      \r\n      useEffect(() => {        \r\n        if (buttonNewMarker) {\r\n            if (rxCheckButtonNewMarker) {\r\n                buttonNewMarker.state('on');\r\n                buttonNewMarker.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonNewMarker.state('off');\r\n                buttonNewMarker.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonNewMarker]);\r\n\r\n      useEffect(() => {        \r\n        if (buttonHeatmap) {\r\n            if (rxCheckButtonHeatmap) {\r\n                buttonHeatmap.state('on');\r\n                buttonHeatmap.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonHeatmap.state('off');\r\n                buttonHeatmap.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonHeatmap])\r\n      useEffect(() => {        \r\n        if (buttonGPS) {\r\n            if (rxCheckButtonGPS) {\r\n                buttonGPS.state('on');\r\n                buttonGPS.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonGPS.state('off');\r\n                buttonGPS.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonGPS])      \r\n\r\n\r\n    \r\n    useEffect(()=>{\r\n        if (map && !rxIsMobileDevice) {\r\n            if (rxCheckButtonNewMarker) {\r\n                L.DomUtil.addClass(map._container,'crosshair-cursor-enabled');\r\n            } else {\r\n                L.DomUtil.removeClass(map._container,'crosshair-cursor-enabled');\r\n            }    \r\n        }\r\n    }, [rxCheckButtonNewMarker]); \r\n      \r\n\r\n\r\n    useEffect(()=>{\r\n        if (map) {\r\n            window.setTimeout(function(){map.invalidateSize({pan: false});}, 600)\r\n        }        \r\n    }, [rxShowSidebar])\r\n\r\n\r\n\r\n\r\n\r\n\r\n    \r\n\r\n\tconst onClickNewMarker = (state: boolean) => {        \r\n        \r\n        dispatch(actCheckButtonNewMarker(state));\r\n        \r\n\r\n\t\tif (rxIsMobileDevice && state) {\t\t\t\t\t\t\r\n            dispatch(actNewMarkerState({ visible: true, position: {lat: 0, lng: 0} }));\r\n            dispatch(actShowOkCancelMobileMarker(true));\r\n\t\t}\r\n\t};\r\n\r\n\tconst onClickHeatmap = (state: boolean) => {\t\t\r\n        console.log(\"onClickHeatmap\", state);\r\n\r\n\t\tif (state) {\r\n            dispatch(actMapBaseLayerName('Dark'))\r\n\t\t} else {\r\n            dispatch(actMapBaseLayerName('Default'))\r\n\t\t}\r\n        dispatch(actCheckButtonHeatmap(state))\r\n\t};\r\n\r\n\r\n\r\n\r\n\r\n    function SetPanToMap() {        \r\n        const map = useMap();\r\n        if (currentCityInfo) {\r\n            // change map position when current city has been changed        \r\n            if (currentCitySysname !== currentCityInfo[\"sysname\"]) {\r\n                map.panTo( [parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])] );\r\n            }\r\n            currentCitySysname = currentCityInfo[\"sysname\"];\r\n\r\n        }\r\n        return null;\r\n    }    \r\n\r\n\r\n    function onClickGPS(state: boolean) {\r\n        if (map) {\r\n            if (state){\r\n                setView_nTimes_gps = 4;\r\n                map.locate({maxZoom: 20, enableHighAccuracy: true, watch:true, maximumAge: 20000});\r\n            } else {\r\n                map.stopLocate();\r\n                map.removeLayer(circle_geolocation);\r\n                setView_nTimes_gps = 4;\r\n            }\r\n\r\n        }\r\n        dispatch(actCheckButtonGPS(state))\r\n    }\r\n\r\n\r\n    //function markerOnClick(e: any)\r\n    //{\r\n    //    let marker: L.Marker = e.target;\r\n    //    let geojson = marker.toGeoJSON(); //: GeoJSON.FeatureCollection<any>\r\n    //    onMarkerClick(geojson);\r\n    //    //console.log(geojson)        \r\n    //}\r\n\r\n\r\n    //function pointToLayer_roadaccident(feature: GeoJSON.Point|GeoJSON.Feature<GeoJSON.Point>, latlng: L.LatLng): any \r\n    //{\r\n    //    if (!rxCheckButtonHeatmap) {\r\n    //        return L.circleMarker(latlng, geojsonMarkerOptions).on('click', markerOnClick)        \r\n    //    }\r\n    //    //return null;\r\n    //}\r\n\r\n\r\n    \r\n    /*\r\n    function ZoomToRadius (zoom: number, crowndiameter: number) {\r\n        let r: number = Math.floor(crowndiameter / 2);\r\n\r\n        if (zoom > 17) {\r\n            r = Math.floor(crowndiameter / 2);\r\n        } else if (zoom == 17){\r\n            r = 7;\r\n        } else if (zoom == 16){\r\n            r = 10;\r\n        } else if (zoom == 15){\r\n            r = 14;\r\n        } else if (zoom == 14){\r\n            r = 19\r\n        } else if (zoom == 13){\r\n            r = 24\r\n        } else if (zoom == 12){\r\n            r = 30\r\n        } else if (zoom == 11){\r\n            r = 37\r\n        } else if (zoom < 11){\r\n            r = 45\r\n        }\r\n    \r\n        if (r < 2) { r = 2 }\r\n        return r;\r\n    }   \r\n    */ \r\n\r\n    //function pointToLayer_citytree(feature: any, latlng: L.LatLng): any {   \r\n    //    console.log('123') \r\n    //    return L.circleMarker(latlng, geojsonMarkerOptions_citytree).on('click', markerOnClick)\r\n        /*\r\n        if (!rxCheckButtonHeatmap && currentZoom !== null) {\r\n            console.log('currentZoom', currentZoom)   \r\n            console.log('lastinsp_crowndiameter', feature.properties.lastinsp_crowndiameter)\r\n\r\n            geojsonMarkerOptions_citytree.radius = ZoomToRadius(currentZoom, feature.properties.lastinsp_crowndiameter);\r\n            if (geojsonMarkerOptions_citytree.radius < 2) {\r\n                geojsonMarkerOptions_citytree.radius = 2;\r\n            }\r\n\r\n            return L.circleMarker(latlng, geojsonMarkerOptions_citytree).on('click', markerOnClick)        \r\n        }*/\r\n\r\n/*\r\n\r\n        pointToLayer: function (feature, latlng) {\r\n\r\n            geojsonMarkerOptions.radius = ZoomToRadius(zoom, feature.properties.lastinsp_crowndiameter);\r\n\r\n            if (geojsonMarkerOptions.radius < 2) {\r\n                geojsonMarkerOptions.radius = 2;\r\n            }\r\n\r\n            {% if status %}\r\n                {% for statusItem in status %}\r\n                    if (feature.properties.lastinsp_status == \"{{statusItem.id}}\")\r\n                    {\r\n                        geojsonMarkerOptions.fillColor = \"#{{statusItem.hexcolor}}\";\r\n                        geojsonMarkerOptions.color = \"#{{statusItem.hexcolor}}\";\r\n                    }\r\n                {% endfor %}\r\n            {% endif %}\r\n\r\n            return L.circle(latlng, geojsonMarkerOptions).on('click', markerOnClick);\r\n\r\n        },\r\n\r\n*/\r\n\r\n\r\n\r\n    //}\r\n\r\n\r\n\r\n    //function onEachFeaturePoint(feature, layer) {\r\n    function onEachFeaturePoint(feature: any, layer: L.Layer) {        \r\n        //console.log('feature: ', feature);\r\n        //console.log('layer: ', layer);\r\n        layer.on({\r\n          'click': function (e) {\r\n             console.log('e: ', e);\r\n             console.log('click');\r\n           }\r\n        })\r\n    }    \r\n\r\n\r\n\r\n\r\n\r\n    function NewMarker({newMarkerState}: any) {          \r\n        const visible = newMarkerState.visible;\r\n\r\n        const map = useMap();\r\n\r\n        const eventHandlers = useMemo(\r\n            () => ({\r\n                dragend() {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current;\r\n                        if (!rxIsMobileDevice && marker != null) {\r\n                            //onDragEndNewMarker(marker.getLatLng())                        \r\n                            const LatLng = marker.getLatLng();\r\n                            let coord = { lat: '0', lng: '0' };\r\n                            coord.lat = LatLng.lat.toFixed(5);\r\n                            coord.lng = LatLng.lng.toFixed(5);\r\n                    \r\n                            //setNewMarkerState({ visible: true, position: coord }); \r\n                            dispatch(actNewMarkerState({ visible: true, position: coord }));                       \r\n                        }\r\n                    }\r\n                },\r\n            }),\r\n            [],\r\n        );\r\n\r\n        return (<>\r\n                    {visible && <> \r\n                        {(!rxIsMobileDevice) \r\n                        ?\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={true}\r\n                                position={newMarkerState.position}\r\n                                ref={newMarkerRef}\r\n                                eventHandlers={eventHandlers}                    \r\n                            />                    \r\n                        :\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={false}\r\n                                //position={map.getCenter()}\r\n                                position={newMarkerState.position.lat==0 ? map.getCenter() : newMarkerState.position }\r\n                                ref={newMarkerRef}                 \r\n                            />\r\n                        } \r\n                </>}\r\n                                         \r\n        </>)\r\n    }\r\n    \r\n\r\n\r\n    function MapEvents() {        \r\n        const map = useMapEvents({\r\n            baselayerchange(e) {\r\n                document.cookie = 'mapname='+e.name\r\n            }, \r\n            //baselayerchange: onBaselayerchange,\r\n\r\n            move(e) {               \r\n                \r\n                if (rxShowOkCancelMobileMarker) {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current\r\n                        marker.setLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n                                        \r\n                        //let coord = { lat: 0, lng: 0 }\r\n                        //coord.lat = e.target.getCenter().lat.toFixed(5)\r\n                        //coord.lng = e.target.getCenter().lng.toFixed(5)\r\n                    }\r\n                }    \r\n            },\r\n\r\n            moveend(e) {\r\n                if (rxShowOkCancelMobileMarker) {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current\r\n                        const LatLng = marker.getLatLng()\r\n                        let coord = { lat: '0', lng: '0' };\r\n                        coord.lat = LatLng.lat.toFixed(5);\r\n                        coord.lng = LatLng.lng.toFixed(5);                   \r\n                        //setNewMarkerState({visible: true, position: coord})                        \r\n                        dispatch(actNewMarkerState({visible: true, position: coord}))\r\n                    }\r\n                }\r\n                //setMapCurrentLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n\r\n\r\n            },\r\n            \r\n            click(e) {\r\n                onClickMap(e)\r\n                /*\r\n                if (rxCheckButtonNewMarker && !rxIsMobileDevice) {\r\n                    //setCheckButtonNewMarker(false)\r\n                    dispatch(actCheckButtonNewMarker(false));\r\n        \r\n                    let coord = { lat: '0', lng: '0' };\r\n                    coord.lat = e.latlng.lat.toFixed(5);\r\n                    coord.lng = e.latlng.lng.toFixed(5);\r\n        \r\n                    //setNewMarkerState({ visible: true, position: coord })\r\n                    dispatch(actNewMarkerState({ visible: true, position: coord }));\r\n        \r\n                    //setShowAccidentTab(true)\r\n                    dispatch(actShowAccidentTab(true));\r\n                    //setActiveTabKey(\"accident\")\r\n                    dispatch(actActiveTabKey('accident'));\r\n                } \r\n                */               \r\n            }, \r\n\r\n            zoomend(e){                                \r\n                if (onZoomEnd) onZoomEnd(e);\r\n\r\n                setCurrentZoom(e.target._zoom)                 \r\n                //dispatch(actCurrentMapZoom(e.target._zoom));               \r\n            },\r\n\r\n            locationfound(e){\r\n                let radius = e.accuracy / 2;\r\n\r\n                if (setView_nTimes_gps > 0) {\r\n                    map.setView(e.latlng, 20);\r\n                    setView_nTimes_gps = setView_nTimes_gps - 1;\r\n                }\r\n    \r\n                if (map.hasLayer(circle_geolocation)) {\r\n                    circle_geolocation.setLatLng(e.latlng);\r\n                    circle_geolocation.setRadius(radius);\r\n                } else {\r\n                    circle_geolocation = L.circle(e.latlng, radius).addTo(map);\r\n                }                \r\n            },\r\n\r\n            locationerror(e){\r\n                //setCheckButtonGPS(false)\r\n                dispatch(actCheckButtonGPS(false))\r\n                alert(e.message)\r\n            }\r\n        })\r\n      \r\n        return null\r\n      }\r\n\r\n\r\n\r\n    function MarkersZoomAdjustment(){\r\n        const map = useMap(); \r\n        const zoom = map.getZoom();\r\n                 \r\n        if (onEachLayer) {\r\n            map.eachLayer(function (layer) {\r\n                onEachLayer(layer, zoom);           \r\n            });\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n\r\n\r\n      function HeatmapFunction(){\r\n        const map = useMap();\r\n        //useEffect(() => {\r\n          //const points = addressPoints\r\n          //? addressPoints.map((p) => {\r\n          //  return [p[0], p[1], p[2]]; // lat lng intensity\r\n          //  })\r\n          //: [];\r\n     \r\n            const points = [\r\n                [43.207650, 27.958490, 1.0]\r\n            ]\r\n\r\n\r\n\r\n            if (heatMapLayer) { \r\n                map.removeLayer(heatMapLayer)\r\n            }\r\n\r\n            if (rxCheckButtonHeatmap) {                \r\n                if (dataHeatmapPoints) {\r\n                    // @ts-ignore\r\n                    heatMapLayer = L.heatLayer(dataHeatmapPoints, {\r\n                        gradient: {0.4: '#1E90FF', 0.8: 'white', 1: 'red'},                        \r\n                        //minOpacity: 0.1,\r\n                        max: 1.5,\r\n                        radius: 14,\r\n                        blur: 10,\r\n                        maxZoom: 6\r\n\r\n                    })//.addTo(map);\r\n                    map.addLayer(heatMapLayer)                \r\n                }\r\n            }\r\n\r\n\r\n            //heatMap.addLatLng([43.207650, 27.998590])\r\n            //heatMap.setLatLngs([])\r\n\r\n            //L.heatLayer(points).redraw()\r\n            //L.heatLayer(points).addLatLng([43.207650, 27.998590])\r\n\r\n        //}, [dataHeatmapPoints]);\r\n\r\n        return null\r\n     }\r\n\r\n\r\n\r\n\r\n\r\n    const createClusterCustomIcon  = function (cluster: L.MarkerCluster) {\r\n        // get the number of items in the cluster\r\n        let count = cluster.getChildCount();\r\n\r\n        // figure out how many digits long the number is\r\n        //var digits = (count + '').length;\r\n        let digits;\r\n        if (count == 2) { digits = '1'; }\r\n        if (count >= 3 && count <=5) { digits = '2'; }\r\n        if (count >= 6 && count <=9) { digits = '3'; }\r\n        if (count >= 10 && count <=14) { digits = '4'; }\r\n        if (count > 14) { digits = '5'; }\r\n\r\n        return L.divIcon({\r\n          html: count.toString(),\r\n          className: 'cluster digits-' + digits,\r\n          iconSize: undefined\r\n        });\r\n      }\r\n\r\n\r\n\r\n\r\n    return (\r\n        <>        \r\n        {/* The map rendered before useEffect called, so first we need to load currentCityInfo before to show the map */}\r\n        { currentCityInfo && currentCityInfo[\"longitude\"] !== \"0\" && currentCityInfo[\"latitude\"]!==\"0\" ? ( \r\n\r\n            <MapContainer whenCreated={setMap} center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} zoom={currentCityInfo.zoom} zoomControl={false} scrollWheelZoom={true} style={{ height: 'calc(100vh - 60px)', width: '100%' }} >                \r\n                <LayersControl position=\"topleft\">                    \r\n                    <MapTileLayers mapBaseLayerName={rxMapBaseLayerName} />                 \r\n                </LayersControl>    \r\n\r\n            \r\n                {/* To change center of the map when current city will change */}\r\n                {/*<SetViewMap center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} />*/} \r\n                <SetPanToMap />\r\n\r\n\r\n\r\n                {appname === 'roadaccident' && <> \r\n                    {currentZoom && currentZoom < 15 ? (\r\n                        <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>  \r\n                    ) : (\r\n                        /* @ts-ignore */\r\n                        <MarkerClusterGroup\r\n                        spiderfyOnMaxZoom={true}\r\n                        showCoverageOnHover={false}\r\n                        zoomToBoundsOnClick={true}\r\n                        maxClusterRadius={15}\r\n                        iconCreateFunction={createClusterCustomIcon}>                \r\n                            <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>                \r\n                        </MarkerClusterGroup>\r\n                    )}\r\n                </>}\r\n\r\n\r\n                {appname === 'citytree' && <>                     \r\n                    <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>  \r\n                </>}\r\n\r\n\r\n\r\n\r\n\r\n                <NewMarker newMarkerState={rxNewMarkerState} onDragEndNewMarker={onDragEndNewMarker}/>\r\n                \r\n                <MapEvents />\r\n                \r\n                {!rxIsMobileDevice && <ZoomControl position='bottomright'/>}\r\n                \r\n   \r\n                {/* <ButtonsControl /> */}\r\n\r\n                <HeatmapFunction />\r\n                \r\n                {onEachLayer && <MarkersZoomAdjustment />}\r\n                \r\n            </MapContainer>\r\n        ) : (\r\n            <p>Loading...</p>\r\n        )}    \r\n            \r\n        </>\r\n        \r\n    )\r\n}\r\n\r\nexport default Map\r\n\r\n\r\n//https://egghead.io/lessons/react-create-a-new-map-using-react-leaflet\r\n\r\n//https://codesandbox.io/s/63wqz?file=/src/LeafletControlGeocoder.jsx\r\n//https://www.npmjs.com/package/leaflet-control-geocoder\r\n\r\n//https://codesandbox.io/s/how-to-add-a-legend-to-the-map-using-react-leaflet-useleaflet-hook-75jnp?file=/src/index.js\r\n\r\n//https://newbedev.com/home-button-leaflet-map\r\n\r\n//пример без React-Leaflet\r\n//https://stackoverflow.com/questions/69697017/use-leaflet-map-object-outside-useeffect-in-react","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACJ0lEQVR4Ae3ShY6bQRADYIeZ3v+9yszMDZPlkSWtslPuiS6+C+8n/zNp4p/froi8Jq/Jxk+TkwmHX//Wz8lG3jNjTeaguabD6HAVbphMwIIzqtd+rzKYhsgUNNcqo3fEBlyyOWmwhbbS4b8SaLBu7SGlpL9gklw3YpYR6J5Bm0zAguspZjvqSVQxqvxsPSJJKYIFKh5A2VIDyMgYfYB9hvcmI0VPTxVZS81ER7qiBoFqBAa9MKOKLzzv2BE3EOnlmDTrNRXryToGOGR65nhvSphjMP6b6WJ6xMYYxSW7l1Pp6CSzbLFPgAN3NGLKPRn3c59qxzapCTPUFNVKh0vUe24azMkW+uRm/B8UU3O3Eiw4nOrrafOSF5gS7PqHUotBQQ6f11p22HDOi+66i2LIHcWJOZrTP+rkhOl7n8YcTzCQIuIvyZPQrvs5Br0OdTsyB+YYrwKokXvsgOIXZzbeQ0DMnhHIqGOdBMEl9qKYAo3pBbbDNkijUSgjv/PrMFhwRwS2YbbMzqg+SzdukoxbeiSEVlgyK6yFmjSYtDxhTXRv1OsgsCb2jflu8hLMyC0P7Qg54NE1qc/MF5PqeAHWSfDL3zxN9dsQ+YD3zEeRS4GeYgFm5I7HNiJPfP4V7/CKeUvwsxpqhkwFzMgjj33Vwe+EnuIxngn8FvNTSCkwmJG+rQm8J/MId/EQL3nZwe2EmSNm9ufkFq9xHzcJPscnLGMRomBKqdzOY2EH+IPOLMEAAAAASUVORK5CYII=\"","import { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\ninterface MainWrapperProps {\r\n    children: JSX.Element;\r\n    cityName: string | undefined;\r\n}\r\n\r\nconst MainWrapper = ({children, cityName}: MainWrapperProps) => {\r\n    const rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\r\n\r\n    return (\r\n        <div className=\"main-wrapper\">            \r\n            {cityName ? (                \r\n                <div id=\"app\">\r\n                    <div className={`d-flex ${rxShowSidebar ? \"showed\" : \"hided\"}`} id=\"wrapper\">\r\n                        {children}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                    \"You must select a city.\"\r\n            )}     \t\t                           \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MainWrapper","interface SidebarProps {\r\n\tchildren: JSX.Element\t\r\n}\r\n\r\nconst Sidebar = ({children}: SidebarProps) => {\r\n\treturn (\r\n\t\t<div className=\"bg-light border-right\" id=\"sidebar-wrapper\">\r\n\t\t\t<div className=\"list-group list-group-flush\" style={{ marginTop: \"15px\" }}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Sidebar\r\n","import Button from \"react-bootstrap/Button\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport {\r\n\tactNewMarkerState,\r\n\tactShowSidebar,\r\n\tactCheckButtonNewMarker,\r\n\tactShowOkCancelMobileMarker,\r\n\tactShowTreeTab,\r\n\tactActiveTabKey,\r\n} from \"../actions\";\r\n\r\n\r\nconst ButtonOkCancelMobileMarker = () => {\r\n\r\n    const dispatch = useDispatch();\r\n    const { t } = useTranslation();\r\n\r\n\r\n    return (\r\n    <>\r\n        <Button\r\n            variant=\"success\"\r\n            id=\"doneEditMarkerMobile\"\r\n            onClick={() => {\r\n                dispatch(\r\n                    actCheckButtonNewMarker(\r\n                        false\r\n                    )\r\n                );\r\n                dispatch(\r\n                    actShowOkCancelMobileMarker(\r\n                        false\r\n                    )\r\n                );\r\n                dispatch(\r\n                    actShowTreeTab(true)\r\n                );\r\n                dispatch(\r\n                    actActiveTabKey(\"tree\")\r\n                );\r\n                dispatch(actShowSidebar(true));\r\n            }}\r\n        >\r\n            {t<string>(\"words.done\")}\r\n        </Button>{\" \"}\r\n        \r\n        <Button\r\n            variant=\"secondary\"\r\n            id=\"cancelMarkerMobile\"\r\n            onClick={() => {\r\n                dispatch(\r\n                    actNewMarkerState({\r\n                        visible: false,\r\n                        position: {\r\n                            lat: 0,\r\n                            lng: 0,\r\n                        },\r\n                    })\r\n                );\r\n                dispatch(\r\n                    actShowOkCancelMobileMarker(\r\n                        false\r\n                    )\r\n                );\r\n                dispatch(\r\n                    actCheckButtonNewMarker(\r\n                        false\r\n                    )\r\n                );\r\n            }}\r\n        >\r\n            &#x2715;\r\n        </Button>{\" \"}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ButtonOkCancelMobileMarker","import { useState, useEffect } from 'react'\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { Form, Button, Card, Row, Col, } from 'react-bootstrap';\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\ninterface FormFilterProps {\r\n\tonSubmitFilter: (filter: {}) => void;\r\n}\r\n\r\n\r\nconst FormFilter = ({onSubmitFilter}: FormFilterProps) => {\r\n    const rxDictSpecieses = useSelector((state: RootState) => state.dataReducer.dictSpecieses);\r\n    const rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);\r\n\tconst rxDictPlaceTypes = useSelector((state: RootState) => state.dataReducer.dictPlaceTypes);\r\n\tconst rxDictIrrigationMethods = useSelector((state: RootState) => state.dataReducer.dictIrrigationMethods);\r\n\tconst rxDictGroupSpecs = useSelector((state: RootState) => state.dataReducer.dictGroupSpec);\r\n\r\n\tconst rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\r\n\t//const rxDictTypeSpecs = useSelector((state: RootState) => state.dataReducer.dictTypeSpec);\r\n\t\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\r\n\r\n\tconst { control, register, handleSubmit, reset, setValue } = useForm({\r\n\t\treValidateMode: \"onChange\",\r\n\t\tdefaultValues: {\r\n\t\t\tspeciesFilter: \"\",\r\n\t\t\tstatusFilter: \"\",\r\n\t\t\tcareTypeFilter: \"\",\r\n\t\t\tremarkFilter: \"\",\r\n\t\t\tplaceTypeFilter: \"\",\r\n\t\t\tirrigationMethodFilter: \"\",\r\n\t\t\tdatePlantedFromFilter: \"\",\r\n\t\t\tdatePlantedToFilter: \"\",\r\n\t\t\tdateAddedFromFilter: \"\",\r\n\t\t\tdateAddedToFilter: \"\",\r\n\t\t\tcommentFilter: \"\",\r\n\t\t\theightFromFilter: \"\",\r\n\t\t\ttrunkGirthFromFilter: \"\",\r\n\t\t\tcrownDiameterFromFilter: \"\",\r\n\t\t\theightToFilter: \"\",\r\n\t\t\ttrunkGirthToFilter: \"\",\r\n\t\t\tcrownDiameterToFilter: \"\",\t\t\t\r\n\t\t\tshowMyTreesFilter: \"\",\r\n\r\n\t\t\t//select: {},\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\t\r\n\t//let optionsSpeciesesFilter: {label: string; options: {value: number; label: string}[] | undefined}[] = [];\r\n\tlet optionsSpeciesesFilter: any = [];\r\n\tif (Array.isArray(rxDictSpecieses) && Array.isArray(rxDictGroupSpecs)) {\r\n\r\n\t\toptionsSpeciesesFilter = rxDictGroupSpecs.map(itemGroup => {\r\n\t\t\treturn {\r\n\t\t\t\tlabel: itemGroup.groupname,\r\n\t\t\t\toptions: rxDictSpecieses.map(spec => {\r\n\t\t\t\t\tif (itemGroup.id === spec.groupspec) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\tlabel: spec.localname,\r\n\t\t\t\t\t\t\tspeciesname: spec.speciesname,\r\n\t\t\t\t\t\t\ttypespec: spec.typespec\r\n\t\t\t\t\t\t\t//color: '#FF8B00'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).filter(e => e) // removes all undefined items in result array\t\t\t \r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tlet optionsStatusesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictStatuses)) {\r\n\t\toptionsStatusesFilter = rxDictStatuses.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.statusname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\t\r\n\tlet optionsCareTypesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictCareTypes)) {\r\n\t\toptionsCareTypesFilter = rxDictCareTypes.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.carename,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\r\n\tlet optionsRemarksFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictRemarks)) {\r\n\t\toptionsRemarksFilter = rxDictRemarks.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.remarkname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\t\r\n\tlet optionsPlaceTypesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictPlaceTypes)) {\r\n\t\toptionsPlaceTypesFilter = rxDictPlaceTypes.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.placename,\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\r\n\tlet optionsIrrigationMethodsFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictIrrigationMethods)) {\r\n\t\toptionsIrrigationMethodsFilter = rxDictIrrigationMethods.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.irrigationname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\r\n\r\n\t  const customStyles = {\r\n\t\t//@ts-ignore\r\n\t\toption: (styles, { data }) => {\r\n\t\t\t//const color = chroma(data.color);\r\n\t\t\treturn {\r\n\t\t\t  ...styles,\r\n\t\t\t  paddingLeft: 20,\r\n\t\t\t  backgroundColor: data.typespec === 2 ? '#EEFFEE' : undefined,\r\n\r\n\t\t\t};\r\n\t\t  },\r\n\t  } \r\n\r\n\r\n\r\n\t  const Option = (props: any) => {\r\n\t\tconst { label, speciesname } = props.data;\r\n\t\treturn (\r\n\t\t  <components.Option {...props}>\r\n\t\t\t<span>{label}</span> <span style={{ color: \"darkgray\" }}>{speciesname}</span>\r\n\t\t  </components.Option>\r\n\t\t);\r\n\t  };\t  \r\n\r\n\r\n\r\n\tfunction onResetButton() {\r\n\t\treset();\r\n\t\tonSubmitFilter({});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form className=\"m-1\" onSubmit={handleSubmit(onSubmitFilter)}>\r\n\t\t\t\t<Form.Group controlId=\"formSpeciesFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.species\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"speciesFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={true}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsSpeciesesFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tgetOptionLabel={(option) =>`${option.label} - ${option.speciesname}`}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formStatusFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.status\")}\r\n\t\t\t\t\t</Form.Label>\r\n\r\n\t\t\t\t\t{/*{!rxIsMobileDevice ? ( */}\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"statusFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\toptions={optionsStatusesFilter}\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t\t\t\tmaxMenuHeight={400}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/*):(\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<select {...register(\"statusFilter\")} \t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tstyle={{width: '100%', minHeight: '38px', borderRadius: '4px', borderColor: 'rgb(204, 204, 204)', backgroundColor: 'rgb(255, 255, 255)'}}\r\n\t\t\t\t\t\t\tmultiple={true}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option disabled selected>{t<string>(\"words.select\")}</option>\r\n\t\t\t\t\t\t\t{optionsStatusesFilter.map((item) => <option key={item.value} value={item.value}>{item.label}</option>)}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}*/}\t\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formCareTypeFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.careType\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"careTypeFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsCareTypesFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formRemarkFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.remark\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"remarkFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsRemarksFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formPlaceTypeFilter\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"230px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.placeType\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"placeTypeFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\toptions={optionsPlaceTypesFilter}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formIrrigationMethodFilter\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"230px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.irrigationMethod\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"irrigationMethodFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\r\n\t\t\t\t\t\t\t\t\t\t\"words.select\"\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\toptions={optionsIrrigationMethodsFilter}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDatePlantedFromFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.plantedFrom\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"datePlantedFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDatePlantedToFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.plantedTo\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"datePlantedToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDateAddedFromFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.dateAddedFrom\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateAddedFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDateAddedToFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.dateAddedTo\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateAddedToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group className=\"mt-3\" controlId=\"formCommentFilter\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.comment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"commentFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control type=\"text\" {...field} />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formFromParamsTreeFilter\" style={{maxWidth: \"50px\"}}>\r\n\t\t\t\t\t\t<Form.Label style={{ marginTop: \"32px\"}}>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.from\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formHeightFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.height\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"heightFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formTrunkGirthFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.trunkGirth\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkGirthFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formCrownDiameterFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.crownDiameter\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crownDiameterFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-0\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formToParamsTreeFilter\" style={{maxWidth: \"50px\"}}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.to\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formHeightToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"heightToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formTrunkGirthToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkGirthToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formCrownDiameterToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crownDiameterToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formShowMyTreesFilter\"\r\n\t\t\t\t\tclassName=\"mt-3 ms-1\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"showMyTreesFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tchecked={field[\"value\"] ?? false}\r\n\t\t\t\t\t\t\t\tinline\r\n\t\t\t\t\t\t\t\tlabel={t<string>(\r\n\t\t\t\t\t\t\t\t\t\"sidebar.filterTab.showMyTrees\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tid=\"idShowMyTreesFilter\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\t\t\t\t\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button variant=\"light\" onClick={onResetButton}>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.clear\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"150px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.search\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default FormFilter\r\n\r\n\r\n\r\n","import Table from \"react-bootstrap/Table\";\r\nimport {useState, useEffect} from 'react';\r\n\r\n\r\ninterface TableListProps {\r\n\t// columns in the table\r\n\tcolumns: {\r\n\t\tfield: string;\r\n\t\theaderName: string;\r\n\t\twidth?: string;\r\n\t\tsortable?: boolean;\r\n\t\tdateTimeOption?: 'onlyDate' | 'onlyTime' | 'dateTime'; // for Date fields you can choose format\r\n\t}[];\r\n\r\n\tsortField?: string;\r\n\tsortAsc?: boolean;\r\n\r\n\tdata: {\r\n\t\tid: number;\r\n\t\t[key: string]: any | {iconFA?: string; iconFASize?: string; text?: string; idButton: string}[]; // array of buttons, where key is field name of a column\r\n\t}[] | undefined;\r\n\r\n\tsize?: string; // sm\r\n\tvariant?: string; // dark\r\n\r\n  \tOnClickButtons?: (rowData: any, idButton: string) => void;\r\n}\r\n\r\n\r\n\r\nfunction TableList({columns, data, sortField, sortAsc=true, size, variant, OnClickButtons}: TableListProps) {\r\n\r\n\tconst [sortState, setSortState] = useState({sortField: sortField, sortAsc: sortAsc});\r\n\tconst [dataTable, setDataTable] = useState(data);\r\n\t\r\n\tuseEffect(()=>{\r\n\t\tsetDataTable(data);\r\n\t}, [data]);\r\n\r\n\r\n\tconst columnsHeader = columns.map((item, index) => ( \r\n\t\t<th \r\n\t\t\tstyle={{ width: item.width ? item.width: \"\", cursor: item.sortable ? \"pointer\" : \"default\" }} \r\n\t\t\tkey={index} \r\n\t\t\tonClick={() => {\r\n\t\t\t\tif (item.sortable) {\r\n\t\t\t\t\tsetSortState({sortField: item.field, sortAsc: sortState.sortField === item.field ? !sortState.sortAsc : true}); // inverse sortAsc, only when sortField has not changed, otherwise sortAsc=true \r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t\r\n\t\t\t{ // for current sorted column draws icon\r\n\t\t\tsortState?.sortField === item.field ? \r\n\t\t\t<>\r\n\t\t\t\t<div style={{float: \"left\", textAlign: \"left\"}}>{item.headerName}</div>\r\n\t\t\t\t<div style={{float: \"right\", textAlign: \"right\"}}>\r\n\t\t\t\t\t<span style={{fontSize: \"8pt\", color: \"gray\"}}> {sortState.sortAsc ? '▼' : '▲'}</span>\r\n\t\t\t\t</div>\t\t\t\r\n\t\t\t</>: item.headerName\r\n\t\t\t}\r\n\t\t</th>\r\n\t));\r\n\r\n\r\n\r\n\tfunction DataTable() {\r\n\t\tfunction compare( a:{}, b:{} ) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tif ( a[sortState.sortField] < b[sortState.sortField] ){\r\n\t\t\t\tif (sortState.sortAsc) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 1;\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t//@ts-ignore\r\n\t\t\tif ( a[sortState.sortField] > b[sortState.sortField] ){\r\n\t\t\t\tif (sortState.sortAsc) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn -1;\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\t\r\n\t\t// sorting of data\r\n\t\tlet sortedData:any[] | undefined = [];\r\n\t\tif (sortState.sortField) {\t\t\r\n\t\t\t//setDataTable(dataTable?.sort(compare));\t\t\t\r\n\t\t\tsortedData = dataTable?.sort(compare);\t\t\t\r\n\t\t} else {\r\n\t\t\tsortedData = dataTable;\r\n\t\t}\r\n\r\n\t\t// fill out\r\n\t\tif (sortedData && sortedData.length > 0) {\r\n\t\t\treturn (\r\n\t\t\t\t<>\r\n\t\t\t\t{sortedData.map((row: any, index) => {\t\t\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<tr key={row.id}>\r\n\t\t\t\t\t\t\t<DataRow row={row} indexRow={index}/>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (<tr><td style={{textAlign: \"center\"}} colSpan={columns.length}>no data</td></tr>)\r\n\t}\t\r\n\r\n\r\n\tinterface DataRowProps {\r\n\t\trow: any;\r\n\t\tindexRow: number;\r\n\t}\t\r\n\tfunction DataRow({row, indexRow}: DataRowProps): any {\t\r\n\t\tconst getUniqKey = (row: any, index: number): string => (`${String(row.id)}.${String(index)}`);\r\n\t\t\r\n\t\t\r\n\t\tconst result = columns.map((col, index) => {\r\n\r\n\t\t\t\r\n\t\t\tif (typeof row[col.field] !== \"object\") { //if it's not object, then it's just value of field, else it's button\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tif (col?.dateTimeOption) {\t\t\t\t\r\n\t\t\t\t\tif (col.dateTimeOption === \"onlyDate\") {\r\n\t\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{new Date(row[col.field]).toLocaleDateString()}</td>)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (col.dateTimeOption === \"onlyTime\") {\r\n\t\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{new Date(row[col.field]).toLocaleTimeString()}</td>)\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\r\n\t\t\t\t\tif (col.dateTimeOption === \"dateTime\") {\r\n\t\t\t\t\t\tlet dateTime = new Date(row[col.field]).toLocaleDateString() + ' ' + new Date(row[col.field]).toLocaleTimeString();\r\n\t\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{dateTime}</td>)\r\n\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{row[col.field]}</td>)\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (col.field===\"#\") {\r\n\t\t\t\t\treturn (<td key={getUniqKey(row, index)}>{indexRow+1}</td>)\t\r\n\t\t\t\t}\r\n\t\t\t\treturn (<td key={getUniqKey(row, index)}>{row[col.field]}</td>)\r\n\t\t\t}\t\r\n\t\t\t\r\n\t\t\t// buttons\r\n\t\t\tconst buttons = row[col.field];\r\n\t\t\t\r\n\t\t\tif (Array.isArray(buttons)) {\r\n\t\t\t\tlet buttonRow:any[] = [];\r\n\t\t\t\tbuttons.forEach(button => {\r\n\t\t\t\t\tif ((button?.text || button?.iconFA)  && button?.idButton) {\r\n\t\t\t\t\t\tlet buttonText = [];\r\n\t\r\n\t\t\t\t\t\tif (button?.iconFA) {\r\n\t\t\t\t\t\t\tif (button?.iconFASize) {\r\n\t\t\t\t\t\t\t\tbuttonText.push(<i key={getUniqKey(row, index)+button.idButton} className={button.iconFA} style={{fontSize: button.iconFASize}}></i>);\t\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tbuttonText.push(<i key={getUniqKey(row, index)+button.idButton} className={button.iconFA}></i>);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif (button?.text) {\r\n\t\t\t\t\t\t\tbuttonText.push(<span key={getUniqKey(row, index)+button.idButton}>{button.text}</span>);\t\r\n\t\t\t\t\t\t}\t\t\t\t\r\n\t\r\n\t\t\t\t\t\tif (OnClickButtons) {\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tbuttonRow.push(<span key={getUniqKey(row, index)+button.idButton}><a href='#' onClick={()=>OnClickButtons(row, button.idButton)}>{buttonText}</a> </span>);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbuttonRow.push(<span key={getUniqKey(row, index)+button.idButton}>{buttonText}</span>);\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn (<td key={getUniqKey(row, index)}>{buttonRow}</td>);\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n  \treturn (\r\n\t\t<Table striped bordered hover size={size} variant={variant}>\r\n\t\t\t<thead>\r\n\t\t\t\t<tr>\t\t\t\t\r\n\t\t\t\t\t{columnsHeader}\t\t\t\r\n\t\t\t\t</tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody>\r\n\t\t\t\t<DataTable/>\r\n\t\t\t</tbody>\r\n\t\t</Table>\r\n  \t)\r\n}\r\n\r\nexport default TableList","import {useState, useEffect, forwardRef, useRef, useImperativeHandle} from 'react';\r\nimport { Form, Button, Spinner , Row, Col, Modal } from \"react-bootstrap\";\r\nimport Image from 'react-bootstrap/Image';\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport deleteImage from \"./delete2.svg\";\r\n\r\ninterface ImageS3UploadProps {\r\n    signingUrl: string;\r\n    autoUpload: boolean;\r\n    //startUploadState?: boolean;\r\n    value: string | undefined;\r\n    onChange: (val: string) => void;    \r\n    emptyPhoto?: string; \r\n    serverPhoto?: string | undefined | null; \r\n    buttonCaption?: string;\r\n\r\n    resizer?: {\r\n        enabled: boolean;\r\n        autoResize: boolean;\r\n        maxWidth: number;\r\n        maxHeight: number;\r\n        compressFormat: string;\r\n        quality: number;\r\n        rotation: number;\r\n    };\r\n\r\n    onFinish?: () => void;\r\n    onProgress?: (percent: number) => void;\r\n    onError?: (status: number, filename: string) => void;\r\n    onSignedUrl?: (data: any)  => void;\r\n}\r\n\r\ninterface RefObject {\r\n    uploadFile: () => boolean\r\n}\r\n\r\n\r\nenum stateComponent {\r\n    none,\r\n    resizing,\r\n    resized,\r\n    uploading,\r\n    uploaded,\r\n    error\r\n}\r\n\r\nconst defaultResizingOptions = {\r\n    enabled: false,\r\n    autoResize: true, // otherwise resizing will be preform before uploading\r\n    maxWidth: 1280,\r\n    maxHeight: 1280,\r\n    compressFormat: \"JPEG\",\r\n    quality: 70,\r\n    rotation: 0\r\n}\r\n\r\nconst ImageS3Upload = forwardRef<RefObject | undefined, ImageS3UploadProps>(({\r\n    signingUrl,\r\n    autoUpload,\r\n    //startUploadState,\r\n    emptyPhoto,\r\n    serverPhoto,\r\n    value,\r\n    onChange,\r\n    buttonCaption = 'Browse...',\r\n    resizer = defaultResizingOptions,\r\n    onFinish,\r\n    onProgress,\r\n    onError,\r\n    onSignedUrl\r\n}, ref) => {\r\n\r\n\r\n    // to be able to call method uploadFile\r\n    useImperativeHandle(ref, () => ({\r\n        uploadFile: () => {\r\n            //@ts-ignore\r\n            if (inputFileEl?.current?.files && inputFileEl.current.files.length===1) {                \r\n                if (status !== stateComponent.resizing) {\r\n                    //@ts-ignore\r\n                    startUpload(inputFileEl?.current?.files[0].name);\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            return false;             \r\n        }\r\n    }));\r\n\r\n\r\n    const inputFileEl = useRef(null);\r\n    \r\n    const [status, setStatus] = useState<stateComponent>(stateComponent.none);\r\n    const [imagePhoto, setImagePhoto] = useState<string | undefined>(undefined);\r\n    const [compressedPhoto, setCompressedPhoto] = useState<any>(undefined);\r\n    const [buttonCaptionState, setButtonCaptionState] = useState(buttonCaption);\r\n    //const [stateUploading, setStateUploading] = useState(false);\r\n    const [showSpinner, setShowSpinner] = useState<boolean>(false);    \r\n    const [s3DataState, setS3DataState] = useState<any>(undefined);\r\n    const [notLoad, setNotLoad] = useState(false); // to prevent loading photo from S3 when we have this photo in blob input element\r\n   \r\n\r\n    useEffect(()=>{\r\n        if (emptyPhoto) {\r\n            setImagePhoto(emptyPhoto);    \r\n        }  \r\n    }, []);\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n        console.log('s3DataState', s3DataState); \r\n        if (s3DataState?.data?.fields?.key) {\r\n            setNotLoad(true);\r\n            onChange(s3DataState.data.fields.key);\r\n        } \r\n    }, [s3DataState]);  \r\n\r\n    useEffect(()=>{                \r\n        \r\n        if (value) {\r\n            \r\n            if (serverPhoto == null) {\r\n                serverPhoto = '';    \r\n            }\r\n\r\n            if (serverPhoto.slice(-1) != '/' && value.slice(0, 1) != '/') { // if there is no symbol / between serverPhoto and value, just add it.\r\n                serverPhoto = serverPhoto + '/';\r\n            }\r\n\r\n            if (!notLoad) { // to prevent loading photo from S3 when we have this photo in blob input element\r\n                setButtonCaptionState(buttonCaption);\r\n                setShowSpinner(false);\r\n                if (inputFileEl?.current) {\r\n                    //@ts-ignore\r\n                    inputFileEl.current.value='';\r\n                }\r\n                                \r\n                setImagePhoto(`${serverPhoto}${value}`);\r\n                //console.log('serverPhotoValue', `${serverPhoto}${value}`); \r\n            }\r\n                    \r\n          \r\n        } else {\r\n            setImagePhoto(emptyPhoto);\r\n            setButtonCaptionState(buttonCaption);\r\n        }\r\n               \r\n        setNotLoad(false);\r\n        \r\n    }, [value]);   \r\n    \r\n    \r\n\r\n\r\n    //useEffect(() => {\r\n        //if (status === stateComponent.resizing) {\r\n        //    setButtonCaptionState(\"Resizing...\");\r\n        //} else {\r\n        //    setButtonCaptionState(buttonCaption);            \r\n        //}   \r\n    //}, [status])\r\n\r\n\r\n        \r\n{/*\r\n    useEffect(()=>{\r\n        if (startUploadState === true && stateUploading === false) {\r\n            setStateUploading(true);\r\n            //@ts-ignore\r\n            if (inputFileEl?.current?.files && inputFileEl.current.files.length===1) {\r\n                //@ts-ignore\r\n                startUpload(inputFileEl?.current?.files[0].name);\r\n            }    \r\n        }\r\n    }, [startUploadState]);\r\n*/}\r\n\r\n\r\n    const resizeFile = (file: any) =>\r\n\t\tnew Promise((resolve) => {\r\n\t\t\tResizer.imageFileResizer(\r\n\t\t\t\tfile,\r\n\t\t\t\tresizer.maxWidth,\r\n\t\t\t\tresizer.maxHeight,\r\n\t\t\t\tresizer.compressFormat,\r\n\t\t\t\tresizer.quality,\r\n\t\t\t\tresizer.rotation,\r\n\t\t\t\t(uri) => {\r\n\t\t\t\t\tresolve(uri);\r\n\t\t\t\t},\r\n\t\t\t\t\"blob\"\r\n\t\t\t);\r\n\t\t});\r\n\r\n\r\n    const onChangeFile = async (event: any) => {\r\n        \r\n        if (event.target.files && event.target.files.length > 0) {\r\n            const file = event.target.files[0];\r\n            //onChange(file.name);\r\n            //setFilename(file.name);\r\n            setImagePhoto(URL.createObjectURL(file)); \r\n            \r\n            if (resizer.enabled && resizer.autoResize) {\r\n                try {                \r\n                    setStatus(stateComponent.resizing);\r\n                    setButtonCaptionState(\"Resizing...\")\r\n                    const image = await resizeFile(file);\r\n\r\n                    if (image instanceof Blob) {\r\n                        setCompressedPhoto(image);\r\n                        setStatus(stateComponent.resized);\r\n                        setButtonCaptionState(\"Resized \");\r\n    \r\n                        if (autoUpload) {\r\n                            startUpload(file.name);     \r\n                        }\r\n                        //console.log('image.size', humanFileSize(image.size));\r\n                    } else {\r\n                        setButtonCaptionState(\"Error\");    \r\n                    } \r\n                    \r\n\r\n\r\n                } catch (err) {\r\n                    console.log(err);\r\n                    setStatus(stateComponent.error);\r\n                    setButtonCaptionState(\"Error\")\r\n                }\r\n            } else {\r\n                if (autoUpload) {\r\n                    startUpload(file.name);     \r\n                }                \r\n            }            \r\n\r\n        }                \r\n    };\r\n\r\n\r\n\r\n\r\n\tconst fetchUrlSign = async (objectName: string) => {\t\t\t\r\n\r\n\t\tlet myHeaders = new Headers();\r\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");  \r\n\r\n        const bodyObject = {objectName: objectName};\r\n        \r\n        let res = await fetch(signingUrl, {\r\n            method: 'POST',\r\n            headers: myHeaders,\r\n            body: JSON.stringify(bodyObject)\r\n        });\r\n\r\n\t\tconst json = await res.json();\r\n\r\n        return JSON.parse(json);\t\t\t\t\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n    const updateProgress = (ev: any) => {\r\n        if (ev.lengthComputable) {\r\n            let percentComplete = Math.round((ev.loaded / ev.total) * 100);\r\n            setButtonCaptionState(String(percentComplete)+'%');\r\n            if (onProgress) {\r\n                onProgress(percentComplete);\r\n            }\r\n            console.log('percentComplete', percentComplete);\r\n            //$('#'+idElement+'_browse_button').html(percentComplete+'%');\r\n        }\r\n    } \r\n\r\n    const uploadFile = (file: any, s3Data: any) => {\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", s3Data.url);\r\n        xhr.timeout = 30000;\r\n        xhr.upload.onprogress = updateProgress;\r\n\r\n        let postData = new FormData();\r\n\t\tfor (let key in s3Data.fields) {\t\t\t\r\n            if (key != 'file') { // in field \"file\" must be blob of file.\r\n                postData.append(key, s3Data.fields[key]);\r\n                //console.log('append', key, s3Data.fields[key]);\r\n            }                    \r\n\t\t}\r\n\t\tpostData.append(\"file\", file); // blob\r\n\r\n\t\txhr.onreadystatechange = () => {\r\n\t\t\tif (xhr.readyState === 4) {\r\n\t\t\t\t// done\r\n\t\t\t\tif (xhr.status === 200 || xhr.status === 204) {\r\n                    setShowSpinner(false);\r\n                    setButtonCaptionState('Done');\r\n                    if (onFinish) {\r\n                        onFinish();\r\n                    }\r\n\r\n                    \r\n\t\t\t\t\t//ok || 204 No Content\r\n                } else {\r\n\t\t\t\t\t//SetStateSaveButton('saveButton', true, 'Запази');\r\n\t\t\t\t\t//SetStateSaveButton('saveInspButton', true, 'Запази');\r\n\t\t\t\t\t//$('#'+idElement+'_loading').hide();\r\n\t\t\t\t\t//$('#'+idElement+'_browse_button').html('Browse...');\r\n\t\t\t\t\t\r\n                    if (onError) {\r\n                        setShowSpinner(false);\r\n                        setButtonCaptionState(`Error ${xhr.status}`);\r\n                        onError(xhr.status, file.name);\r\n                    }                    \r\n                    \r\n                    alert(\r\n\t\t\t\t\t\t\"Error during file upload (status: \" +\r\n\t\t\t\t\t\t\txhr.status +\r\n\t\t\t\t\t\t\t\"): \" +\r\n\t\t\t\t\t\t\tfile.name\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}  \r\n\t\t};\r\n\r\n\r\n\t\txhr.onload = () => {\r\n\t\t\t// transaction completes successfully.\r\n\t\t\tconsole.log(\"transaction completes successfully.\");\r\n            //if (s3DataState?.data?.fields?.key) {\r\n            //    onChange(s3DataState.data.fields.key);\r\n            //}             \r\n\t\t};  \r\n\r\n\r\n        xhr.onerror = () => {\r\n            //SetStateSaveButton('saveButton', true, 'Запази');\r\n            //SetStateSaveButton('saveInspButton', true, 'Запази');\r\n            //$('#'+idElement+'_loading').hide();\r\n            //$('#'+idElement+'_browse_button').html('Browse...');\r\n            alert('Error during file upload: ' + file.name);\r\n        };  \r\n          \r\n        \r\n        console.log('postData', postData);\r\n        xhr.send(postData);  \r\n\r\n    \r\n    //    {\"data\": {\"url\": \"https://urbangis.s3.amazonaws.com/\", \"fields\": {\"acl\": \"public-read\", \"Content-Type\": \"image/jpeg\", \"key\": \"media/citytree/images_tree/user_None/None\", \"x-amz-algorithm\": \"AWS4-HMAC-SHA256\", \"x-amz-credential\": \"***REMOVED***/20220524/eu-central-1/s3/aws4_request\", \"x-amz-date\": \"20220524T105522Z\", \"policy\": \"eyJleHBpcmF0aW9uIjogIjIwMjItMDUtMjRUMTE6NTU6MjJaIiwgImNvbmRpdGlvbnMiOiBbeyJhY2wiOiAicHVibGljLXJlYWQifSwgeyJDb250ZW50LVR5cGUiOiAiaW1hZ2UvanBlZyJ9LCB7ImJ1Y2tldCI6ICJ1cmJhbmdpcyJ9LCB7ImtleSI6ICJtZWRpYS9jaXR5dHJlZS9pbWFnZXNfdHJlZS91c2VyX05vbmUvTm9uZSJ9LCB7IngtYW16LWFsZ29yaXRobSI6ICJBV1M0LUhNQUMtU0hBMjU2In0sIHsieC1hbXotY3JlZGVudGlhbCI6ICJBS0lBMllTTzdGRTVKQllPWEU1Qy8yMDIyMDUyNC9ldS1jZW50cmFsLTEvczMvYXdzNF9yZXF1ZXN0In0sIHsieC1hbXotZGF0ZSI6ICIyMDIyMDUyNFQxMDU1MjJaIn1dfQ==\", \"x-amz-signature\": \"75a181348c86194678752f6c726582a833408925226259efc0ad6858060d56bb\", \"file\": null}}, \"url\": \"https://urbangis.s3.amazonaws.com/media/citytree/images_tree/user_None/None\", \"file_exists\": false}\r\n    }\r\n\r\n\r\n\r\n\r\n    const startUpload = async (filename: string) => {\r\n        filename = filename.replace(/\\s/g, ''); // remove spaces, because there is some problem with restAPI, which return url filename with %20 instead space, after that when we savind data again, %20 will be convert to %2520 (% = %25)\r\n\r\n        setShowSpinner(true);\r\n        setButtonCaptionState('Starting... ');\r\n        setS3DataState(undefined);\r\n        const signedUrl = await fetchUrlSign(filename);\r\n        setS3DataState(signedUrl);  \r\n        if (onSignedUrl) {\r\n            onSignedUrl(signedUrl);\r\n        }\r\n        \r\n        console.log('signedUrl', signedUrl);\r\n        \r\n\r\n        if (signedUrl.file_exists === false) {\r\n            //@ts-ignore\r\n            if (inputFileEl?.current?.files && inputFileEl.current.files.length===1) {\r\n                //@ts-ignore\r\n                const file = inputFileEl.current.files[0];\r\n\r\n                if (resizer.enabled) {\r\n                   \r\n                    if (resizer.autoResize) { // photo already resized and stored in compressedPhoto\r\n                        if (compressedPhoto) {\r\n                            //@ts-ignore\r\n                            uploadFile(compressedPhoto, signedUrl.data);\r\n                        }\r\n                    } else {\r\n                        try {                \r\n\r\n                            setStatus(stateComponent.resizing);\r\n                            setButtonCaptionState(\"Resizing...\")\r\n                            const image = await resizeFile(file);\r\n                            setStatus(stateComponent.resized);\r\n                            setButtonCaptionState(\"Resized\");\r\n                            //@ts-ignore\r\n                            uploadFile(image, signedUrl.data);                            \r\n                        } catch (err) {\r\n                            console.log(err);\r\n                            setStatus(stateComponent.error);\r\n                            setButtonCaptionState(\"Error\")\r\n                        }                        \r\n                    }\r\n\r\n                    \r\n                } else {\r\n                    //@ts-ignore\r\n                    uploadFile(file, signedUrl.data);\r\n                }                \r\n            }\r\n        } else {\r\n            let rndStr = makeRandomStr(5);\r\n            startUpload(rndStr + '_' + filename);            \r\n        }\r\n    \r\n    }\r\n\r\n\r\n\r\n\r\n    return (\r\n        <div style={{position: \"relative\"}}>\r\n            <Form.Group>\r\n                <Image src={imagePhoto} fluid={true} rounded key={imagePhoto} /> {/* key to prevent showing previous loaded photos */}\r\n                <a href=\"#\">\r\n                    {/*\r\n                    <i className=\"far fa-times-circle fa-lg\" \r\n                        style={{color: \"#BB0000\", position: \"absolute\", top: \"-3px\", right: \"8px\", textShadow: \"0 0 3px white\"}}\r\n                        onClick={() => { \r\n                            //onChange(\"*will_be_deleted*\"); \r\n                            //setFilename(\"*will_be_deleted*\");\r\n                            onChange(\"\"); \r\n                            setImagePhoto(emptyPhoto);\r\n                            if (inputFileEl?.current) {\r\n                                //@ts-ignore\r\n                                inputFileEl.current.value='';\r\n                            }                             \r\n                        }} \r\n                    />\r\n                    */}   \r\n\r\n                    <Image \r\n                        src={deleteImage} \r\n                        style={{width: \"46px\", height: \"46px\", position: \"absolute\", top: \"-9px\", right: \"-8px\"}} \r\n                        onClick={() => { \r\n                            onChange(\"\"); \r\n                            setImagePhoto(emptyPhoto);\r\n                            if (inputFileEl?.current) {\r\n                                //@ts-ignore\r\n                                inputFileEl.current.value='';\r\n                            }                             \r\n                        }}                     \r\n                    />\r\n\r\n                </a>\r\n                \r\n                <Button variant=\"outline-secondary\" style={{width: \"100%\"}} className=\"mt-3\"\r\n                    onClick={()=>{\r\n                        //onChange(\"Helloooo\")\r\n                        setShowSpinner(false);\r\n                        setButtonCaptionState(buttonCaption);\r\n                        //@ts-ignore                        \r\n                        inputFileEl.current.click();\r\n                    }}>\r\n                    {showSpinner && <Spinner\r\n                        as=\"span\"\r\n                        animation=\"border\"\r\n                        size=\"sm\"\r\n                        role=\"status\"\r\n                        aria-hidden=\"true\"\r\n                    />}                \r\n                    {buttonCaptionState}\r\n                </Button>{' '}\r\n                \r\n                \r\n                <input ref={inputFileEl} type=\"file\" accept=\"image/*\" style={{display: \"none\"}} \r\n                    onChange={onChangeFile}\r\n                    /*\r\n                    onChange={(e)=>{\r\n                        if (e.target.files && e.target.files.length > 0) {\r\n                            const file = e.target.files[0];\r\n                            //onChange(file.name);\r\n                            //setFilename(file.name);\r\n                            setImagePhoto(URL.createObjectURL(file)); \r\n                            if (autoUpload) {\r\n                                startUpload(file.name);     \r\n                            }\r\n                        }     \r\n                    }}\r\n                    */\r\n                />\r\n\r\n                \r\n                {/* \r\n                <input ref={inputTextEl} style={{width: \"100%\"}}\r\n                    //value={filename}\r\n                    //onChange={({ target: { value } }) => onChange(value)}\r\n                /> \r\n\r\n\r\n                \r\n\r\n              \r\n\r\n                    \r\n                <img src=\"{% static 'images/no-photo.png' %}\" class=\"img-fluid rounded\" id=\"id_insp_img_photo1\">\r\n                            <a href=\"#\"><i class=\"far fa-times-circle fa-2x iconDeletePhoto\" onclick=\"document.getElementById('id_insp_photo1_new_name').value='*will_be_deleted*'; $('#id_insp_img_photo1').attr('src', '{% static 'images/no-photo.png' %}');\"></i></a>\r\n\r\n                */}\r\n            </Form.Group>        \r\n        </div>\r\n  )\r\n\r\n})\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction makeRandomStr(length: number) {\r\n    let result           = '';\r\n    const characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    const charactersLength = characters.length;\r\n    for ( var i = 0; i < length; i++ ) {\r\n      result += characters.charAt(Math.floor(Math.random() *\r\n charactersLength));\r\n   }\r\n   return result;\r\n}\r\n\r\n\r\n\r\n\r\nfunction humanFileSize(size: number) {\r\n    const i = Math.floor( Math.log(size) / Math.log(1024) );\r\n    const sSize = ( size / Math.pow(1024, i) ).toFixed(2);\r\n    return `${sSize} ${['B', 'kB', 'MB', 'GB', 'TB'][i]}`;\r\n    //return ( size / Math.pow(1024, i) ).toFixed(2) * 1 + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n    \r\n};\r\n\r\nexport default ImageS3Upload","export default __webpack_public_path__ + \"static/media/delete2.5b09b7b5.svg\";","import ImageS3Upload from './ImageS3Upload';\r\n\r\nexport default ImageS3Upload;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkMzMzRGRjBCRDQ0RTExRUI4M0FBOEVDOTExMzA0Q0NEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkMzMzRGRjBDRDQ0RTExRUI4M0FBOEVDOTExMzA0Q0NEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzMzNEZGMDlENDRFMTFFQjgzQUE4RUM5MTEzMDRDQ0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzMzNEZGMEFENDRFMTFFQjgzQUE4RUM5MTEzMDRDQ0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4+BmGWAAAYBklEQVR42uxd2VcUxxce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\"","import { Form, Button, Card, Row, Col, Modal} from 'react-bootstrap';\r\nimport {useState, useEffect, forwardRef, useRef, useImperativeHandle} from 'react'\r\nimport { Controller } from \"react-hook-form\";\r\nimport ImageS3Upload from \"./ImageS3Upload\";\r\nimport noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface UploadPhotosProps {\r\n    controlFromUseForm: any;\r\n    signingS3Url: string;\r\n    serverPhoto?: string | undefined | null;\r\n    onCallbackDone: () => void;\r\n} \r\n\r\ninterface RefObject {\r\n    uploadPhotos: () => void\r\n}\r\n\r\nconst UploadPhotos = forwardRef<RefObject | undefined, UploadPhotosProps>(({\r\n    controlFromUseForm,\r\n    signingS3Url,\r\n    serverPhoto,\r\n    onCallbackDone\r\n}, ref) => {\r\n\r\n\tconst photo1Ref = useRef(); // to be able to call method uploadFile\r\n\tconst photo2Ref = useRef();\r\n\tconst photo3Ref = useRef();   \r\n    \r\n\tconst [uploadedPhoto1, setUploadedPhoto1] = useState(false);\r\n\tconst [uploadedPhoto2, setUploadedPhoto2] = useState(false);\r\n\tconst [uploadedPhoto3, setUploadedPhoto3] = useState(false);   \r\n\r\n\tuseEffect(() => {\r\n\t\tif (uploadedPhoto1 && uploadedPhoto2 && uploadedPhoto3) {\t\t\t\r\n\t\t\tsetUploadedPhoto1(false);\r\n\t\t\tsetUploadedPhoto2(false);\r\n\t\t\tsetUploadedPhoto3(false);\r\n\t\t\t\t\t\t\r\n\t\t\tonCallbackDone();\r\n\t\t}\r\n\t}, [uploadedPhoto1, uploadedPhoto2, uploadedPhoto3]);\r\n\r\n\r\n\r\n    const autoUpload = false;\r\n\r\n    const resizerOptions = {\r\n        enabled: true,\r\n        autoResize: true, // otherwise resizing will be preform before uploading\r\n        maxWidth: 1280,\r\n        maxHeight: 1280,\r\n        compressFormat: \"JPEG\",\r\n        quality: 70,\r\n        rotation: 0            \r\n    }\r\n\r\n\r\n    // to be able to call method uploadFile\r\n    useImperativeHandle(ref, () => ({\r\n        uploadPhotos: () => {\r\n\r\n            let p1 = false;\r\n            let p2 = false;\r\n            let p3 = false;\r\n            //@ts-ignore\r\n            if (photo1Ref?.current?.uploadFile) {\r\n                //@ts-ignore\r\n                p1=photo1Ref.current.uploadFile();\r\n            }\t\r\n    \r\n            //@ts-ignore\r\n            if (photo2Ref?.current?.uploadFile) {\r\n                //@ts-ignore\r\n                p2=photo2Ref.current.uploadFile();\r\n            }\r\n            \r\n            //@ts-ignore\r\n            if (photo3Ref?.current?.uploadFile) {\r\n                //@ts-ignore\r\n                p3=photo3Ref.current.uploadFile();\r\n            }\t\t\r\n    \r\n    \r\n            console.log('p', p1, p2, p3);\r\n            if (!p1 && !p2 && !p3) { // there is no photo to upload, so just submit form\r\n                onCallbackDone();\r\n            } else {\r\n                //e.preventDefault();\r\n                setUploadedPhoto1(!p1);\r\n                setUploadedPhoto2(!p2);\r\n                setUploadedPhoto3(!p3);\r\n                //console.log('cons', {photo1: !p1, photo2: !p2, photo3: !p3, data: data})\r\n                //setPhotosUploaded({photo1: !p1, photo2: !p2, photo3: !p3, data: data});\r\n            }\t            \r\n\r\n        }\r\n    }));\r\n\r\n\r\n\r\n\tconst onFinishPhoto1 = () => {\r\n\t\tconsole.log('onFinishPhoto1');\r\n\t\tsetUploadedPhoto1(true);\r\n\t\t//setPhotosUploaded({...photosUploaded, photo1: true});\t\r\n\t}\r\n\tconst onFinishPhoto2 = () => {\r\n\t\tconsole.log('onFinishPhoto2');\r\n\t\tsetUploadedPhoto2(true);\r\n\t\r\n\t\t//setPhotosUploaded({photo1: photosUploaded.photo1, photo2: true, photo3: photosUploaded.photo3, data: photosUploaded.data});\r\n\t\t//setPhotosUploaded({...photosUploaded, photo2: true});\r\n\t}\r\n\tconst onFinishPhoto3 = () => {\r\n\t\tconsole.log('onFinishPhoto3');\r\n\t\t//setPhotosUploaded({...photosUploaded, photo3: true});\r\n\t\tsetUploadedPhoto3(true);\r\n\t}\r\n\r\n\r\n\r\n\r\n    return (\r\n\r\n\r\n        <Row className=\"mt-3\" xs={3}>\r\n            <Form.Group as={Col} controlId=\"formIdInsp1\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo1\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\r\n                            //startUploadState={photo1StateUpload.start}\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\t\r\n                            onFinish={onFinishPhoto1}\r\n                            resizer={resizerOptions}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                            {...field}\r\n                            ref={photo1Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Col} controlId=\"formIdInsp2\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo2\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\t\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\r\n                            onFinish={onFinishPhoto2}\r\n                            resizer={resizerOptions}\r\n                            {...field}\r\n                            ref={photo2Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Col} controlId=\"formIdInsp3\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo3\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\r\n                            onFinish={onFinishPhoto3}\r\n                            resizer={resizerOptions}\r\n                            {...field}\r\n                            ref={photo3Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\t\r\n        </Row>\r\n\r\n\r\n\r\n  )\r\n})\r\n\r\nexport default UploadPhotos","import { useState, useEffect, useRef } from 'react';\r\nimport { useForm, Controller  } from 'react-hook-form';\r\nimport { Form, Button, Card, Row, Col, Modal} from 'react-bootstrap';\r\nimport Datetime from 'react-datetime';\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../reducers/index'\r\nimport { TreeItem } from \"../interfaces\";\r\nimport moment from 'moment';\r\nimport TableList from './TableList'\r\nimport UploadPhotos from \"./UploadPhotos\"\r\n//import ImageS3Upload from \"./ImageS3Upload\";\r\n//import noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface FormTreeProps {\r\n\tonSubmitTree: (data: {}) => void;\r\n\tonDeleteTree: (id: number) => void;\r\n\tonCloseTree: () => void;\r\n    \r\n    onNewInsp:(idTree: number) => void;\r\n    onEditInsp: (data: {}) => void;\r\n    onClickInspPhotos: (data: {}) => void;\r\n        \t\r\n    dataTreeForm: TreeItem | null;\r\n    city: string;\r\n    signingS3Url: string;\r\n}\r\n\r\n\r\nconst FormTree = ({\r\n\tonSubmitTree,\r\n\tonDeleteTree,\r\n\tonCloseTree,\r\n    onNewInsp,\r\n    onEditInsp,\r\n    onClickInspPhotos,\r\n\tdataTreeForm,\r\n    city,\r\n    signingS3Url\r\n}: FormTreeProps) => {\r\n\r\n    const rxNewMarkerState = useSelector((state: RootState) => state.uiReducer.newMarkerState);\r\n    const [showModalDelete, setShowModalDelete] = useState(false);\r\n\r\n    const rxDictSpecieses = useSelector((state: RootState) => state.dataReducer.dictSpecieses);\r\n    const rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);\r\n\tconst rxDictPlaceTypes = useSelector((state: RootState) => state.dataReducer.dictPlaceTypes);\r\n\tconst rxDictIrrigationMethods = useSelector((state: RootState) => state.dataReducer.dictIrrigationMethods);\r\n    const rxDictGroupSpecs = useSelector((state: RootState) => state.dataReducer.dictGroupSpec);\r\n\r\n\r\n\t//const [uploadedPhoto1, setUploadedPhoto1] = useState(false);\r\n\t//const [uploadedPhoto2, setUploadedPhoto2] = useState(false);\r\n\t//const [uploadedPhoto3, setUploadedPhoto3] = useState(false); \r\n    \r\n\t//const photo1Ref = useRef(); // to be able to call method uploadFile\r\n\t//const photo2Ref = useRef();\r\n\t//const photo3Ref = useRef();\r\n\r\n    const uploadPhotosRef = useRef();\r\n\r\n\r\n    interface IInspections {\r\n\t\tid: number;\r\n\t\t[key: string]: any | {iconFA?: string; iconFASize?: string; text?: string; idButton: string};\r\n\t};\r\n\r\n    const [inspections, setInspections] = useState<IInspections[] | undefined>(undefined);\r\n\r\n\r\n    const dateTimeRef = useRef(null);\r\n    const { t } = useTranslation();\r\n\r\n    // rxNewMarkerState\r\n\tuseEffect(() => {\r\n\t\tif (rxNewMarkerState.visible) {\r\n\t\t\treset();\r\n\r\n\t\t\t// perhaps a bug of component, value is not reset, so reset it manually\r\n\t\t\t//@ts-ignore\r\n\t\t\t//dateTimeRef.current.state.inputValue = \"\";\r\n\t\t\t//@ts-ignore\r\n\t\t\t//dateTimeRef.current.state.selectedDate = undefined;\r\n\r\n\t\t\tsetValue(\"latitude\", rxNewMarkerState.position.lat);\r\n\t\t\tsetValue(\"longitude\", rxNewMarkerState.position.lng);            \r\n            //@ts-ignore\r\n            setValue(\"irrigationmethod\", optionsIrrigationMethodsData[0]);            \r\n\t\t}\r\n\t}, [rxNewMarkerState]);    \r\n\r\n\r\n\r\n\r\n    // when provide data to show it\r\n\tuseEffect(() => {\r\n\t\tlet formData: any = {};\r\n\r\n        formData.id = dataTreeForm?.id;\r\n        formData.latitude = dataTreeForm?.latitude;\r\n        formData.longitude = dataTreeForm?.longitude;\r\n        \r\n\t\tlet species = dataTreeForm?.species_id;\r\n\t\tif (species) {\r\n\t\t\tlet isFound = false; // to stop loop\r\n            optionsSpeciesesData.forEach((element:any) => { // loop for categories (The most common, The medium common and so on...)\r\n                if (element?.options && Array.isArray(element.options)) { // in every categories trying to find id of species \r\n                    \r\n                    if (!isFound) {\r\n                        formData.species = element.options.find(                \t\t\t\r\n                            (item: any) => {\r\n                                isFound = item.value === species; \r\n                                return isFound;\t}\r\n                        );             \r\n                    }       \r\n                }        \r\n            });\r\n            \r\n\t\t}        \r\n        \r\n        formData.speciescomment = dataTreeForm?.speciescomment;\r\n        formData.comment = dataTreeForm?.comment;\r\n\r\n        \r\n\t\tlet placetype = dataTreeForm?.placetype;\r\n\t\tif (placetype) {\r\n\t\t\tconsole.log('optionsPlaceTypesData', optionsPlaceTypesData)\r\n\t\t\tformData.placetype = optionsPlaceTypesData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === placetype\t\r\n\t\t\t);\r\n\t\t}    \r\n        \r\n\t\tlet irrigationmethod = dataTreeForm?.irrigationmethod;\r\n\t\tif (irrigationmethod) {\r\n\t\t\t//console.log('optionsPlaceTypesData', optionsPlaceTypesData)\r\n\t\t\tformData.irrigationmethod = optionsIrrigationMethodsData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === irrigationmethod\t\r\n\t\t\t);\r\n\t\t}          \r\n        \r\n\r\n\t\tif (dataTreeForm?.dateplanted) {\r\n            console.log('dataTreeForm?.properties?.dateplanted', dataTreeForm?.dateplanted);\r\n\t\t\tformData.dateplanted = dataTreeForm.dateplanted;\r\n\t\t}\r\n\r\n        formData.googlestreeturl = dataTreeForm?.googlestreeturl;\r\n\r\n\r\n        reset(formData, { keepDefaultValues: true });\r\n\r\n        const fetchInpections = async () => {\r\n\t\t    //@ts-ignore\r\n            let url = `${process.env.REACT_APP_API_URL}citytree/${city}/trees/${dataTreeForm.id}/inspections/`;\r\n    \t\tlet res = await fetch(url);\r\n\t\t    let data = await res.json(); \r\n            \r\n            // adding buttons\r\n            data = data.map((element: any) => {\r\n                element.buttons = [];\r\n                element.buttons.push({iconFA: 'fas fa-edit', iconFASize: '15pt', idButton: 'edit'});\r\n                \r\n                if (element?.photo1 || element?.photo2 || element?.photo3) {\r\n                    element.buttons.push({iconFA: 'fa fa-camera', iconFASize: '15pt', idButton: 'photo'});                       \r\n                    \r\n                }\r\n                element.typeData = 'Inspection';\r\n                return element;\r\n                    \r\n            });\r\n            \r\n            console.log('inspections',data);\r\n            setInspections(data);       \r\n        };\r\n\r\n        if (dataTreeForm?.id) {\r\n            fetchInpections();    \r\n        }\r\n\r\n\r\n\t}, [dataTreeForm]);\r\n\r\n\r\n\r\n    /*\r\n\tuseEffect(() => {\r\n\t\tif (uploadedPhoto1 && uploadedPhoto2 && uploadedPhoto3) {\r\n\t\t\tsetUploadedPhoto1(false);\r\n\t\t\tsetUploadedPhoto2(false);\r\n\t\t\tsetUploadedPhoto3(false);\r\n\r\n\t\t\thandleSubmit(prepareOnSubmitTree)();\r\n\t\t}\r\n\t}, [uploadedPhoto1, uploadedPhoto2, uploadedPhoto3]);\r\n    */\r\n\r\n\r\n\r\n\r\n    let optionsSpeciesesData: any = [];\r\n    if (Array.isArray(rxDictSpecieses) && Array.isArray(rxDictGroupSpecs)) {\r\n\r\n        optionsSpeciesesData = rxDictGroupSpecs.map(itemGroup => {\r\n            return {\r\n                label: itemGroup.groupname,\r\n                options: rxDictSpecieses.map(spec => {\r\n                    if (itemGroup.id === spec.groupspec) {\r\n                        return {\r\n                            value: spec.id,\r\n                            label: spec.localname,\r\n                            speciesname: spec.speciesname,\r\n                            typespec: spec.typespec\r\n                            //color: '#FF8B00'\r\n                        }\r\n                    }\r\n                }).filter(e => e) // removes all undefined items in result array\t\t\t \r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    let optionsStatusesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictStatuses)) {\r\n        optionsStatusesData = rxDictStatuses.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.statusname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsCareTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictCareTypes)) {\r\n        optionsCareTypesData = rxDictCareTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.carename,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsRemarksData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictRemarks)) {\r\n        optionsRemarksData = rxDictRemarks.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.remarkname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsPlaceTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictPlaceTypes)) {\r\n        //console.log('rxDictPlaceTypes', rxDictPlaceTypes)\r\n        optionsPlaceTypesData = rxDictPlaceTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.placename,\r\n            };\r\n        });\r\n    }\r\n\r\n    let optionsIrrigationMethodsData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictIrrigationMethods)) {\r\n        optionsIrrigationMethodsData = rxDictIrrigationMethods.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.irrigationname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tsetValue,\r\n\t\tgetValues,\r\n\t\tformState: { errors },\r\n        trigger\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\t\t\t\r\n            id: \"\",\r\n            latitude: \"\",\r\n            longitude: \"\",\r\n            species: \"\",\r\n            speciescomment: \"\",\r\n            comment: \"\",\r\n            placetype: \"\",\r\n            irrigationmethod: \"\",            \r\n            dateplanted: \"\",\r\n            googlestreeturl: \"\",\r\n            \r\n            height: \"\",\r\n            crowndiameter: \"\",\r\n            trunkgirth: \"\",\r\n            status: \"\",\r\n            remarks: \"\",\r\n            recommendations: \"\",\r\n            photo1: \"\",\r\n            photo2: \"\",\r\n            photo3: \"\"\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\r\n\tasync function onSubmitBefore(e: any) {\r\n\t\te.preventDefault();\t\t\t\t\r\n\t\t\r\n        const result = await trigger(); // programmaticaly run validation\r\n        if (result) {\r\n            //@ts-ignore\r\n            uploadPhotosRef.current.uploadPhotos(); // component uploadPhotos has a callback to start a submit of the form, when uploading has been finished.\r\n        }\r\n\r\n\r\n\r\n        /*\r\n        //setPhoto1StateUpload({...photo1StateUpload, start: true})\r\n\r\n\t\tlet p1 = false;\r\n\t\tlet p2 = false;\r\n\t\tlet p3 = false;\r\n\t\t//@ts-ignore\r\n\t\tif (photo1Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp1=photo1Ref.current.uploadFile();\r\n\t\t}\t\r\n\r\n\t\t//@ts-ignore\r\n\t\tif (photo2Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp2=photo2Ref.current.uploadFile();\r\n\t\t}\r\n\t\t\r\n\t\t//@ts-ignore\r\n\t\tif (photo3Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp3=photo3Ref.current.uploadFile();\r\n\t\t}\t\t\r\n\r\n\r\n\t\tconsole.log('p', p1, p2, p3);\r\n\t\tif (!p1 && !p2 && !p3) { // there is no photo to upload, so just submit form\r\n\t\t\t//handleSubmit(prepareOnSubmitInsp)()\r\n\t\t} else {\r\n\t\t\te.preventDefault();\r\n\t\t\tsetUploadedPhoto1(!p1);\r\n\t\t\tsetUploadedPhoto2(!p2);\r\n\t\t\tsetUploadedPhoto3(!p3);\r\n\t\t\t//console.log('cons', {photo1: !p1, photo2: !p2, photo3: !p3, data: data})\r\n\t\t\t//setPhotosUploaded({photo1: !p1, photo2: !p2, photo3: !p3, data: data});\r\n\t\t}\t\t\r\n\t\t\r\n\t\t//handleSubmit(prepareOnSubmitInsp)()\r\n        */\r\n\t}\r\n\r\n\tconst onCallbackDone = () => {\r\n\t\tconsole.log('DONE');\r\n\t\thandleSubmit(prepareOnSubmitTree)();\t\r\n\t}    \r\n\r\n\r\n\r\n\tfunction prepareOnSubmitTree(data: {\r\n        id: any;\r\n        latitude: string;\r\n        longitude: string;\r\n        species: any;\r\n        speciescomment: string;\r\n        comment: string;\r\n        placetype: any;\r\n        irrigationmethod: any;\r\n        dateplanted: any;\r\n        googlestreeturl: string | null;\r\n\r\n        inspection?: any;\r\n        height: any;\r\n        crowndiameter: any;\r\n        trunkgirth: any;\r\n        status: any;\r\n        remarks: any;\r\n        recommendations: any;\r\n        photo1: string | null; \r\n        photo2: string | null;\r\n        photo3: string | null;\r\n    }) {\r\n\t\t//let dataResult: any = {};\r\n        //console.log('data', data);\r\n\r\n\r\n        if (!data.dateplanted) {\r\n            data.dateplanted = null;    \r\n        }\r\n\r\n        if (rxNewMarkerState?.visible === true) {\r\n            // new record                \r\n            data.species = data.species.value;\r\n            data.placetype = data.placetype.value;\r\n            data.irrigationmethod = data?.irrigationmethod?.value;            \r\n\r\n            // make inspection\r\n            if (data?.height && data?.crowndiameter && data?.trunkgirth && data?.status) {\r\n                data.inspection = {\r\n                    height: parseInt(data.height),\r\n                    crowndiameter: parseFloat(data.crowndiameter),\r\n                    trunkgirth: parseInt(data.trunkgirth),\r\n                    status: data.status.value,  \r\n                    \r\n                    photo1: data.photo1,          \r\n                    photo2: data.photo2, \r\n                    photo3: data.photo3, \r\n                };\r\n\r\n                if (data?.remarks && Array.isArray(data.remarks)) {\r\n                    data.inspection.remarks = [];\r\n                    data.remarks.forEach(element => {\r\n                        data.inspection.remarks.push(element.value);     \r\n                    });                                           \r\n                }\r\n                \r\n                if (data?.recommendations && Array.isArray(data.recommendations)) {\r\n                    data.inspection.recommendations = [];\r\n                    data.recommendations.forEach(element => {\r\n                        data.inspection.recommendations.push(element.value);     \r\n                    });                                           \r\n                }                             \r\n            }   \r\n\r\n            delete data.id;\r\n            delete data.height;\r\n            delete data.crowndiameter;\r\n            delete data.trunkgirth;\r\n            delete data.status; \r\n            delete data.remarks;\r\n            delete data.recommendations; \r\n\r\n            console.log('onSubmitTree', data);\r\n            onSubmitTree(data);\r\n\r\n        } else {\r\n            // edit\r\n            data.species = data.species.value;\r\n            data.placetype = data.placetype.value;\r\n            data.irrigationmethod = data?.irrigationmethod?.value; \r\n            \r\n            console.log('dataedit', data);\r\n            onSubmitTree(data);\r\n        }\r\n\r\n        \r\n    }        \r\n\r\n\r\n    const customStyles = {\r\n\t\t//@ts-ignore\r\n\t\toption: (styles, { data, isSelected, isFocused, isDisabled  }) => {\r\n\t\t\t//const color = chroma(data.color);\r\n\t\t\treturn {\r\n\t\t\t  ...styles,\r\n\t\t\t  paddingLeft: 20,\r\n\t\t\t  //backgroundColor: data.typespec === 2 ? '#EEFFEE' : undefined,\r\n              backgroundColor: isDisabled\r\n              ? undefined\r\n              : isSelected\r\n              ? \"#606060\"\r\n              : isFocused\r\n              ? \"#EEEEEE\"\r\n              : data.typespec === 2 ? '#EEFFEE' : undefined,\r\n\t\t\t};\r\n\t\t  },\r\n\t  } \r\n\r\n\r\n\r\n\t  const Option = (props: any) => {\r\n\t\tconst { label, speciesname } = props.data;\r\n\t\treturn (\r\n\t\t  <components.Option {...props}>\r\n\t\t\t<span>{label}</span> <span style={{ color: \"darkgray\" }}>{speciesname}</span>\r\n\t\t  </components.Option>\r\n\t\t);\r\n\t  };\r\n\r\n\r\n\r\n\r\n    function OnButtonTableClick (rowData: any, idButton: string) {    \r\n        console.log(idButton, rowData);\r\n        if (idButton==='edit') {\r\n            onEditInsp(rowData);\r\n        } else if (idButton==='photo') {\r\n            onClickInspPhotos(rowData);\r\n        }\r\n        \r\n    }\r\n\r\n\r\n    /*\r\n\tconst onFinishPhoto1 = () => {\r\n\t\tconsole.log('onFinishPhoto1');\r\n\t\tsetUploadedPhoto1(true);\r\n\t\t//setPhotosUploaded({...photosUploaded, photo1: true});\t\r\n\t}\r\n\tconst onFinishPhoto2 = () => {\r\n\t\tconsole.log('onFinishPhoto2');\r\n\t\tsetUploadedPhoto2(true);\r\n\t\r\n\t\t//setPhotosUploaded({photo1: photosUploaded.photo1, photo2: true, photo3: photosUploaded.photo3, data: photosUploaded.data});\r\n\t\t//setPhotosUploaded({...photosUploaded, photo2: true});\r\n\t}\r\n\tconst onFinishPhoto3 = () => {\r\n\t\tconsole.log('onFinishPhoto3');\r\n\t\t//setPhotosUploaded({...photosUploaded, photo3: true});\r\n\t\tsetUploadedPhoto3(true);\r\n\t}\t    \r\n    */\r\n\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form\r\n\t\t\t\tclassName=\"m-1\"\r\n\t\t\t\tonSubmit={handleSubmit(prepareOnSubmitTree)}\r\n\t\t\t>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formCoordEditButton\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.latLng\")}{\" \"}\r\n\t\t\t\t\t\t\t<a href=\"#\">\r\n\t\t\t\t\t\t\t\t<i className=\"fas fa-edit align-middle\"></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formLatTree\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"latitude\"\r\n                            rules={{ required: true }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tstep=\"any\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tisInvalid={!!errors.latitude}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t{t<string>(\"words.requiredField\")}\r\n\t\t\t\t\t\t</Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formLngTree\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"longitude\"\r\n                            rules={{ required: true }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tstep=\"any\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tisInvalid={!!errors.longitude}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t{t<string>(\"words.requiredField\")}\r\n\t\t\t\t\t\t</Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formSpecies\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.species\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"species\"\r\n                        rules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={true}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsSpeciesesData}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tgetOptionLabel={(option) =>`${option.label} - ${option.speciesname}`}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n                    <p className=\"requiredField\">{errors.species?.message}</p>\r\n\t\t\t\t</Form.Group>\r\n\r\n                \r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formSpeciesCommentTree\"\r\n\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.speciescomment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"speciescomment\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n                \r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formCommentTree\"\r\n\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.comment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"comment\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tas=\"textarea\"\r\n\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formPlaceTypeTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.placetype\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"placetype\"\r\n                            rules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n                                    options={optionsPlaceTypesData}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n                        <p className=\"requiredField\">{errors.placetype?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formIrrigationmethodTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.irrigationmethod\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"irrigationmethod\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n                                    options={optionsIrrigationMethodsData}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n                    <Form.Group as={Col} controlId=\"formDatePlantedTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.dateplanted\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateplanted\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formGoogleStreetUrlTree\" style={{ minWidth: \"230px\" }}>\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.googlestreeturl\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"googlestreeturl\"\r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Form.Control\r\n                                    type=\"text\"\r\n                                    {...field}\r\n                                />\r\n                            )}\r\n                        />\r\n                    </Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n                {rxNewMarkerState.visible ? \r\n                <>\r\n                    <Form.Group className=\"mt-4\" controlId=\"formFirstInspectionTree\">\r\n                        <Form.Label>\r\n                            <b>{t<string>(\"sidebar.treeTab.firstInspection\")}</b>\r\n                        </Form.Label>\r\n\r\n                    </Form.Group>   \r\n                    \r\n                    <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"formHeightTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.heightTree\")}\r\n                            </Form.Label>\r\n                            <Controller\r\n                                name=\"height\"\r\n                                rules={{ required: t<string>(\"words.requiredField\") }}                               \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"\r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n                            <p className=\"requiredField\">{errors.height?.message}</p>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formDiameterTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.diameterTree\")}\r\n                            </Form.Label>\r\n                            <Controller\r\n                                name=\"crowndiameter\"\r\n                                rules={{ required: t<string>(\"words.requiredField\"), max: 99, pattern: /^\\d+([.]\\d)?$/ }}                              \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"\r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n\t\t\t\t\t\t{errors.crowndiameter?.message && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">{errors.crowndiameter?.message}</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"max\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Maximum value is 99</p>\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"pattern\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Allow only one decimal point</p>\r\n\t\t\t\t\t\t}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formGirthTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.girthTree\")}\r\n                            </Form.Label>\r\n                            <div style={{height: \"100%\"}}>\r\n                            <Controller\r\n                                name=\"trunkgirth\"\r\n                                rules={{ required: t<string>(\"words.requiredField\") }}                                \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"    \r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n                            <p className=\"requiredField\">{errors.trunkgirth?.message}</p>\r\n                            </div>\r\n                        </Form.Group>                        \r\n\t\t\t\t    </Row>  \r\n\r\n\r\n\r\n\r\n\r\n\r\n                    <Form.Group controlId=\"formStatusTree\" className=\"mt-3\">\r\n                        <Form.Label className=\"required\">\r\n                            {t<string>(\"sidebar.treeTab.status\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"status\"\r\n                            rules={{ required: t<string>(\"words.requiredField\") }} \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsStatusesData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n                        <p className=\"requiredField\">{errors.status?.message}</p>\r\n\t\t\t\t    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formRemarksTree\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.remarks\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"remarks\"                            \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    isMulti\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsRemarksData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n\t\t\t\t    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formCareTypesTree\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.careTypes\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"recommendations\"                            \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    isMulti\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsCareTypesData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n\t\t\t\t    </Form.Group>    \r\n\r\n\r\n                    <UploadPhotos \r\n                        controlFromUseForm={control}\r\n                        signingS3Url={signingS3Url}\r\n                        onCallbackDone={onCallbackDone}\t\r\n                        ref={uploadPhotosRef}\r\n\t\t\t\t    />\r\n                </>\r\n\r\n                \r\n                : <>\r\n                    <Form.Group controlId=\"formInspActTable\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.inspActionsTable\")}\r\n                        </Form.Label>\r\n                        \r\n                        <TableList columns={\r\n                            [\r\n                                {\r\n                                    field: \"#\",\r\n                                    headerName: \"\",\r\n                                },                            \r\n                                {\r\n                                    field: \"datetime\",\r\n                                    headerName: \"Дата\",\r\n                                    width: \"40%\",\r\n                                    sortable: true,\r\n                                    dateTimeOption: \"onlyDate\",\r\n                                },\r\n                                {\r\n                                    field: \"typeData\",\r\n                                    headerName: \"Тип\",\r\n                                    width: \"35%\"\r\n                                },    \r\n                                {\r\n                                    field: \"buttons\",\r\n                                    headerName: \"Actions\",\r\n                                    width: \"25%\"\r\n                                },             \r\n                            ]\r\n                        } data={inspections} sortField={\"datetime\"} sortAsc={false} size={\"sm\"} OnClickButtons={OnButtonTableClick}/>\r\n\r\n                    </Form.Group>\r\n\r\n\r\n                    <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"formNewInspButton\">\r\n                            <Button\r\n                                style={{width: \"100%\"}}\r\n                                onClick={() => dataTreeForm?.id && onNewInsp(dataTreeForm.id)}\r\n                                variant=\"light\"\r\n                            >\r\n                                {t<string>(\"sidebar.treeTab.newInspButton\")}\r\n                            </Button>{\" \"}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formNewActButton\">\r\n                            <Button\r\n                                style={{width: \"100%\"}}\r\n                                //onClick={}\r\n                                variant=\"light\"\r\n                            >\r\n                                {t<string>(\"sidebar.treeTab.newActButton\")}\r\n                            </Button>{\" \"}\r\n                        </Form.Group>\r\n                    </Row>\r\n                </>}\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"id\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(true)}\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.delete\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button \r\n                        onClick={onCloseTree} \r\n                        variant=\"secondary\"\r\n                    >\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.close\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button                        \r\n\t\t\t\t\t\ttype=\"submit\"\r\n                        onClick={ rxNewMarkerState.visible ? onSubmitBefore : undefined }\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"110px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.save\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showModalDelete}\r\n\t\t\t\tonHide={() => setShowModalDelete(false)}\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t<Modal.Title>{t<string>(\"words.deleting\")}</Modal.Title>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Body>{t<string>(\"sidebar.treeTab.confirmDeleting\")}</Modal.Body>\r\n\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowModalDelete(false);\r\n\t\t\t\t\t\t\tonDeleteTree(parseInt(getValues(\"id\").toString()));\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.delete\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(false)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.cancel\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n\r\n}\r\n\r\n\r\nexport default FormTree","import { useState, useEffect, useRef } from \"react\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { Form, Button, Card, Row, Col, Modal } from \"react-bootstrap\";\r\nimport Datetime from \"react-datetime\";\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\nimport { InspItem } from \"../interfaces\";\r\nimport UploadPhotos from \"./UploadPhotos\"\r\n//import ImageS3Upload from \"./ImageS3Upload\";\r\n//import noPhotoImage from \"./images/no-photo.png\";\r\n\r\n\r\n\r\n\r\ninterface FormInspProps {\r\n\tonSubmitInsp: (data: {}) => void;\r\n\tonDeleteInsp: (data: InspItem | null) => void;\r\n\tonCloseInsp: () => void;\r\n\tdataInspForm: InspItem | null;\r\n\tcity: string;\r\n\tsigningS3Url: string;\r\n}\r\n\r\n\r\nlet test = 1;\r\n\r\nconst FormInspection = ({\r\n\tonSubmitInsp,\r\n\tonDeleteInsp,\r\n\tonCloseInsp,\r\n\tdataInspForm,\r\n\tcity,\r\n\tsigningS3Url\r\n}: FormInspProps) => {\r\n\r\n    \t\r\n\tconst [showModalDelete, setShowModalDelete] = useState(false);\r\n\r\n\tconst rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);    \r\n    const { t } = useTranslation();\r\n\r\n\t//const [uploadedPhoto1, setUploadedPhoto1] = useState(false);\r\n\t//const [uploadedPhoto2, setUploadedPhoto2] = useState(false);\r\n\t//const [uploadedPhoto3, setUploadedPhoto3] = useState(false);\t\r\n\t\r\n\t//const photo1Ref = useRef(); // to be able to call method uploadFile\r\n\t//const photo2Ref = useRef();\r\n\t//const photo3Ref = useRef();\r\n\r\n\tconst uploadPhotosRef = useRef();\r\n\r\n\tconst {\t\t\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tsetValue,\r\n\t\tgetValues,\r\n\t\tformState: { errors, isValid },\r\n\t\ttrigger \r\n\t} = useForm({ \r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\t\t\t\r\n            id: \"\",  \r\n            treeId: \"\",          \r\n            height: \"\",\r\n            crowndiameter: \"\",\r\n            trunkgirth: \"\",\r\n            status: \"\",\r\n            remarks: [],\r\n            recommendations: [],\r\n\t\t\tphoto1: \"\",\r\n\t\t\tphoto2: \"\",\r\n\t\t\tphoto3: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n\t\tlet formData: any = {};\r\n\r\n        formData.id = dataInspForm?.id;  \r\n        formData.treeId = dataInspForm?.tree; \r\n        formData.height = dataInspForm?.height; \r\n        formData.crowndiameter = dataInspForm?.crowndiameter; \r\n        formData.trunkgirth = dataInspForm?.trunkgirth; \r\n        \r\n\t\tlet status = dataInspForm?.status;\r\n\t\tif (status) {\r\n\t\t\tformData.status = optionsStatusesData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === status\t\r\n\t\t\t);\r\n\t\t}   \r\n  \r\n        \r\n\t\tlet remarks = dataInspForm?.remarks;\r\n\t\tif (remarks) {\r\n\t\t\t//let remarksValues = remarks.map((item) => item);\r\n\t\t\tformData.remarks = optionsRemarksData.filter(\r\n\t\t\t\t//@ts-ignore\r\n                (item) => remarks.includes(item.value)\r\n\t\t\t);\r\n\t\t}  \r\n        \r\n\t\tlet recommendations = dataInspForm?.recommendations;\r\n\t\tif (recommendations) {\r\n\t\t\t//let remarksValues = remarks.map((item) => item);\r\n\t\t\tformData.recommendations = optionsCareTypesData.filter(\r\n\t\t\t\t//@ts-ignore\r\n                (item) => recommendations.includes(item.value)\r\n\t\t\t);\r\n\t\t}        \r\n\r\n\r\n\t\tif (dataInspForm?.photo1) {\r\n\t\t\tformData.photo1 = dataInspForm.photo1;\r\n\t\t} else {\r\n\t\t\tformData.photo1 = '';\r\n\t\t}\r\n\t\tif (dataInspForm?.photo2) {\r\n\t\t\tformData.photo2 = dataInspForm.photo2;\r\n\t\t} else {\r\n\t\t\tformData.photo2 = '';\r\n\t\t}\r\n\t\tif (dataInspForm?.photo3) {\r\n\t\t\tformData.photo3 = dataInspForm.photo3;\r\n\t\t} else {\r\n\t\t\tformData.photo3 = '';\r\n\t\t}\t\t\r\n\t\t\r\n        \r\n        reset(formData, { keepDefaultValues: true });\r\n\t\tconsole.log('dataInspForm');\r\n\r\n    }, [dataInspForm]);\r\n\r\n\r\n\t/*\r\n\tuseEffect(() => {\r\n\t\tif (uploadedPhoto1 && uploadedPhoto2 && uploadedPhoto3) {\t\t\t\r\n\t\t\tsetUploadedPhoto1(false);\r\n\t\t\tsetUploadedPhoto2(false);\r\n\t\t\tsetUploadedPhoto3(false);\r\n\r\n\t\t\thandleSubmit(prepareOnSubmitInsp)();\r\n\t\t}\r\n\t}, [uploadedPhoto1, uploadedPhoto2, uploadedPhoto3]);\t\r\n\t*/\r\n\r\n\r\n\r\n\r\n    let optionsStatusesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictStatuses)) {\r\n        optionsStatusesData = rxDictStatuses.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.statusname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsCareTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictCareTypes)) {\r\n        optionsCareTypesData = rxDictCareTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.carename,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsRemarksData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictRemarks)) {\r\n        optionsRemarksData = rxDictRemarks.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.remarkname,\r\n            };\r\n        });\r\n    }    \r\n\r\n\r\n\r\n\r\n\tasync function onSubmitBefore(e: any) {\r\n\t\te.preventDefault();\t\t\t\t\r\n\t\tconst result = await trigger(); // programmaticaly run validation\r\n\t\tif (result) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tuploadPhotosRef.current.uploadPhotos(); // component uploadPhotos has a callback to start a submit of the form, when uploading has been finished.\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t/*\r\n\t\tlet p1 = false;\r\n\t\tlet p2 = false;\r\n\t\tlet p3 = false;\r\n\t\t//@ts-ignore\r\n\t\tif (photo1Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp1=photo1Ref.current.uploadFile();\r\n\t\t}\t\r\n\r\n\t\t//@ts-ignore\r\n\t\tif (photo2Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp2=photo2Ref.current.uploadFile();\r\n\t\t}\r\n\t\t\r\n\t\t//@ts-ignore\r\n\t\tif (photo3Ref?.current?.uploadFile) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tp3=photo3Ref.current.uploadFile();\r\n\t\t}\t\t\r\n\r\n\r\n\t\tconsole.log('p', p1, p2, p3);\r\n\t\tif (!p1 && !p2 && !p3) { // there is no photo to upload, so just submit form\r\n\t\t\t//handleSubmit(prepareOnSubmitInsp)()\r\n\t\t} else {\r\n\t\t\te.preventDefault();\r\n\t\t\tsetUploadedPhoto1(!p1);\r\n\t\t\tsetUploadedPhoto2(!p2);\r\n\t\t\tsetUploadedPhoto3(!p3);\r\n\t\t}\t\t\r\n\t\t\r\n\t\t//handleSubmit(prepareOnSubmitInsp)()\r\n\t\t*/\r\n\t}\r\n\r\n\tfunction prepareOnSubmitInsp(data: {\r\n        id: any;  \r\n        treeId: any;      \r\n        height: any;\r\n        crowndiameter: any;\r\n        trunkgirth: any;\r\n        status: any;\r\n        remarks: any;\r\n        recommendations: any;\r\n        //photo1: any;\r\n        //photo2: any;\r\n        //photo3: any;\r\n    }) {\r\n\r\n\t\tconsole.log('submit', data);\r\n\r\n        data.height = parseInt(data.height);\r\n        data.crowndiameter = parseFloat(data.crowndiameter);\r\n        data.trunkgirth = parseInt(data.trunkgirth);\r\n        data.status = data.status.value;\r\n\r\n        if (data?.remarks && Array.isArray(data.remarks)) {\r\n            let remarks: number[] = [];\r\n            data.remarks.forEach((element:{value: number; label: string}) => {\r\n                remarks.push(element.value);     \r\n            }); \r\n            data.remarks = remarks;                                          \r\n        }\r\n\r\n        if (data?.recommendations && Array.isArray(data.recommendations)) {\r\n            let recommendations: number[] = [];\r\n            data.recommendations.forEach((element:{value: number; label: string}) => {\r\n                recommendations.push(element.value);     \r\n            }); \r\n            data.recommendations = recommendations;                                          \r\n        }  \t\t\r\n\r\n\t\tonSubmitInsp(data);\r\n\r\n    };\r\n\r\n\r\n\t/*\r\n\tconst onFinishPhoto1 = () => {\r\n\t\tconsole.log('onFinishPhoto1');\r\n\t\tsetUploadedPhoto1(true);\r\n\t\t//setPhotosUploaded({...photosUploaded, photo1: true});\t\r\n\t}\r\n\tconst onFinishPhoto2 = () => {\r\n\t\tconsole.log('onFinishPhoto2');\r\n\t\tsetUploadedPhoto2(true);\r\n\t\r\n\t\t//setPhotosUploaded({photo1: photosUploaded.photo1, photo2: true, photo3: photosUploaded.photo3, data: photosUploaded.data});\r\n\t\t//setPhotosUploaded({...photosUploaded, photo2: true});\r\n\t}\r\n\tconst onFinishPhoto3 = () => {\r\n\t\tconsole.log('onFinishPhoto3');\r\n\t\t//setPhotosUploaded({...photosUploaded, photo3: true});\r\n\t\tsetUploadedPhoto3(true);\r\n\t}\t\r\n\t*/\r\n\r\n\r\n\tconst onUploadError = (e: any) => {\r\n\t\tconsole.log('onUploadError', e);\r\n\t}\r\n\r\n\r\n\tconst onCallbackDone = () => {\r\n\t\tconsole.log('DONE');\r\n\t\thandleSubmit(prepareOnSubmitInsp)();\t\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form className=\"m-1\" onSubmit={handleSubmit(prepareOnSubmitInsp)}>\t\t\t\t\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formHeightTree\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.heightTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"height\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t)}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<p className=\"requiredField\">{errors.height?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDiameterTree\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.diameterTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crowndiameter\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\"), max: 99, pattern: /^\\d+([.]\\d)?$/ }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.crowndiameter?.message && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">{errors.crowndiameter?.message}</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"max\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Maximum value is 99</p>\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"pattern\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Allow only one decimal point</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formGirthTree\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.girthTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkgirth\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<p className=\"requiredField\">{errors.trunkgirth?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formStatusTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.status\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"status\"\r\n\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsStatusesData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<p className=\"requiredField\">{errors.status?.message}</p>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formRemarksTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.remarks\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"remarks\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsRemarksData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formCareTypesTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.careTypes\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"recommendations\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsCareTypesData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdInsp\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"id\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\t\t\t\t\r\n\r\n\r\n\t\t\t\t<UploadPhotos \r\n\t\t\t\t\tcontrolFromUseForm={control}\r\n\t\t\t\t\tsigningS3Url={signingS3Url}\r\n\t\t\t\t\tserverPhoto={dataInspForm?.photoServer}\r\n\t\t\t\t\tonCallbackDone={onCallbackDone}\t\r\n\t\t\t\t\tref={uploadPhotosRef}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/*\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formIdInsp1\" className=\"mt-3\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"photo1\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\r\n\t\t\t\t\t\t\t\t<ImageS3Upload  \r\n\t\t\t\t\t\t\t\t\tsigningUrl={signingS3Url}\r\n\t\t\t\t\t\t\t\t\tautoUpload={false}\r\n\t\t\t\t\t\t\t\t\t//startUploadState={photo1StateUpload.start}\r\n\t\t\t\t\t\t\t\t\temptyPhoto={noPhotoImage}\r\n\t\t\t\t\t\t\t\t\tserverPhoto={dataInspForm?.photoServer}\t\r\n\t\t\t\t\t\t\t\t\tonFinish={onFinishPhoto1}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tref={photo1Ref}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formIdInsp2\" className=\"mt-3\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"photo2\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\r\n\t\t\t\t\t\t\t\t<ImageS3Upload  \r\n\t\t\t\t\t\t\t\t\tsigningUrl={signingS3Url}\r\n\t\t\t\t\t\t\t\t\tautoUpload={false}\t\r\n\t\t\t\t\t\t\t\t\temptyPhoto={noPhotoImage}\r\n\t\t\t\t\t\t\t\t\tserverPhoto={dataInspForm?.photoServer}\r\n\t\t\t\t\t\t\t\t\tonFinish={onFinishPhoto2}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tref={photo2Ref}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formIdInsp3\" className=\"mt-3\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"photo3\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\r\n\t\t\t\t\t\t\t\t<ImageS3Upload  \r\n\t\t\t\t\t\t\t\t\tsigningUrl={signingS3Url}\r\n\t\t\t\t\t\t\t\t\tautoUpload={false}\r\n\t\t\t\t\t\t\t\t\temptyPhoto={noPhotoImage}\r\n\t\t\t\t\t\t\t\t\tserverPhoto={dataInspForm?.photoServer}\r\n\t\t\t\t\t\t\t\t\tonFinish={onFinishPhoto3}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tref={photo3Ref}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t</Row>\r\n\t\t\t\t*/}\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdTreeInsp\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"treeId\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>      \r\n\r\n\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(true)}\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t> \r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.delete\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button \r\n                        onClick={onCloseInsp} \t\t\t\t\t\r\n                        variant=\"secondary\"\r\n                    >\r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.close\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button                        \r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tonClick={onSubmitBefore}\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"110px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.save\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\r\n\r\n\r\n\r\n\t\t\t</Form>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showModalDelete}\r\n\t\t\t\tonHide={() => setShowModalDelete(false)}\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t<Modal.Title>{t<string>(\"words.deleting\")}</Modal.Title>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Body>{t<string>(\"sidebar.inspTab.confirmDeleting\")}</Modal.Body>\r\n\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowModalDelete(false);\r\n\t\t\t\t\t\t\t//onDeleteInsp(parseInt(getValues(\"id\").toString()));\r\n                            onDeleteInsp(dataInspForm);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.delete\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(false)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.cancel\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FormInspection;\r\n","import Carousel from \"react-bootstrap/Carousel\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport \"./ImageSlider.css\";\r\n\r\n\r\ninterface ImageSliderProps {\r\n    visible: boolean;\r\n    setVisible: any;\r\n    images: string[];\r\n} \r\n\r\nfunction ImageSlider({\r\n    visible,\r\n    setVisible,\r\n    images\r\n}: ImageSliderProps) {\r\n  return (\r\n    \r\n    \r\n    <Modal\r\n        show={visible}\r\n        onHide={() => setVisible({visible: false, images:[]})}\r\n        //size=\"lg\"\r\n        //@ts-ignore\r\n        dialogClassName=\"modal-90w\"       \r\n        aria-labelledby=\"example-custom-modal-styling-title\"\r\n    >\r\n        <Modal.Body>\r\n            <Carousel interval={null}>\r\n                {                \r\n                    images.map((photo) => \r\n                        <Carousel.Item key={photo} >\r\n                            <img\r\n                                className=\"d-block w-100\"\r\n                                src={photo}                                               \r\n                            />\r\n                        </Carousel.Item>                    \r\n                    )                \r\n                }                \r\n            </Carousel>\r\n        </Modal.Body>\r\n    </Modal>\r\n\r\n  )\r\n}\r\n\r\nexport default ImageSlider","import { useState, useEffect } from 'react'\r\nimport { Form, Button, FloatingLabel, Modal } from \"react-bootstrap\";\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { actLoginModalShow, actRegisterModalShow } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\n\r\ninterface Credentials {\r\n\tusername: string; \r\n\tpassword: string; \r\n\trememberme: boolean;\r\n} \r\n\r\n\r\ninterface LoginModalFormProps {\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n}\r\n\r\n\r\nconst LoginModalForm = ({setAuthToken}:LoginModalFormProps) => {\r\n\tconst dispatch = useDispatch();\r\n\tconst rxLoginModalShow = useSelector((state: RootState) => state.uiReducer.loginModalShow)\r\n\r\n\tconst [showWrongPassword, setShowWrongPassword] = useState(false);\r\n\tconst { t } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\r\n\t\tsetShowWrongPassword(false);\r\n\t}, [rxLoginModalShow]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\trememberme: false,\r\n\t\t},\r\n\t});\r\n\r\n\tasync function loginUser(credentials: Credentials) {\r\n\t\tconsole.log(credentials)\r\n\t\treturn fetch(`${process.env.REACT_APP_API_URL}token/`, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\t\t}).then((data) => {\r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\r\n\t\t\t\t\t//data.rememberme = credentials.rememberme\r\n\t\t\t\t\tsetAuthToken(data);\r\n\t\t\t\t\t//console.log(data);\r\n\t\t\t\t\tsetShowWrongPassword(false);\r\n\r\n\t\t\t\t\t//setLoginModalShow(false)\r\n\t\t\t\t\tdispatch(actLoginModalShow(false));\r\n\t\t\t\t});\r\n\t\t\t} else if (data.status === 401) {\r\n\t\t\t\tsetShowWrongPassword(true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst OnSubmitForm = (data: Credentials) => {\r\n\t\tsetShowWrongPassword(false);\r\n\t\tlocalStorage.setItem(\"rememberme\", data.rememberme.toString());\r\n\t\tloginUser(data);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\t//show={show}\r\n\t\t\tshow={rxLoginModalShow}\r\n\t\t\t//onHide={onHide}\r\n\t\t\tonHide={() => dispatch(actLoginModalShow(false))}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t<string>(\"loginForm.title\")}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formLogin\">\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingInput\"\r\n\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.username\")}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t(\"loginForm.username\")}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.password\")}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t(\"loginForm.password\")}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formBasicCheckbox\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"rememberme\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t/* @ts-ignore */\r\n\t\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.rememberMe\")}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t{showWrongPassword && (\r\n\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t{t<string>(\"loginForm.wrongUsernamePassword\")}\r\n\t\t\t\t\t\t</Form.Text>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"loginForm.login\")}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{/* {t('loginForm.dontHaveAccount')} <a href=\"#\" onClick={()=> { setLoginModalShow(false); setRegisterModalShow(true) } }>{t('loginForm.signUp')}</a> */}\r\n\t\t\t\t\t\t\t{t<string>(\"loginForm.dontHaveAccount\")}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(false));\r\n\t\t\t\t\t\t\t\t\tdispatch(actRegisterModalShow(true));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"loginForm.signUp\")}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default LoginModalForm;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Form, Button, FloatingLabel, Modal, Col, Row } from \"react-bootstrap\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { actLoginModalShow, actRegisterModalShow } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\n\r\ninterface RegisterModalFormProps {\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n}\r\n\r\n\r\ninterface RegisterData {\r\n\tusername: string;\r\n\temail: string;\r\n\tpassword: string;\r\n\tpassword2: string;\r\n\tfirst_name: string;\r\n\tlast_name: string;\r\n} \r\n\r\n\r\n\r\n\r\nconst RegisterModalForm = ({setAuthToken}: RegisterModalFormProps) => {\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst rxRegisterModalShow = useSelector((state: RootState) => state.uiReducer.registerModalShow)\t\r\n\t\r\n\tconst { t } = useTranslation()\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\t\r\n\t}, [rxRegisterModalShow]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n        setError,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\temail: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tpassword2: \"\",\r\n\t\t\tfirst_name: \"\",\r\n\t\t\tlast_name: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\tconst OnSubmitForm = (data: RegisterData) => {\r\n\t\tregisterUser(data);\r\n\t};\r\n\r\n\tasync function registerUser(credentials: RegisterData) {\t\t\r\n\t\treturn fetch(`${process.env.REACT_APP_API_URL}users/`, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\r\n\t\t}).then((data) => {            \r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\t\r\n                    console.log('ok', data)\t\t\t\t\r\n                    //setRegisterModalShow(false);\r\n\t\t\t\t\tdispatch(actRegisterModalShow(false))\r\n                    setAuthToken(data.token) // after register make login\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t} else if (data.status >= 400) {\r\n\t\t\t\tdata.json().then((data) => {\r\n\t\t\t\t\tconsole.log(data)\r\n                \r\n                    for (const [key, value] of Object.entries(data)) {                \r\n                        //@ts-ignore\r\n\t\t\t\t\t\tsetError(key, {\r\n                            type: \"manual\",\r\n                            message: value,\r\n                        }); \r\n                    }                   \r\n\t\t\t\t});                \r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\t//show={show}\r\n\t\t\tshow={rxRegisterModalShow}\r\n\t\t\t//onHide={onHide}\r\n\t\t\tonHide={() => dispatch(actRegisterModalShow(false))}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t<string>('registerForm.title')}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formRegister\">\r\n\t\t\t\t\t\t\r\n                \r\n                        {errors?.username?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore*/}\r\n\t\t\t\t\t\t\t\t{errors.username.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                        \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingUsername\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.username')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.username')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n                        \r\n                        {errors?.email?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore  message is array, but declared as string */}\r\n\t\t\t\t\t\t\t\t{errors.email.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                          \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingEmail\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.email')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"email\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.email')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.email}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\r\n                        {errors?.password?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore*/}\r\n\t\t\t\t\t\t\t\t{errors.password.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}  \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.password')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.password')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword2\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password2\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password2}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"first_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.firstNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.first_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"last_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.lastNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.last_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>('registerForm.register')}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{t<string>('registerForm.alreadyHaveAccount')}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(actRegisterModalShow(false))\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(true))\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>('registerForm.login')}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RegisterModalForm;\r\n","import \"./App.css\";\nimport L from 'leaflet'\n\nimport { useParams } from \"react-router-dom\";\nimport { useState, useEffect, useRef } from \"react\";\n\nimport MenuGlobal from \"./components_hl/MenuGlobal\";\nimport Map from \"./components_hl/Map\";\nimport MainWrapper from \"./components/MainWrapper\";\nimport Sidebar from \"./components/Sidebar\";\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\nimport Button from \"react-bootstrap/Button\";\nimport ButtonOkCancelMobileMarker from \"./components/ButtonOkCancelMobileMarker\";\n\nimport FormFilter from './components/FormFilter';\nimport FormTree from './components/FormTree';\nimport FormInspection from './components/FormInspection';\nimport ImageSlider from './components/ImageSlider';\n\nimport useAuthToken from \"./useAuthToken\";\nimport LoginModalForm from \"./components/LoginModalForm\";\nimport RegisterModalForm from \"./components/RegisterModalForm\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { RootState, allReducers } from \"./reducers/index\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n\tactNewMarkerState,\n\tactIsMobileDevice,\n\tactShowSidebar,\n\tactCheckButtonNewMarker,\n\tactShowOkCancelMobileMarker,\n\tactShowTreeTab,\n\tactActiveTabKey,\n\tactDictStatuses,\n\tactDictSpecieses,\n\tactDictCareTypes,\n\tactDictRemarks,\n\tactDictPlaceTypes,\n\tactDictIrrigationMethods,\n\tactDictGroupSpecs, \n\tactDictTypeSpecs,\n\tactDataTrees,\n\tactDataFilters,\n\tactShowInspTab,\n} from \"./actions\";\nimport { TreeItem, InspItem } from \"./interfaces\";\n\nconst signingS3Url = `${process.env.REACT_APP_API_URL}citytree/s3/generate_signed_url/`;\n\nlet geojsonMarkerOptions_citytree = {\n    //renderer: myRenderer,\n    radius: 5,\n    fillColor: \"#008000\",\n    color: \"#008000\",\n    weight: 0,\n    opacity: 1,\n    fillOpacity: 0.5\n\t};\n\n\n\n\nfunction App() {\n\tconst paramsRouter = useParams();\n\tconst csrftoken = getCookie(\"csrftoken\");\n\n\t// redux\n\tconst dispatch = useDispatch();\n\tconst rxDataTrees = useSelector((state: RootState) => state.dataReducer.dataTrees);\n\tconst rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\n\tconst rxShowOkCancelMobileMarker = useSelector((state: RootState) => state.uiReducer.showOkCancelMobileMarker);\n\tconst rxDataFilters = useSelector((state: RootState) => state.dataReducer.dataFilters);\n\tconst rxActiveTabKey = useSelector((state: RootState) => state.uiReducer.activeTabKey);\n\tconst rxShowTreeTab = useSelector((state: RootState) => state.uiReducer.showTreeTab);\n\tconst rxShowInspTab = useSelector((state: RootState) => state.uiReducer.showInspTab);\n\tconst rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\n\tconst rxCheckButtonHeatmap = useSelector((state: RootState) => state.uiReducer.checkButtonHeatmap);\n\n\tconst rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\n\tconst rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\n\n\tconst [currentZoomMap, setCurrentZoomMap] = useState(13);\n\n\tconst { authToken, setAuthToken } = useAuthToken();\n\tconst [screenWidth, setScreenWidth] = useState(window.innerWidth);\n\t//const [isMobileDevice, setIsMobileDevice] = useState(false)\n\tconst isMobileView = screenWidth <= 768; // show or hide sidebar at startup\n\n\n\tconst [dataTreeForm, setDataTreeForm] = useState<TreeItem | null>(null);\n\tconst [dataInspForm, setDataInspForm] = useState<InspItem | {tree: number} | null>(null);\n\tconst [imageSlider, setImageSlider] = useState<{visible: boolean; images: string[]}>({visible: false, images: []});\n\tconst { t } = useTranslation();\n\n\tlet dataHeatmapPoints: number[][] = []; // [[lat, lng, value],[lat, lng, value]...]\t\n\n\tuseEffect(() => {\n\t\t\n\t\tconst fetchSpecieses = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/specieses/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictSpecieses(data));\n\t\t}\t\t\n\n\t\tconst fetchCareTypes = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/caretypes/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictCareTypes(data));\n\t\t}\t\n\n\t\tconst fetchRemarks = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/remarks/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictRemarks(data));\n\t\t}\t\n\t\t\n\t\tconst fetchPlaceTypes = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/placetypes/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictPlaceTypes(data));\n\t\t}\t\t\n\n\t\tconst fetchIrrigationMethods = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/irrigationmethods/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictIrrigationMethods(data));\n\t\t}\t\n\t\t\n\t\tconst fetchGroupSpecs = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/groupspecs/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictGroupSpecs(data));\n\t\t}\t\n\t\t\n\t\tconst fetchTypeSpecs = async () => {\t\t\t\n\t\t\tconst url = `${process.env.REACT_APP_API_URL}citytree/dictionary/typespecs/`;\n\t\t\tconst res = await fetch(url);\n\t\t\tconst data = await res.json();\n\t\t\tdispatch(actDictTypeSpecs(data));\n\t\t}\t\t\n\n\t\tfetchSpecieses();\n\t\tfetchCareTypes();\n\t\tfetchRemarks();\n\t\tfetchPlaceTypes();\n\t\tfetchIrrigationMethods();\n\t\tfetchGroupSpecs();\n\t\tfetchTypeSpecs();\n\n\t\tif (authToken) {\n            checkAuthToken()\n        }\t\n\t\t\n\t\tdispatch(actIsMobileDevice(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)))\n\t\t//dispatch(actIsMobileDevice(true))\n\t\tdispatch(actShowSidebar(!isMobileView))\t\n\t\t\n\t\twindow.addEventListener('resize', handleWindowSizeChange);\n        return () => {\n            window.removeEventListener('resize', handleWindowSizeChange);\t\t\t\n        }\t\t\n\n\t}, []); /* useEffect triggers when route has been changed too */\n\n\n\tuseEffect(() => {\n\t\tfetchTreesAndStatuses();\n\t}, [paramsRouter]); /* useEffect triggers when route has been changed too */\n\n    useEffect(() => {\n        let periodUpdate = 240000 //4 min\n        let interval = setInterval(() => {\n            if (authToken) {\n                refreshAuthToken(authToken.refresh)    \n            }\n        }, periodUpdate)\n\n        return ()=> clearInterval(interval)\n    }, [authToken]);\n\n\n    function handleWindowSizeChange() {\n        setScreenWidth(window.innerWidth);\n    }\t\n\n\n\tconst fetchTreesAndStatuses = async () => {\n\t\t//first of all, we must fetch dictionary with statuse, otherwise we can't draw points of trees in diferent color depends of them statuses.\n\t\tlet url = `${process.env.REACT_APP_API_URL}citytree/dictionary/statuses`;\n\t\tlet res = await fetch(url);\n\t\tlet data = await res.json();\n\t\tdispatch(actDictStatuses(data));\n\t\t\t\t\t\t\n\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/`;\n\t\tres = await fetch(url);\n\t\tdata = await res.json();\n\t\tdata.dateTimeGenerated = Date.now();\n\t\t\n\t\tdispatch(actDataTrees(data));\n\t};\n\n\t//const onMarkerClick = (data: AccidentItem) => {\n\t\t//console.log('data', data)\n\t//\tdispatch(actShowAccidentTab(true));\n\t//\tdispatch(actActiveTabKey(\"accident\"));\n\t//\tsetDataAccidentForm(data);\n\t//\tdispatch(actShowSidebar(true));\n\t//};\n\n\tfunction markerOnClick(e: any) {\n\t\tconst fetchTreeData = async (idTree: number) => {\n\t\t\t\n\t\t\t\tlet url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${idTree}/`;\n\t\t\t\tlet res = await fetch(url);\n\t\t\t\tlet data = await res.json();\n\t\n\t\t\t\tsetDataTreeForm(data);\n\t\t\t\tdispatch(actShowTreeTab(true));\n\t\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\t\t\t\t\t\n\t\t\t\tdispatch(actShowSidebar(true));\t\t\t\n\t\t\t\t\n\t\t\t\t//onMarkerClick(geojson);\n\t\t\t\t//console.log(geojson) \n\t\t\t\n\t\t}\n\n\n\t\tlet marker: L.Marker = e.target;\n\t\tlet geojson = marker.toGeoJSON(); //: GeoJSON.FeatureCollection<any>\n\t\t//console.log(geojson);\n\t\tif (geojson?.properties?.id) {\n\t\t\tfetchTreeData(geojson?.properties?.id);\n\t\t}   \n\t}\t\n\n\n\n\n\n\t\n\tconst onSubmitTree = (data: any) => {\n\t\tlet method;\n\t\tlet url;\n\t\tif (data.id) {\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.id}/`;\n\t\t\tmethod = \"PUT\";\n\t\t} else {\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/`;\n\t\t\tmethod = \"POST\";\n\t\t}\n\n\t\tconst succeedCallBack = () => {\n\t\t\tfetchTreesAndStatuses();\n\t\t\tdispatch(actNewMarkerState({ visible: false, position: {} }));\n\t\t\tdispatch(actActiveTabKey('filter'));\n\t\t\tdispatch(actShowTreeTab(false));\n\n\t\t\tif (isMobileView) {\n\t\t\t\tdispatch(actShowSidebar(false))\n\t\t\t}\t\t\t\n\t\t}\t\t\n\t\tfetchUrl(url, method, data, succeedCallBack);\n\t\t\n\t\t\n\t};\n\n\n\n\tconst onDeleteTree = (id: number) => {\n\t\tconst succeedCallBack = () => {\t\t\t\t\t\n\t\t\tdispatch(actActiveTabKey('filter'));\n\t\t\tdispatch(actShowTreeTab(false));\t\t\t\t\t\t\n\t\t\tfetchTreesAndStatuses();\t\t\t\t\n\t\t}\n\n\t\tfetchUrl(`${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${id}`, \"DELETE\", {}, succeedCallBack);\n\t};\n\n\n\tconst onCloseTree = () => {\n\t\tdispatch(actNewMarkerState({ visible: false, position: {} }));\n\t\tdispatch(actActiveTabKey('filter'));\n\t\tdispatch(actShowTreeTab(false));\n\t};\n\n\n\n\n\n\tconst fetchTreeData = async (idTree: number) => {\t\t\t\n\t\tlet url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${idTree}/`;\n\t\tlet res = await fetch(url);\n\t\tlet data = await res.json();\n\t\tsetDataTreeForm(data);\t\t\n\t}\n\n\tconst onSubmitInsp = (data: any) => {\n\t\tlet method;\n\t\tlet url;\n\t\tif (data.id) {\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.treeId}/inspections/${data.id}/`;\n\t\t\tmethod = \"PUT\";\n\t\t} else {\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.treeId}/inspections/`;\n\t\t\tmethod = \"POST\";\n\t\t}\n\n\t\tconst succeedCallBack = () => {\n\t\t\tfetchTreeData(data.treeId);\t\t\n\t\t\tfetchTreesAndStatuses();\n\t\t\tdispatch(actActiveTabKey('tree'));\n\t\t\tdispatch(actShowInspTab(false));\t\t\t\n\t\t}\n\n\t\tconsole.log('insp', data, url);\n\t\tfetchUrl(url, method, data, succeedCallBack);\n\t\t\t\n\t};\n\n\tconst onDeleteInsp = (data: InspItem | null) => {\n\t\tconst succeedCallBack = () => {\n\t\t\tif (data) {\n\t\t\t\tfetchTreeData(data.tree);\n\t\t\t\tdispatch(actActiveTabKey('tree'));\n\t\t\t\tdispatch(actShowInspTab(false));\t\t\t\t\t\t\n\t\t\t\tfetchTreesAndStatuses();\n\t\t\t}\t\t\n\t\t}\n\n\t\tif (data?.id) {\n\t\t\tconsole.log('DELETE', data)\n\t\t\t//path('citytree/<str:city>/trees/<str:treeid>/inspections/<str:inspid>/', views.citytreeInspectionItem, name=\"citytree-restapi-inspection-item\"),\n\t\t\tfetchUrl(`${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/0/inspections/${data.id}`, \"DELETE\", {}, succeedCallBack);\n\t\t}\t\n\t};\t\n\n\tconst onCloseInsp = () => {\t\t\n\t\tdispatch(actShowInspTab(false));\n\t\tdispatch(actActiveTabKey('tree'));\t\t\n\t};\t\n\n\tconst onNewInsp = (idTree: number) => {\n\t\tsetDataInspForm({tree: idTree});\n\t\tdispatch(actShowInspTab(true));\n\t\tdispatch(actActiveTabKey('insp'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\t\t\t\n\n\t}\n\n\tconst onEditInsp = (data: any) => {\n\t\tconsole.log('onEditInsp', data);\t\t\n\t\tsetDataInspForm({...data}); //таким образом передается копия объекта, которая указывает на другой участок памяти, иначе useEffect не срабатывает у формы, а значит форма не перезаполняется, когда например чтото поменяли на форме, затем ее закрыли без сохранения и снова открыли, видим вместо актуальных данных, старые, которые не сохранялись\n\t\tdispatch(actShowInspTab(true));\n\t\tdispatch(actActiveTabKey('insp'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\t\t\n\t}\t\n\n\tconst onClickInspPhotos = (data: any) => {\n\t\tconsole.log('onClickPhotos', data);\t\t\n\t\t\n\t\tconst images: string[] = [];\n\t\tif (data?.photo1) {\n\t\t\timages.push(`${data.photoServer}${data?.photo1}`);\n\t\t}\n\t\tif (data?.photo2) {\n\t\t\timages.push(`${data.photoServer}${data?.photo2}`);\n\t\t}\n\t\tif (data?.photo3) {\n\t\t\timages.push(`${data.photoServer}${data?.photo3}`);\n\t\t}\t\t\t\t\n\n\t\tif (images.length > 0) {\n\t\t\tsetImageSlider({visible: true, images: images});\n\t\t}\t\t\t\t\t\n\t}\t\t\n\n\t\t\n\n\n\tconst onClickMap = (e: any) => {\n\t\tif (rxCheckButtonNewMarker && !rxIsMobileDevice) {\n\t\t\tdispatch(actCheckButtonNewMarker(false));\n\n\t\t\tlet coord = { lat: '0', lng: '0' };\n\t\t\tcoord.lat = e.latlng.lat.toFixed(5);\n\t\t\tcoord.lng = e.latlng.lng.toFixed(5);\n\t\t\t\n\t\t\tdispatch(actNewMarkerState({ visible: true, position: coord }));\n\n\t\t\tdispatch(actShowTreeTab(true));\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\t\t\t\t\t\n\t\t\tdispatch(actShowSidebar(true));\t\n\t\t}\t\t\n\t}\n\n\tconst onZoomEnd = (e: any) => {\n\t\tconsole.log('zoom', e.target._zoom);\n\t\tsetCurrentZoomMap(e.target._zoom);\n\t}\n\t\n\tconst onEachLayer = (layer: L.Layer, zoom: number) => {\n\t\t//@ts-ignore\n\t\tconst crowndiameter = layer?.feature?.properties?.lastinsp_crowndiameter;\n\t\tif (crowndiameter) {\n\t\t\t//@ts-ignore\n\t\t    layer.setRadius(ZoomToRadius(zoom, crowndiameter));                    \n\t\t\t\n\t\t} \t\t\n\t}\t\n\t\n\n\tconst onDragEndNewMarker = (LatLng: { lon: number; lat: number }) => {\n\t\t//let coord = { lat: 0, lng: 0 };\n\t\t//coord.lat = LatLng.lat.toFixed(5);\n\t\t//coord.lng = LatLng.lng.toFixed(5);\n\t\t//setNewMarkerState({ visible: true, position: coord });\n\t};\n\n\tconst filterMapCallback = (feature: any): boolean => {\n\t\t\n\t\tconst objectSearchResult = {\n\t\t\tspecies: true,\n\t\t\tstatus: true,\n\t\t\trecommendations: true,\n\t\t\tremarks: true,\n\t\t\tplacetype: true,\n\t\t\tirrigationmethod: true,\n\t\n\t\t\tplantedDateFrom: true,\n\t\t\tplantedDateTo: true,\n\t\t\taddedDateFrom: true,\n\t\t\taddedDateTo: true,\n\t\t\tcomment: true,\n\t\n\t\t\theightFrom: true,\n\t\t\theightTo: true,\n\t\t\ttrunkGirthFrom: true,\n\t\t\ttrunkGirthTo: true,\n\t\t\tcrownDiameterFrom: true,\n\t\t\tcrownDiameterTo: true,\n\t\n\t\t\tshowOnlyMyTrees: true\t\t\t\n\t\t}\n\n\t\tlet valueFilter;\n\n\t\t\t\t\n\t\tvalueFilter = rxDataFilters?.speciesFilter;\n\t\tif (Array.isArray(valueFilter)) {\n\t\t\tobjectSearchResult.species = isFoundArrayInValue(valueFilter, feature.properties.species);\t\t\t\n\t\t}\n\n\t\tvalueFilter = rxDataFilters?.statusFilter;\n\t\tif (Array.isArray(valueFilter)) {\n\t\t\tobjectSearchResult.status = isFoundArrayInValue(valueFilter, feature.properties.lastinsp_status);\t\t\t\n\t\t}\n\n\n\t\tvalueFilter = rxDataFilters?.careTypeFilter;\n\t\tif (Array.isArray(valueFilter)) {\n\t\t\tobjectSearchResult.recommendations = isFoundArrayInArray(valueFilter, feature.properties.recommendations);\n\t\t}\t\n\t\t\n\t\tvalueFilter = rxDataFilters?.remarkFilter;\n\t\tif (Array.isArray(valueFilter)) {\n\t\t\tobjectSearchResult.remarks = isFoundArrayInArray(valueFilter, feature.properties.remarks);\n\t\t}\t\t\n\n\n\n\t\tvalueFilter = rxDataFilters?.placeTypeFilter?.value;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.placetype = valueFilter === feature.properties.placetype;\n\t\t}\n\n\t\tvalueFilter = rxDataFilters?.irrigationMethodFilter?.value;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.irrigationmethod = valueFilter === feature.properties.irrigationmethod;\n\t\t}\t\n\t\t\n\t\tvalueFilter = rxDataFilters?.datePlantedFromFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.plantedDateFrom =\n\t\t\t\tfeature.properties.dateplanted >= valueFilter;\n\t\t}\n\t\tvalueFilter = rxDataFilters?.datePlantedToFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.plantedDateTo =\n\t\t\t\tfeature.properties.dateplanted <= valueFilter;\n\t\t}\t\n\t\t\n\t\tvalueFilter = rxDataFilters?.dateAddedFromFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.addedDateFrom =\n\t\t\t\tfeature.properties.datetimeadded >= valueFilter;\n\t\t}\n\t\tvalueFilter = rxDataFilters?.dateAddedToFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.addedDateTo =\n\t\t\t\tfeature.properties.datetimeadded <= valueFilter;\n\t\t}\t\n\t\t\n\t\tvalueFilter = rxDataFilters?.commentFilter;\n\t\tif (valueFilter) {\n\t\t\tif (\n\t\t\t\tfeature.properties.comment\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.indexOf(valueFilter.toLowerCase()) === -1\n\t\t\t) {\n\t\t\t\tobjectSearchResult.comment = false;\n\t\t\t}\n\t\t}\t\t\n\n\n\t\t\n\t\tvalueFilter = rxDataFilters?.heightFromFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.heightFrom = feature.properties.lastinsp_height >= valueFilter;\n\t\t}\n\t\tvalueFilter = rxDataFilters?.heightToFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.heightTo = feature.properties.lastinsp_height <= valueFilter;\n\t\t}\t\n\t\t\n\t\tvalueFilter = rxDataFilters?.trunkGirthFromFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.trunkGirthFrom = feature.properties.lastinsp_trunkgirth >= valueFilter;\n\t\t}\n\t\tvalueFilter = rxDataFilters?.trunkGirthToFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.trunkGirthTo = feature.properties.lastinsp_trunkgirth <= valueFilter;\n\t\t}\t\n\t\t\n\t\tvalueFilter = rxDataFilters?.crownDiameterFromFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.crownDiameterFrom = feature.properties.lastinsp_crowndiameter >= valueFilter;\n\t\t}\n\t\tvalueFilter = rxDataFilters?.crownDiameterToFilter;\n\t\tif (valueFilter) {\n\t\t\tobjectSearchResult.crownDiameterTo = feature.properties.lastinsp_crowndiameter <= valueFilter;\n\t\t}\t\t\n\n\n\n\t\tvalueFilter = rxDataFilters?.showMyTreesFilter;\n\t\tif (valueFilter && authToken?.user) {\n\t\t\tobjectSearchResult.showOnlyMyTrees = authToken.user.id === feature.properties.useradded;\t\n\t\t}\n\n\n\t\tlet result = true;\n\t\tfor (const el in objectSearchResult) {\n\t\t\t//@ts-ignore\n\t\t\tif (objectSearchResult[el] === false) {\n\t\t\t\tresult = false;\n\t\t\t\tbreak;\n\t\t\t}\t\t\t\n\t\t}\n\t\t\t \t\t\n\t\t//rxDataTrees.dateTimeGenerated = Date.now(); // dateTimeGenerated is used like key parameter to update data on map, when it changed\n\t\treturn result;\n\t};\n\n\tfunction isFoundArrayInValue(array: {value: number}[], value: number) {\n\t\tfor (let el of array) {\n\t\t\tif (el.value === value) {\n\t\t\t\treturn true;\t\t\t\t\n\t\t\t}\t\t\t\t\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction isFoundArrayInArray(arraySearch: {value: number}[], arrayTree: string[]){\n\t\tconst intersection = arraySearch.filter((x) => {\n\t\t\treturn arrayTree.includes(String(x.value));\n\t\t});\n\t\treturn intersection.length > 0;\n\t}\t\n\n\n\n\tconst onSubmitFilter = (filter: {}) => {\n\t\tconsole.log(filter);\n\t\tdataHeatmapPoints = [];\n\t\t\n\t\trxDataTrees.dateTimeGenerated = Date.now(); // dateTimeGenerated is used like key parameter to update data on map, when it changed. <GeoJSON key={mainData.dateTimeGenerated}...\n\t\tdispatch(actDataFilters(filter));\t\n\n\t\tif (isMobileView) {\n\t\t\tdispatch(actShowSidebar(false))\n\t\t}\n\t};\n\n\n\n\tfunction pointToLayerTrees(feature: any, latlng: L.LatLng): any {   \n\t\tif (!rxCheckButtonHeatmap) {\n\t\t\t// change color of point depends on them status\n\t\t\tif (feature.properties.lastinsp_status) {\n\t\t\t\tif (Array.isArray(rxDictStatuses)) {\n\t\t\t\t\trxDictStatuses.forEach(element => {\n\t\t\t\t\tif (element.id === feature.properties.lastinsp_status) {\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.fillColor = `#${element.hexcolor}`;\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.color = `#${element.hexcolor}`;\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.radius = ZoomToRadius(currentZoomMap, feature.properties.lastinsp_crowndiameter);\n\t\t\t\t\t}\t\n\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t \n\t\t\treturn L.circle(latlng, geojsonMarkerOptions_citytree).on('click', markerOnClick);\n\t\t}\n\t\t\treturn null;\n\t};\n\n\tfunction ZoomToRadius (zoom: number, crowndiameter: number) {\n\t\t// + 21...13 -\n\t\tlet r = Math.floor(crowndiameter / 2);\n\t\tif (zoom < 19) r = r + (18-zoom)*5;\n\t\tif (r < 2) r=2;\n\t\treturn r; \t\t\n\t}\t\n\n\n\n\treturn (\t\t\n\t\t<MainWrapper cityName={paramsRouter.cityName}>\n\t\t\t<>\t\t\t\t\t\t\t\t\t\n\t\t\t\t<Sidebar>\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\tid=\"controlled-tab-example\"\n\t\t\t\t\t\tactiveKey={rxActiveTabKey}\n\t\t\t\t\t\tonSelect={(k) => dispatch(actActiveTabKey(k))}\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tclassName=\"mb-3\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"filter\"\n\t\t\t\t\t\t\ttitle={t<string>(\"sidebar.filterTab.title\")}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormFilter onSubmitFilter={onSubmitFilter}  \n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\n\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"tree\"\n\t\t\t\t\t\t\ttitle={t<string>(\n\t\t\t\t\t\t\t\t\"sidebar.treeTab.title\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\ttabClassName={\n\t\t\t\t\t\t\t\t!rxShowTreeTab ? \"d-none\" : \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormTree \n\t\t\t\t\t\t\t\t\tonSubmitTree={onSubmitTree}\n\t\t\t\t\t\t\t\t\tonDeleteTree={onDeleteTree}\n\t\t\t\t\t\t\t\t\tonCloseTree={onCloseTree} \n\t\t\t\t\t\t\t\t\tonNewInsp={onNewInsp}\n\t\t\t\t\t\t\t\t\tonEditInsp={onEditInsp}\n\t\t\t\t\t\t\t\t\tonClickInspPhotos={onClickInspPhotos}\n\t\t\t\t\t\t\t\t\tdataTreeForm={dataTreeForm}\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\t\tcity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t\tsigningS3Url={signingS3Url}\n\t\t\t\t\t\t\t\t\t//currentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\n\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"insp\"\n\t\t\t\t\t\t\ttitle={t<string>(\n\t\t\t\t\t\t\t\t\"sidebar.inspTab.title\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\ttabClassName={\n\t\t\t\t\t\t\t\t!rxShowInspTab ? \"d-none\" : \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormInspection \n\t\t\t\t\t\t\t\t\tonSubmitInsp={onSubmitInsp}\n\t\t\t\t\t\t\t\t\tonDeleteInsp={onDeleteInsp}\n\t\t\t\t\t\t\t\t\tonCloseInsp={onCloseInsp} \n\t\t\t\t\t\t\t\t\tdataInspForm={dataInspForm}\n\t\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\t\tcity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t\tsigningS3Url={signingS3Url}\n\t\t\t\t\t\t\t\t\t//currentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\t\t\t\t\t\t\t\t\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Sidebar>\n\n\t\t\t\t<div id=\"page-content-wrapper\">\n\t\t\t\t\t<MenuGlobal\n\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t//onClickShowMenu={ () => dispatch(actShowSidebar(!rxShowSidebar)) }\n\t\t\t\t\t\tauthToken={authToken}\n\t\t\t\t\t\tsetAuthToken={setAuthToken}\n\t\t\t\t\t\tappname=\"citytree\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"container-fluid\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tpaddingRight: \"0px\",\n\t\t\t\t\t\t\tpaddingLeft: \"0px\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Map\n\t\t\t\t\t\t\tmainData={rxDataTrees}\n\t\t\t\t\t\t\tappname=\"citytree\"\n\t\t\t\t\t\t\tdataHeatmapPoints={dataHeatmapPoints}\n\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\tonClickMap={onClickMap}\n\t\t\t\t\t\t\tonZoomEnd={onZoomEnd}\n\t\t\t\t\t\t\tonEachLayer={onEachLayer}\n\t\t\t\t\t\t\t//={onMarkerClick}\n\t\t\t\t\t\t\tonDragEndNewMarker={onDragEndNewMarker}\n\t\t\t\t\t\t\tpointToLayerCallback={pointToLayerTrees}\n\t\t\t\t\t\t\tfilterMapCallback={filterMapCallback}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n\t\t\t\t{rxShowOkCancelMobileMarker && (\n\t\t\t\t\t<ButtonOkCancelMobileMarker/>\n\t\t\t\t)}\n\n\t\t\t\t<ImageSlider \n\t\t\t\t\tvisible={imageSlider.visible} \n\t\t\t\t\tsetVisible={setImageSlider} \n\t\t\t\t\timages={imageSlider.images}\n\t\t\t\t/>\n\n\t\t\t\t<LoginModalForm setAuthToken={setAuthToken}/>\n\t\t\t\t<RegisterModalForm setAuthToken={setAuthToken}/> \t\t\t\n\t\t\t</>\n\t\t</MainWrapper>\n\n\t);\n\n\n\tfunction getCookie(name: string) {\n\t\tvar cookieValue = null;\n\t\tif (document.cookie && document.cookie !== \"\") {\n\t\t\tvar cookies = document.cookie.split(\";\");\n\t\t\tfor (var i = 0; i < cookies.length; i++) {\n\t\t\t\tvar cookie = cookies[i].trim();\n\t\t\t\t// Does this cookie string begin with the name we want?\n\t\t\t\tif (cookie.substring(0, name.length + 1) === name + \"=\") {\n\t\t\t\t\tcookieValue = decodeURIComponent(\n\t\t\t\t\t\tcookie.substring(name.length + 1)\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn cookieValue;\n\t}\n\n\n\n\n\n\n\tfunction fetchUrl(url: string, method: string, bodyObject?: any, callBackSucceed?: () => void) {\n\t\tlet myHeaders = new Headers();\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");\n\t\t\n\t\tif (csrftoken) {\n\t\t\tmyHeaders.append(\"X-CSRFToken\", csrftoken);\n\t\t}\t\n\t\tif (authToken?.access) {\n\t\t\tmyHeaders.append(\"Authorization\", \"Bearer \" + authToken.access);\n\t\t}\n\n\n\t\tconsole.log('myHeaders',myHeaders.get('Authorization'));\n\n\t\tfetch(url, {\n\t\t\tmethod: method,\n\t\t\theaders: myHeaders,\n\t\t\tbody: JSON.stringify(bodyObject),\n\t\t}).then(function (response) {\n\t\t\tif (response.status >= 400) {\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\talert(\n\t\t\t\t\t\tresponse.statusText +\n\t\t\t\t\t\t\t\" (\" +\n\t\t\t\t\t\t\tresponse.status +\n\t\t\t\t\t\t\t\")\\n\\n\" +\n\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tif (callBackSucceed) {\n\t\t\t\t\tcallBackSucceed();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\n\n    function refreshAuthToken(refreshToken: string){\n\t\tlet myHeaders = new Headers();\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");\n\t\tif (csrftoken) {\n\t\t\tmyHeaders.append(\"X-CSRFToken\", csrftoken);\n\t\t}\t\n\n        fetch(`${process.env.REACT_APP_API_URL}token/refresh/`, {\n            method: \"POST\",\n            headers: myHeaders,\n            body: JSON.stringify({ refresh: refreshToken }),\n\n        }).then(function (response) {\n            if (response.status == 200) {\n                response.json().then((data) => {    \n                    //setAuthToken({access: data.access, refresh: authToken.refresh})\n                    setAuthToken(data)\n                });\n            } else if (response.status >= 400) {\n                setAuthToken(null)    \n            }\n        });\n    };\n\n\n    function checkAuthToken() {\n\t\tlet body = { token: authToken.access }\n\t\tlet url = `${process.env.REACT_APP_API_URL}token/verify/`;\n\t\tlet myHeaders = new Headers();\n\n\t\tmyHeaders.append(\"Content-type\", \"application/json\");\n\t\tif (csrftoken) {\n\t\t\tmyHeaders.append(\"X-CSRFToken\", csrftoken);\n\t\t}\t\n\n\t\tfetch(url, {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: myHeaders,\n\t\t\tbody: JSON.stringify(body),\n\n\t\t}).then(function (response) {\n\t\t\tif (response.status >= 400) {\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\tconsole.log(\">= 400\", data);\n\n                    refreshAuthToken(authToken.refresh)\n\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tresponse.json().then((data) => {\n\t\t\t\t\tconsole.log(\"ok\", data);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t};\n\n\n}\n\n\n\nexport default App;\n","import { useState } from 'react';\r\n\r\nexport default function useAuthToken() {\r\n    \r\n    const getUsernameFromToken = (json: {access: string; refresh: string}) =>{\r\n        let token = json?.access \r\n\r\n        if (token) {\r\n            const arToken = token.split('.')\r\n            if (arToken.length > 1) {\r\n                return {\r\n                    \"name\": JSON.parse(atob(arToken[1])).username,\r\n                    \"id\": JSON.parse(atob(arToken[1])).user_id\r\n                }    \r\n            }\r\n        }\r\n    }\r\n    \r\n    const getToken = () => {\r\n        let tokenString\r\n        const rememberme = localStorage.getItem('rememberme')\r\n\r\n        if (rememberme==='true') {\r\n            tokenString = localStorage.getItem('token')\r\n        } else {\r\n            tokenString = sessionStorage.getItem('token')\r\n        }\r\n        \r\n\r\n        if (tokenString) {\r\n            let json = JSON.parse(tokenString)\r\n            const user = getUsernameFromToken(json)\r\n            if (user) {\r\n                json.user = user\r\n            }            \r\n            return json\r\n        } else {\r\n            return null\r\n        }\r\n      };\r\n\r\n    const [authToken, setAuthToken] = useState(getToken());\r\n\r\n\r\n    const saveToken = (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => {\r\n        if (userToken) {\r\n\r\n            const rememberme = localStorage.getItem('rememberme')\r\n\r\n            if (rememberme === 'true') {\r\n                localStorage.setItem('token', JSON.stringify(userToken));\r\n            } else {\r\n                sessionStorage.setItem('token', JSON.stringify(userToken));\r\n            }\r\n            \r\n            \r\n            const user = getUsernameFromToken(userToken)\r\n            if (user) {\r\n                userToken.user = user\r\n            }            \r\n        } else {\r\n            localStorage.removeItem(\"token\")    \r\n            localStorage.removeItem(\"rememberme\") \r\n            sessionStorage.removeItem(\"token\")\r\n        }           \r\n        setAuthToken(userToken);\r\n    };    \r\n\r\n\r\n    return {\r\n        setAuthToken: saveToken,\r\n        authToken\r\n    }    \r\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import i18n from 'i18next';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\n\r\nimport translationEN from './locales/en/translation.json';\r\nimport translationBG from './locales/bg/translation.json';\r\nconst availableLanguages = ['en', 'bg'];\r\n\r\n\r\ni18n\r\n    .use(LanguageDetector)\r\n    .use(initReactI18next) // passes i18n down to react-i18next\r\n    .init({\r\n        // the translations\r\n        // (tip move them in a JSON file and import them,\r\n        // or even better, manage them via a UI: https://react.i18next.com/guides/multiple-translation-files#manage-your-translations-with-a-management-gui)\r\n        resources: {\r\n            en: {\r\n                translation: translationEN\r\n            },\r\n\r\n            bg: {\r\n                translation: translationBG\r\n            }      \r\n        },\r\n        //lng: \"bg\", // if you're using a language detector, do not define the lng option\r\n        //lng: localStorage.getItem('lng') || 'en',\r\n        fallbackLng: \"en\",\r\n\r\n        interpolation: {\r\n        escapeValue: false // react already safes from xss => https://www.i18next.com/translation-function/interpolation#unescape\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\nexport default i18n;","const initialState = {\r\n    showSidebar: false,\r\n    showTreeTab: false,\r\n    showInspTab: false,\r\n    activeTabKey: 'filter',\r\n    loginModalShow: false,\r\n    registerModalShow: false,\r\n\r\n    mapBaseLayerName: 'Default',\r\n    newMarkerState: {\r\n\t\tvisible: false,\r\n\t\tposition: {},\r\n\t\tisMobile: false\r\n\t},\r\n    showOkCancelMobileMarker: false,\r\n    checkButtonNewMarker: false,\r\n    checkButtonHeatmap: false,\r\n    checkButtonGPS: false,\r\n\r\n    isMobileDevice: false\r\n}\r\n\r\nconst uiReducer = (state=initialState, action: {type: string; payload: any}) => {\r\n    switch (action.type) {\r\n        case 'SHOWSIDEBAR':\r\n            return {\r\n                ...state,\r\n                showSidebar: action.payload\r\n            }\r\n        case 'SHOWTREETAB':\r\n            return {\r\n                ...state,\r\n                showTreeTab: action.payload\r\n            }   \r\n        case 'SHOWINSPTAB':\r\n            return {\r\n                ...state,\r\n                showInspTab: action.payload\r\n            }                      \r\n        case 'ACTIVETABKEY':\r\n            return {\r\n                ...state,\r\n                activeTabKey: action.payload\r\n            }                                              \r\n        case 'LOGINMODALSHOW':\r\n            return {\r\n                ...state,\r\n                loginModalShow: action.payload\r\n            }\r\n\r\n        case 'REGISTERMODALSHOW':\r\n            return {\r\n                ...state,\r\n                registerModalShow: action.payload\r\n            }    \r\n        \r\n\r\n\r\n        case 'MAPBASELAYERNAME':\r\n            return {\r\n                ...state,\r\n                mapBaseLayerName: action.payload\r\n            } \r\n            \r\n        case 'NEWMARKERSTATE':\r\n            return {\r\n                ...state,\r\n                newMarkerState: action.payload\r\n            } \r\n\r\n        case 'SHOWOKCANCELMOBILEMARKER':\r\n            return {\r\n                ...state,\r\n                showOkCancelMobileMarker: action.payload\r\n            }              \r\n        \r\n        case 'CHECKBUTTONNEWMARKER':\r\n            return {\r\n                ...state,\r\n                checkButtonNewMarker: action.payload\r\n            }\r\n        case 'CHECKBUTTONHEATMAP':\r\n            return {\r\n                ...state,\r\n                checkButtonHeatmap: action.payload\r\n            }            \r\n        case 'CHECKBUTTONGPS':\r\n            return {\r\n                ...state,\r\n                checkButtonGPS: action.payload\r\n            }            \r\n                        \r\n\r\n\r\n        case 'ISMOBILEDEVICE':\r\n            return {\r\n                ...state,\r\n                isMobileDevice: action.payload\r\n            }\r\n\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default uiReducer","const initialState = {\r\n    dataTrees: [],\r\n    dataFilters: {},\r\n    dictStatuses: [],\r\n    dictSpecieses: [],\r\n    dictCareTypes: [],\r\n    dictRemarks: [], \r\n    dictPlaceTypes: [],\r\n    dictIrrigationMethods: [], \r\n    dictGroupSpec: [],\r\n    dictTypeSpec: [] \r\n}\r\n\r\nconst dataReducer = (state=initialState, action: {type: string; payload: any}) => {\r\n    switch (action.type) {\r\n        case 'DATATREES':\r\n            return {\r\n                ...state,\r\n                dataTrees: action.payload\r\n            }\r\n\r\n        case 'DICTSTATUSES':\r\n            return {\r\n                ...state,\r\n                dictStatuses: action.payload\r\n            }\r\n\r\n        case 'DICTSPECIESES':\r\n            return {\r\n                ...state,\r\n                dictSpecieses: action.payload\r\n            }      \r\n\r\n        case 'DICTCARETYPES':\r\n            return {\r\n                ...state,\r\n                dictCareTypes: action.payload\r\n            }  \r\n\r\n        case 'DICTREMARKS':\r\n            return {\r\n                ...state,\r\n                dictRemarks: action.payload\r\n            }  \r\n\r\n        case 'DICTPLACETYPES':\r\n            return {\r\n                ...state,\r\n                dictPlaceTypes: action.payload\r\n            }    \r\n            \r\n        case 'DICTIRRIGATIONMETHODS':\r\n            return {\r\n                ...state,\r\n                dictIrrigationMethods: action.payload\r\n            }   \r\n            \r\n        case 'DICTGROUPSPECS':\r\n            return {\r\n                ...state,\r\n                dictGroupSpec: action.payload\r\n            }             \r\n            \r\n        case 'DICTTYPESPECS':\r\n            return {\r\n                ...state,\r\n                dictTypeSpec: action.payload\r\n            }             \r\n\r\n        case 'DATAFILTERS':\r\n            return {\r\n                ...state,\r\n                dataFilters: action.payload\r\n            }\r\n\r\n\r\n        default:\r\n            return state            \r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport default dataReducer","import uiReducer from './userInterface'\r\nimport dataReducer from './dataApp'\r\nimport { combineReducers } from 'redux'\r\n\r\nexport const allReducers = combineReducers({\r\n    uiReducer,\r\n    dataReducer    \r\n});\r\n\r\n//export default allReducers\r\nexport type RootState = ReturnType<typeof allReducers>","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\nimport './sidebar.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport './i18nextConf';\nimport { createStore } from 'redux';\nimport { allReducers } from './reducers/index.ts';\nimport { Provider } from 'react-redux';\n\n// Importing the Bootstrap CSS\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst store = createStore(\n  allReducers,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n)\n\nReactDOM.render(\n  <Provider store={store}>\n  <React.StrictMode>\n    <BrowserRouter basename=\"/citytree\">\n      <Routes>\n        <Route path=\"/\" element={<App />}>\n          <Route path=\":cityName\" element={<App />} >\n            <Route path=\":treeId\" element={<App />} />\n          </Route>               \n        </Route>\n      </Routes>\n    </BrowserRouter>\n  </React.StrictMode>\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}