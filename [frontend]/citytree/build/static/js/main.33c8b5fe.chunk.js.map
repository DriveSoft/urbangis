{"version":3,"sources":["actions/index.js","components_hl/MenuGlobal.tsx","components_hl/ButtonMap.js","components_hl/MapTileLayers.tsx","components_hl/Map.tsx","components/images/markers/marker-red.png","components/images/markers/marker-shadow.png","components/MainWrapper.tsx","components/Sidebar.tsx","components/ButtonOkCancelMobileMarker.tsx","components/FormFilter.tsx","components/InspectionsList.tsx","components/images/no-photo.png","components/UploadPhotos.tsx","components/FormTree.tsx","components/FormInspection.tsx","components/ImageSlider.tsx","components/TreePreviewModal.tsx","constants/const.ts","utils/misc.ts","constants/urlsAPI.ts","auth/useAuthToken.tsx","components/LoginModalForm.tsx","components/RegisterModalForm.tsx","utils/filterDataMap.ts","utils/fetchAllDictionariesData.ts","i18nextConf.js","auth/permissions.ts","App.tsx","reportWebVitals.js","reducers/userInterface.tsx","reducers/dataApp.tsx","reducers/index.ts","index.js"],"names":["actNewTreeCreation","value","type","payload","actShowSidebar","actShowTreeTab","actShowInspTab","actActiveTabKey","actLoginModalShow","actRegisterModalShow","actMapBaseLayerName","actMapMarkerState","actShowOkCancelMobileMarker","actCheckButtonNewMarker","actCheckButtonGPS","actDataPermissions","actDataTrees","MenuGlobal","currentCity","appname","authToken","setAuthToken","dispatch","useDispatch","rxShowSidebar","useSelector","state","uiReducer","showSidebar","useState","expanded","setExpanded","cities","setCities","useTranslation","t","i18n","changeLanguage","useEffect","fetchCities","fetch","process","res","json","data","console","log","Navbar","bg","expand","collapseOnSelect","Container","Button","className","variant","id","onClick","Toggle","Collapse","Nav","Link","href","NavDropdown","title","Item","active","map","city","as","to","sysname","cityname","language","user","name","ButtonMap_","iconTrue","iconFalse","L","easyButton","position","states","stateName","icon","control","button","style","backgroundColor","addTo","MapTileLayers","heatMapLayer","setView_nTimes_gps","circle_geolocation","mapBaseLayerName","LayersControl","BaseLayer","checked","TileLayer","attribution","url","accessToken","maxZoom","tileSize","zoomOffset","subdomains","bingkey","redIcon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","currentCitySysname","Map","mainData","dataHeatmapPoints","onDragEndNewMarker","onClickMap","onZoomEnd","onClickCreateNewMarker","onEachLayer","pointToLayerCallback","filterMapCallback","rxMapBaseLayerName","rxIsMobileDevice","isMobileDevice","rxMapMarkerState","mapMarkerState","rxShowOkCancelMobileMarker","showOkCancelMobileMarker","rxCheckButtonNewMarker","checkButtonNewMarker","rxCheckButtonHeatmap","checkButtonHeatmap","rxCheckButtonGPS","checkButtonGPS","currentCityInfo","setCurrentCityInfo","setMap","currentZoom","setCurrentZoom","buttonNewMarker","setButtonNewMarker","buttonHeatmap","setButtonHeatmap","buttonGPS","setButtonGPS","mapname_","document","cookie","split","find","row","startsWith","newMarkerRef","useRef","onClickNewMarker","onClickHeatmap","onClickGPS","remove","fetchCity","dateTimeGenerated","Date","now","DomUtil","addClass","_container","removeClass","window","setTimeout","invalidateSize","pan","visible","lat","lng","SetPanToMap","useMap","panTo","parseFloat","locate","enableHighAccuracy","watch","maximumAge","stopLocate","hasLayer","removeLayer","NewMarker","eventHandlers","useMemo","dragend","current","marker","LatLng","getLatLng","coord","toFixed","time","Promise","resolve","then","Marker","draggable","getCenter","ref","MapEvents","useMapEvents","baselayerchange","e","move","setLatLng","target","moveend","click","zoomend","_zoom","locationfound","radius","accuracy","setView","latlng","setRadius","circle","locationerror","alert","message","MarkersZoomAdjustment","zoom","getZoom","eachLayer","layer","onEachFeaturePoint","feature","HeatmapFunction","heatLayer","gradient","max","blur","addLayer","MapContainer","whenCreated","center","zoomControl","scrollWheelZoom","height","width","GeoJSON","pointToLayer","filter","onEachFeature","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","iconCreateFunction","cluster","digits","count","getChildCount","divIcon","html","toString","undefined","ZoomControl","MainWrapper","children","cityName","Sidebar","marginTop","ButtonOkCancelMobileMarker","FormFilter","onSubmitFilter","rxDictSpecieses","dataReducer","dictSpecieses","rxDictStatuses","dictStatuses","rxDictCareTypes","dictCareTypes","rxDictRemarks","dictRemarks","rxDictPlaceTypes","dictPlaceTypes","rxDictIrrigationMethods","dictIrrigationMethods","rxDictGroupSpecs","dictGroupSpec","useForm","reValidateMode","defaultValues","speciesFilter","statusFilter","careTypeFilter","remarkFilter","placeTypeFilter","irrigationMethodFilter","datePlantedFromFilter","datePlantedToFilter","dateAddedFromFilter","dateAddedToFilter","commentFilter","heightFromFilter","trunkGirthFromFilter","crownDiameterFromFilter","heightToFilter","trunkGirthToFilter","crownDiameterToFilter","showMyTreesFilter","handleSubmit","reset","optionsSpeciesesFilter","Array","isArray","unknownTreeItem","itemGroup","label","groupname","options","spec","groupspec","localname","speciesname","typespec","unshift","optionsStatusesFilter","x","statusname","optionsCareTypesFilter","carename","optionsRemarksFilter","remarkname","optionsPlaceTypesFilter","placename","optionsIrrigationMethodsFilter","irrigationname","customStyles","option","styles","paddingLeft","Option","props","color","Form","onSubmit","Group","controlId","Label","render","field","placeholder","isMulti","isSearchable","getOptionLabel","components","maxMenuHeight","Row","Col","minWidth","isClearable","Control","maxWidth","size","min","Check","inline","InspectionsList","inspectionsData","setInspectionsData","rxDataLastEditetTreeId","dataLastEditedTreeId","fetchInpections","idTree","element","buttons","push","iconFA","iconFASize","idButton","photo1","photo2","photo3","typeData","treeId","OnClickButtons","rowData","onClickButtonEditInsp","onClickButtonPhotosInsp","sortField","sortAsc","noDataTitle","columns","headerName","sortable","dateTimeOption","UploadPhotos","forwardRef","controlFromUseForm","signingS3Url","serverPhoto","onCallbackDone","photo1Ref","photo2Ref","photo3Ref","submit","success","submitData","setSubmitData","autoUpload","resizerOptions","enabled","autoResize","maxHeight","compressFormat","quality","rotation","useImperativeHandle","uploadPhotos","all","uploadFile","values","result","forEach","xs","signingUrl","emptyPhoto","noPhotoImage","resizer","FormTree","onSubmitTree","onDeleteTree","onCloseTree","onNewInsp","onClickInspEdit","onClickInspPhotos","onClickEditCoords","dataTreeForm","rxNewTreeCreation","newTreeCreation","showModalDelete","setShowModalDelete","submitButtonEnabled","setSubmitButtonEnabled","uploadPhotosRef","setValue","optionsIrrigationMethodsData","formData","latitude","longitude","species","species_id","isFound","optionsSpeciesesData","category","item","speciescomment","comment","placetype","optionsPlaceTypesData","irrigationmethod","dateplanted","googlestreeturl","keepDefaultValues","optionsStatusesData","optionsCareTypesData","optionsRemarksData","crowndiameter","trunkgirth","status","remarks","recommendations","useradded","getValues","errors","formState","trigger","preventDefault","prepareOnSubmitTree","inspection","parseInt","isSelected","isFocused","isDisabled","rules","required","step","isInvalid","Feedback","rows","pattern","isSuccessful","display","disabled","Modal","show","onHide","Header","closeButton","Title","Body","Footer","FormInspection","onSubmitInsp","onDeleteInsp","onCloseInsp","dataInspForm","isValid","tree","includes","prepareOnSubmitInsp","photoServer","ImageSlider","setVisible","images","dialogClassName","Carousel","interval","photo","src","RowTable","isValueIsLink","dateTimeToDate","dateTimeStr","dateTime","arDateTime","toISOString","length","TreePreviewModal","setTreePreview","onButtonEditTreeClick","handleClose","photos","isPrevNextControlsEnable","numberOfPhotos","lastinsp_photo1","lastinsp_photo2","lastinsp_photo3","itemPhoto","photoIndex","photoKeyName","hasOwnProperty","alt","controls","Table","striped","lastinsp_status","lastinsp_height","lastinsp_trunkgirth","lastinsp_crowndiameter","lastinsp_remarks","lastinsp_recommendations","inspData","csrftoken","cookieValue","cookies","i","trim","substring","decodeURIComponent","getCookie","fetchUrl2","method","bodyObject","tokenAccess","myHeaders","getHTTPHeader","headers","body","JSON","stringify","fetchResult","ok","fetchException","statusText","detail","this","Headers","append","URL_LOGIN","URL_REFRESH_TOKEN","URL_VERIFY_TOKEN","URL_GET_PERMISSIONS","URL_GENERATE_S3_URLKEY","URL_GET_DICT_SPECIESES","URL_GET_DICT_CARETYPES","URL_GET_DICT_REMARKS","URL_GET_DICT_PLACETYPES","URL_GET_DICT_IRRIGATIONMETHODS","URL_GET_DICT_GROUPSPECS","URL_GET_DICT_TYPESPECS","URL_GET_DICT_STATUSES","urlTreesByCity","urlTreeByCityAndID","checkAuthToken","access","isTokenValid","refreshTokens","refresh","urlCheckingToken","token","refreshToken","getNewAccessRefreshAuthToken","accessRefreshToken","urlRefreshingToken","response","LoginModalForm","rxLoginModalShow","loginModalShow","showWrongPassword","setShowWrongPassword","username","password","rememberme","credentials","centered","localStorage","setItem","loginUser","FloatingLabel","Text","RegisterModalForm","rxRegisterModalShow","registerModalShow","email","password2","first_name","last_name","setError","Object","entries","key","registerUser","isFoundArrayInValue","array","isFoundArrayInArray","arraySearch","arrayTree","String","fetchAllDictionariesData","fetchData","speciesesResponse","caretypesResponse","remarksResponse","placetypesResponse","irrigationmethodsResponse","groupspecsResponse","typespecsResponse","specieses","caretypes","placetypes","irrigationmethods","groupspecs","typespecs","apiURL","use","LanguageDetector","initReactI18next","init","resources","en","translation","translationEN","translationBG","fallbackLng","interpolation","escapeValue","initPermissions","is_superuser","view_tree","granted","deniedMessage","i18next","add_tree","change_tree","can_change_not_own_tree_record","can_delete_not_own_tree_record","delete_tree","view_inspection","add_inspection","change_inspection","can_change_not_own_insp_record","can_delete_not_own_insp_record","delete_inspection","careactivity","view_careactivity","has_perm","permObject","model","permName","getCurrentUserPermissions","initPermissionsRes","currentPermissions","citytree","arrayPerms","perm","geojsonMarkerOptions_citytree","fillColor","weight","opacity","fillOpacity","App","paramsRouter","useParams","navigate","useNavigate","rxDataPermissions","dataPermissions","rxDataTrees","dataTrees","rxDataFilters","dataFilters","rxActiveTabKey","activeTabKey","rxShowTreeTab","showTreeTab","rxShowInspTab","showInspTab","currentZoomMap","setCurrentZoomMap","tokenString","getItem","sessionStorage","parse","getUserInfoFromToken","getToken","arToken","atob","user_id","userToken","removeItem","useAuthToken","innerWidth","screenWidth","setScreenWidth","isMobileView","setDataTreeForm","setDataInspForm","imageSlider","setImageSlider","treePreview","fetchAllDictionariesDataWrapper","userAuthentication","test","navigator","userAgent","showTreePreview","addEventListener","handleWindowSizeChange","removeEventListener","actDictCareTypes","actDictRemarks","actDictPlaceTypes","actDictIrrigationMethods","actDictGroupSpecs","actDictTypeSpecs","catch","error","fetchTreesAndStatuses","URL","markerOnClick","geojson","toGeoJSON","properties","setInterval","keys","permResult","clearInterval","fetchTreeData","editTree","updateInspectionListsWithSpecificTreeId","ZoomToRadius","r","Math","floor","Tabs","activeKey","onSelect","k","Tab","eventKey","tabClassName","paddingRight","hexcolor","on","valueFilter","objectSearchResult","plantedDateFrom","plantedDateTo","addedDateFrom","addedDateTo","heightFrom","heightTo","trunkGirthFrom","trunkGirthTo","crownDiameterFrom","crownDiameterTo","showOnlyMyTrees","datetimeadded","toLowerCase","indexOf","el","filterDataMap","dot","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initialState","isMobile","action","dictTypeSpec","allReducers","combineReducers","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","StrictMode","basename","path","getElementById"],"mappings":"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","file":"static/js/main.33c8b5fe.chunk.js","sourcesContent":["// userInterface actions ================================================\r\nexport const actNewTreeCreation= (value) => {\r\n    return {\r\n        type: 'NEWTREECREATION',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowSidebar = (value) => {\r\n    return {\r\n        type: 'SHOWSIDEBAR',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowTreeTab = (value) => {\r\n    return {\r\n        type: 'SHOWTREETAB',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowInspTab = (value) => {\r\n    return {\r\n        type: 'SHOWINSPTAB',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actActiveTabKey = (value) => {\r\n    return {\r\n        type: 'ACTIVETABKEY',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actLoginModalShow = (value) => {\r\n    return {\r\n        type: 'LOGINMODALSHOW',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actRegisterModalShow = (value) => {\r\n    return {\r\n        type: 'REGISTERMODALSHOW',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const actMapBaseLayerName = (value) => {\r\n    return {\r\n        type: 'MAPBASELAYERNAME',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actMapMarkerState = (value) => {\r\n    return {\r\n        type: 'MAPMARKERSTATE',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actShowOkCancelMobileMarker = (value) => {\r\n    return {\r\n        type: 'SHOWOKCANCELMOBILEMARKER',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actCheckButtonNewMarker = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONNEWMARKER',\r\n        payload: value\r\n    }\r\n}\r\nexport const actCheckButtonHeatmap = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONHEATMAP',\r\n        payload: value\r\n    }\r\n}\r\nexport const actCheckButtonGPS = (value) => {\r\n    return {\r\n        type: 'CHECKBUTTONGPS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actIsMobileDevice = (value) => {\r\n    return {\r\n        type: 'ISMOBILEDEVICE',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// date actions ================================================\r\nexport const actDataPermissions= (value) => {\r\n    return {\r\n        type: 'DATAPERMISSIONS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDataTrees= (value) => {\r\n    return {\r\n        type: 'DATATREES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDataLastEditedTreeId= (value) => {\r\n    return {\r\n        type: 'DATALASTEDITEDTREEID',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictStatuses = (value) => {\r\n    return {\r\n        type: 'DICTSTATUSES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictSpecieses = (value) => {\r\n    return {\r\n        type: 'DICTSPECIESES',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\nexport const actDictCareTypes = (value) => {\r\n    return {\r\n        type: 'DICTCARETYPES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictRemarks = (value) => {\r\n    return {\r\n        type: 'DICTREMARKS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictPlaceTypes = (value) => {\r\n    return {\r\n        type: 'DICTPLACETYPES',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictIrrigationMethods = (value) => {\r\n    return {\r\n        type: 'DICTIRRIGATIONMETHODS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictGroupSpecs = (value) => {\r\n    return {\r\n        type: 'DICTGROUPSPECS',\r\n        payload: value\r\n    }\r\n}\r\n\r\nexport const actDictTypeSpecs = (value) => {\r\n    return {\r\n        type: 'DICTTYPESPECS',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const actDataFilters = (value) => {\r\n    return {\r\n        type: 'DATAFILTERS',\r\n        payload: value\r\n    }\r\n}\r\n\r\n\r\n","import { useState, useEffect } from 'react'\r\nimport Container from 'react-bootstrap/Container';\r\nimport Navbar from 'react-bootstrap/Navbar'\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport NavDropdown from 'react-bootstrap/NavDropdown';\r\nimport Button from 'react-bootstrap/Button';\r\nimport { Link } from \"react-router-dom\";\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { actLoginModalShow, actShowSidebar } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\ninterface IStateCities {\r\n\tcities: {\r\n\t\tid: number\r\n\t\tsysname: string;\r\n\t\tcityname: string;\r\n\t\tlatitude: number;\r\n\t\tlongitude: number;\r\n\t\tpopulation: number;\r\n\t}[]\r\n}\r\n\r\ninterface MenuGlobalProps {\r\n\tcurrentCity: string;\r\n\tappname: string;\r\n\tauthToken: any;\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n  }\r\n\r\n\r\n\r\nfunction MenuGlobal({\r\n\tcurrentCity,\r\n\tappname,\r\n\tauthToken,\r\n\tsetAuthToken,\r\n}: MenuGlobalProps) {\r\n\tconst dispatch = useDispatch();\r\n\tconst rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar)\r\n\tconst [expanded, setExpanded] = useState(false);\r\n\tconst [cities, setCities] = useState<IStateCities['cities']>([]);\r\n\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tconst fetchCities = async () => {\r\n\t\t\tconst res = await fetch(`${process.env.REACT_APP_API_URL}cities/`);\r\n\t\t\tconst data = await res.json();\r\n\t\t\tsetCities(data);\r\n\t\t\tconsole.log(data);\r\n\t\t};\r\n\r\n\t\tfetchCities();\r\n\t}, []);\r\n\r\n\tfunction changeLanguage(value: string) {\r\n\t\ti18n.changeLanguage(value);\r\n\t\t//localStorage.setItem('lng', value)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Navbar bg=\"light\" expand=\"lg\" expanded={expanded} collapseOnSelect >\r\n\t\t\t<Container>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tclassName=\"start-0\"\r\n\t\t\t\t\tvariant=\"outline-primary\"\r\n\t\t\t\t\tid=\"menu-toggle\"\r\n\t\t\t\t\t//onClick={onClickShowMenu}\r\n\t\t\t\t\tonClick={() => dispatch(actShowSidebar(!rxShowSidebar))}\r\n\t\t\t\t>\r\n\t\t\t\t\t{t<string>(\"menu.menu\")}\r\n\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t<Navbar.Toggle aria-controls=\"basic-navbar-nav\" onClick={() => setExpanded(!expanded)} />\r\n\t\t\t\t<Navbar.Collapse id=\"basic-navbar-nav\">\r\n\t\t\t\t\t<Nav className=\"ms-auto\">\r\n\t\t\t\t\t\t<Nav.Link href=\"/\">{t<string>(\"menu.home\")}</Nav.Link>\r\n\r\n\t\t\t\t\t\t<NavDropdown\r\n\t\t\t\t\t\t\ttitle={t<string>(\"menu.appMaps.title\")}\r\n\t\t\t\t\t\t\tid=\"basic-nav-dropdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/roadaccident/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"roadaccident\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.roadaccident\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/citytree/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"citytree\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.citytree\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\thref={`/urbanobject/${currentCity}`}\r\n\t\t\t\t\t\t\t\tkey=\"3\"\r\n\t\t\t\t\t\t\t\tactive={appname === \"urbanobject\"}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.appMaps.urbanobject\")}\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown\r\n\t\t\t\t\t\t\ttitle={t<string>(\"menu.city\")}\r\n\t\t\t\t\t\t\tid=\"basic-nav-dropdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{cities.map((city) => (\r\n\t\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\t\tas={Link}\r\n\t\t\t\t\t\t\t\t\tkey={city.id}\r\n\t\t\t\t\t\t\t\t\tto={`/${city.sysname}`}\r\n\t\t\t\t\t\t\t\t\tactive={currentCity === city.sysname}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{city.cityname}\r\n\t\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t<NavDropdown title=\"Lang\" id=\"basic-nav-dropdown\">\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"1\"\r\n\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\"en\" === i18n.language ||\r\n\t\t\t\t\t\t\t\t\t\"en-US\" === i18n.language ||\r\n\t\t\t\t\t\t\t\t\t\"en-GB\" === i18n.language\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvalue=\"en\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage(\"en\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEnglish\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\r\n\t\t\t\t\t\t\t<NavDropdown.Item\r\n\t\t\t\t\t\t\t\tkey=\"2\"\r\n\t\t\t\t\t\t\t\tactive={\"bg\" === i18n.language}\r\n\t\t\t\t\t\t\t\tvalue=\"bg\"\r\n\t\t\t\t\t\t\t\tonClick={() => changeLanguage(\"bg\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tBulgarian\r\n\t\t\t\t\t\t\t</NavDropdown.Item>\r\n\t\t\t\t\t\t</NavDropdown>\r\n\r\n\t\t\t\t\t\t{authToken ? (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Nav.Link>\r\n\t\t\t\t\t\t\t\t\t{`${t(\"words.hello\")}, ${\r\n\t\t\t\t\t\t\t\t\t\tauthToken?.user?.name\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\r\n\t\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetAuthToken(null);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{t<string>(\"menu.logout\")}\r\n\t\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Nav.Link\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t//onClick={() => setLoginModalShow(true)}\r\n\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(true))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"menu.signin\")}\r\n\t\t\t\t\t\t\t</Nav.Link>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Nav>\r\n\t\t\t\t</Navbar.Collapse>\r\n\t\t\t</Container>\r\n\t\t</Navbar>\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default MenuGlobal\r\n","// don't work with TypeScript, error: TypeError: leaflet__WEBPACK_IMPORTED_MODULE_0___default.a.easyButton is not a function\r\nimport L from 'leaflet';\r\nimport easyButton from 'leaflet-easybutton'\r\nimport \"leaflet-easybutton/src/easy-button.css\"\r\nimport \"@fortawesome/fontawesome-free/css/all.min.css\" \r\n \r\n\r\nfunction ButtonMap_ (map, iconTrue, iconFalse, onClick) {\r\n    //const map = useMap()\r\n    \r\n            const buttonMap = L.easyButton({\r\n                position: 'topright',\r\n                states:[\r\n                    {\r\n                        title: '',\r\n                        stateName: 'off',\r\n                        icon: `<i class=\"${iconTrue}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('on');\r\n                            //@ts-ignore\r\n                            control.button.style.backgroundColor = 'red';\r\n                            onClick(true)\r\n                        }\r\n                    },\r\n        \r\n                    {\r\n                        title: '',\r\n                        stateName: 'on',\r\n                        icon: `<i class=\"${iconFalse}\"></i>`,\r\n                        onClick: function(control){\r\n                            control.state('off');\r\n                            //@ts-ignore\r\n                            control.button.style.backgroundColor = 'white';\r\n                            onClick(false)\r\n                        }\r\n                    }]\r\n            }).addTo( map );\r\n\r\n\r\n\r\n            //if (checkButtonState) {\r\n            //    buttonMap.state('on');\r\n            //    buttonMap.button.style.backgroundColor = 'red';\r\n            //} else {\r\n            //    buttonMap.state('off');\r\n            //    buttonMap.button.style.backgroundColor = 'white';            \r\n            //}\r\n            \r\n            \r\n    \r\n    return buttonMap\r\n\r\n}\r\n\r\nexport default ButtonMap_\r\n","import React from \"react\"\r\nimport { LayersControl, TileLayer } from \"react-leaflet\"\r\n//@ts-ignore\r\nimport {BingLayer} from 'react-leaflet-bing-v2/src/index'\r\n\r\n\r\ninterface MapTileLayersProps {\r\n\tmapBaseLayerName: string;\r\n}\r\n\r\nfunction MapTileLayers({ mapBaseLayerName }: MapTileLayersProps) {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Default\"}\r\n\t\t\t\tname=\"Default\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/streets-v11\"\r\n\t\t\t\t\tmaxZoom={21}\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Dark\"}\r\n\t\t\t\tname=\"Dark\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/dark-v10\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tzoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Google\"}\r\n\t\t\t\tname=\"Google\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat1\"}\r\n\t\t\t\tname=\"Sat1\"\r\n\t\t\t>\r\n                <BingLayer  bingkey={'AniAD3xsGTaSbK1pa0_UkWS1CldG0nGI7r55MlVZqHhyKil9rD9dFK8536u8hTj1'} type=\"Aerial\"/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n            \r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat2\"}\r\n\t\t\t\tname=\"Sat2\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Google'\r\n\t\t\t\t\turl=\"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}\"\r\n                    maxZoom={20}\r\n                    subdomains={['mt0','mt1','mt2','mt3']}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat3\"}\r\n\t\t\t\tname=\"Sat3\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Tiles &copy; Esri'\r\n\t\t\t\t\turl=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\r\n                    maxZoom={19}                    \r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\r\n\t\t\t<LayersControl.BaseLayer\r\n\t\t\t\tchecked={mapBaseLayerName === \"Sat4\"}\r\n\t\t\t\tname=\"Sat4\"\r\n\t\t\t>\r\n\t\t\t\t<TileLayer\r\n\t\t\t\t\tattribution='Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> <a href=\"https://www.mapbox.com/\">Mapbox</a>'\r\n\t\t\t\t\turl=\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\"\r\n\t\t\t\t\taccessToken=\"pk.eyJ1IjoiZHJpdmVzb2Z0IiwiYSI6ImNqY3hkMzAwNTAwM2IzM28zajFoeG1pamYifQ.w5UaGnR0OMDIa6ARiyWoYQ\"\r\n\t\t\t\t\tid=\"mapbox/satellite-v9\"\r\n\t\t\t\t\ttileSize={512}\r\n\t\t\t\t\tmaxZoom={21}\r\n                    zoomOffset={-1}\r\n\t\t\t\t/>\r\n\t\t\t</LayersControl.BaseLayer>\r\n\r\n\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default MapTileLayers;\r\n","import { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { MapContainer, LayersControl, TileLayer, ZoomControl, useMapEvents, GeoJSON, useMap, Marker, Popup } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport \"leaflet.heat\";\r\nimport \"./Map.css\";\r\n\r\n//import ButtonMap from './ButtonMap'\r\nimport ButtonMap_ from './ButtonMap';\r\nimport MapTileLayers from '../components_hl/MapTileLayers';\r\n\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport redIconFile from '../components/images/markers/marker-red.png';\r\nimport redIconShadowFile from '../components/images/markers/marker-shadow.png';\r\n\r\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\r\nimport 'react-leaflet-markercluster/dist/styles.min.css'; // sass\r\n//require('leaflet/dist/leaflet.css'); // inside .js file\r\n//require('react-leaflet-markercluster/dist/styles.min.css'); // inside .js file\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport {\r\n\tactCheckButtonGPS,\r\n\tactCheckButtonHeatmap,\r\n\tactCheckButtonNewMarker,\r\n\tactMapBaseLayerName,\r\n\tactMapMarkerState,\r\n\tactShowOkCancelMobileMarker\r\n    //actShowAccidentTab,\r\n    //actActiveTabKey\r\n} from \"../actions\";\r\nimport { RootState } from '../reducers/index';\r\n\r\n\r\n// fix disapeared marker from map\r\n\r\n//import icon from 'leaflet/dist/images/marker-icon.png';\r\n//import iconShadow from 'leaflet/dist/images/marker-shadow.png';\r\n//let DefaultIcon = L.icon({\r\n//    iconAnchor: [12, 40],\r\n//    iconUrl: icon,\r\n//    shadowUrl: iconShadow\r\n//});\r\n//L.Marker.prototype.options.icon = DefaultIcon;\r\n\r\n\r\n\r\n\r\n\r\nlet redIcon = L.icon({ \r\n    iconUrl: redIconFile,\r\n    shadowUrl: redIconShadowFile,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41]\r\n  });\r\n\r\n//let buttonNewMarker = null\r\n//let buttonHeatmap = null\r\n//let buttonGPS = null\r\n\r\nlet currentCitySysname = ''\r\n\r\nlet heatMapLayer: any;\r\nlet markersLayer\r\n\r\nlet setView_nTimes_gps: number;\r\nlet circle_geolocation: L.Circle<any>;\r\n\r\ninterface IStateCurrentCity {\r\n    id: number\r\n\tsysname: string;\r\n\tcityname: string;\r\n\tlatitude: string;\r\n\tlongitude: string;\r\n\tpopulation: number;\t\r\n    zoom: number;\r\n}\r\n\r\ninterface MapProps {\r\n    mainData: any;\r\n    appname: string;\r\n    dataHeatmapPoints: number[][]; // [[lat, lng, value],[lat, lng, value]...]\r\n    currentCity: string;\r\n    onDragEndNewMarker: (LatLng: {lat: number; lng: number}) => void;\r\n    onClickMap: (e: any) => void;\r\n    onClickCreateNewMarker?: (state: boolean) => boolean | void;\r\n    onZoomEnd?: (e: any) => void;\r\n    onEachLayer?: (layer: L.Layer, zoom: number) => void;\r\n    //onMarkerClick: (data: any) => void;\r\n    pointToLayerCallback: (feature: any, latlng: L.LatLng) => any;\r\n    filterMapCallback: (feature: any) => boolean;\r\n}\r\n\r\nfunction Map ({\r\n                mainData,  \r\n                appname,          \r\n                dataHeatmapPoints, \r\n                currentCity,                 \r\n                onDragEndNewMarker, \r\n                onClickMap, \r\n                onClickCreateNewMarker,\r\n                onZoomEnd,  \r\n                onEachLayer,                            \r\n                //onMarkerClick,                 \r\n                pointToLayerCallback,\r\n                filterMapCallback               \r\n            }: MapProps) {\r\n               \r\n\r\n    const dispatch = useDispatch()\r\n    //const defaultZoom = 13;\r\n    //const rxDataAccidents = useSelector((state: RootState) => state.dataReducer.dataAccidents)\r\n    \r\n    const rxMapBaseLayerName = useSelector((state: RootState) => state.uiReducer.mapBaseLayerName);\r\n    const rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\r\n    const rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\r\n    const rxMapMarkerState = useSelector((state: RootState) => state.uiReducer.mapMarkerState);\r\n    const rxShowOkCancelMobileMarker = useSelector((state: RootState) => state.uiReducer.showOkCancelMobileMarker);\r\n    \r\n    const rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\r\n    const rxCheckButtonHeatmap = useSelector((state: RootState) => state.uiReducer.checkButtonHeatmap);\r\n    const rxCheckButtonGPS = useSelector((state: RootState) => state.uiReducer.checkButtonGPS);\r\n\r\n    //const [currentCityInfo, setCurrentCityInfo] = useState({latitude: \"0\", longitude: \"0\"})\r\n    const [currentCityInfo, setCurrentCityInfo] = useState<IStateCurrentCity | null>(null);\r\n    const [map, setMap] = useState<any>(null);  \r\n    \r\n    const [currentZoom, setCurrentZoom] = useState(13); \r\n\r\n    const [buttonNewMarker, setButtonNewMarker] = useState<any>(null);\r\n    const [buttonHeatmap, setButtonHeatmap] = useState<any>(null);\r\n    const [buttonGPS, setButtonGPS] = useState<any>(null);    \r\n\r\n    let mapname_ = document.cookie\r\n    .split('; ')\r\n    .find(row => row.startsWith('mapname='))\r\n\r\n    let mapname\r\n    if (mapname_) {\r\n        mapname = mapname_.split('=')[1]    \r\n    }\r\n\r\n\r\n    let newMarkerRef = useRef(null)   \r\n \r\n\r\n    // create buttons\r\n    useEffect(() => {        \r\n        if (map) {            \r\n            setButtonNewMarker( ButtonMap_(map, 'fas fa-map-marker-alt fa-lg', 'fas fa-map-marker-alt fa-lg', onClickNewMarker) )\r\n            setButtonHeatmap( ButtonMap_(map, 'fas fa-eye fa-lg', 'fas fa-eye-slash fa-lg', onClickHeatmap) )\r\n            setButtonGPS( ButtonMap_(map, 'fas fa-satellite-dish fa-lg', 'fas fa-satellite-dish fa-lg', onClickGPS) )\r\n            \r\n            //setMapCurrentLatLng({lat: map.getCenter().lat, lng: map.getCenter().lng})                        \r\n\r\n            let mapname_ = document.cookie\r\n\t\t\t.split(\"; \")\r\n\t\t\t.find((row) => row.startsWith(\"mapname=\"));\r\n\r\n\t\t    if (mapname_) {\r\n                dispatch(actMapBaseLayerName(mapname_.split(\"=\")[1]))\r\n\t\t    }            \r\n        }        \r\n\r\n        return () => { \r\n            buttonNewMarker && buttonNewMarker.remove()\r\n            buttonHeatmap && buttonHeatmap.remove()\r\n            buttonGPS && buttonGPS.remove()\r\n        }  \r\n\r\n\r\n      }, [map])  //<MapContainer whenCreated={setMap} ...\r\n\r\n\r\n    // load data for the city\r\n    useEffect(() => {\r\n\r\n        const fetchCity = async () => {\r\n            const res = await fetch(`${process.env.REACT_APP_API_URL}cities/${currentCity}`);\r\n            const data = await res.json();\r\n            setCurrentCityInfo(data);          \r\n        }\r\n\r\n        fetchCity();\r\n        console.log('currentCity');\r\n           \r\n    }, [currentCity])  //[currentCity]\r\n   \r\n\r\n    \r\n\r\n      // apply states for buttons\r\n      \r\n      useEffect(() => {        \r\n        if (buttonNewMarker) {\r\n            if (rxCheckButtonNewMarker) {\r\n                buttonNewMarker.state('on');\r\n                buttonNewMarker.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonNewMarker.state('off');\r\n                buttonNewMarker.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonNewMarker]);\r\n\r\n      useEffect(() => {        \r\n        if (buttonHeatmap) {\r\n            mainData.dateTimeGenerated = Date.now(); // to redraw data in GeoJSON\r\n            if (rxCheckButtonHeatmap) {\r\n                buttonHeatmap.state('on');\r\n                buttonHeatmap.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonHeatmap.state('off');\r\n                buttonHeatmap.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonHeatmap]);\r\n\r\n      useEffect(() => {        \r\n        if (buttonGPS) {\r\n            if (rxCheckButtonGPS) {\r\n                buttonGPS.state('on');\r\n                buttonGPS.button.style.backgroundColor = 'red';\r\n            } else {\r\n                buttonGPS.state('off');\r\n                buttonGPS.button.style.backgroundColor = 'white';            \r\n            }  \r\n        }\r\n      }, [rxCheckButtonGPS]);     \r\n\r\n    \r\n    useEffect(()=>{\r\n        if (map && !rxIsMobileDevice) {\r\n            if (rxCheckButtonNewMarker) {\r\n                L.DomUtil.addClass(map._container,'crosshair-cursor-enabled');\r\n            } else {\r\n                L.DomUtil.removeClass(map._container,'crosshair-cursor-enabled');\r\n            }    \r\n        }\r\n    }, [rxCheckButtonNewMarker]); \r\n      \r\n\r\n\r\n    useEffect(()=>{\r\n        if (map) {\r\n            window.setTimeout(function(){map.invalidateSize({pan: false});}, 600)\r\n        }        \r\n    }, [rxShowSidebar])\r\n\r\n\r\n\r\n    \r\n\r\n\tconst onClickNewMarker = (state: boolean) => {                \r\n        // if (onClickCreateNewMarker) {\r\n        //     const preventDefault = onClickCreateNewMarker(state);            \r\n        //     if (preventDefault === false) {            \r\n        //         return\r\n        //     }                \r\n        // }\r\n                        \r\n\t\tif (rxIsMobileDevice && state) {\t\t\t\t\t\t\r\n            dispatch(actMapMarkerState({ visible: true, position: {lat: 0, lng: 0} }));\r\n            dispatch(actShowOkCancelMobileMarker(true));\r\n\t\t}\r\n\r\n        dispatch(actCheckButtonNewMarker(state));\r\n\t};\r\n\r\n\tconst onClickHeatmap = (state: boolean) => {\t\t        \t\t\r\n        dispatch(actCheckButtonHeatmap(state));\r\n        if (state) {\r\n            dispatch(actMapBaseLayerName('Dark'));\r\n\t\t} else {\r\n            dispatch(actMapBaseLayerName('Default'));\r\n\t\t}\r\n        \r\n\t};\r\n\r\n\r\n    function SetPanToMap() {        \r\n        const map = useMap();\r\n        if (currentCityInfo) {\r\n            // change map position when current city has been changed        \r\n            if (currentCitySysname !== currentCityInfo[\"sysname\"]) {\r\n                map.panTo( [parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])] );\r\n            }\r\n            currentCitySysname = currentCityInfo[\"sysname\"];\r\n\r\n        }\r\n        return null;\r\n    }    \r\n\r\n\r\n    function onClickGPS(state: boolean) {\r\n        if (map) {\r\n            if (state){\r\n                setView_nTimes_gps = 4;\r\n                map.locate({maxZoom: 20, enableHighAccuracy: true, watch:true, maximumAge: 20000});\r\n            } else {\r\n                map.stopLocate();\r\n                if (circle_geolocation && map.hasLayer(circle_geolocation)) map.removeLayer(circle_geolocation);\r\n                setView_nTimes_gps = 4;\r\n            }\r\n\r\n        }\r\n        dispatch(actCheckButtonGPS(state));\r\n    }\r\n\r\n\r\n    function NewMarker({mapMarkerState}: any) {  \r\n        const visible = mapMarkerState.visible;\r\n        const map = useMap();\r\n\r\n        const eventHandlers = useMemo(\r\n            () => ({\r\n                dragend() {\r\n                    \r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current;\r\n                        if (!rxIsMobileDevice && marker != null) {                                                    \r\n                            const LatLng = marker.getLatLng();\r\n                            const coord = { lat: '0', lng: '0' };\r\n                            coord.lat = LatLng.lat.toFixed(5);\r\n                            coord.lng = LatLng.lng.toFixed(5);\r\n                            \r\n                            //const cordFloat = {lat: parseFloat(coord.lat), lng: parseFloat(coord.lng)}\r\n                            //onDragEndNewMarker(cordFloat);\r\n                            //setNewMarkerState({ visible: true, position: coord }); \r\n                            //console.log('123', { visible: true, position: coord });\r\n                            \r\n                            // I don't know why, but that prevent the error for citytree app, when user try to move the marker\r\n                            sleep(0).then(() => {\r\n                                //console.log('onDragEndNewMarker timer', { visible: true, position: coord });\r\n                                    dispatch(actMapMarkerState({ visible: true, position: coord })); \r\n                            });\r\n\r\n                                                                        \r\n                        }\r\n                    }\r\n                }\r\n            }),\r\n            [],\r\n        );\r\n        function sleep (time: number) {\r\n            return new Promise((resolve) => setTimeout(resolve, time));\r\n        }          \r\n\r\n         \r\n\r\n        return (<>\r\n                    {visible && <> \r\n                        {(!rxIsMobileDevice) \r\n                        ?\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={true}\r\n                                position={mapMarkerState.position}                                                                \r\n                                ref={newMarkerRef}\r\n                                eventHandlers={eventHandlers}                    \r\n                            />                    \r\n                        :\r\n                            <Marker\r\n                                icon={redIcon}\r\n                                key='newMarker'\r\n                                draggable={false}\r\n                                //position={map.getCenter()}\r\n                                position={mapMarkerState.position.lat==0 ? map.getCenter() : mapMarkerState.position }\r\n                                ref={newMarkerRef}                 \r\n                            />\r\n                        } \r\n                </>}\r\n                                         \r\n        </>)\r\n    }\r\n    \r\n\r\n\r\n    function MapEvents() {        \r\n        const map = useMapEvents({\r\n            baselayerchange(e) {\r\n                document.cookie = 'mapname='+e.name\r\n            }, \r\n            //baselayerchange: onBaselayerchange,\r\n\r\n            move(e) {               \r\n                \r\n                if (rxShowOkCancelMobileMarker) {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current\r\n                        marker.setLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n                                        \r\n                        //let coord = { lat: 0, lng: 0 }\r\n                        //coord.lat = e.target.getCenter().lat.toFixed(5)\r\n                        //coord.lng = e.target.getCenter().lng.toFixed(5)\r\n                    }\r\n                }    \r\n            },\r\n\r\n            moveend(e) {\r\n                if (rxShowOkCancelMobileMarker) {\r\n                    if (newMarkerRef.current) {\r\n                        const marker: L.Marker = newMarkerRef.current\r\n                        const LatLng = marker.getLatLng()\r\n                        let coord = { lat: '0', lng: '0' };\r\n                        coord.lat = LatLng.lat.toFixed(5);\r\n                        coord.lng = LatLng.lng.toFixed(5);                   \r\n                        //setNewMarkerState({visible: true, position: coord})                        \r\n                        dispatch(actMapMarkerState({visible: true, position: coord}))\r\n                    }\r\n                }                \r\n                //setMapCurrentLatLng({lat: e.target.getCenter().lat, lng: e.target.getCenter().lng})\r\n            },\r\n            \r\n            click(e) {\r\n                onClickMap(e)              \r\n            }, \r\n\r\n            zoomend(e){                                \r\n                if (onZoomEnd) onZoomEnd(e);\r\n\r\n                setCurrentZoom(e.target._zoom)                 \r\n                //dispatch(actCurrentMapZoom(e.target._zoom));               \r\n            },\r\n\r\n            locationfound(e){\r\n                let radius = e.accuracy / 2;\r\n\r\n                if (setView_nTimes_gps > 0) {\r\n                    map.setView(e.latlng, 20);\r\n                    setView_nTimes_gps = setView_nTimes_gps - 1;\r\n                }\r\n    \r\n                if (circle_geolocation && map.hasLayer(circle_geolocation)) {\r\n                    circle_geolocation.setLatLng(e.latlng);\r\n                    circle_geolocation.setRadius(radius);\r\n                } else {\r\n                    circle_geolocation = L.circle(e.latlng, radius).addTo(map);\r\n                }                \r\n            },\r\n\r\n            locationerror(e){\r\n                //setCheckButtonGPS(false)\r\n                dispatch(actCheckButtonGPS(false))\r\n                alert(e.message)\r\n            }\r\n        })\r\n      \r\n        return null\r\n      }\r\n\r\n\r\n\r\n    function MarkersZoomAdjustment(){    \r\n        const map = useMap(); \r\n        const zoom = map.getZoom();\r\n                 \r\n        if (onEachLayer) {\r\n            map.eachLayer(function (layer) {\r\n                onEachLayer(layer, zoom);           \r\n            });\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    function onEachFeaturePoint(feature: any, layer: L.Layer) {               \r\n        //@ts-ignore\r\n        //layer.myTag = \"myGeoJSON\"\r\n        // layer.on({\r\n        //   'click': function (e) {\r\n        //      console.log('e: ', e);\r\n        //      console.log('click');\r\n        //    }\r\n        // })\r\n    }  \r\n\r\n    function HeatmapFunction(){\r\n        const map = useMap();\r\n\r\n            if (heatMapLayer) { \r\n                map.removeLayer(heatMapLayer)\r\n            }\r\n\r\n            if (rxCheckButtonHeatmap) {                      \r\n\r\n                if (dataHeatmapPoints) {\r\n                    // @ts-ignore\r\n                    heatMapLayer = L.heatLayer(dataHeatmapPoints, {\r\n                        gradient: {0.4: '#1E90FF', 0.8: 'white', 1: 'red'},                        \r\n                        //minOpacity: 0.1,\r\n                        max: 1.5,\r\n                        radius: 14,\r\n                        blur: 10,\r\n                        maxZoom: 6\r\n\r\n                    })//.addTo(map);\r\n                    map.addLayer(heatMapLayer);                \r\n                }\r\n            } \r\n\r\n        return null\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    const createClusterCustomIcon  = function (cluster: L.MarkerCluster) {\r\n        // get the number of items in the cluster\r\n        let count = cluster.getChildCount();\r\n\r\n        // figure out how many digits long the number is\r\n        //var digits = (count + '').length;\r\n        let digits;\r\n        if (count === 2) { digits = '1'; }\r\n        if (count >= 3 && count <=5) { digits = '2'; }\r\n        if (count >= 6 && count <=9) { digits = '3'; }\r\n        if (count >= 10 && count <=14) { digits = '4'; }\r\n        if (count > 14) { digits = '5'; }\r\n\r\n        return L.divIcon({\r\n          html: count.toString(),\r\n          className: 'cluster digits-' + digits,\r\n          iconSize: undefined\r\n        });\r\n      }\r\n\r\n\r\n\r\n\r\n    return (\r\n        <>        \r\n        {/* The map rendered before useEffect called, so first we need to load currentCityInfo before to show the map */}\r\n        { currentCityInfo && currentCityInfo[\"longitude\"] !== \"0\" && currentCityInfo[\"latitude\"]!==\"0\" ? ( \r\n\r\n            <MapContainer whenCreated={setMap} center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} zoom={currentCityInfo.zoom} zoomControl={false} scrollWheelZoom={true} style={{ height: 'calc(100vh - 60px)', width: '100%' }} >                \r\n                <LayersControl position=\"topleft\">                    \r\n                    <MapTileLayers mapBaseLayerName={rxMapBaseLayerName} />                 \r\n                </LayersControl>    \r\n\r\n                \r\n                {/* To change center of the map when current city will change */}\r\n                {/*<SetViewMap center={[parseFloat(currentCityInfo[\"latitude\"]), parseFloat(currentCityInfo[\"longitude\"])]} />*/} \r\n                <SetPanToMap />\r\n\r\n                \r\n\r\n                {appname === 'roadaccident' && <> \r\n                    {currentZoom && currentZoom < 15 ? (\r\n                        <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>  \r\n                    ) : (\r\n                        /* @ts-ignore */\r\n                        <MarkerClusterGroup\r\n                        spiderfyOnMaxZoom={true}\r\n                        showCoverageOnHover={false}\r\n                        zoomToBoundsOnClick={true}\r\n                        maxClusterRadius={15}\r\n                        iconCreateFunction={createClusterCustomIcon}>                \r\n                            <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>                \r\n                        </MarkerClusterGroup>\r\n                    )}\r\n                </>}\r\n\r\n\r\n                {appname === 'citytree' && <>                                                         \r\n                    {console.log('mainData.dateTimeGenerated', mainData.dateTimeGenerated)}\r\n                    <GeoJSON key={mainData.dateTimeGenerated} data={mainData} pointToLayer={pointToLayerCallback} filter={filterMapCallback} onEachFeature={onEachFeaturePoint}/>                                       \r\n                </>}\r\n\r\n                <NewMarker mapMarkerState={rxMapMarkerState} onDragEndNewMarker={onDragEndNewMarker}/>\r\n                \r\n                <MapEvents />\r\n                \r\n                {!rxIsMobileDevice && <ZoomControl position='bottomright'/>}\r\n                \r\n   \r\n                {/* <ButtonsControl /> */}\r\n\r\n                <HeatmapFunction />\r\n                \r\n                {onEachLayer && <MarkersZoomAdjustment />}\r\n                \r\n            </MapContainer>\r\n        ) : (\r\n            <p>Loading...</p>\r\n        )}    \r\n            \r\n        </>\r\n        \r\n    )\r\n}\r\n\r\nexport default Map\r\n\r\n\r\n//https://egghead.io/lessons/react-create-a-new-map-using-react-leaflet\r\n\r\n//https://codesandbox.io/s/63wqz?file=/src/LeafletControlGeocoder.jsx\r\n//https://www.npmjs.com/package/leaflet-control-geocoder\r\n\r\n//https://codesandbox.io/s/how-to-add-a-legend-to-the-map-using-react-leaflet-useleaflet-hook-75jnp?file=/src/index.js\r\n\r\n//https://newbedev.com/home-button-leaflet-map\r\n\r\n//пример без React-Leaflet\r\n//https://stackoverflow.com/questions/69697017/use-leaflet-map-object-outside-useeffect-in-react","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACJ0lEQVR4Ae3ShY6bQRADYIeZ3v+9yszMDZPlkSWtslPuiS6+C+8n/zNp4p/froi8Jq/Jxk+TkwmHX//Wz8lG3jNjTeaguabD6HAVbphMwIIzqtd+rzKYhsgUNNcqo3fEBlyyOWmwhbbS4b8SaLBu7SGlpL9gklw3YpYR6J5Bm0zAguspZjvqSVQxqvxsPSJJKYIFKh5A2VIDyMgYfYB9hvcmI0VPTxVZS81ER7qiBoFqBAa9MKOKLzzv2BE3EOnlmDTrNRXryToGOGR65nhvSphjMP6b6WJ6xMYYxSW7l1Pp6CSzbLFPgAN3NGLKPRn3c59qxzapCTPUFNVKh0vUe24azMkW+uRm/B8UU3O3Eiw4nOrrafOSF5gS7PqHUotBQQ6f11p22HDOi+66i2LIHcWJOZrTP+rkhOl7n8YcTzCQIuIvyZPQrvs5Br0OdTsyB+YYrwKokXvsgOIXZzbeQ0DMnhHIqGOdBMEl9qKYAo3pBbbDNkijUSgjv/PrMFhwRwS2YbbMzqg+SzdukoxbeiSEVlgyK6yFmjSYtDxhTXRv1OsgsCb2jflu8hLMyC0P7Qg54NE1qc/MF5PqeAHWSfDL3zxN9dsQ+YD3zEeRS4GeYgFm5I7HNiJPfP4V7/CKeUvwsxpqhkwFzMgjj33Vwe+EnuIxngn8FvNTSCkwmJG+rQm8J/MId/EQL3nZwe2EmSNm9ufkFq9xHzcJPscnLGMRomBKqdzOY2EH+IPOLMEAAAAASUVORK5CYII=\"","import { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\ninterface MainWrapperProps {\r\n    children: JSX.Element;\r\n    cityName: string | undefined;\r\n}\r\n\r\nconst MainWrapper = ({children, cityName}: MainWrapperProps) => {\r\n    const rxShowSidebar = useSelector((state: RootState) => state.uiReducer.showSidebar);\r\n\r\n    return (\r\n        //@ts-ignore\r\n        <div className=\"main-wrapper\">            \r\n            {cityName ? (                \r\n                <div id=\"app\">\r\n                    <div className={`d-flex ${rxShowSidebar ? \"showed\" : \"hided\"}`} id=\"wrapper\">\r\n                        {children}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                    \"You must select a city.\"\r\n            )}     \t\t                           \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MainWrapper","interface SidebarProps {\r\n\tchildren: JSX.Element\t\r\n}\r\n\r\nconst Sidebar = ({children}: SidebarProps) => {\r\n\treturn (\r\n\t\t<div className=\"bg-light border-right\" id=\"sidebar-wrapper\">\r\n\t\t\t<div className=\"list-group list-group-flush\" style={{ marginTop: \"15px\" }}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Sidebar\r\n","import Button from \"react-bootstrap/Button\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {\r\n\tactMapMarkerState,\r\n\tactShowSidebar,\r\n\tactCheckButtonNewMarker,\r\n\tactShowOkCancelMobileMarker,\r\n\tactShowTreeTab,\r\n\tactActiveTabKey,\r\n    actNewTreeCreation\r\n} from \"../actions\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\n\r\nconst ButtonOkCancelMobileMarker = () => {\r\n\r\n    const dispatch = useDispatch();\r\n    const { t } = useTranslation();\r\n    const rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\r\n\r\n\r\n    return (\r\n    <>\r\n        <Button\r\n            variant=\"success\"\r\n            id=\"doneEditMarkerMobile\"\r\n            onClick={() => {\r\n                if (rxCheckButtonNewMarker) dispatch(actNewTreeCreation(true));\r\n                \r\n                dispatch(actCheckButtonNewMarker(false));\r\n                dispatch(actShowOkCancelMobileMarker(false));                \r\n                dispatch(actShowTreeTab(true));\r\n                dispatch(actActiveTabKey(\"tree\"));\r\n                dispatch(actShowSidebar(true));                \r\n            }}\r\n        >\r\n            {t<string>(\"words.done\")}\r\n        </Button>{\" \"}\r\n        \r\n        <Button\r\n            variant=\"secondary\"\r\n            id=\"cancelMarkerMobile\"\r\n            onClick={() => {\r\n                dispatch(\r\n                    actMapMarkerState({\r\n                        visible: false,\r\n                        position: {\r\n                            lat: 0,\r\n                            lng: 0,\r\n                        },\r\n                    })\r\n                );\r\n                dispatch(\r\n                    actShowOkCancelMobileMarker(\r\n                        false\r\n                    )\r\n                );\r\n                dispatch(\r\n                    actCheckButtonNewMarker(\r\n                        false\r\n                    )\r\n                );\r\n            }}\r\n        >\r\n            &#x2715;\r\n        </Button>{\" \"}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ButtonOkCancelMobileMarker","import { useForm, Controller  } from 'react-hook-form'\r\nimport { Form, Button, Row, Col, } from 'react-bootstrap';\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\ninterface FormFilterProps {\r\n\tonSubmitFilter: (filter: {}) => void;\r\n}\r\n\r\n\r\nconst FormFilter = ({onSubmitFilter}: FormFilterProps) => {\r\n    const rxDictSpecieses = useSelector((state: RootState) => state.dataReducer.dictSpecieses);\r\n    const rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);\r\n\tconst rxDictPlaceTypes = useSelector((state: RootState) => state.dataReducer.dictPlaceTypes);\r\n\tconst rxDictIrrigationMethods = useSelector((state: RootState) => state.dataReducer.dictIrrigationMethods);\r\n\tconst rxDictGroupSpecs = useSelector((state: RootState) => state.dataReducer.dictGroupSpec);\r\n\t\r\n\tconst { t } = useTranslation();\r\n\r\n\r\n\r\n\tconst { control, handleSubmit, reset } = useForm({\r\n\t\treValidateMode: \"onChange\",\r\n\t\tdefaultValues: {\r\n\t\t\tspeciesFilter: \"\",\r\n\t\t\tstatusFilter: \"\",\r\n\t\t\tcareTypeFilter: \"\",\r\n\t\t\tremarkFilter: \"\",\r\n\t\t\tplaceTypeFilter: \"\",\r\n\t\t\tirrigationMethodFilter: \"\",\r\n\t\t\tdatePlantedFromFilter: \"\",\r\n\t\t\tdatePlantedToFilter: \"\",\r\n\t\t\tdateAddedFromFilter: \"\",\r\n\t\t\tdateAddedToFilter: \"\",\r\n\t\t\tcommentFilter: \"\",\r\n\t\t\theightFromFilter: \"\",\r\n\t\t\ttrunkGirthFromFilter: \"\",\r\n\t\t\tcrownDiameterFromFilter: \"\",\r\n\t\t\theightToFilter: \"\",\r\n\t\t\ttrunkGirthToFilter: \"\",\r\n\t\t\tcrownDiameterToFilter: \"\",\t\t\t\r\n\t\t\tshowMyTreesFilter: \"\",\r\n\r\n\t\t\t//select: {},\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\t\r\n\t//let optionsSpeciesesFilter: {label: string; options: {value: number; label: string}[] | undefined}[] = [];\r\n\tlet optionsSpeciesesFilter: any = [];\r\n\tif (Array.isArray(rxDictSpecieses) && Array.isArray(rxDictGroupSpecs)) {\r\n\t\tlet unknownTreeItem = null;\r\n\r\n\t\toptionsSpeciesesFilter = rxDictGroupSpecs.map(itemGroup => {\r\n\t\t\treturn {\t\t\t\t\r\n\t\t\t\tlabel: itemGroup.groupname,\r\n\t\t\t\toptions: rxDictSpecieses.map(spec => {\r\n\t\t\t\t\tif (itemGroup.id === spec.groupspec) {\r\n\t\t\t\t\t\tif (spec.id !== 1) { // unknow tree item has id = 1\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname,\r\n\t\t\t\t\t\t\t\tspeciesname: spec.speciesname,\r\n\t\t\t\t\t\t\t\ttypespec: spec.typespec\r\n\t\t\t\t\t\t\t\t//color: '#FF8B00'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tunknownTreeItem = {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn null;\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}).filter(e => e) // removes all undefined items in result array\t\t\t \r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\tif (unknownTreeItem) {\r\n\t\t\toptionsSpeciesesFilter.unshift(unknownTreeItem);\r\n\t\t}\t\t\t\t\r\n\t}\r\n\r\n\r\n\tlet optionsStatusesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictStatuses)) {\r\n\t\toptionsStatusesFilter = rxDictStatuses.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.statusname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\t\r\n\tlet optionsCareTypesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictCareTypes)) {\r\n\t\toptionsCareTypesFilter = rxDictCareTypes.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.carename,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\r\n\tlet optionsRemarksFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictRemarks)) {\r\n\t\toptionsRemarksFilter = rxDictRemarks.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.remarkname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\t\r\n\tlet optionsPlaceTypesFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictPlaceTypes)) {\r\n\t\toptionsPlaceTypesFilter = rxDictPlaceTypes.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.placename,\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\r\n\tlet optionsIrrigationMethodsFilter: {value: string; label: string}[] = [];\r\n\tif (Array.isArray(rxDictIrrigationMethods)) {\r\n\t\toptionsIrrigationMethodsFilter = rxDictIrrigationMethods.map((x) => {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: x.id,\r\n\t\t\t\t//label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n\t\t\t\tlabel: x.irrigationname,\r\n\t\t\t};\r\n\t\t});\r\n\t}\t\r\n\r\n\r\n\t  const customStyles = {\r\n\t\t//@ts-ignore\r\n\t\toption: (styles, { data }) => {\r\n\t\t\t//const color = chroma(data.color);\r\n\t\t\treturn {\r\n\t\t\t  ...styles,\r\n\t\t\t  paddingLeft: 20,\r\n\t\t\t  backgroundColor: data.typespec === 2 ? '#EEFFEE' : undefined,\r\n\r\n\t\t\t};\r\n\t\t  },\r\n\t  } \r\n\r\n\r\n\r\n\t  const Option = (props: any) => {\r\n\t\tconst { label, speciesname } = props.data;\r\n\t\treturn (\r\n\t\t  <components.Option {...props}>\r\n\t\t\t<span>{label}</span> <span style={{ color: \"darkgray\" }}>{speciesname}</span>\r\n\t\t  </components.Option>\r\n\t\t);\r\n\t  };\t  \r\n\r\n\r\n\r\n\tfunction onResetButton() {\r\n\t\treset();\r\n\t\tonSubmitFilter({});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form className=\"m-1\" onSubmit={handleSubmit(onSubmitFilter)}>\r\n\t\t\t\t<Form.Group controlId=\"formSpeciesFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.species\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"speciesFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={true}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsSpeciesesFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tgetOptionLabel={(option) =>`${option.label} - ${option.speciesname}`}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formStatusFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.status\")}\r\n\t\t\t\t\t</Form.Label>\r\n\r\n\t\t\t\t\t{/*{!rxIsMobileDevice ? ( */}\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"statusFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\toptions={optionsStatusesFilter}\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t\t\t\tmaxMenuHeight={400}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/*):(\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<select {...register(\"statusFilter\")} \t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tstyle={{width: '100%', minHeight: '38px', borderRadius: '4px', borderColor: 'rgb(204, 204, 204)', backgroundColor: 'rgb(255, 255, 255)'}}\r\n\t\t\t\t\t\t\tmultiple={true}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option disabled selected>{t<string>(\"words.select\")}</option>\r\n\t\t\t\t\t\t\t{optionsStatusesFilter.map((item) => <option key={item.value} value={item.value}>{item.label}</option>)}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}*/}\t\t\t\t\t\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formCareTypeFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.careType\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"careTypeFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsCareTypesFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formRemarkFilter\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.remark\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"remarkFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsRemarksFilter}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formPlaceTypeFilter\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"230px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.placeType\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"placeTypeFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\toptions={optionsPlaceTypesFilter}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formIrrigationMethodFilter\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"230px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.irrigationMethod\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"irrigationMethodFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\tplaceholder={t<string>(\r\n\t\t\t\t\t\t\t\t\t\t\"words.select\"\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\toptions={optionsIrrigationMethodsFilter}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDatePlantedFromFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.plantedFrom\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"datePlantedFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDatePlantedToFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.plantedTo\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"datePlantedToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDateAddedFromFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.dateAddedFrom\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateAddedFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDateAddedToFilter\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.dateAddedTo\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateAddedToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group className=\"mt-3\" controlId=\"formCommentFilter\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.comment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"commentFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control type=\"text\" {...field} />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formFromParamsTreeFilter\" style={{maxWidth: \"50px\"}}>\r\n\t\t\t\t\t\t<Form.Label style={{ marginTop: \"32px\"}}>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.from\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formHeightFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.height\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"heightFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formTrunkGirthFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.trunkGirth\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkGirthFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"999\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formCrownDiameterFromFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.crownDiameter\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crownDiameterFromFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Row className=\"mt-0\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formToParamsTreeFilter\" style={{maxWidth: \"50px\"}}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.to\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formHeightToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"heightToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formTrunkGirthToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkGirthToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"999\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group\r\n\t\t\t\t\t\tas={Col}\r\n\t\t\t\t\t\tcontrolId=\"formCrownDiameterToFormFilter\"\r\n\t\t\t\t\t\tclassName=\"ps-1 pe-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crownDiameterToFilter\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"99\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formShowMyTreesFilter\"\r\n\t\t\t\t\tclassName=\"mt-3 ms-1\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"showMyTreesFilter\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tchecked={field[\"value\"] ?? false}\r\n\t\t\t\t\t\t\t\tinline\r\n\t\t\t\t\t\t\t\tlabel={t<string>(\r\n\t\t\t\t\t\t\t\t\t\"sidebar.filterTab.showMyTrees\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tid=\"idShowMyTreesFilter\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\t\t\t\t\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button variant=\"light\" onClick={onResetButton}>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.clear\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"150px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.filterTab.search\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default FormFilter\r\n\r\n\r\n\r\n","import { useEffect, useState } from 'react';\r\n\r\n//import TableList from './Table'\r\n//import { DataStructureTableList } from './Table/interfaces'\r\nimport { BootstrapTable } from 'react-bootstrap-table-light'\r\nimport { DataStructureTable } from 'react-bootstrap-table-light/src/interfaces';\r\n\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\n\r\ninterface InspectionsListProps {\r\n    idTree: number | undefined;  \r\n    onClickButtonEditInsp: (inspData: any) => void;\r\n    onClickButtonPhotosInsp: (inspData: any) => void;\r\n}\r\n\r\nconst InspectionsList = (props: InspectionsListProps) => {\r\n\r\n    const [inspectionsData, setInspectionsData] = useState<DataStructureTable[] | undefined>(undefined);\r\n    const rxDataLastEditetTreeId = useSelector((state: RootState) => state.dataReducer.dataLastEditedTreeId);\r\n\r\n    const fetchInpections = async () => {\r\n        //@ts-ignore\r\n        let url = `${process.env.REACT_APP_API_URL}citytree/cityfoo/trees/${props.idTree}/inspections/`;\r\n        let res = await fetch(url);\r\n        let data = await res.json(); \r\n\r\n\r\n        \r\n        // adding buttons\r\n        data = data.map((element: any) => {\r\n            element.buttons = [];\r\n            element.buttons.push({iconFA: 'fas fa-edit', iconFASize: '15pt', idButton: 'edit'});\r\n            \r\n            if (element?.photo1 || element?.photo2 || element?.photo3) {\r\n                element.buttons.push({iconFA: 'fa fa-camera', iconFASize: '15pt', idButton: 'photo'});                       \r\n                \r\n            }\r\n            element.typeData = 'Inspection';\r\n            return element;\r\n                \r\n        });\r\n        \r\n        setInspectionsData(data);       \r\n    };\r\n\r\n    useEffect(() => {\r\n        if (props.idTree) {\r\n            fetchInpections();\r\n        }\r\n    }, [props.idTree]);\r\n\r\n    useEffect(() => {\r\n        //console.log('rxDataLastEditetTreeId', props.idTree, rxDataLastEditetTreeId);\r\n        if (props.idTree && (props.idTree === rxDataLastEditetTreeId.treeId)) { // if data about inspection was updated, which belongs to this instance of tree, then update the component\r\n            fetchInpections();\r\n            console.log('rxDataLastEditetTreeId');\r\n        }\r\n    }, [rxDataLastEditetTreeId]);\r\n\r\n\r\n    const OnClickInspButtons = (rowData: any, idButton: string) => {            \r\n        if (idButton==='edit') props.onClickButtonEditInsp(rowData);        \r\n        if (idButton==='photo') props.onClickButtonPhotosInsp(rowData);                 \r\n    }\r\n\r\n    return (\r\n        <BootstrapTable \r\n            data={inspectionsData} \r\n            OnClickButtons={OnClickInspButtons} \r\n            sortField={\"datetime\"} \r\n            sortAsc={false} \r\n            size={\"sm\"} \r\n            noDataTitle='Няма'       \r\n            columns={\r\n                [\r\n                    {\r\n                        field: \"#\",\r\n                        headerName: \"\",\r\n                    },                            \r\n                    {\r\n                        field: \"datetime\",\r\n                        headerName: \"Дата\",\r\n                        width: \"40%\",\r\n                        sortable: true,\r\n                        dateTimeOption: \"onlyDate\",\r\n                    },\r\n                    {\r\n                        field: \"typeData\",\r\n                        headerName: \"Тип\",\r\n                        width: \"35%\"\r\n                    },    \r\n                    {\r\n                        field: \"buttons\",\r\n                        headerName: \"Actions\",\r\n                        width: \"25%\"\r\n                    },             \r\n                ]\r\n            }\r\n        />\r\n    )\r\n}\r\n\r\n\r\nexport default InspectionsList; ","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkMzMzRGRjBCRDQ0RTExRUI4M0FBOEVDOTExMzA0Q0NEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkMzMzRGRjBDRDQ0RTExRUI4M0FBOEVDOTExMzA0Q0NEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzMzNEZGMDlENDRFMTFFQjgzQUE4RUM5MTEzMDRDQ0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzMzNEZGMEFENDRFMTFFQjgzQUE4RUM5MTEzMDRDQ0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4+BmGWAAAYBklEQVR42uxd2VcUxxce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\"","import { Form, Button, Card, Row, Col, Modal} from 'react-bootstrap';\r\nimport {useState, useEffect, forwardRef, useRef, useImperativeHandle} from 'react'\r\nimport { Controller } from \"react-hook-form\";\r\n//import ImageS3Upload from \"./ImageS3Upload\";\r\nimport { ImageS3Upload } from \"react-image-upload-s3\";\r\nimport noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface UploadPhotosProps {\r\n    controlFromUseForm: any;\r\n    signingS3Url: string;\r\n    serverPhoto?: string;\r\n    onCallbackDone: (isSuccessful: boolean) => void;\r\n} \r\n\r\ninterface RefObject {\r\n    uploadPhotos: () => void\r\n}\r\n\r\n// enum StateUploader {\r\n//     none,\r\n//     ok,\r\n//     error\r\n// }\r\n\r\nconst UploadPhotos = forwardRef<RefObject | undefined, UploadPhotosProps>(({\r\n    controlFromUseForm,\r\n    signingS3Url,\r\n    serverPhoto,\r\n    onCallbackDone\r\n}, ref) => {\r\n\r\n\tconst photo1Ref = useRef(); // to be able to call method uploadFile\r\n\tconst photo2Ref = useRef();\r\n\tconst photo3Ref = useRef();   \r\n    //const [photosUploaded, setPhotosUploaded] = useState<{photo1: StateUploader, photo2: StateUploader, photo3: StateUploader}>({photo1: StateUploader.none, photo2: StateUploader.none, photo3: StateUploader.none});\r\n    const [submitData, setSubmitData] = useState({submit: false, success: false});\r\n\r\n    useEffect(()=> {        \r\n        if (submitData.submit) {\r\n            onCallbackDone(submitData.success);    \r\n            setSubmitData({submit: false, success: false});\r\n        }                        \r\n    }, [submitData]);    \r\n\r\n\t// useEffect(() => {\r\n\t// \tif (photosUploaded.photo1 !== StateUploader.none && photosUploaded.photo2 !== StateUploader.none && photosUploaded.photo3 !== StateUploader.none) {\t\t\t\r\n\t// \t\tonCallbackDone(photosUploaded.photo1 === StateUploader.ok && photosUploaded.photo2 === StateUploader.ok && photosUploaded.photo3 === StateUploader.ok);\r\n    //         setPhotosUploaded({photo1: StateUploader.none, photo2: StateUploader.none, photo3: StateUploader.none});\t\t\t\t\t\t\t\t\t\r\n\t// \t}\r\n\t// }, [photosUploaded]);    \r\n\r\n\r\n    const autoUpload = false;\r\n\r\n    const resizerOptions = {\r\n        enabled: true,\r\n        autoResize: true, // otherwise resizing will be preform before uploading\r\n        maxWidth: 1280,\r\n        maxHeight: 1280,\r\n        compressFormat: \"JPEG\",\r\n        quality: 70,\r\n        rotation: 0            \r\n    }\r\n\r\n\r\n    // to be able to call method uploadFile\r\n    useImperativeHandle(ref, () => ({\r\n        uploadPhotos: () => {\r\n            //setPhotosUploaded({photo1: StateUploader.none, photo2: StateUploader.none, photo3: StateUploader.none});            \r\n            //@ts-ignore\r\n            //photo1Ref?.current?.uploadFile();\r\n            //@ts-ignore\r\n            //photo2Ref?.current?.uploadFile();\r\n            //@ts-ignore\r\n            //photo3Ref?.current?.uploadFile();            \r\n\r\n            Promise.all([\r\n                //@ts-ignore\r\n                photo1Ref.current.uploadFile(),\t\r\n                //@ts-ignore\r\n                photo2Ref.current.uploadFile(),\r\n                //@ts-ignore\r\n                photo3Ref.current.uploadFile()\t            \r\n            ]).then((values) => {          \r\n                console.log('result', values);\r\n                let result = true;\r\n                values.forEach((value) => {if (!value) result = false})\r\n                setSubmitData({submit: true, success: result});\r\n            });            \r\n        }\r\n    }));\r\n\r\n\r\n\t// const onFinishPhoto1 = (isSuccessful: boolean) => {\t\t\r\n    //     setPhotosUploaded(prev => ({...prev, photo1: isSuccessful ? StateUploader.ok : StateUploader.error }));\r\n\t// }\r\n\t// const onFinishPhoto2 = (isSuccessful: boolean) => {\t\t\r\n    //     //isSuccessful && setPhotosUploaded(prev => ({...prev, photo2: true}));\r\n    //     setPhotosUploaded(prev => ({...prev, photo2: isSuccessful ? StateUploader.ok : StateUploader.error }));\r\n\t// }\r\n\t// const onFinishPhoto3 = (isSuccessful: boolean) => {\t\t\r\n    //     //isSuccessful && setPhotosUploaded(prev => ({...prev, photo3: true}));\r\n    //     setPhotosUploaded(prev => ({...prev, photo3: isSuccessful ? StateUploader.ok : StateUploader.error }));\r\n\t// }\r\n\r\n\r\n    return (\r\n        <Row className=\"mt-3\" xs={3}>\r\n            <Form.Group as={Col} controlId=\"formIdInsp1\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo1\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}                            \r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\t\r\n                            //onFinish={onFinishPhoto1}\r\n                            resizer={resizerOptions}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                            {...field}\r\n                            ref={photo1Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Col} controlId=\"formIdInsp2\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo2\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\t\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\r\n                            //onFinish={onFinishPhoto2}\r\n                            resizer={resizerOptions}\r\n                            {...field}\r\n                            ref={photo2Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Col} controlId=\"formIdInsp3\" className=\"mt-3 align-self-end\">\r\n                <Controller\r\n                    name=\"photo3\"\r\n                    control={controlFromUseForm}\r\n                    render={({ field }) => (\r\n\r\n                        <ImageS3Upload  \r\n                            signingUrl={signingS3Url}\r\n                            autoUpload={autoUpload}\r\n                            emptyPhoto={noPhotoImage}\r\n                            serverPhoto={serverPhoto}\r\n                            //onFinish={onFinishPhoto3}\r\n                            resizer={resizerOptions}\r\n                            {...field}\r\n                            ref={photo3Ref}\r\n                        />\r\n\r\n                    )}\r\n                />\r\n            </Form.Group>\t\r\n        </Row>\r\n\r\n\r\n\r\n  )\r\n})\r\n\r\nexport default UploadPhotos","import { useState, useEffect, useRef } from 'react';\r\nimport { useForm, Controller  } from 'react-hook-form';\r\nimport { Form, Button, Row, Col, Modal} from 'react-bootstrap';\r\nimport Select, { components } from \"react-select\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../reducers/index'\r\nimport { TreeItem } from \"../interfaces\";\r\nimport InspectionsList from './InspectionsList';\r\nimport UploadPhotos from \"./UploadPhotos\"\r\n//import noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface FormTreeProps {\r\n\tonSubmitTree: (data: {}) => void;\r\n\t//onDeleteTree: (id: number) => void;\r\n    onDeleteTree: (data: TreeItem | null) => void;\r\n\tonCloseTree: () => void;\r\n    \r\n    onNewInsp:(idTree: number) => void;\r\n    onClickInspEdit: (data: {}) => void;\r\n    onClickInspPhotos: (data: {}) => void;\r\n    onClickEditCoords: (coord: {lat: string; lng: string}) => void;\r\n        \t\r\n    dataTreeForm: TreeItem | null;\r\n    city: string;\r\n    signingS3Url: string;\r\n}\r\n\r\n\r\nconst FormTree = ({\r\n\tonSubmitTree,\r\n\tonDeleteTree,\r\n\tonCloseTree,\r\n    onNewInsp,\r\n    onClickInspEdit,\r\n    onClickInspPhotos,\r\n    onClickEditCoords,\r\n\tdataTreeForm,\r\n    city,\r\n    signingS3Url\r\n}: FormTreeProps) => {\r\n\r\n    const rxMapMarkerState = useSelector((state: RootState) => state.uiReducer.mapMarkerState);\r\n    const rxNewTreeCreation = useSelector((state: RootState) => state.uiReducer.newTreeCreation);\r\n    const [showModalDelete, setShowModalDelete] = useState(false);\r\n    const [submitButtonEnabled, setSubmitButtonEnabled] = useState(true);\r\n\r\n    const rxDictSpecieses = useSelector((state: RootState) => state.dataReducer.dictSpecieses);\r\n    const rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);\r\n\tconst rxDictPlaceTypes = useSelector((state: RootState) => state.dataReducer.dictPlaceTypes);\r\n\tconst rxDictIrrigationMethods = useSelector((state: RootState) => state.dataReducer.dictIrrigationMethods);\r\n    const rxDictGroupSpecs = useSelector((state: RootState) => state.dataReducer.dictGroupSpec);\r\n\r\n\r\n    const uploadPhotosRef = useRef();\r\n\r\n\r\n    // interface IInspections {\r\n\t// \tid: number;\r\n\t// \t[key: string]: any | {iconFA?: string; iconFASize?: string; text?: string; idButton: string};\r\n\t// };\r\n\r\n    //const [inspections, setInspections] = useState<IInspections[] | undefined>(undefined);\r\n\r\n    const { t } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n        reset();\r\n        //@ts-ignore\r\n        setValue(\"irrigationmethod\", optionsIrrigationMethodsData[0]);                 \r\n        setValue(\"latitude\", rxMapMarkerState.position.lat);\r\n        setValue(\"longitude\", rxMapMarkerState.position.lng);                  \r\n\t}, [rxNewTreeCreation]);  \r\n    \r\n\tuseEffect(() => {\r\n\t\tif (rxMapMarkerState.visible) {\r\n\t\t\tsetValue(\"latitude\", rxMapMarkerState.position.lat);\r\n\t\t\tsetValue(\"longitude\", rxMapMarkerState.position.lng);                       \r\n\t\t}\r\n\t}, [rxMapMarkerState]);    \r\n\r\n\r\n\r\n\r\n    // when provide data to show it\r\n\tuseEffect(() => {\r\n\t\tlet formData: any = {};\r\n\r\n        formData.id = dataTreeForm?.id;\r\n        formData.latitude = dataTreeForm?.latitude;\r\n        formData.longitude = dataTreeForm?.longitude;\r\n        \r\n\t\tlet species = dataTreeForm?.species_id;\r\n\t\tif (species) {\r\n\t\t\tlet isFound = false; // to stop loop\r\n            optionsSpeciesesData.forEach((category:any) => { // loop for categories (The most common, The medium common and so on...)\r\n                if (category?.options && Array.isArray(category.options)) { // in every categories trying to find id of species \r\n                    \r\n                    if (!isFound) {\r\n                        formData.species = category.options.find(                \t\t\t\r\n                            (item: any) => {\r\n                                isFound = item.value === species; \r\n                                return isFound;\t}\r\n                        );             \r\n                    }       \r\n                } else {  \r\n                    // if there are species at the same level with categories, like Unknown specify.                 \r\n                    if (category?.value && category.value === species) {                        \r\n                        formData.species = category;\r\n                        isFound = true;                        \r\n                    }\r\n\r\n                }      \r\n            });\r\n            \r\n\t\t} \r\n\r\n        \r\n        \r\n        \r\n        \r\n        formData.speciescomment = dataTreeForm?.speciescomment;\r\n        formData.comment = dataTreeForm?.comment;\r\n\r\n        \r\n\t\tlet placetype = dataTreeForm?.placetype;\r\n\t\tif (placetype) {\r\n\t\t\tconsole.log('optionsPlaceTypesData', optionsPlaceTypesData)\r\n\t\t\tformData.placetype = optionsPlaceTypesData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === placetype\t\r\n\t\t\t);\r\n\t\t}    \r\n        \r\n\t\tlet irrigationmethod = dataTreeForm?.irrigationmethod;\r\n\t\tif (irrigationmethod) {\r\n\t\t\t//console.log('optionsPlaceTypesData', optionsPlaceTypesData)\r\n\t\t\tformData.irrigationmethod = optionsIrrigationMethodsData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === irrigationmethod\t\r\n\t\t\t);\r\n\t\t}          \r\n        \r\n\r\n\t\tif (dataTreeForm?.dateplanted) {\r\n            console.log('dataTreeForm?.properties?.dateplanted', dataTreeForm?.dateplanted);\r\n\t\t\tformData.dateplanted = dataTreeForm.dateplanted;\r\n\t\t}\r\n\r\n        formData.googlestreeturl = dataTreeForm?.googlestreeturl;\r\n\r\n\r\n        reset(formData, { keepDefaultValues: true });\r\n\r\n\t}, [dataTreeForm]);\r\n\r\n\r\n\t//let optionsSpeciesesFilter: {label: string; options: {value: number; label: string}[] | undefined}[] = [];\r\n\tlet optionsSpeciesesData: any = [];\r\n\tif (Array.isArray(rxDictSpecieses) && Array.isArray(rxDictGroupSpecs)) {\r\n\t\tlet unknownTreeItem = null;\r\n\r\n\t\toptionsSpeciesesData = rxDictGroupSpecs.map(itemGroup => {\r\n\t\t\treturn {\t\t\t\t\r\n\t\t\t\tlabel: itemGroup.groupname,\r\n\t\t\t\toptions: rxDictSpecieses.map(spec => {\r\n\t\t\t\t\tif (itemGroup.id === spec.groupspec) {\r\n\t\t\t\t\t\tif (spec.id !== 1) { // unknow tree item has id = 1\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname,\r\n\t\t\t\t\t\t\t\tspeciesname: spec.speciesname,\r\n\t\t\t\t\t\t\t\ttypespec: spec.typespec\r\n\t\t\t\t\t\t\t\t//color: '#FF8B00'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tunknownTreeItem = {\r\n\t\t\t\t\t\t\t\tvalue: spec.id,\r\n\t\t\t\t\t\t\t\tlabel: spec.localname\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn null;\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}).filter(e => e) // removes all undefined items in result array\t\t\t \r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\tif (unknownTreeItem) {\r\n\t\t\toptionsSpeciesesData.unshift(unknownTreeItem);\r\n\t\t}\t\t\t\t\r\n\t}    \r\n\r\n\r\n    let optionsStatusesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictStatuses)) {\r\n        optionsStatusesData = rxDictStatuses.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.statusname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsCareTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictCareTypes)) {\r\n        optionsCareTypesData = rxDictCareTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.carename,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsRemarksData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictRemarks)) {\r\n        optionsRemarksData = rxDictRemarks.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.remarkname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsPlaceTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictPlaceTypes)) {\r\n        //console.log('rxDictPlaceTypes', rxDictPlaceTypes)\r\n        optionsPlaceTypesData = rxDictPlaceTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.placename,\r\n            };\r\n        });\r\n    }\r\n\r\n    let optionsIrrigationMethodsData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictIrrigationMethods)) {\r\n        optionsIrrigationMethodsData = rxDictIrrigationMethods.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.irrigationname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tsetValue,\r\n\t\tgetValues,\r\n\t\tformState: { errors },\r\n        trigger\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\t\t\t\r\n            id: \"\",\r\n            latitude: \"\",\r\n            longitude: \"\",\r\n            species: \"\",\r\n            speciescomment: \"\",\r\n            comment: \"\",\r\n            placetype: \"\",\r\n            irrigationmethod: \"\",            \r\n            dateplanted: \"\",\r\n            googlestreeturl: \"\",\r\n            \r\n            height: \"\",\r\n            crowndiameter: \"\",\r\n            trunkgirth: \"\",\r\n            status: \"\",\r\n            remarks: \"\",\r\n            recommendations: \"\",\r\n            photo1: \"\",\r\n            photo2: \"\",\r\n            photo3: \"\",\r\n            useradded: 0\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\r\n\tasync function onSubmitBefore(e: any) {\r\n\t\te.preventDefault();\t\t\t\t\r\n\t\t\r\n        const result = await trigger(); // programmaticaly run validation\r\n        if (result) {\r\n            //@ts-ignore\r\n            uploadPhotosRef.current.uploadPhotos(); // component uploadPhotos has a callback to start a submit of the form, when uploading has been finished.\r\n            setSubmitButtonEnabled(false);\r\n        }\r\n\t}\r\n\r\n\tconst onCallbackDone = (isSuccessful: boolean) => {\t\t\r\n\t\tsetSubmitButtonEnabled(true);\r\n        isSuccessful && handleSubmit(prepareOnSubmitTree)();\t        \r\n\t}    \r\n\r\n\r\n\r\n\tfunction prepareOnSubmitTree(data: {\r\n        id: any;\r\n        latitude: string;\r\n        longitude: string;\r\n        species: any;\r\n        speciescomment: string;\r\n        comment: string;\r\n        placetype: any;\r\n        irrigationmethod: any;\r\n        dateplanted: any;\r\n        googlestreeturl: string | null;\r\n\r\n        inspection?: any;\r\n        height: any;\r\n        crowndiameter: any;\r\n        trunkgirth: any;\r\n        status: any;\r\n        remarks: any;\r\n        recommendations: any;\r\n        photo1: string | null; \r\n        photo2: string | null;\r\n        photo3: string | null;\r\n\r\n        useradded: any;\r\n    }) {\r\n\t\t//let dataResult: any = {};\r\n        //console.log('data', data);\r\n\r\n\r\n        if (!data.dateplanted) {\r\n            data.dateplanted = null;    \r\n        }\r\n\r\n        if (rxNewTreeCreation === true) {\r\n            // new record                \r\n            data.species = data.species.value;\r\n            data.placetype = data.placetype.value;\r\n            data.irrigationmethod = data?.irrigationmethod?.value;            \r\n\r\n            // make inspection\r\n            if (data?.height && data?.crowndiameter && data?.trunkgirth && data?.status) {\r\n                data.inspection = {\r\n                    height: parseInt(data.height),\r\n                    crowndiameter: parseFloat(data.crowndiameter),\r\n                    trunkgirth: parseInt(data.trunkgirth),\r\n                    status: data.status.value,  \r\n                    \r\n                    photo1: data.photo1,          \r\n                    photo2: data.photo2, \r\n                    photo3: data.photo3, \r\n                };\r\n\r\n                if (data?.remarks && Array.isArray(data.remarks)) {\r\n                    data.inspection.remarks = [];\r\n                    data.remarks.forEach(element => {\r\n                        data.inspection.remarks.push(element.value);     \r\n                    });                                           \r\n                }\r\n                \r\n                if (data?.recommendations && Array.isArray(data.recommendations)) {\r\n                    data.inspection.recommendations = [];\r\n                    data.recommendations.forEach(element => {\r\n                        data.inspection.recommendations.push(element.value);     \r\n                    });                                           \r\n                }                             \r\n            }   \r\n\r\n            delete data.id;\r\n            delete data.height;\r\n            delete data.crowndiameter;\r\n            delete data.trunkgirth;\r\n            delete data.status; \r\n            delete data.remarks;\r\n            delete data.recommendations; \r\n\r\n            console.log('onSubmitTree', data);\r\n            onSubmitTree(data);\r\n\r\n        } else {\r\n            // edit\r\n            data.species = data.species.value;\r\n            data.placetype = data.placetype.value;\r\n            data.irrigationmethod = data?.irrigationmethod?.value; \r\n            if (dataTreeForm) data.useradded = dataTreeForm.useradded;\r\n            \r\n            \r\n            console.log('dataedit', data);\r\n            onSubmitTree(data);\r\n        }\r\n\r\n        \r\n    }        \r\n\r\n\r\n    const customStyles = {\r\n\t\t//@ts-ignore\r\n\t\toption: (styles, { data, isSelected, isFocused, isDisabled  }) => {\r\n\t\t\t//const color = chroma(data.color);\r\n\t\t\treturn {\r\n\t\t\t  ...styles,\r\n\t\t\t  paddingLeft: 20,\r\n\t\t\t  //backgroundColor: data.typespec === 2 ? '#EEFFEE' : undefined,\r\n              backgroundColor: isDisabled\r\n              ? undefined\r\n              : isSelected\r\n              ? \"#606060\"\r\n              : isFocused\r\n              ? \"#EEEEEE\"\r\n              : data.typespec === 2 ? '#EEFFEE' : undefined,\r\n\t\t\t};\r\n\t\t  },\r\n\t  } \r\n\r\n\r\n\r\n\t  const Option = (props: any) => {\r\n\t\tconst { label, speciesname } = props.data;\r\n\t\treturn (\r\n\t\t  <components.Option {...props}>\r\n\t\t\t<span>{label}</span> <span style={{ color: \"darkgray\" }}>{speciesname}</span>\r\n\t\t  </components.Option>\r\n\t\t);\r\n\t  };\r\n\r\n\r\n    \r\n\r\n    function OnButtonTableClick (rowData: any, idButton: string) {    \r\n        if (idButton==='edit') {\r\n            //onClickInspEdit(rowData);\r\n        } else if (idButton==='photo') {\r\n            //onClickInspPhotos(rowData);\r\n        }        \r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form\r\n\t\t\t\tclassName=\"m-1\"\r\n\t\t\t\tonSubmit={handleSubmit(prepareOnSubmitTree)}\r\n\t\t\t>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formCoordEditButton\">\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.latLng\")}{\" \"}\r\n\t\t\t\t\t\t\t<a href=\"#\">\r\n\t\t\t\t\t\t\t\t<i className=\"fas fa-edit align-middle\" onClick={() => onClickEditCoords({lat:getValues(\"latitude\"), lng:getValues(\"longitude\")})}></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formLatTree\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"latitude\"\r\n                            rules={{ required: true }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tstep=\"any\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tisInvalid={!!errors.latitude}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t{t<string>(\"words.requiredField\")}\r\n\t\t\t\t\t\t</Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formLngTree\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"longitude\"\r\n                            rules={{ required: true }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\tstep=\"any\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tisInvalid={!!errors.longitude}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t{t<string>(\"words.requiredField\")}\r\n\t\t\t\t\t\t</Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formSpecies\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.species\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"species\"\r\n                        rules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={true}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsSpeciesesData}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tstyles={customStyles}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tgetOptionLabel={(option) =>`${option.label} - ${option.speciesname}`}\r\n\t\t\t\t\t\t\t\tcomponents={{ Option }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n                    <p className=\"requiredField\">{errors.species?.message}</p>\r\n\t\t\t\t</Form.Group>\r\n\r\n                \r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formSpeciesCommentTree\"\r\n\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.speciescomment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"speciescomment\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n                \r\n\t\t\t\t<Form.Group\r\n\t\t\t\t\tcontrolId=\"formCommentTree\"\r\n\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.comment\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"comment\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tas=\"textarea\"\r\n\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formPlaceTypeTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.placetype\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"placetype\"\r\n                            rules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n                                    options={optionsPlaceTypesData}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n                        <p className=\"requiredField\">{errors.placetype?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formIrrigationmethodTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.irrigationmethod\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"irrigationmethod\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n                                    options={optionsIrrigationMethodsData}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n\r\n\t\t\t\t<Row className=\"mt-3\">\r\n                    <Form.Group as={Col} controlId=\"formDatePlantedTree\" style={{ minWidth: \"230px\" }}>\r\n\t\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.dateplanted\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"dateplanted\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control type=\"date\" {...field} />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n                    <Form.Group as={Col} controlId=\"formGoogleStreetUrlTree\" style={{ minWidth: \"230px\" }}>\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.googlestreeturl\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"googlestreeturl\"\r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Form.Control\r\n                                    type=\"text\"\r\n                                    {...field}\r\n                                />\r\n                            )}\r\n                        />\r\n                    </Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\r\n                {rxNewTreeCreation ? \r\n                <>\r\n                    <Form.Group className=\"mt-4\" controlId=\"formFirstInspectionTree\">\r\n                        <Form.Label>\r\n                            <b>{t<string>(\"sidebar.treeTab.firstInspection\")}</b>\r\n                        </Form.Label>\r\n\r\n                    </Form.Group>   \r\n                    \r\n                    <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"formHeightTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.heightTree\")}\r\n                            </Form.Label>\r\n                            <Controller\r\n                                name=\"height\"\r\n                                rules={{ required: t<string>(\"words.requiredField\") }}                               \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"\r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n                            <p className=\"requiredField\">{errors.height?.message}</p>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formDiameterTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.diameterTree\")}\r\n                            </Form.Label>\r\n                            <Controller\r\n                                name=\"crowndiameter\"\r\n                                rules={{ required: t<string>(\"words.requiredField\"), max: 99, pattern: /^\\d+([.]\\d)?$/ }}                              \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"\r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n\t\t\t\t\t\t{errors.crowndiameter?.message && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">{errors.crowndiameter?.message}</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"max\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Maximum value is 99</p>\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"pattern\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Allow only one decimal point</p>\r\n\t\t\t\t\t\t}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formGirthTree\">\r\n                            <Form.Label className=\"required\">\r\n                                {t<string>(\"sidebar.treeTab.girthTree\")}\r\n                            </Form.Label>\r\n                            <div style={{height: \"100%\"}}>\r\n                            <Controller\r\n                                name=\"trunkgirth\"\r\n                                rules={{ required: t<string>(\"words.requiredField\") }}                                \r\n                                control={control}\r\n                                render={({ field }) => (\r\n                                    <Form.Control\r\n                                        type=\"number\"\r\n                                        size=\"sm\"    \r\n                                        {...field}\r\n                                    />\r\n                                )}\r\n                            />\r\n                            <p className=\"requiredField\">{errors.trunkgirth?.message}</p>\r\n                            </div>\r\n                        </Form.Group>                        \r\n\t\t\t\t    </Row>  \r\n\r\n\r\n\r\n\r\n\r\n\r\n                    <Form.Group controlId=\"formStatusTree\" className=\"mt-3\">\r\n                        <Form.Label className=\"required\">\r\n                            {t<string>(\"sidebar.treeTab.status\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"status\"\r\n                            rules={{ required: t<string>(\"words.requiredField\") }} \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsStatusesData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n                        <p className=\"requiredField\">{errors.status?.message}</p>\r\n\t\t\t\t    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formRemarksTree\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.remarks\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"remarks\"                            \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    isMulti\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsRemarksData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n\t\t\t\t    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formCareTypesTree\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.careTypes\")}\r\n                        </Form.Label>\r\n                        <Controller\r\n                            name=\"recommendations\"                            \r\n                            control={control}\r\n                            render={({ field }) => (\r\n                                <Select\r\n                                    {...field}\r\n                                    isMulti\r\n                                    placeholder={t<string>(\"words.select\")}\r\n                                    isSearchable={false}\r\n                                    //@ts-ignore\r\n                                    options={optionsCareTypesData}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n                                />\r\n                            )}\r\n                        />\r\n\t\t\t\t    </Form.Group>    \r\n\r\n\r\n                    <UploadPhotos \r\n                        controlFromUseForm={control}\r\n                        signingS3Url={signingS3Url}\r\n                        onCallbackDone={onCallbackDone}\t\r\n                        ref={uploadPhotosRef}\r\n\t\t\t\t    />\r\n                </>\r\n\r\n                \r\n                : <>\r\n                    <Form.Group controlId=\"formInspActTable\" className=\"mt-3\">\r\n                        <Form.Label>\r\n                            {t<string>(\"sidebar.treeTab.inspActionsTable\")}\r\n                        </Form.Label>\r\n                        \r\n                        <InspectionsList \r\n                            idTree={dataTreeForm?.id}\r\n                            //data={inspections} \r\n                            //OnClickButtons={OnButtonTableClick}\r\n                            onClickButtonEditInsp={onClickInspEdit}\r\n                            onClickButtonPhotosInsp={onClickInspPhotos}\r\n                        />\r\n\r\n                    </Form.Group>\r\n\r\n\r\n                    <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"formNewInspButton\">\r\n                            <Button\r\n                                style={{width: \"100%\"}}\r\n                                onClick={() => dataTreeForm?.id && onNewInsp(dataTreeForm.id)}\r\n                                variant=\"light\"\r\n                            >\r\n                                {t<string>(\"sidebar.treeTab.newInspButton\")}\r\n                            </Button>{\" \"}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formNewActButton\">\r\n                            <Button\r\n                                style={{width: \"100%\"}}\r\n                                //onClick={}\r\n                                variant=\"light\"\r\n                            >\r\n                                {t<string>(\"sidebar.treeTab.newActButton\")}\r\n                            </Button>{\" \"}\r\n                        </Form.Group>\r\n                    </Row>\r\n                </>}\r\n\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"id\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(true)}\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.delete\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button \r\n                        onClick={onCloseTree} \r\n                        variant=\"secondary\"\r\n                    >\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.close\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button                        \r\n\t\t\t\t\t\ttype=\"submit\"\r\n                        onClick={ rxNewTreeCreation ? onSubmitBefore : undefined }\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"110px\" }}\r\n                        disabled={!submitButtonEnabled}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.save\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showModalDelete}\r\n\t\t\t\tonHide={() => setShowModalDelete(false)}\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t<Modal.Title>{t<string>(\"words.deleting\")}</Modal.Title>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Body>{t<string>(\"sidebar.treeTab.confirmDeleting\")}</Modal.Body>\r\n\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowModalDelete(false);\r\n\t\t\t\t\t\t\t//onDeleteTree(parseInt(getValues(\"id\").toString()));\r\n                            onDeleteTree(dataTreeForm);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.delete\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(false)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.cancel\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n\r\n}\r\n\r\n\r\nexport default FormTree","import { useState, useEffect, useRef } from \"react\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { Form, Button, Row, Col, Modal } from \"react-bootstrap\";\r\nimport Select from \"react-select\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../reducers/index\";\r\nimport { InspItem } from \"../interfaces\";\r\nimport UploadPhotos from \"./UploadPhotos\"\r\n//import ImageS3Upload from \"./ImageS3Upload\";\r\n//import noPhotoImage from \"./images/no-photo.png\";\r\n\r\n\r\n\r\n\r\ninterface FormInspProps {\r\n\tonSubmitInsp: (data: {}) => void;\r\n\tonDeleteInsp: (data: InspItem | null) => void;\r\n\tonCloseInsp: () => void;\r\n\tdataInspForm: InspItem | null;\r\n\tcity: string;\r\n\tsigningS3Url: string;\r\n}\r\n\r\n\r\nconst FormInspection = ({\r\n\tonSubmitInsp,\r\n\tonDeleteInsp,\r\n\tonCloseInsp,\r\n\tdataInspForm,\r\n\tcity,\r\n\tsigningS3Url\r\n}: FormInspProps) => {\r\n\r\n    \t\r\n\tconst [showModalDelete, setShowModalDelete] = useState(false);\r\n\r\n\tconst rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\r\n    const rxDictCareTypes = useSelector((state: RootState) => state.dataReducer.dictCareTypes);\r\n\tconst rxDictRemarks = useSelector((state: RootState) => state.dataReducer.dictRemarks);    \r\n    const { t } = useTranslation();\r\n\tconst [submitButtonEnabled, setSubmitButtonEnabled] = useState(true);\r\n\r\n\r\n\tconst uploadPhotosRef = useRef();\r\n\r\n\tconst {\t\t\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tsetValue,\r\n\t\tgetValues,\r\n\t\tformState: { errors, isValid },\r\n\t\ttrigger \r\n\t} = useForm({ \r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\t\t\t\r\n            id: \"\",  \r\n            treeId: \"\",          \r\n            height: \"\",\r\n            crowndiameter: \"\",\r\n            trunkgirth: \"\",\r\n            status: \"\",\r\n            remarks: [],\r\n            recommendations: [],\r\n\t\t\tphoto1: \"\",\r\n\t\t\tphoto2: \"\",\r\n\t\t\tphoto3: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n\t\tlet formData: any = {};\r\n\r\n        formData.id = dataInspForm?.id;  \r\n        formData.treeId = dataInspForm?.tree; \r\n        formData.height = dataInspForm?.height; \r\n        formData.crowndiameter = dataInspForm?.crowndiameter; \r\n        formData.trunkgirth = dataInspForm?.trunkgirth; \r\n        \r\n\t\tlet status = dataInspForm?.status;\r\n\t\tif (status) {\r\n\t\t\tformData.status = optionsStatusesData.find(\t\t\t\t\r\n\t\t\t\t(item) => item.value === status\t\r\n\t\t\t);\r\n\t\t}   \r\n  \r\n        \r\n\t\tlet remarks = dataInspForm?.remarks;\r\n\t\tif (remarks) {\r\n\t\t\t//let remarksValues = remarks.map((item) => item);\r\n\t\t\tformData.remarks = optionsRemarksData.filter(\r\n\t\t\t\t//@ts-ignore\r\n                (item) => remarks.includes(item.value)\r\n\t\t\t);\r\n\t\t}  \r\n        \r\n\t\tlet recommendations = dataInspForm?.recommendations;\r\n\t\tif (recommendations) {\r\n\t\t\t//let remarksValues = remarks.map((item) => item);\r\n\t\t\tformData.recommendations = optionsCareTypesData.filter(\r\n\t\t\t\t//@ts-ignore\r\n                (item) => recommendations.includes(item.value)\r\n\t\t\t);\r\n\t\t}        \r\n\r\n\r\n\t\tif (dataInspForm?.photo1) {\r\n\t\t\tformData.photo1 = dataInspForm.photo1;\r\n\t\t} else {\r\n\t\t\tformData.photo1 = '';\r\n\t\t}\r\n\t\tif (dataInspForm?.photo2) {\r\n\t\t\tformData.photo2 = dataInspForm.photo2;\r\n\t\t} else {\r\n\t\t\tformData.photo2 = '';\r\n\t\t}\r\n\t\tif (dataInspForm?.photo3) {\r\n\t\t\tformData.photo3 = dataInspForm.photo3;\r\n\t\t} else {\r\n\t\t\tformData.photo3 = '';\r\n\t\t}\t\t\r\n\t\t\r\n        \r\n        reset(formData, { keepDefaultValues: true });\r\n\t\tconsole.log('dataInspForm', dataInspForm);\r\n\r\n    }, [dataInspForm]);\r\n\r\n\r\n    let optionsStatusesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictStatuses)) {\r\n        optionsStatusesData = rxDictStatuses.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.statusname,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsCareTypesData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictCareTypes)) {\r\n        optionsCareTypesData = rxDictCareTypes.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.carename,\r\n            };\r\n        });\r\n    }\t\r\n\r\n    let optionsRemarksData: {value: number; label: string}[] = [];\r\n    if (Array.isArray(rxDictRemarks)) {\r\n        optionsRemarksData = rxDictRemarks.map((x) => {\r\n            return {\r\n                value: x.id,\r\n                //label: t(`sidebar.filterTab.maneuversList.${x.maneuvername}`),\r\n                label: x.remarkname,\r\n            };\r\n        });\r\n    }    \r\n\r\n\r\n\r\n\r\n\tasync function onSubmitBefore(e: any) {\r\n\t\te.preventDefault();\t\t\t\t\r\n\t\tconst result = await trigger(); // programmaticaly run validation\r\n\t\tif (result) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tuploadPhotosRef.current.uploadPhotos(); // component uploadPhotos has a callback to start a submit of the form, when uploading has been finished.\r\n\t\t\tsetSubmitButtonEnabled(false);\r\n\t\t}\r\n\t}\r\n\r\n\tconst onCallbackDone = (isSuccessful: boolean) => {\r\n\t\tsetSubmitButtonEnabled(true);\r\n        isSuccessful && handleSubmit(prepareOnSubmitInsp)();\t\t\t\r\n\t}\r\n\r\n\tfunction prepareOnSubmitInsp(data: {\r\n        id: any;  \r\n        treeId: any;      \r\n        height: any;\r\n        crowndiameter: any;\r\n        trunkgirth: any;\r\n        status: any;\r\n        remarks: any;\r\n        recommendations: any;\r\n        //photo1: any;\r\n        //photo2: any;\r\n        //photo3: any;\r\n    }) {\r\n\r\n\t\tconsole.log('submit', data);\r\n\r\n        data.height = parseInt(data.height);\r\n        data.crowndiameter = parseFloat(data.crowndiameter);\r\n        data.trunkgirth = parseInt(data.trunkgirth);\r\n        data.status = data.status.value;\r\n\r\n        if (data?.remarks && Array.isArray(data.remarks)) {\r\n            let remarks: number[] = [];\r\n            data.remarks.forEach((element:{value: number; label: string}) => {\r\n                remarks.push(element.value);     \r\n            }); \r\n            data.remarks = remarks;                                          \r\n        }\r\n\r\n        if (data?.recommendations && Array.isArray(data.recommendations)) {\r\n            let recommendations: number[] = [];\r\n            data.recommendations.forEach((element:{value: number; label: string}) => {\r\n                recommendations.push(element.value);     \r\n            }); \r\n            data.recommendations = recommendations;                                          \r\n        }  \t\t\r\n\r\n\t\tonSubmitInsp({...data, user: dataInspForm?.user});\r\n\r\n    };\r\n\r\n\r\n\tconst onUploadError = (e: any) => {\r\n\t\tconsole.log('onUploadError', e);\r\n\t}\r\n\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Form className=\"m-1\" onSubmit={handleSubmit(prepareOnSubmitInsp)}>\t\t\t\t\r\n\t\t\t\t<Row className=\"mt-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formHeightTreeInsp\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.heightTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"height\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t)}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<p className=\"requiredField\">{errors.height?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formDiameterTreeInsp\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.diameterTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"crowndiameter\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\"), max: 99, pattern: /^\\d+([.]\\d)?$/ }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.crowndiameter?.message && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">{errors.crowndiameter?.message}</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"max\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Maximum value is 99</p>\r\n\t\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\t\t{errors.crowndiameter?.type === \"pattern\" && \r\n\t\t\t\t\t\t\t<p className=\"requiredField\">Allow only one decimal point</p>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"formGirthTreeInsp\">\r\n\t\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.girthTree\")}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"trunkgirth\"\r\n\t\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<p className=\"requiredField\">{errors.trunkgirth?.message}</p>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formStatusTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label className=\"required\">\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.status\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"status\"\r\n\t\t\t\t\t\trules={{ required: t<string>(\"words.requiredField\") }}\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsStatusesData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<p className=\"requiredField\">{errors.status?.message}</p>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formRemarksTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.remarks\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"remarks\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsRemarksData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formCareTypesTree\" className=\"mt-3\">\r\n\t\t\t\t\t<Form.Label>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.treeTab.careTypes\")}\r\n\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"recommendations\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\t\tplaceholder={t<string>(\"words.select\")}\r\n\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\toptions={optionsCareTypesData}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\r\n\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdInsp\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"id\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\t\t\t\t\r\n\r\n\r\n\t\t\t\t<UploadPhotos \r\n\t\t\t\t\tcontrolFromUseForm={control}\r\n\t\t\t\t\tsigningS3Url={signingS3Url}\r\n\t\t\t\t\tserverPhoto={dataInspForm?.photoServer}\r\n\t\t\t\t\tonCallbackDone={onCallbackDone}\t\r\n\t\t\t\t\tref={uploadPhotosRef}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<Form.Group controlId=\"formIdTreeInsp\" className=\"mt-3\">\r\n\t\t\t\t\t<Controller\r\n\t\t\t\t\t\tname=\"treeId\"\r\n\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>      \r\n\r\n\r\n\r\n\t\t\t\t<div className=\"mt-4 me-2 float-end\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(true)}\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t> \r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.delete\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button \r\n                        onClick={onCloseInsp} \t\t\t\t\t\r\n                        variant=\"secondary\"\r\n                    >\r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.close\")}\r\n\t\t\t\t\t</Button>{\" \"}\r\n\t\t\t\t\t<Button                        \r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tonClick={onSubmitBefore}\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\tstyle={{ minWidth: \"110px\" }}\r\n\t\t\t\t\t\tdisabled={!submitButtonEnabled}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"sidebar.inspTab.save\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\r\n\r\n\r\n\r\n\t\t\t</Form>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showModalDelete}\r\n\t\t\t\tonHide={() => setShowModalDelete(false)}\r\n\t\t\t>\r\n\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t<Modal.Title>{t<string>(\"words.deleting\")}</Modal.Title>\r\n\t\t\t\t</Modal.Header>\r\n\t\t\t\t<Modal.Body>{t<string>(\"sidebar.inspTab.confirmDeleting\")}</Modal.Body>\r\n\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowModalDelete(false);\r\n\t\t\t\t\t\t\t//onDeleteInsp(parseInt(getValues(\"id\").toString()));\r\n                            onDeleteInsp(dataInspForm);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.delete\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => setShowModalDelete(false)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"words.cancel\")}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FormInspection;\r\n","import Carousel from \"react-bootstrap/Carousel\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport \"./ImageSlider.css\";\r\n\r\n\r\ninterface ImageSliderProps {\r\n    visible: boolean;\r\n    setVisible: any;\r\n    images: string[];\r\n} \r\n\r\nfunction ImageSlider({\r\n    visible,\r\n    setVisible,\r\n    images\r\n}: ImageSliderProps) {\r\n  return (\r\n    \r\n    \r\n    <Modal\r\n        show={visible}\r\n        onHide={() => setVisible({visible: false, images:[]})}\r\n        //size=\"lg\"\r\n        //@ts-ignore\r\n        dialogClassName=\"modal-90w\"       \r\n        aria-labelledby=\"example-custom-modal-styling-title\"\r\n    >\r\n        <Modal.Body>\r\n            <Carousel interval={null}>\r\n                {                \r\n                    images.map((photo) => \r\n                        <Carousel.Item key={photo} >\r\n                            <img\r\n                                className=\"d-block w-100\"\r\n                                src={photo}                                               \r\n                            />\r\n                        </Carousel.Item>                    \r\n                    )                \r\n                }                \r\n            </Carousel>\r\n        </Modal.Body>\r\n    </Modal>\r\n\r\n  )\r\n}\r\n\r\nexport default ImageSlider","import { Form, Button, Row, Col, } from 'react-bootstrap';\r\nimport Table from 'react-bootstrap/Table';\r\nimport Carousel from \"react-bootstrap/Carousel\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport InspectionsList from './InspectionsList';\r\nimport { useTranslation } from 'react-i18next';\r\nimport \"./TreePreviewModal.css\";\r\nimport noPhotoImage from \"./images/no-photo.png\";\r\n\r\ninterface TreePreviewModalProps {\r\n    visible: boolean;\r\n    data: any;\r\n    setTreePreview: any; \r\n    onButtonEditTreeClick: (idTree: number) => void;\r\n    onClickInspEdit: (data: {}) => void;\r\n    onClickButtonEditInsp: (inspData: any) => void;\r\n    onClickButtonPhotosInsp: (inspData: any) => void;    \r\n} \r\n\r\nfunction TreePreviewModal({\r\n    visible,\r\n    data,\r\n    setTreePreview,\r\n    onButtonEditTreeClick,\r\n    onClickButtonEditInsp,\r\n    onClickButtonPhotosInsp\r\n}: TreePreviewModalProps) {\r\n\r\n    const { t } = useTranslation();    \r\n    const handleClose = () => setTreePreview({visible: false, data: {photos:[]}});    \r\n    const handleEditTree = () => {\r\n        setTreePreview({visible: false, data: {photos:[]}}); \r\n        onButtonEditTreeClick(data.id)   \r\n    }\r\n\r\n    const onClickButtonEditInspBefore = (inspData: any) => {\r\n        setTreePreview({visible: false, data: {photos:[]}});\r\n        onClickButtonEditInsp(inspData);\r\n    }\r\n\r\n    const isPrevNextControlsEnable = () => {\r\n        return numberOfPhotos() > 1;\r\n    }\r\n\r\n    function numberOfPhotos() {\r\n        let result = 0;\r\n        if (data?.lastinsp_photo1 && data.lastinsp_photo1) result++;\r\n        if (data?.lastinsp_photo2 && data.lastinsp_photo2) result++;\r\n        if (data?.lastinsp_photo3 && data.lastinsp_photo3) result++;\r\n        \r\n        return result;        \r\n    }\r\n\r\n\r\n\r\n    function itemPhoto(photoIndex: string){\r\n        const photoKeyName = 'lastinsp_photo'+photoIndex;\r\n        \r\n        return (            \r\n            (data.hasOwnProperty(photoKeyName) && data[photoKeyName]) && (\r\n                <Carousel.Item key={data[photoKeyName]} className=\"carouselItem\">\r\n                    <img\r\n                        className=\"d-block w-100 imgItem\" alt={\"photo\"+photoIndex}\r\n                        src={data.photoServer+data[photoKeyName]}                                               \r\n                    />\r\n                </Carousel.Item> \r\n            )\r\n        )         \r\n    }\r\n\r\n    function imgPhotoItem() {        \r\n       \r\n        if (numberOfPhotos() > 0) {\r\n            return (\r\n                <Carousel interval={null} controls={isPrevNextControlsEnable()}>\r\n                    \r\n                    {itemPhoto('1')}\r\n                    {itemPhoto('2')}\r\n                    {itemPhoto('3')}\r\n                    \r\n                </Carousel>                \r\n            )\r\n        } else {\r\n            return (\r\n                <Carousel interval={null} controls={isPrevNextControlsEnable()}>\r\n                    <Carousel.Item className=\"carouselItem\">\r\n                        <img className=\"d-block w-100 imgItem\" alt=\"\" src={noPhotoImage} />\r\n                    </Carousel.Item>   \r\n                </Carousel>   \r\n            )\r\n        }\r\n    }\r\n\r\n\r\n    return (    \r\n    \r\n        <Modal\r\n            show={visible}\r\n            onHide={handleClose}\r\n            //size=\"lg\"\r\n            //@ts-ignore\r\n            dialogClassName=\"modal-90w\"       \r\n            aria-labelledby=\"example-custom-modal-styling-title\"\r\n        >\r\n\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>{data.localname} - {data.species} </Modal.Title>\r\n            </Modal.Header>\r\n\r\n            <Modal.Body>\r\n                <Row className=\"mt-1\">\r\n                    <Form.Group\r\n                            as={Col}\r\n                            controlId=\"formTreePreviewLeftSide\"\r\n                            style={{ minWidth: \"300px\" }}\r\n                    >\r\n                        \r\n                            {imgPhotoItem()}\r\n                        \r\n                     \r\n                    </Form.Group>\r\n\r\n                    <Form.Group\r\n                            as={Col}\r\n                            controlId=\"formTreePreviewRightSide\"\r\n                            //style={{ minWidth: \"230px\" }}\r\n                    >\r\n                        <Table striped>\r\n                            <tbody>\r\n                                <RowTable title={t<string>(\"TreePreviewModal.status\")} value={data.lastinsp_status} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.parameters\")} value={`${t<string>(\"TreePreviewModal.heightTree\")}: ${data.lastinsp_height} \\u00A0\\u00A0 ${t<string>(\"TreePreviewModal.girthTree\")}: ${data.lastinsp_trunkgirth} \\u00A0\\u00A0 ${t<string>(\"TreePreviewModal.diameterTree\")}: ${data.lastinsp_crowndiameter}`} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.dateplanted\")} value={dateTimeToDate(data.dateplanted)} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.googlestreeturl\")} value={data.googlestreeturl} isValueIsLink/>\r\n                                <RowTable title={t<string>(\"TreePreviewModal.remarks\")} value={data.lastinsp_remarks} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.careTypes\")} value={data.lastinsp_recommendations} />\r\n                                <RowTable title={t<string>(\"TreePreviewModal.comment\")} value={data.comment} />                                \r\n                            </tbody>\r\n                        </Table>\r\n\r\n\r\n                        <p className=\"mt-5\" id=\"captionInspectsActions\">Прегледи и Дейности</p>\r\n\r\n                        <InspectionsList \r\n                            idTree={data?.id}                             \r\n                            onClickButtonEditInsp={onClickButtonEditInspBefore}\r\n                            onClickButtonPhotosInsp={onClickButtonPhotosInsp}                          \r\n                        />\r\n\r\n                    </Form.Group>                \r\n                </Row>\r\n            </Modal.Body>\r\n\r\n            <Modal.Footer>\r\n                <Button variant=\"light\" onClick={handleEditTree}>\r\n                    {t<string>(\"TreePreviewModal.edit\")}\r\n                </Button>\r\n                <Button variant=\"primary\" style={{ minWidth: \"160px\" }} onClick={handleClose}>\r\n                    {t<string>(\"TreePreviewModal.close\")}\r\n                </Button>\r\n            </Modal.Footer>\r\n\r\n        </Modal>\r\n\r\n    )\r\n}\r\n\r\n\r\ninterface RowTableProps {\r\n    title: string;\r\n    value: string | null;\r\n    isValueIsLink?: boolean;   \r\n} \r\n\r\nconst RowTable = ({title, value, isValueIsLink}: RowTableProps) => {\r\n    if (value) {\r\n        return (\r\n            <tr>\r\n                <td>{title}</td>\r\n                { isValueIsLink ? \r\n                    <td><a href={value} target=\"_blank\">Link</a></td>\r\n                : <td>{value}</td>\r\n                }\r\n          </tr>                \r\n        );\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n\r\nfunction dateTimeToDate(dateTimeStr: string) {\r\n    if (dateTimeStr) {\r\n        const dateTime = new Date(dateTimeStr);\r\n        if (dateTime) {\r\n            const arDateTime = dateTime.toISOString().split(\"T\");\r\n            if (arDateTime.length === 2) {\r\n                return arDateTime[0];\r\n            } \r\n            return dateTimeStr;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\n\r\nexport default TreePreviewModal","import { getCookie } from \"../utils/misc\";\r\n\r\nexport const csrftoken = getCookie(\"csrftoken\");","import { csrftoken } from '../constants/const'\r\n\r\nexport async function fetchUrl2(url: string, method: string, bodyObject?: any, tokenAccess?: string) {\r\n    const myHeaders = getHTTPHeader(csrftoken, tokenAccess);\r\n\r\n    const fetchResult = await fetch(url, {\r\n        method: method,\r\n        headers: myHeaders,\r\n        body: JSON.stringify(bodyObject),\r\n    });\r\n\r\n    const result = await fetchResult.json();\r\n    if (fetchResult.ok) {\r\n        return result;\r\n    }\r\n\r\n    //@ts-ignore\r\n    throw new fetchException(fetchResult.status, fetchResult.statusText, result.detail);    \r\n};\t\r\n\r\nfunction fetchException(status: number, message: string, detail: string) {\r\n    //@ts-ignore\r\n    this.message = message;\r\n    //@ts-ignore\r\n    this.status = status;\r\n    //@ts-ignore\r\n    this.detail = detail;    \r\n}\t\r\n\r\nfunction getHTTPHeader(csrftoken: string | null, accessToken: string | undefined){\r\n    const myHeaders = new Headers();\r\n    myHeaders.append(\"Content-type\", \"application/json\");\r\n    \r\n    if (csrftoken) {\r\n        myHeaders.append(\"X-CSRFToken\", csrftoken);\r\n        console.log('csrftoken', csrftoken);\r\n    }\t\r\n    if (accessToken) {\r\n        myHeaders.append(\"Authorization\", \"Bearer \" + accessToken);\r\n    }\r\n    return myHeaders;\r\n}\r\n\r\n\r\n\r\nexport function getCookie(name: string) {\r\n    var cookieValue = null;\r\n    if (document.cookie && document.cookie !== \"\") {\r\n        var cookies = document.cookie.split(\";\");\r\n        for (var i = 0; i < cookies.length; i++) {\r\n            var cookie = cookies[i].trim();\r\n            // Does this cookie string begin with the name we want?\r\n            if (cookie.substring(0, name.length + 1) === name + \"=\") {\r\n                cookieValue = decodeURIComponent(\r\n                    cookie.substring(name.length + 1)\r\n                );\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return cookieValue;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// function fetchUrl(url: string, method: string, bodyObject?: any, tokenAccess?: string, callBackSucceed?: (data: any) => void) {\r\n//     const myHeaders = getHTTPHeader(csrftoken, tokenAccess);\r\n\r\n//     fetch(url, {\r\n//         method: method,\r\n//         headers: myHeaders,\r\n//         body: JSON.stringify(bodyObject),\r\n//     }).then(function (response) {\r\n//         if (response.status >= 400) {\r\n//             console.log('fetchUrl', response.status, response.statusText);\r\n\r\n            \r\n//             response.json().then((data) => {\r\n//                 //@ts-ignore\r\n//                 throw new fetchException(response.status, response.statusText, data.detail);\r\n//             \t// alert(\r\n//             \t// \tresponse.statusText +\r\n//             \t// \t\t\" (\" +\r\n//             \t// \t\tresponse.status +\r\n//             \t// \t\t\")\\n\\n\" +\r\n//             \t// \t\tdata.detail\r\n//             \t// );\r\n//             });\r\n//         } else {\r\n            \r\n//             if (callBackSucceed) {\r\n\r\n//                 response.json().then((data) => {\r\n//                     callBackSucceed(data);\r\n//                 })\r\n                \r\n//             }\r\n//         }\r\n//     });\r\n// };","export const URL_LOGIN = `${process.env.REACT_APP_API_URL}token/`;\r\nexport const URL_REFRESH_TOKEN = `${process.env.REACT_APP_API_URL}token/refresh/`;\r\nexport const URL_VERIFY_TOKEN = `${process.env.REACT_APP_API_URL}token/verify/`;\r\n\r\nexport const URL_GET_PERMISSIONS = `${process.env.REACT_APP_API_URL}currentusers/permissions/citytree`;\r\n\r\nexport const URL_GENERATE_S3_URLKEY = `${process.env.REACT_APP_API_URL}citytree/s3/generate_signed_url/`\r\n\r\nexport const URL_GET_DICT_SPECIESES = `${process.env.REACT_APP_API_URL}citytree/dictionary/specieses/`;\r\nexport const URL_GET_DICT_CARETYPES = `${process.env.REACT_APP_API_URL}citytree/dictionary/caretypes/`;\r\nexport const URL_GET_DICT_REMARKS = `${process.env.REACT_APP_API_URL}citytree/dictionary/remarks/`;\r\nexport const URL_GET_DICT_PLACETYPES = `${process.env.REACT_APP_API_URL}citytree/dictionary/placetypes/`;\r\nexport const URL_GET_DICT_IRRIGATIONMETHODS = `${process.env.REACT_APP_API_URL}citytree/dictionary/irrigationmethods/`;\r\nexport const URL_GET_DICT_GROUPSPECS = `${process.env.REACT_APP_API_URL}citytree/dictionary/groupspecs/`;\r\nexport const URL_GET_DICT_TYPESPECS = `${process.env.REACT_APP_API_URL}citytree/dictionary/typespecs/`;\r\nexport const URL_GET_DICT_STATUSES = `${process.env.REACT_APP_API_URL}citytree/dictionary/statuses`;\r\n\r\nexport const urlTreesByCity = (cityName: string) => `${process.env.REACT_APP_API_URL}citytree/${cityName}/trees/`;\r\nexport const urlTreeByCityAndID = (cityName: string, id: number) => `${process.env.REACT_APP_API_URL}citytree/${cityName}/trees/${id}/`;\r\n\r\n\r\n\r\n","import { useState } from 'react';\r\nimport { getCookie, fetchUrl2 } from \"../utils/misc\"\r\nimport { URL_VERIFY_TOKEN, URL_REFRESH_TOKEN } from '../constants/urlsAPI';\r\n\r\ninterface userTokenJson {\r\n    access: string; \r\n    refresh: string; \r\n    user: {\r\n        id: number; \r\n        name: string;\r\n    }    \r\n}\r\n\r\n\r\nexport const useAuthToken = () => {\r\n        \r\n    const [authToken, setAuthToken] = useState(getToken());\r\n\r\n    function getToken() {        \r\n        let tokenString;\r\n        const rememberme = localStorage.getItem('rememberme');\r\n\r\n        if (rememberme==='true') {\r\n            tokenString = localStorage.getItem('token');\r\n        } else {\r\n            tokenString = sessionStorage.getItem('token');\r\n        }\r\n        \r\n        if (tokenString) {            \r\n            const json = JSON.parse(tokenString);\r\n            const user = getUserInfoFromToken(json);\r\n            if (user) {\r\n                json.user = user;\r\n            }      \r\n\r\n            return json;        \r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    const saveToken = (userToken: userTokenJson | null) => {\r\n        console.log('saveToken', userToken);\r\n        if (userToken) {\r\n            const rememberme = localStorage.getItem('rememberme');\r\n\r\n            if (rememberme === 'true') {\r\n                localStorage.setItem('token', JSON.stringify(userToken));\r\n            } else {\r\n                sessionStorage.setItem('token', JSON.stringify(userToken));\r\n            }\r\n                        \r\n            const user = getUserInfoFromToken(userToken);\r\n            if (user) {                \r\n                if (userToken?.user) {\r\n                    userToken.user = {...userToken.user, id: user.id, name: user.name}\r\n                } else {\r\n                    userToken.user = user;    \r\n                }\r\n                \r\n            }            \r\n        } else {\r\n            localStorage.removeItem(\"token\");\r\n            localStorage.removeItem(\"rememberme\"); \r\n            sessionStorage.removeItem(\"token\");\r\n        }           \r\n        console.log('saveToken', userToken);\r\n        setAuthToken(userToken);\r\n    };    \r\n\r\n    function getUserInfoFromToken(json: userTokenJson): {id: number; name: string} | undefined {        \r\n        let token = json?.access; \r\n\r\n        if (token) {\r\n            const arToken = token.split('.');\r\n            if (arToken.length > 1) {\r\n                console.log('getUserInfoFromToken', JSON.parse(atob(arToken[1])));\r\n                return {                    \r\n                    \"name\": JSON.parse(atob(arToken[1])).username,\r\n                    \"id\": JSON.parse(atob(arToken[1])).user_id\r\n                }    \r\n            }\r\n        }\r\n    }    \r\n\r\n\r\n    return [authToken, saveToken];  \r\n}\r\n\r\n\r\nexport async function userAuthentication(authToken: any, setAuthToken: any) {\r\n    if (authToken) {\r\n        const isTokenValid = await checkAuthToken(URL_VERIFY_TOKEN, authToken.access);\r\n        console.log('isTokenValid', isTokenValid);\r\n        \r\n        if (isTokenValid) return true;\r\n        \r\n        if (!isTokenValid) {\r\n            return await refreshTokens(setAuthToken, authToken.refresh);\t\t\t\t\t\t\t\r\n        }\t\t\t\t\t\t\t\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function checkAuthToken(urlCheckingToken: string, accessToken: string) {    \r\n    try {\r\n        await fetchUrl2(urlCheckingToken, 'POST', { token: accessToken }, accessToken); // if success, return just empty object {}\r\n        return true;\r\n    } catch (err) {\r\n        console.log('checkAuthToken', err);\r\n        return false;        \r\n    }\t\t\t\r\n};\t\r\n\r\nexport async function refreshTokens(setAuthToken: any, refreshToken: string) {\r\n    const accessRefreshToken = await getNewAccessRefreshAuthToken(URL_REFRESH_TOKEN, refreshToken);        \r\n    setAuthToken(accessRefreshToken);\r\n    if (accessRefreshToken) return true;\r\n    return false;\t\t\t\t\r\n}\r\n\r\n\r\n\r\nexport async function getNewAccessRefreshAuthToken(urlRefreshingToken: string, refreshToken: string){\r\n    try {\r\n        const response = await fetchUrl2(urlRefreshingToken, 'POST', { refresh: refreshToken });\r\n        return response;\r\n    } catch (err) {\r\n        console.log('getNewAccessRefreshAuthToken', err);\r\n        return null;        \r\n    }\r\n    \r\n    \r\n    \r\n    // const csrftoken = getCookie(\"csrftoken\");\r\n    // let myHeaders = new Headers();\r\n    // myHeaders.append(\"Content-type\", \"application/json\");\r\n    // if (csrftoken) {\r\n    //     myHeaders.append(\"X-CSRFToken\", csrftoken);\r\n    // }\t\r\n\r\n    // const response = await fetch(urlRefreshingToken, {\r\n    //     method: \"POST\",\r\n    //     headers: myHeaders,\r\n    //     body: JSON.stringify({ refresh: refreshToken }),\r\n    // });\r\n    \r\n    // if (response.status >= 400) {\r\n    //     return null;\r\n    // } else {\r\n    //     const responseJson = await response.json();\r\n    //     return responseJson;\t\r\n    // }\t\t\r\n};","import { useState, useEffect } from 'react'\r\nimport { Form, Button, FloatingLabel, Modal } from \"react-bootstrap\";\r\nimport { useForm, Controller  } from 'react-hook-form'\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { actLoginModalShow, actRegisterModalShow } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\nimport { URL_LOGIN } from '../constants/urlsAPI';\r\n\r\n\r\n\r\ninterface Credentials {\r\n\tusername: string; \r\n\tpassword: string; \r\n\trememberme: boolean;\r\n} \r\n\r\n\r\ninterface LoginModalFormProps {\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n}\r\n\r\n\r\nconst LoginModalForm = ({setAuthToken} : LoginModalFormProps) => {\r\n\tconst dispatch = useDispatch();\r\n\tconst rxLoginModalShow = useSelector((state: RootState) => state.uiReducer.loginModalShow)\r\n\r\n\tconst [showWrongPassword, setShowWrongPassword] = useState(false);\r\n\tconst { t } = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\r\n\t\tsetShowWrongPassword(false);\r\n\t}, [rxLoginModalShow]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\trememberme: false,\r\n\t\t},\r\n\t});\r\n\r\n\tasync function loginUser(credentials: Credentials) {\r\n\t\tconsole.log(credentials)\r\n\t\treturn fetch(URL_LOGIN, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\t\t}).then((data) => {\r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\t\t\t\t\t\t\t\r\n\t\t\t\t\tconsole.log('setAuthToken', data);\r\n\t\t\t\t\tsetAuthToken(data);\t\t\t\t\t\r\n\t\t\t\t\tsetShowWrongPassword(false);\t\t\t\t\t\r\n\t\t\t\t\tdispatch(actLoginModalShow(false));\r\n\t\t\t\t});\r\n\t\t\t} else if (data.status === 401) {\r\n\t\t\t\tsetShowWrongPassword(true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconst OnSubmitForm = (data: Credentials) => {\r\n\t\tsetShowWrongPassword(false);\r\n\t\tlocalStorage.setItem(\"rememberme\", data.rememberme.toString());\r\n\t\tloginUser(data);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\t//show={show}\r\n\t\t\tshow={rxLoginModalShow}\r\n\t\t\t//onHide={onHide}\r\n\t\t\tonHide={() => dispatch(actLoginModalShow(false))}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t<string>(\"loginForm.title\")}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formLogin\">\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingInput\"\r\n\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.username\")}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t(\"loginForm.username\")}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.password\")}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t(\"loginForm.password\")}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formBasicCheckbox\">\r\n\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\tname=\"rememberme\"\r\n\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t/* @ts-ignore */\r\n\t\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\tlabel={t<string>(\"loginForm.rememberMe\")}\r\n\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t{showWrongPassword && (\r\n\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t{t<string>(\"loginForm.wrongUsernamePassword\")}\r\n\t\t\t\t\t\t</Form.Text>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>(\"loginForm.login\")}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{/* {t('loginForm.dontHaveAccount')} <a href=\"#\" onClick={()=> { setLoginModalShow(false); setRegisterModalShow(true) } }>{t('loginForm.signUp')}</a> */}\r\n\t\t\t\t\t\t\t{t<string>(\"loginForm.dontHaveAccount\")}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(false));\r\n\t\t\t\t\t\t\t\t\tdispatch(actRegisterModalShow(true));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>(\"loginForm.signUp\")}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default LoginModalForm;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Form, Button, FloatingLabel, Modal, Col, Row } from \"react-bootstrap\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { actLoginModalShow, actRegisterModalShow } from '../actions'\r\nimport { RootState } from '../reducers/index'\r\n\r\n\r\n\r\ninterface RegisterModalFormProps {\r\n\tsetAuthToken: (userToken: {access: string; refresh: string; user?: {id: number; name: string}} | null) => void;\r\n}\r\n\r\n\r\ninterface RegisterData {\r\n\tusername: string;\r\n\temail: string;\r\n\tpassword: string;\r\n\tpassword2: string;\r\n\tfirst_name: string;\r\n\tlast_name: string;\r\n} \r\n\r\n\r\n\r\n\r\nconst RegisterModalForm = ({setAuthToken}: RegisterModalFormProps) => {\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst rxRegisterModalShow = useSelector((state: RootState) => state.uiReducer.registerModalShow)\t\r\n\t\r\n\tconst { t } = useTranslation()\r\n\r\n\tuseEffect(() => {\r\n\t\treset();\t\r\n\t}, [rxRegisterModalShow]);\r\n\r\n\tconst {\r\n\t\tcontrol,\r\n\t\thandleSubmit,\r\n\t\treset,\r\n        setError,\r\n\t\tformState: { errors },\r\n\t} = useForm({\r\n\t\t//reValidateMode: 'onChange',\r\n\t\tdefaultValues: {\r\n\t\t\tusername: \"\",\r\n\t\t\temail: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tpassword2: \"\",\r\n\t\t\tfirst_name: \"\",\r\n\t\t\tlast_name: \"\",\r\n\t\t},\r\n\t});\r\n\r\n\r\n\r\n\r\n\tconst OnSubmitForm = (data: RegisterData) => {\r\n\t\tregisterUser(data);\r\n\t};\r\n\r\n\tasync function registerUser(credentials: RegisterData) {\t\t\r\n\t\treturn fetch(`${process.env.REACT_APP_API_URL}users/`, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\r\n\t\t\tbody: JSON.stringify(credentials),\r\n\r\n\t\t}).then((data) => {            \r\n\t\t\tif (data.status === 200) {\r\n\t\t\t\tdata.json().then((data) => {\t\r\n                    console.log('ok', data)\t\t\t\t\r\n                    //setRegisterModalShow(false);\r\n\t\t\t\t\tdispatch(actRegisterModalShow(false))\r\n                    setAuthToken(data.token) // after register make login\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t} else if (data.status >= 400) {\r\n\t\t\t\tdata.json().then((data) => {\r\n\t\t\t\t\tconsole.log(data)\r\n                \r\n                    for (const [key, value] of Object.entries(data)) {                \r\n                        //@ts-ignore\r\n\t\t\t\t\t\tsetError(key, {\r\n                            type: \"manual\",\r\n                            message: value,\r\n                        }); \r\n                    }                   \r\n\t\t\t\t});                \r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\t//{...props}\r\n\t\t\t//show={show}\r\n\t\t\tshow={rxRegisterModalShow}\r\n\t\t\t//onHide={onHide}\r\n\t\t\tonHide={() => dispatch(actRegisterModalShow(false))}\r\n\t\t\taria-labelledby=\"contained-modal-title-vcenter\"\r\n\t\t\tcentered\r\n\t\t>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t\t\t\t{t<string>('registerForm.title')}\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Form onSubmit={handleSubmit(OnSubmitForm)}>\r\n\t\t\t\t\t<Form.Group className=\"mb-3\" controlId=\"formRegister\">\r\n\t\t\t\t\t\t\r\n                \r\n                        {errors?.username?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore*/}\r\n\t\t\t\t\t\t\t\t{errors.username.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                        \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingUsername\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.username')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.username')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.username}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n                        \r\n                        {errors?.email?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore  message is array, but declared as string */}\r\n\t\t\t\t\t\t\t\t{errors.email.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}                          \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingEmail\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.email')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"email\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.email')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.email}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\r\n                        {errors?.password?.message && (\r\n\t\t\t\t\t\t\t<Form.Text className=\"text-danger\">\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{/*@ts-ignore*/}\r\n\t\t\t\t\t\t\t\t{errors.password.message.map(value => <p key={value} className=\"mb-0\">{value}</p>)}\r\n\t\t\t\t\t\t\t</Form.Text>                           \r\n\t\t\t\t\t\t)}  \r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.password')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.password')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\t\tcontrolId=\"floatingPassword2\"\r\n\t\t\t\t\t\t\tlabel={t<string>('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\tname=\"password2\"\r\n\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\trules={{ required: true }}\r\n\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.confirmPassword')}\r\n\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.password2}\r\n\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FloatingLabel>\r\n\r\n\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"first_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.firstNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.first_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<Controller\r\n\t\t\t\t\t\t\t\t\tname=\"last_name\"\r\n\t\t\t\t\t\t\t\t\tcontrol={control}\r\n\t\t\t\t\t\t\t\t\trules={{ required: false }}\r\n\t\t\t\t\t\t\t\t\trender={({ field }) => (\r\n\t\t\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('registerForm.lastNameOptional')}\r\n\t\t\t\t\t\t\t\t\t\t\tisInvalid={!!errors.last_name}\r\n\t\t\t\t\t\t\t\t\t\t\t{...field}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName=\"mb-3\"\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tstyle={{ display: \"block\", width: \"100%\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{t<string>('registerForm.register')}\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Form.Text className=\"text-muted mb-0\">\r\n\t\t\t\t\t\t<p className=\"text-center\">\r\n\t\t\t\t\t\t\t{t<string>('registerForm.alreadyHaveAccount')}{\" \"}\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(actRegisterModalShow(false))\r\n\t\t\t\t\t\t\t\t\tdispatch(actLoginModalShow(true))\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t<string>('registerForm.login')}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</Form.Text>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RegisterModalForm;\r\n","export const filterDataMap = (feature: any, dataFilters: any, authToken: any): boolean => {\r\n\t\t\r\n    const objectSearchResult = {\r\n        species: true,\r\n        status: true,\r\n        recommendations: true,\r\n        remarks: true,\r\n        placetype: true,\r\n        irrigationmethod: true,\r\n\r\n        plantedDateFrom: true,\r\n        plantedDateTo: true,\r\n        addedDateFrom: true,\r\n        addedDateTo: true,\r\n        comment: true,\r\n\r\n        heightFrom: true,\r\n        heightTo: true,\r\n        trunkGirthFrom: true,\r\n        trunkGirthTo: true,\r\n        crownDiameterFrom: true,\r\n        crownDiameterTo: true,\r\n\r\n        showOnlyMyTrees: true\t\t\t\r\n    }\r\n\r\n    let valueFilter;\r\n\r\n            \r\n    valueFilter = dataFilters?.speciesFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.species = isFoundArrayInValue(valueFilter, feature.properties.species);\t\t\t\r\n    }\r\n\r\n    valueFilter = dataFilters?.statusFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.status = isFoundArrayInValue(valueFilter, feature.properties.lastinsp_status);\t\t\t\r\n    }\r\n\r\n\r\n    valueFilter = dataFilters?.careTypeFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.recommendations = isFoundArrayInArray(valueFilter, feature.properties.recommendations);\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.remarkFilter;\r\n    if (Array.isArray(valueFilter)) {\r\n        objectSearchResult.remarks = isFoundArrayInArray(valueFilter, feature.properties.remarks);\r\n    }\t\t\r\n\r\n\r\n\r\n    valueFilter = dataFilters?.placeTypeFilter?.value;\r\n    if (valueFilter) {\r\n        objectSearchResult.placetype = valueFilter === feature.properties.placetype;\r\n    }\r\n\r\n    valueFilter = dataFilters?.irrigationMethodFilter?.value;\r\n    if (valueFilter) {\r\n        objectSearchResult.irrigationmethod = valueFilter === feature.properties.irrigationmethod;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.datePlantedFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.plantedDateFrom =\r\n            feature.properties.dateplanted >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.datePlantedToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.plantedDateTo =\r\n            feature.properties.dateplanted <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.dateAddedFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.addedDateFrom =\r\n            feature.properties.datetimeadded >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.dateAddedToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.addedDateTo =\r\n            feature.properties.datetimeadded <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.commentFilter;\r\n    if (valueFilter) {\r\n        if (\r\n            feature.properties.comment\r\n                .toLowerCase()\r\n                .indexOf(valueFilter.toLowerCase()) === -1\r\n        ) {\r\n            objectSearchResult.comment = false;\r\n        }\r\n    }\t\t\r\n\r\n\r\n    \r\n    valueFilter = dataFilters?.heightFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.heightFrom = feature.properties.lastinsp_height >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.heightToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.heightTo = feature.properties.lastinsp_height <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.trunkGirthFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.trunkGirthFrom = feature.properties.lastinsp_trunkgirth >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.trunkGirthToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.trunkGirthTo = feature.properties.lastinsp_trunkgirth <= valueFilter;\r\n    }\t\r\n    \r\n    valueFilter = dataFilters?.crownDiameterFromFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.crownDiameterFrom = feature.properties.lastinsp_crowndiameter >= valueFilter;\r\n    }\r\n    valueFilter = dataFilters?.crownDiameterToFilter;\r\n    if (valueFilter) {\r\n        objectSearchResult.crownDiameterTo = feature.properties.lastinsp_crowndiameter <= valueFilter;\r\n    }\t\t\r\n\r\n\r\n\r\n    valueFilter = dataFilters?.showMyTreesFilter;\r\n    if (valueFilter && authToken?.user) {\r\n        objectSearchResult.showOnlyMyTrees = authToken.user.id === feature.properties.useradded;\t\r\n    }\r\n\r\n\r\n    let result = true;\r\n    for (const el in objectSearchResult) {\r\n        //@ts-ignore\r\n        if (objectSearchResult[el] === false) {\r\n            result = false;\r\n            break;\r\n        }\t\t\t\r\n    }\r\n                 \r\n    //rxDataTrees.dateTimeGenerated = Date.now(); // dateTimeGenerated is used like key parameter to update data on map, when it changed\r\n    return result;\r\n};\r\n\r\nfunction isFoundArrayInValue(array: {value: number}[], value: number) {\r\n    for (let el of array) {\r\n        if (el.value === value) {\r\n            return true;\t\t\t\t\r\n        }\t\t\t\t\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction isFoundArrayInArray(arraySearch: {value: number}[], arrayTree: string[]){\r\n    const intersection = arraySearch.filter((x) => {\r\n        return arrayTree.includes(String(x.value));\r\n    });\r\n    return intersection.length > 0;\r\n}\t","import { \r\n    URL_GET_DICT_SPECIESES, \r\n    URL_GET_DICT_CARETYPES,\r\n    URL_GET_DICT_REMARKS,\r\n    URL_GET_DICT_PLACETYPES,\r\n    URL_GET_DICT_IRRIGATIONMETHODS,\r\n    URL_GET_DICT_GROUPSPECS,\r\n    URL_GET_DICT_TYPESPECS \r\n} from '../constants/urlsAPI';\r\n\r\n\r\nexport const fetchAllDictionariesData = async() => {\t\t\r\n    \r\n    const [\r\n        speciesesResponse, \r\n        caretypesResponse, \r\n        remarksResponse, \r\n        placetypesResponse, \r\n        irrigationmethodsResponse, \r\n        groupspecsResponse, \r\n        typespecsResponse\r\n    ] = await Promise.all([\r\n        \r\n        fetchData(URL_GET_DICT_SPECIESES),\r\n        fetchData(URL_GET_DICT_CARETYPES),\r\n        fetchData(URL_GET_DICT_REMARKS),\r\n        fetchData(URL_GET_DICT_PLACETYPES),\r\n        fetchData(URL_GET_DICT_IRRIGATIONMETHODS),\r\n        fetchData(URL_GET_DICT_GROUPSPECS),\r\n        fetchData(URL_GET_DICT_TYPESPECS)\r\n    ]);\r\n\r\n\r\n    const specieses = await speciesesResponse;\r\n    const caretypes = await caretypesResponse;\r\n    const remarks = await remarksResponse;\r\n    const placetypes = await placetypesResponse;\r\n    const irrigationmethods = await irrigationmethodsResponse;\r\n    const groupspecs = await groupspecsResponse;\r\n    const typespecs = await typespecsResponse;\r\n\r\n    return [\r\n        specieses,\r\n        caretypes,\r\n        remarks,\r\n        placetypes,\r\n        irrigationmethods,\r\n        groupspecs,\r\n        typespecs    \r\n    ];\t\r\n}\r\n\r\nconst fetchData = async (apiURL: string) => {\t\t\t\r\n    const res = await fetch(apiURL);\r\n    const data = await res.json();\r\n    return data; \t\t\t\r\n} ","import i18n from 'i18next';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\n\r\nimport translationEN from './locales/en/translation.json';\r\nimport translationBG from './locales/bg/translation.json';\r\nconst availableLanguages = ['en', 'bg'];\r\n\r\n\r\ni18n\r\n    .use(LanguageDetector)\r\n    .use(initReactI18next) // passes i18n down to react-i18next\r\n    .init({\r\n        // the translations\r\n        // (tip move them in a JSON file and import them,\r\n        // or even better, manage them via a UI: https://react.i18next.com/guides/multiple-translation-files#manage-your-translations-with-a-management-gui)\r\n        resources: {\r\n            en: {\r\n                translation: translationEN\r\n            },\r\n\r\n            bg: {\r\n                translation: translationBG\r\n            }      \r\n        },\r\n        //lng: \"bg\", // if you're using a language detector, do not define the lng option\r\n        //lng: localStorage.getItem('lng') || 'en',\r\n        fallbackLng: \"en\",\r\n\r\n        interpolation: {\r\n        escapeValue: false // react already safes from xss => https://www.i18next.com/translation-function/interpolation#unescape\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\nexport default i18n;","import { fetchUrl2 } from \"../utils/misc\"\r\nimport { URL_GET_PERMISSIONS } from '../constants/urlsAPI';\r\nimport i18next from '../i18nextConf.js'\r\n\r\nexport const initPermissions = () => {\r\n    return {\r\n    is_superuser: false,\r\n    tree: {       \r\n        view_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.view_tree')\r\n        },\r\n        add_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.add_tree')\r\n        },\r\n        change_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.change_tree')\r\n        },\r\n        can_change_not_own_tree_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.can_change_not_own_tree_record')\r\n        },   \r\n        can_delete_not_own_tree_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.can_delete_not_own_tree_record')\r\n        },                         \r\n        delete_tree: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.tree.delete_tree')\r\n        },        \r\n    },\r\n\r\n    inspection: {\r\n        view_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.view_inspection')\r\n        },   \r\n        add_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.add_inspection')\r\n        },   \r\n        change_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.change_inspection')\r\n        },  \r\n        can_change_not_own_insp_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.can_change_not_own_insp_record')\r\n        },   \r\n        can_delete_not_own_insp_record: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.can_delete_not_own_insp_record')\r\n        },                              \r\n        delete_inspection: {\r\n            granted: false,\r\n            deniedMessage: i18next.t('permsMessages.inspection.delete_inspection')\r\n        }                                \r\n    },\r\n\r\n    careactivity: {\r\n        view_careactivity: {\r\n            granted: false,\r\n            deniedMessage: \"\"\r\n        }             \r\n    },\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const has_perm = (permObject: any, model: string, permName: string, authToken: any) => {\r\n    \r\n    if (!authToken) {\r\n        alert('Authorization required');\r\n        return false;\r\n    }\r\n\r\n    if (permObject?.is_superuser === true) return true;\r\n    \r\n    console.log('has_perm value', permObject);    \r\n\r\n    if(permObject) {\r\n        if(permObject.hasOwnProperty(model) && permObject[model].hasOwnProperty(permName)) {\r\n            if (permObject[model][permName]?.granted === true) {\r\n                return true;\r\n            } else {\r\n                const deniedMessage = permObject[model][permName]?.deniedMessage;                \r\n                if (deniedMessage) alert(deniedMessage);   \r\n            }                \r\n        }\r\n        return false;\r\n    }\r\n    console.log('has_perm', 'permObject is not exists');\r\n    console.log('has_perm value', permObject);\r\n    return false;\r\n}\r\n\r\nexport async function getCurrentUserPermissions(authToken: any) {\r\n    try {\r\n\r\n        const fetchResult = await fetchUrl2(URL_GET_PERMISSIONS, \"GET\", undefined, authToken.access);\r\n        if (fetchResult && authToken?.user) {\t\t\t\t\t\t    \r\n            console.log('getCurrentUserPermissions', fetchResult);\r\n            \r\n            const initPermissionsRes = initPermissions();\r\n            const currentPermissions = {...initPermissionsRes};\r\n            currentPermissions.is_superuser = fetchResult.is_superuser;\t\t\t\t\t\t\t\t\t\r\n\r\n            if (fetchResult?.citytree) {\r\n                for (const model in fetchResult['citytree']) {\t\t\t\t\t\t\r\n                    const arrayPerms = fetchResult['citytree'][model];\t\t\t\t\t\r\n                    if (Array.isArray(arrayPerms)) {\t\t\t\t\t\t\t\r\n                        arrayPerms.forEach((perm) => {                            \r\n                            //@ts-ignore\r\n                            currentPermissions[model][perm] = {...currentPermissions[model][perm], granted: true};\r\n                        })\t\t\t\t\t\t\t\r\n                    }\r\n                }\r\n            }\r\n            console.log('currentPermissions', currentPermissions);\r\n            return currentPermissions; \r\n            //dispatch(actDataPermissions(currentPermissions));\r\n\r\n            \t\t\t\t\t\t\t\t\r\n        }        \r\n        console.log('URL_GET_PERMISSIONS', fetchResult);\r\n        return null;    \r\n\r\n    } catch(err) {\r\n        console.log('getCurrentUserPermissions', err);        \r\n    }\r\n}\t","import \"./App.css\";\nimport L from 'leaflet'\n\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from  'react-router-dom';\n//import { redirect } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\n\nimport MenuGlobal from \"./components_hl/MenuGlobal\";\nimport Map from \"./components_hl/Map\";\nimport MainWrapper from \"./components/MainWrapper\";\nimport Sidebar from \"./components/Sidebar\";\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\nimport ButtonOkCancelMobileMarker from \"./components/ButtonOkCancelMobileMarker\";\n\nimport FormFilter from './components/FormFilter';\nimport FormTree from './components/FormTree';\nimport FormInspection from './components/FormInspection';\nimport ImageSlider from './components/ImageSlider';\nimport TreePreviewModal from \"./components/TreePreviewModal\";\n\nimport { useAuthToken } from \"./auth/useAuthToken\";\nimport LoginModalForm from \"./components/LoginModalForm\";\nimport RegisterModalForm from \"./components/RegisterModalForm\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { RootState } from \"./reducers/index\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n\tactMapMarkerState,\n\tactNewTreeCreation,\n\tactShowOkCancelMobileMarker,\n\tactIsMobileDevice,\n\tactShowSidebar,\n\tactCheckButtonNewMarker,\n\tactShowTreeTab,\n\tactActiveTabKey,\n\tactDataLastEditedTreeId,\n\tactDictStatuses,\n\tactDictSpecieses,\n\tactDictCareTypes,\n\tactDictRemarks,\n\tactDictPlaceTypes,\n\tactDictIrrigationMethods,\n\tactDictGroupSpecs, \n\tactDictTypeSpecs,\n\tactDataTrees,\n\tactDataFilters,\n\tactShowInspTab,\n\tactDataPermissions\n} from \"./actions\";\nimport { TreeItem, InspItem } from \"./interfaces\";\n\nimport { filterDataMap } from \"./utils/filterDataMap\"\nimport { fetchUrl2 } from \"./utils/misc\"\nimport { fetchAllDictionariesData } from \"./utils/fetchAllDictionariesData\"\nimport { \n\tURL_GET_DICT_STATUSES, \n\tURL_GENERATE_S3_URLKEY, \n\turlTreesByCity, \n\turlTreeByCityAndID \n} from './constants/urlsAPI';\n\nimport { getCurrentUserPermissions, has_perm } from './auth/permissions'\nimport { userAuthentication, refreshTokens } from './auth/useAuthToken';\n\nlet geojsonMarkerOptions_citytree = {\n    //renderer: myRenderer,\n    radius: 5,\n    fillColor: \"#008000\",\n    color: \"#008000\",\n    weight: 0,\n    opacity: 1,\n    fillOpacity: 0.5\n\t};\n\n\n\n\nfunction App() {\n\tconst paramsRouter = useParams();\n\tconst navigate = useNavigate();\n\t//const csrftoken = getCookie(\"csrftoken\");\n\n\t// redux\n\tconst dispatch = useDispatch();\n\tconst rxDataPermissions = useSelector((state: RootState) => state.dataReducer.dataPermissions);\n\tconst rxDataTrees = useSelector((state: RootState) => state.dataReducer.dataTrees);\n\tconst rxShowOkCancelMobileMarker = useSelector((state: RootState) => state.uiReducer.showOkCancelMobileMarker);\n\tconst rxDataFilters = useSelector((state: RootState) => state.dataReducer.dataFilters);\n\tconst rxActiveTabKey = useSelector((state: RootState) => state.uiReducer.activeTabKey);\n\tconst rxShowTreeTab = useSelector((state: RootState) => state.uiReducer.showTreeTab);\n\tconst rxShowInspTab = useSelector((state: RootState) => state.uiReducer.showInspTab);\n\tconst rxDictStatuses = useSelector((state: RootState) => state.dataReducer.dictStatuses);\n\tconst rxCheckButtonHeatmap = useSelector((state: RootState) => state.uiReducer.checkButtonHeatmap);\n\n\tconst rxCheckButtonNewMarker = useSelector((state: RootState) => state.uiReducer.checkButtonNewMarker);\n\tconst rxIsMobileDevice = useSelector((state: RootState) => state.uiReducer.isMobileDevice);\n\n\tconst [currentZoomMap, setCurrentZoomMap] = useState(13);\n\n\tconst [authToken, setAuthToken] = useAuthToken();\n\tconst [screenWidth, setScreenWidth] = useState(window.innerWidth);\n\tconst isMobileView = screenWidth <= 768; // show or hide sidebar at startup\n\n\tconst [dataTreeForm, setDataTreeForm] = useState<TreeItem | null>(null);\n\tconst [dataInspForm, setDataInspForm] = useState<InspItem | {tree: number} | null>(null);\n\tconst [imageSlider, setImageSlider] = useState<{visible: boolean; images: string[]}> ({visible: false, images: []});\n\tconst [treePreview, setTreePreview] = useState<{visible: boolean; data: {}; idTree: number | null}>({visible: false, data:{}, idTree: null});\n\tconst { t, i18n } = useTranslation();\n\n\tlet dataHeatmapPoints: number[][] = []; // [[lat, lng, value],[lat, lng, value]...]\t\n\n\n\tuseEffect(() => {\n\t\tfetchAllDictionariesDataWrapper();\t\t\n\t\tuserAuthentication(authToken, setAuthToken);\n\t\tdispatch(actIsMobileDevice(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)));\n\t\tdispatch(actShowSidebar(!isMobileView));\t\n\t\t\n\t\tif (paramsRouter?.treeId) showTreePreview(parseInt(paramsRouter.treeId));\n\n\t\twindow.addEventListener('resize', handleWindowSizeChange);\n        return () => {\n            window.removeEventListener('resize', handleWindowSizeChange);\t\t\t\n        }\t\t\t\n\t\t\t\t\n\t}, []); /* useEffect triggers when route has been changed too */\n\n\tconst fetchAllDictionariesDataWrapper = () => {\n\t\tfetchAllDictionariesData().then(([specieses, caretypes, remarks, placetypes, irrigationmethods, groupspecs, typespecs]) => {\n\t\t\tdispatch(actDictSpecieses(specieses));\n\t\t\tdispatch(actDictCareTypes(caretypes));\n\t\t\tdispatch(actDictRemarks(remarks));\n\t\t\tdispatch(actDictPlaceTypes(placetypes));\n\t\t\tdispatch(actDictIrrigationMethods(irrigationmethods));\n\t\t\tdispatch(actDictGroupSpecs(groupspecs));\n\t\t\tdispatch(actDictTypeSpecs(typespecs));\n\t\t}).catch(error => {\t\t\t\n\t\t\tconsole.log('fetchAllDictionariesData error: ', error);\n\t\t});\t\n\t}\n\n    function handleWindowSizeChange() {\n        setScreenWidth(window.innerWidth);\n    }\n\n\tuseEffect(() => {\n\t\tfetchTreesAndStatuses();\t\t\t\t\n\t}, [paramsRouter]); /* useEffect triggers when route has been changed too */\n\n\tconst fetchTreesAndStatuses = async () => {\n\t\t//first of all, we must fetch dictionary with statuse, otherwise we can't draw points of trees in diferent color depends of them statuses.\n\t\tlet res = await fetch(URL_GET_DICT_STATUSES);\n\t\tlet data = await res.json();\n\t\tdispatch(actDictStatuses(data));\n\t\t\t\t\t\t\n\t\tif (paramsRouter.cityName) {\n\t\t\tconst URL = urlTreesByCity(paramsRouter.cityName);//`${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/`;\n\t\t\tres = await fetch(URL);\n\t\t\tdata = await res.json();\n\t\t\tdata.dateTimeGenerated = Date.now();\n\t\t\t\n\t\t\tdispatch(actDataTrees(data));\n\t\t}\n\t};\n\n\n    useEffect(() => {\n        let periodUpdate = 240000;//240000 //4 min\n        let interval = setInterval(() => {\n            if (authToken) {    \n\t\t\t\trefreshTokens(setAuthToken, authToken.refresh).then((res)=> console.log('refreshTokens', res));\n            }\n        }, periodUpdate);\n\n\t\n\t\t// update permissions if permissions object still empty, it can happens when website is loading with expired access token\n\t\tif (Object.keys(rxDataPermissions).length === 0 && authToken?.user?.id) {\n\t\t\tgetCurrentUserPermissions(authToken).then((permResult) => {\n\t\t\t\tif (permResult) {\n\t\t\t\t\tconsole.log('permResult useEffect authToken', permResult);\n\t\t\t\t\tdispatch(actDataPermissions(permResult));\n\t\t\t\t}\t\n\t\t\t});\t\t\t\n\t\t}\t\t\n\n        return () => clearInterval(interval)\n    }, [authToken]);\n\t\n\n    useEffect(() => {\n\t\tif (authToken?.user?.id) {\n\t\t\tgetCurrentUserPermissions(authToken).then((permResult) => {\t\t\t\t\n\t\t\t\tif (permResult) dispatch(actDataPermissions(permResult));\n\t\t\t});\t\t\t\n\t\t}\t\n    }, [authToken?.user?.id]);\n\n\n\n\tuseEffect(()=>{\n\t\tif (authToken?.user?.id) {\n\t\t\tgetCurrentUserPermissions(authToken).then((permResult) => {\t\t\t\t\n\t\t\t\tif (permResult) dispatch(actDataPermissions(permResult));\n\t\t\t});\t\t\t\n\t\t}\t\n\t}, [i18n.language]);\n\n\n\tfunction markerOnClick(e: any) {\n\t\tlet marker: L.Marker = e.target;\n\t\tlet geojson = marker.toGeoJSON(); //: GeoJSON.FeatureCollection<any>\n\n\t\tif (geojson?.properties?.id) {\t\t\t\t\t\n\t\t\tshowTreePreview(geojson?.properties?.id);\n\t\t}   \n\t}\n\n\tconst showTreePreview = (idTree: number) => {\t\t\t\t\n\t\tsetTreePreview({ visible: true, data: {}, idTree: idTree });\t\n\t};\n\n\t// when event comes from markerOnClick, it comes from L.Circle which is not React component, therefore there is something wrong, because in this event you can't see current values in States and Redux (to check permissions using rxDataPermissions), so I used redux event to broke that chain\n\tuseEffect(()=>{\t\t\n\t\tif (treePreview?.visible === true && treePreview?.idTree) {\n\t\t\tnavigate(`${paramsRouter.cityName}/${treePreview.idTree.toString()}`);\n\t\t\tfetchTreeData(treePreview.idTree).then((data) =>\n\t\t\t\tsetTreePreview({ visible: true, data: data, idTree: null })\n\t\t\t);\t\t\t\n\t\t} else if (treePreview?.visible === false) {\n\t\t\tnavigate(`${paramsRouter.cityName}`);\n\t\t}\n\n\t}, [treePreview]);\n\n\tconst onButtonEditTreeClick = (idTree: number) => {\n\t\teditTree(idTree);\n\t}\n\n\tconst editTree = (idTree: number) => {\n\t\tfetchTreeData(idTree).then((data) => setDataTreeForm(data));\t\t\n\t\tdispatch(actShowTreeTab(true));\n\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\n\t}\n\t\n\tconst onSubmitTree = async (data: any) => {\t\t\n\t\tif (!has_perm(rxDataPermissions, 'tree', 'change_tree', authToken)) return;\n\t\t\t\t\t\t\t\n\t\tif (paramsRouter.cityName) {\n\t\t\tlet method;\n\t\t\tlet url;\n\t\t\tif (data.id) {\n\t\t\t\tconsole.log(data, authToken.user.id);\n\t\t\t\tif (data.useradded !== authToken.user.id && !has_perm(rxDataPermissions, 'tree', 'can_change_not_own_tree_record', authToken) ) return; \n\t\t\t\t//url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.id}/`;\n\t\t\t\turl = urlTreeByCityAndID(paramsRouter.cityName, data.id);\n\t\t\t\tmethod = \"PUT\";\n\t\t\t} else {\n\t\t\t\t//url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/`;\n\t\t\t\turl = urlTreesByCity(paramsRouter.cityName);\n\t\t\t\tmethod = \"POST\";\n\t\t\t}\n\t\t\t\t\t\n\t\t\ttry {\n\t\t\t\tawait fetchUrl2(url, method, data, authToken.access);\n\t\t\t\tfetchTreesAndStatuses();\n\t\t\t\tdispatch(actMapMarkerState({ visible: false, position: {} }));\n\t\t\t\tdispatch(actNewTreeCreation(false));\n\t\t\t\tdispatch(actActiveTabKey('filter'));\n\t\t\t\tdispatch(actShowTreeTab(false));\n\n\t\t\t\tif (isMobileView) { \n\t\t\t\t\tdispatch(actShowSidebar(false))\n\t\t\t\t}\t\t\t\t\n\t\t\t} catch(err) {\n\t\t\t\tconsole.log('onSubmitTree', err);\n\t\t\t\t//@ts-ignore\n\t\t\t\talert(err.detail);\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t};\n\n\tconst onDeleteTree = async (data: TreeItem | null) => {\n\t\tif (!has_perm(rxDataPermissions, 'tree', 'delete_tree', authToken)) return;\t\t\n\t\tif (!has_perm(rxDataPermissions, 'tree', 'can_delete_not_own_tree_record', authToken) && data?.useradded !== authToken.user.id) return;\n\t\t\n\t\tif (data?.id && paramsRouter.cityName) {\n\t\t\tawait fetchUrl2(urlTreeByCityAndID(paramsRouter.cityName, data.id), \"DELETE\", {}, authToken.access);\n\t\t\tdispatch(actActiveTabKey('filter'));\n\t\t\tdispatch(actShowTreeTab(false));\t\t\t\t\t\t\n\t\t\tfetchTreesAndStatuses();\t\t\t\n\t\t}\n\t};\n\n\tconst onCloseTree = () => {\t\n\t\tdispatch(actMapMarkerState({ visible: false, position: {} }));\n\t\tdispatch(actNewTreeCreation(false));\n\t\tdispatch(actActiveTabKey('filter'));\n\t\tdispatch(actShowTreeTab(false));\n\t};\n\n\tconst fetchTreeData = async (idTree: number) => {\t\t\t\n\t\tlet url = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${idTree}/`;\n\t\tlet res = await fetch(url);\n\t\tlet data = await res.json();\n\t\tconsole.log('fetchTreeData', data)\n\t\treturn data;\n\t\t//setDataTreeForm(data);\t\t\n\t}\n\n\tconst onSubmitInsp = async (data: any) => {\n\n\t\tlet method;\n\t\tlet url;\n\t\tif (data.id) {\n\n\t\t\tif (!has_perm(rxDataPermissions, 'inspection', 'change_inspection', authToken)) return;\n\t\t\tif (data?.user !== authToken.user.id && !has_perm(rxDataPermissions, 'inspection', 'can_change_not_own_insp_record', authToken)) return;\t\t\t\n\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.treeId}/inspections/${data.id}/`;\n\t\t\tmethod = \"PUT\";\n\t\t} else {\t\t\t\t\t\t\n\t\t\turl = `${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/${data.treeId}/inspections/`;\n\t\t\tmethod = \"POST\";\n\t\t}\n\n\n\t\tconsole.log('insp', data, url);\n\t\tawait fetchUrl2(url, method, data, authToken.access);\n\t\tfetchTreeData(data.treeId).then(data => setDataTreeForm(data));\t\t\n\t\tfetchTreesAndStatuses();\n\t\tif (rxShowTreeTab === true) {\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\n\t\t} else {\n\t\t\tdispatch(actActiveTabKey('filter'));\t\n\t\t}\n\t\tdispatch(actShowInspTab(false));\n\t\t\n\t\tupdateInspectionListsWithSpecificTreeId(data.treeId);\t\t\n\t\t\t\n\t};\n\n\tconst onDeleteInsp = async (data: InspItem | null) => {\n\t\tif (!has_perm(rxDataPermissions, 'inspection', 'delete_inspection', authToken)) return;\t\t\n\t\tif (data?.user !== authToken.user.id && !has_perm(rxDataPermissions, 'inspection', 'can_delete_not_own_insp_record', authToken)) return;\t\t\n\n\t\tif (data?.id) {\n\t\t\tconsole.log('DELETE', data)\n\t\t\t//path('citytree/<str:city>/trees/<str:treeid>/inspections/<str:inspid>/', views.citytreeInspectionItem, name=\"citytree-restapi-inspection-item\"),\n\t\t\tawait fetchUrl2(\n\t\t\t\t`${process.env.REACT_APP_API_URL}citytree/${paramsRouter.cityName}/trees/0/inspections/${data.id}`, \n\t\t\t\t\"DELETE\", \n\t\t\t\t{}, \n\t\t\t\tauthToken.access);\n\n\t\t\t\tif (data) {\n\t\t\t\t\tfetchTreeData(data.tree).then(data => setDataTreeForm(data));\t;\t\t\t\t\n\t\t\t\t\tif (rxShowTreeTab === true) {\n\t\t\t\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatch(actActiveTabKey('filter'));\t\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\tdispatch(actShowInspTab(false));\t\t\t\t\t\t\n\t\t\t\t\tfetchTreesAndStatuses();\n\t\t\t\t\tupdateInspectionListsWithSpecificTreeId(data.tree);\n\t\t\t\t}\t\t\t\t\n\n\t\t}\t\n\t};\t\n\n\tfunction updateInspectionListsWithSpecificTreeId (id: number) {\n\t\tdispatch(actDataLastEditedTreeId({treeId: id})); \n\t}\t\n\n\tconst onCloseInsp = () => {\t\t\n\t\tdispatch(actShowInspTab(false));\n\t\tif (rxShowTreeTab === true) {\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\n\t\t} else {\n\t\t\tdispatch(actActiveTabKey('filter'));\t\n\t\t}\t\t\t\t\t\n\t};\t\n\n\tconst onNewInsp = (idTree: number) => {\n\t\tif (!has_perm(rxDataPermissions, 'inspection', 'add_inspection', authToken)) return; \n\n\t\tsetDataInspForm({tree: idTree});\n\t\tdispatch(actShowInspTab(true));\n\t\tdispatch(actActiveTabKey('insp'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\t\t\t\n\n\t}\n\n\tconst onClickInspEdit = (data: any) => {\n\t\tif (!has_perm(rxDataPermissions, 'inspection', 'view_inspection', authToken)) return; \n\n\t\t//setDataInspForm({...data}); //таким образом передается копия объекта, которая указывает на другой участок памяти, иначе useEffect не срабатывает у формы, а значит форма не перезаполняется, когда например чтото поменяли на форме, затем ее закрыли без сохранения и снова открыли, видим вместо актуальных данных, старые, которые не сохранялись\n\t\tsetDataInspForm(data);\n\t\tdispatch(actShowInspTab(true));\n\t\tdispatch(actActiveTabKey('insp'));\t\t\t\t\t\t\t\t\t\n\t\tdispatch(actShowSidebar(true));\t\t\t\n\t}\t\n\n\tconst onClickInspPhotos = (data: any) => {\n\t\tconsole.log('onClickPhotos', data);\t\t\n\t\t\n\t\tconst images: string[] = [];\n\t\tif (data?.photo1) {\n\t\t\timages.push(`${data.photoServer}${data?.photo1}`);\n\t\t}\n\t\tif (data?.photo2) {\n\t\t\timages.push(`${data.photoServer}${data?.photo2}`);\n\t\t}\n\t\tif (data?.photo3) {\n\t\t\timages.push(`${data.photoServer}${data?.photo3}`);\n\t\t}\t\t\t\t\n\n\t\tif (images.length > 0) {\n\t\t\tsetImageSlider({visible: true, images: images});\n\t\t}\t\t\t\t\t\n\t}\t\t\n\n\tconst onClickEditCoords = (coord: {lat: string; lng: string}) => {\t\t\t\n\t\tif (rxIsMobileDevice) {\t\n\t\t\tdispatch(actShowSidebar(false));\t\t\t\t\t            \n            dispatch(actShowOkCancelMobileMarker(true));\n\t\t}\n\t\t\n\t\tdispatch(actMapMarkerState({ visible: true, position: coord }));\t\t\t\t\t\t\n\t}\n\t\t\n\tconst onClickMap = (e: any) => {\n\t\tif (rxCheckButtonNewMarker && !rxIsMobileDevice) {\n\t\t\tdispatch(actNewTreeCreation(true));\n\t\t\tdispatch(actCheckButtonNewMarker(false));\n\n\t\t\tlet coord = { lat: '0', lng: '0' };\n\t\t\tcoord.lat = e.latlng.lat.toFixed(5);\n\t\t\tcoord.lng = e.latlng.lng.toFixed(5);\n\t\t\t\n\t\t\tdispatch(actMapMarkerState({ visible: true, position: coord }));\n\t\t\tdispatch(actNewTreeCreation(true));\n\n\t\t\tdispatch(actShowTreeTab(true));\n\t\t\tdispatch(actActiveTabKey('tree'));\t\t\t\t\t\t\t\t\t\n\t\t\tdispatch(actShowSidebar(true));\t\n\t\t}\t\t\n\t}\n\n\tconst onClickCreateNewMarker = (state: boolean): boolean | void => {\t\t\t\t\t\t\n\t\t//console.log('test', test);\n\t\t//console.log('rxDataPermissions', rxDataPermissions);\n\t\t//if (!has_perm(rxDataPermissions, 'tree', 'add_tree', authToken)) return false;\t\t\t\t\t\t\t\n\t}\n\n\tuseEffect(()=>{\n\t\tif (rxCheckButtonNewMarker) {\n\t\t\tif (!has_perm(rxDataPermissions, 'tree', 'add_tree', authToken)) {\n\t\t\t\tdispatch(actCheckButtonNewMarker(false));\n\n\t\t\t\tif (rxIsMobileDevice) {\t\t\t\t\t\t\n\t\t\t\t\tdispatch(actMapMarkerState({ visible: false, position: {lat: 0, lng: 0} }));\n\t\t\t\t\tdispatch(actShowOkCancelMobileMarker(false));\n\t\t\t\t}\t\t\t\t\n\t\t\t}\t\t\t\t\t\t\n\t\t}\t\n\t}, [rxCheckButtonNewMarker]);\n\n\tconst onZoomEnd = (e: any) => {\n\t\t//console.log('zoom', e.target._zoom);\n\t\tsetCurrentZoomMap(e.target._zoom);\n\t}\n\t\t\n\tconst onDragEndNewMarker = (LatLng: { lat: number; lng: number }) => {\n\t\tdispatch(actMapMarkerState({ visible: true, position: LatLng }));\n\t};\n\n\tconst onSubmitFilter = (filter: {}) => {\t\t\n\t\tdataHeatmapPoints = [];\n\t\t\t\t\n\t\trxDataTrees.dateTimeGenerated = Date.now(); // dateTimeGenerated is used like key parameter to update data on map, when it changed. <GeoJSON key={mainData.dateTimeGenerated}...\n\t\tdispatch(actDataFilters(filter));\t\n\n\t\tif (isMobileView) {\n\t\t\tdispatch(actShowSidebar(false))\n\t\t}\n\t\t\n\t};\n\n\tconst filterMapCallback = (feature: any): boolean => {\n\t\tconst result = filterDataMap(feature, rxDataFilters, authToken);\n\n\t\tif (result && rxCheckButtonHeatmap) {\n\t\t\tlet crowndiameter = feature?.properties?.lastinsp_crowndiameter;\n\t\t\tif (!crowndiameter) crowndiameter = 1;\t\t\t\n\t\t\tconst dot = [feature.properties.latitude, feature.properties.longitude, crowndiameter / 20];\t\t\t\t\t\n\t\t\tdataHeatmapPoints.push(dot);\n\t\t\t//console.log(dataHeatmapPoints.length)\n\t\t}\n\n\t\treturn result;\n\t};\t\n\t\n\t\n\tuseEffect(()=>{\n\t\trxDataTrees.dateTimeGenerated = Date.now();\t// you must change that key to force GEOJSON function to redraw point\t\t\n\t}, [rxCheckButtonHeatmap]);\n\n\tfunction pointToLayerTrees(feature: any, latlng: L.LatLng): any { \t\t\t\t\t\t\n\t\tif (!rxCheckButtonHeatmap) {\t\t\t\n\t\t\t// change color of point depends on them status\n\t\t\tif (feature.properties.lastinsp_status) {\n\t\t\t\tif (Array.isArray(rxDictStatuses)) {\n\t\t\t\t\trxDictStatuses.forEach(element => {\n\t\t\t\t\tif (element.id === feature.properties.lastinsp_status) {\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.fillColor = `#${element.hexcolor}`;\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.color = `#${element.hexcolor}`;\n\t\t\t\t\t\tgeojsonMarkerOptions_citytree.radius = ZoomToRadius(currentZoomMap, feature.properties.lastinsp_crowndiameter);\n\t\t\t\t\t}\t\n\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\t\n\t\t\t\n\t\t\t//return L.circleMarker(latlng, geojsonMarkerOptions_citytree).on('click', markerOnClick);\n\t\t\treturn L.circle(latlng, geojsonMarkerOptions_citytree).on('click', markerOnClick);\t\t\t\n\t\t}\t\t\t\n\t\treturn null;\n\t}\n\n\tfunction ZoomToRadius (zoom: number, crowndiameter: number) {\n\t\t// + 21...13 -\n\t\tlet r = Math.floor(crowndiameter / 2);\n\t\tif (zoom < 19) r = r + (18-zoom)*5;\n\t\tif (r < 2) r=2;\n\t\treturn r; \t\t\n\t}\t\n\t\n\tconst onEachLayer = (layer: L.Layer, zoom: number) => {\n\t\tif (rxCheckButtonHeatmap) return;\n\n\t\t//@ts-ignore\n\t\tconst crowndiameter = layer?.feature?.properties?.lastinsp_crowndiameter;\n\t\tif (crowndiameter) {\n\t\t\t//@ts-ignore\n\t\t    layer.setRadius(ZoomToRadius(zoom, crowndiameter));                    \t\t\t\n\t\t} \t\t\n\t}\t\n\n\n \n\treturn (\t\t\t\t\n\t\t<MainWrapper cityName={paramsRouter.cityName}>\t\t\t\n\t\t\t<>\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t<Sidebar>\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\tid=\"controlled-tab-example\"\n\t\t\t\t\t\tactiveKey={rxActiveTabKey}\n\t\t\t\t\t\tonSelect={(k) => dispatch(actActiveTabKey(k))}\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tclassName=\"mb-3\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"filter\"\n\t\t\t\t\t\t\ttitle={t<string>(\"sidebar.filterTab.title\")}\t\t\t\t\t\t\t\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormFilter onSubmitFilter={onSubmitFilter}  \n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\n\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"tree\"\n\t\t\t\t\t\t\ttitle={t<string>(\n\t\t\t\t\t\t\t\t\"sidebar.treeTab.title\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\ttabClassName={\n\t\t\t\t\t\t\t\t!rxShowTreeTab ? \"d-none\" : \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormTree \n\t\t\t\t\t\t\t\t\tonSubmitTree={onSubmitTree}\n\t\t\t\t\t\t\t\t\tonDeleteTree={onDeleteTree}\n\t\t\t\t\t\t\t\t\tonCloseTree={onCloseTree} \n\t\t\t\t\t\t\t\t\tonNewInsp={onNewInsp}\n\t\t\t\t\t\t\t\t\tonClickInspEdit={onClickInspEdit}\n\t\t\t\t\t\t\t\t\tonClickInspPhotos={onClickInspPhotos}\n\t\t\t\t\t\t\t\t\tonClickEditCoords={onClickEditCoords}\n\t\t\t\t\t\t\t\t\tdataTreeForm={dataTreeForm}\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\t\tcity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t\tsigningS3Url={URL_GENERATE_S3_URLKEY}\n\t\t\t\t\t\t\t\t\t//currentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\n\n\t\t\t\t\t\t<Tab\n\t\t\t\t\t\t\teventKey=\"insp\"\n\t\t\t\t\t\t\ttitle={t<string>(\n\t\t\t\t\t\t\t\t\"sidebar.inspTab.title\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\ttabClassName={\n\t\t\t\t\t\t\t\t!rxShowInspTab ? \"d-none\" : \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"form-wrapper\">\n\t\t\t\t\t\t\t\t<FormInspection \n\t\t\t\t\t\t\t\t\tonSubmitInsp={onSubmitInsp}\n\t\t\t\t\t\t\t\t\tonDeleteInsp={onDeleteInsp}\n\t\t\t\t\t\t\t\t\tonCloseInsp={onCloseInsp} \n\t\t\t\t\t\t\t\t\tdataInspForm={dataInspForm}\n\t\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\t\tcity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t\tsigningS3Url={URL_GENERATE_S3_URLKEY}\n\t\t\t\t\t\t\t\t\t//currentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tab>\t\t\t\t\t\t\t\t\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Sidebar>\n\n\t\t\t\t<div id=\"page-content-wrapper\">\n\t\t\t\t\t<MenuGlobal\n\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t//onClickShowMenu={ () => dispatch(actShowSidebar(!rxShowSidebar)) }\n\t\t\t\t\t\tauthToken={authToken}\n\t\t\t\t\t\tsetAuthToken={setAuthToken}\n\t\t\t\t\t\tappname=\"citytree\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"container-fluid\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tpaddingRight: \"0px\",\n\t\t\t\t\t\t\tpaddingLeft: \"0px\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Map\n\t\t\t\t\t\t\tmainData={rxDataTrees}\n\t\t\t\t\t\t\tappname=\"citytree\"\n\t\t\t\t\t\t\tdataHeatmapPoints={dataHeatmapPoints}\n\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\tcurrentCity={paramsRouter.cityName}\n\t\t\t\t\t\t\tonClickMap={onClickMap}\n\t\t\t\t\t\t\tonClickCreateNewMarker={onClickCreateNewMarker}\n\t\t\t\t\t\t\tonZoomEnd={onZoomEnd}\n\t\t\t\t\t\t\tonEachLayer={onEachLayer}\n\t\t\t\t\t\t\t//={onMarkerClick}\n\t\t\t\t\t\t\tonDragEndNewMarker={onDragEndNewMarker}\n\t\t\t\t\t\t\tpointToLayerCallback={pointToLayerTrees}\n\t\t\t\t\t\t\tfilterMapCallback={filterMapCallback}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n\t\t\t\t{rxShowOkCancelMobileMarker && (\n\t\t\t\t\t<ButtonOkCancelMobileMarker/>\n\t\t\t\t)}\n\n\t\t\t\t<ImageSlider \n\t\t\t\t\tvisible={imageSlider.visible} \n\t\t\t\t\tsetVisible={setImageSlider} \n\t\t\t\t\timages={imageSlider.images}\n\t\t\t\t/>\n\n\t\t\t\t<TreePreviewModal \n\t\t\t\t\tvisible={treePreview.visible} \n\t\t\t\t\tdata={treePreview.data}\n\t\t\t\t\tsetTreePreview={setTreePreview}\n\t\t\t\t\tonButtonEditTreeClick={onButtonEditTreeClick}\n\t\t\t\t\tonClickInspEdit={onClickInspEdit} \n\t\t\t\t\tonClickButtonEditInsp={onClickInspEdit}\n\t\t\t\t\tonClickButtonPhotosInsp={onClickInspPhotos}\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t/>\t\t\t\t\n\n\t\t\t\t<LoginModalForm setAuthToken={setAuthToken}/>\n\t\t\t\t<RegisterModalForm setAuthToken={setAuthToken}/> \t\t\t\n\t\t\t</>\n\t\t</MainWrapper>\n\n\t);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","const initialState = {\r\n    showSidebar: false,\r\n    showTreeTab: false,\r\n    showInspTab: false,\r\n    activeTabKey: 'filter',\r\n    loginModalShow: false,\r\n    registerModalShow: false,\r\n\r\n    mapBaseLayerName: 'Default',\r\n    mapMarkerState: {\r\n\t\tvisible: false,\r\n\t\tposition: {},\r\n\t\tisMobile: false\r\n\t},\r\n    newTreeCreation: false,\r\n    showOkCancelMobileMarker: false,\r\n    checkButtonNewMarker: false,\r\n    checkButtonHeatmap: false,\r\n    checkButtonGPS: false,\r\n\r\n    isMobileDevice: false\r\n}\r\n\r\nconst uiReducer = (state=initialState, action: {type: string; payload: any}) => {\r\n    switch (action.type) {\r\n        case 'SHOWSIDEBAR':\r\n            return {\r\n                ...state,\r\n                showSidebar: action.payload\r\n            }\r\n        case 'SHOWTREETAB':\r\n            return {\r\n                ...state,\r\n                showTreeTab: action.payload\r\n            }   \r\n        case 'SHOWINSPTAB':\r\n            return {\r\n                ...state,\r\n                showInspTab: action.payload\r\n            }                      \r\n        case 'ACTIVETABKEY':\r\n            return {\r\n                ...state,\r\n                activeTabKey: action.payload\r\n            }                                              \r\n        case 'LOGINMODALSHOW':\r\n            return {\r\n                ...state,\r\n                loginModalShow: action.payload\r\n            }\r\n\r\n        case 'REGISTERMODALSHOW':\r\n            return {\r\n                ...state,\r\n                registerModalShow: action.payload\r\n            }    \r\n        \r\n\r\n\r\n        case 'MAPBASELAYERNAME':\r\n            return {\r\n                ...state,\r\n                mapBaseLayerName: action.payload\r\n            } \r\n            \r\n        case 'MAPMARKERSTATE':\r\n            return {\r\n                ...state,\r\n                mapMarkerState: action.payload\r\n            } \r\n\r\n        case 'NEWTREECREATION':\r\n            return {\r\n                ...state,\r\n                newTreeCreation: action.payload\r\n            }             \r\n\r\n        case 'SHOWOKCANCELMOBILEMARKER':\r\n            return {\r\n                ...state,\r\n                showOkCancelMobileMarker: action.payload\r\n            }              \r\n        \r\n        case 'CHECKBUTTONNEWMARKER':\r\n            return {\r\n                ...state,\r\n                checkButtonNewMarker: action.payload\r\n            }\r\n        case 'CHECKBUTTONHEATMAP':\r\n            return {\r\n                ...state,\r\n                checkButtonHeatmap: action.payload\r\n            }            \r\n        case 'CHECKBUTTONGPS':\r\n            return {\r\n                ...state,\r\n                checkButtonGPS: action.payload\r\n            }            \r\n                        \r\n\r\n\r\n        case 'ISMOBILEDEVICE':\r\n            return {\r\n                ...state,\r\n                isMobileDevice: action.payload\r\n            }\r\n\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default uiReducer","const initialState = {\r\n    dataPermissions: {},\r\n    dataTrees: [],\r\n    dataFilters: {},\r\n    dictStatuses: [],\r\n    dictSpecieses: [],\r\n    dictCareTypes: [],\r\n    dictRemarks: [], \r\n    dictPlaceTypes: [],\r\n    dictIrrigationMethods: [], \r\n    dictGroupSpec: [],\r\n    dictTypeSpec: [],\r\n    dataLastEditedTreeId: {treeId: 0} \r\n}\r\n\r\nconst dataReducer = (state=initialState, action: {type: string; payload: any}) => {\r\n    switch (action.type) {\r\n        case 'DATAPERMISSIONS':\r\n            return {\r\n                ...state,\r\n                dataPermissions: action.payload\r\n            }\r\n        case 'DATATREES':\r\n            return {\r\n                ...state,\r\n                dataTrees: action.payload\r\n            }\r\n\r\n        case 'DATALASTEDITEDTREEID':\r\n            return {\r\n                ...state,\r\n                dataLastEditedTreeId: action.payload\r\n            }\r\n                        \r\n        case 'DICTSTATUSES':\r\n            return {\r\n                ...state,\r\n                dictStatuses: action.payload\r\n            }\r\n\r\n        case 'DICTSPECIESES':\r\n            return {\r\n                ...state,\r\n                dictSpecieses: action.payload\r\n            }      \r\n\r\n        case 'DICTCARETYPES':\r\n            return {\r\n                ...state,\r\n                dictCareTypes: action.payload\r\n            }  \r\n\r\n        case 'DICTREMARKS':\r\n            return {\r\n                ...state,\r\n                dictRemarks: action.payload\r\n            }  \r\n\r\n        case 'DICTPLACETYPES':\r\n            return {\r\n                ...state,\r\n                dictPlaceTypes: action.payload\r\n            }    \r\n            \r\n        case 'DICTIRRIGATIONMETHODS':\r\n            return {\r\n                ...state,\r\n                dictIrrigationMethods: action.payload\r\n            }   \r\n            \r\n        case 'DICTGROUPSPECS':\r\n            return {\r\n                ...state,\r\n                dictGroupSpec: action.payload\r\n            }             \r\n            \r\n        case 'DICTTYPESPECS':\r\n            return {\r\n                ...state,\r\n                dictTypeSpec: action.payload\r\n            }             \r\n\r\n        case 'DATAFILTERS':\r\n            return {\r\n                ...state,\r\n                dataFilters: action.payload\r\n            }\r\n\r\n\r\n        default:\r\n            return state            \r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport default dataReducer","import uiReducer from './userInterface'\r\nimport dataReducer from './dataApp'\r\nimport { combineReducers } from 'redux'\r\n\r\nexport const allReducers = combineReducers({\r\n    uiReducer,\r\n    dataReducer    \r\n});\r\n\r\n//export default allReducers\r\nexport type RootState = ReturnType<typeof allReducers>","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\nimport './sidebar.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport './i18nextConf';\nimport { createStore } from 'redux';\nimport { allReducers } from './reducers/index.ts';\nimport { Provider } from 'react-redux';\n\n// Importing the Bootstrap CSS\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst store = createStore(\n  allReducers,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n)\n\nReactDOM.render(\n  <Provider store={store}>\n  <React.StrictMode>\n    <BrowserRouter basename=\"/citytree\">\n      <Routes>\n        <Route path=\"/\" element={<App />}>\n          <Route path=\":cityName\" element={<App />} >\n            <Route path=\":treeId\" element={<App />} />\n          </Route>               \n        </Route>\n      </Routes>\n    </BrowserRouter>\n  </React.StrictMode>\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}